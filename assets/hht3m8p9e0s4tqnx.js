const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j0yo6uv6652vva62.js","assets/i8clt0mfz495j7ii.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/fv135gy2k0pewip3.js","assets/kgnykbdth8mb50na.js","assets/g8i6bixylsxyemsr.js","assets/ddurw41ljhd63sp4.js","assets/gsas8pb1acnf7jnd.js","assets/pbw8dlpn7avzkj1f.js","assets/nkvmhihsargoclsc.js","assets/fqr9t6mx0mgbb8wb.js","assets/ktrkoq6ffn0gq1va.js","assets/o6zuph8g9nfa6t2k.js","assets/nr1vc1815n1t71bd.js","assets/bh6hb7ypq0ifozyx.js","assets/fvwl5axm49dprhsf.js","assets/e9gtc6k4kfmwzcn1.js","assets/b4xre65mpwtmpsm5.js","assets/haxs88dyx78kruos.js","assets/db2vbext8urnm82g.js","assets/i1vfxlpgdgslxqwx.js","assets/efcqr1k3spvze0uw.js","assets/bxgk09qvxvkate6l.js","assets/h8pr5f6a9kp0y6hm.js","assets/mzyl3pd4zxnxoe9i.js","assets/gy1lpvuoewmzh42c.js","assets/i03gut32e8jn5ajq.js","assets/h1em0bjkpkjv8ykw.js","assets/nfccle6oyncifphl.js","assets/hu1bt0oauegdhua6.js"])))=>i.map(i=>d[i]);
var Er=Object.defineProperty,jr=Object.defineProperties;var wr=Object.getOwnPropertyDescriptors;var Fo=Object.getOwnPropertySymbols;var Mr=Object.prototype.hasOwnProperty,Rr=Object.prototype.propertyIsEnumerable;var Go=(t,e,n)=>e in t?Er(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_t=(t,e)=>{for(var n in e||(e={}))Mr.call(e,n)&&Go(t,n,e[n]);if(Fo)for(var n of Fo(e))Rr.call(e,n)&&Go(t,n,e[n]);return t},Jt=(t,e)=>jr(t,wr(e));import{_ as Ye,c as It,r as T,j as s,M as os,f as Gn,e as Pt,h as Aa,m as vr,ab as Nr}from"./i8clt0mfz495j7ii.js";import{o as Qe,L as Tt,u as tt,as as Us,de as Or,cH as Bt,a5 as Hn,p as Br,a0 as as,w as Gs,x as Hs,be as ka,h as St,bO as ht,d as ut,P as gt,dj as is,k4 as Ks,jH as Wn,a as Ee,$ as Dr,aW as Lr,aV as hs,b1 as Ia,aN as Ys,r7 as Fr,aX as Dt,dM as Gr,bN as Pa,ey as Hr,et as Wr,iT as Ea,p3 as Ur,b8 as $s,fA as Un,fF as $r,e5 as zr,r8 as qr,r9 as Vr,fU as $n,hB as Jr,gj as Kr,hC as Yr,kg as zn,op as ja,p1 as Qr,ak as Z,eh as Qs,bT as Kt,aJ as Xr,aL as wa,iX as Je,jr as Zr,jQ as Ma,l0 as el,ra as Rn,eL as Ut,id as tl,ie as sl,ih as nl,ic as ol,ff as Ra,iI as al,e4 as it,jq as Wt,i4 as il,T as qn,il as rl,rb as ll,en as va,rc as cl,rd as vs,ki as An,h2 as dl,re as ul,rf as ml,rg as pl,fV as fl,c8 as hl,kf as gl,ir as Vn,eK as Na,eq as Oa,eJ as Rt,rh as Ba,bQ as vn,aU as qe,ba as Da,kF as La,hr as Nn,es as Jn,ri as Xs,bI as zs,B as Fa,rj as Kn,aS as Yt,eC as Ga,rk as Ho,kB as _l,n$ as Ha,rl as Yn,eu as Qn,hD as Xn,e as Wa,rm as bl,o0 as xl,rn as yl,aT as qs,p4 as Sl,ro as Zn,l$ as Cl,q4 as Tl,b0 as Al,rp as kl,rq as Il,rr as Pl,ky as El,ex as jl,rs as wl,aQ as Ml,lG as Rl,eG as vl,oX as Ua,dc as $a,iA as eo,ku as za,fC as qa,rt as Nl,ob as Va,cp as Ol,kS as On,iu as Bl,jm as Dl,aG as Ll,eg as Ja,ru as Fl,bz as Gl,rv as Hl,i as Wl,ke as Ul,lS as $l,gV as zl,H as ql,d1 as Bn,lH as Vl,oO as Jl,iV as Kl,rw as Yl,eI as Ql,gi as Xl,rx as Zl,jt as Wo,kp as ec,E as tc,gU as sc,fB as nc,fD as oc,dq as ac,dT as Uo,jz as ic,ix as kn,ju as rc,oi as lc,kv as $o,js as cc,ry as dc,rz as uc,bR as In,bM as zo,eH as qo,ja as Ns,rA as mc,rB as Vo,aj as pc,jw as fc,ol as hc,d_ as Jo,oj as gc,ok as _c,h4 as bc,iv as Os,hV as Ko,kG as xc,by as Ka,gh as Pn,rC as Yo,bb as En,bc as jn,rD as Qo,bL as yc,kT as Sc,kU as Cc,dk as Xo,rE as Tc,k2 as Ac,rF as kc,i$ as Ic,rG as Pc,f7 as Zo,iZ as ea,rH as Ec,fn as jc,dv as wc,rI as Mc,rJ as Rc,rK as vc,J as Nc,rL as Oc,r3 as Bc,c7 as ta,iY as Dc,kr as Lc,z as Fc,jC as Gc,cK as Hc,cJ as Bs,fw as Wc,fg as Uc,h0 as $c,fc as zc,rM as qc,m6 as Vc}from"./ghewn7l2ynbm32fm.js";import{aS as Vs,aT as ps,pi as Jc,e1 as Kc,pj as Yc,mn as Qc,ny as Ya,pk as sa,pl as Xc,nN as Zc,pm as Qa,mo as na,pn as ed,po as td,ib as Xa,ic as sd,pp as nd,pq as od,lQ as vt,lS as Js,pr as _e,ps as ad,pt as id,z as rd,pu as ld,m2 as oa,pv as cd,pw as dd,nW as ud,px as md,py as aa,pz as pd,pA as fd,pB as hd,pC as gd,pD as _d,pE as bd,pF as xd,pG as yd,pH as Sd,pI as Cd,pJ as Td,pK as Ad,pL as kd,pM as ia,pN as Id,pO as Pd,pP as Ed,pQ as jd,pR as wd,pS as Md,pT as Rd,pU as vd,pV as Nd,pW as Od,pX as Bd,pY as Dd,pZ as Ld,p_ as Fd,aH as Gd,fo as Za,p$ as ra,q0 as Hd,q1 as Dn,gI as ei,bk as ti,q2 as Wd,q3 as Ud,q4 as $d,bc as zd,hD as la,hn as Ws,q5 as ms,q6 as qd,q7 as si,q8 as Vd,q9 as Jd,qa as Kd,qb as Yd,qc as Qd,qd as Xd,ba as fs,bo as Zd,qe as eu,qf as tu,qg as su,qh as nu,mP as ou,qi as au,qj as ca,qk as ni,ql as iu,qm as ru,bV as oi,qn as ai,qo as ii,qp as wn,qq as lu,qr as cu,qs as Mn,qt as du,qu as uu,qv as mu,kx as pu,qw as Ln,qx as fu,qy as hu,qz as gu,qA as ri,qB as _u,qC as bu,qD as xu,qE as da,qF as yu,qG as Su,qH as Cu,qI as Tu,qJ as Au,P as ua,qK as ku,qL as Iu,gj as Pu,it as ma,iq as pa,qM as Eu,gl as ju,qN as wu,ks as Mu,qO as Ru,qP as vu,ao as Nu,qQ as Ou,qR as Bu,qS as Du,qT as Lu,he as Fu,hg as fa,qU as ha,qV as Gu,qW as Hu,qX as Wu,qY as Uu,bW as $u,ix as zu,g_ as qu,kO as Vu,qZ as Ju,q_ as Ku,q$ as ga,gB as cs,r0 as ns,r1 as _a,n7 as Yu,nS as ba,r2 as Qu,r3 as Xu,r4 as Zu,r5 as em,r6 as xa,aP as ya,r7 as tm,gu as sm,r8 as nm,r9 as om,j_ as am,j$ as im,k0 as rm,ra as lm,rb as cm,rc as dm,fJ as um,rd as mm,mR as bt,re as pm,ai as fm,jE as hm,rf as gm,rg as _m,rh as bm,ri as xm,rj as ym,rk as Ds,rl as Sm,aD as Cm,fq as Tm,rm as Am,rn as km,ro as Im,rp as Pm,rq as Em,rr as jm,rs as wm,rt as Mm,ru as Rm,rv as vm,rw as Nm,rx as Om,ry as Bm,rz as Dm,rA as Lm,rB as Fm,rC as Gm,gV as Hm,j4 as Wm,d0 as Um,cv as $m,rD as zm,rE as qm,rF as Vm,rG as Jm,rH as Km,rI as Ym,jp as Qm}from"./j0yo6uv6652vva62.js";import{b as Xm}from"./kgnykbdth8mb50na.js";import{P as Zm,u as ep,h as tp}from"./ktw3b87sujui39wx.js";import{u as sp}from"./nrrhfi0a0bbsg9w2.js";const np=Qe(()=>Ye(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yl),__vite__mapDeps([0,1,2,3,4])),{loading:t=>Tt(t)}),op=Qe(()=>Ye(()=>import("./fv135gy2k0pewip3.js"),__vite__mapDeps([5,1,0,2,3,4,6,7])).then(t=>t.default)),Sa=Gn({bannerBody:{id:"gqtTeH",defaultMessage:"Work smarter and better with coworkers in your organization"},dismissBanner:{id:"hbc/Bs",defaultMessage:"Dismiss banner"}});function ap(t){"use forget";const e=It.c(17),{clientThreadId:n,canShowBanner:o}=t,r=o===void 0?!1:o,d=tt();let l;e[0]!==d?(l=Us(d),e[0]=d,e[1]=l):l=e[1];const i=l;let p;e[2]!==n?(p=Or(n),e[2]=n,e[3]=p):p=e[3];const u=p,f=Bt(n,lp),{eligible:I}=Vs(ps.hasSeenJoinWorkspaceBanner),b=u&&!f,m=Hn(),A=(m==null?void 0:m.email_domain_type)==="professional",S=i&&A&&r&&b&&u&&!f&&I,{data:h,isLoading:P}=Br();let R;e[4]!==(h==null?void 0:h.accountItems)?(R=h==null?void 0:h.accountItems.some(rp),e[4]=h==null?void 0:h.accountItems,e[5]=R):R=e[5];const c=!!R;let V;e[6]!==d?(V=as(d,"3217430380",{disableExposureLog:!0}).get("enable_workspace_discovery",!1),e[6]=d,e[7]=V):V=e[7];const g=!P&&!c&&V&&S;let j;if(e[8]!==d){const F=Gs.getItem(Hs.WorkspaceDiscoveryInfo),xe=ka(d,"2801792036").get("cache_ttl_ms",6048e5);j=Jc(F,xe),e[8]=d,e[9]=j}else j=e[9];const{isFresh:$,hasWorkspacesToJoin:L}=j;let J;e[10]!==d?(J=St(d,"69563813"),e[10]=d,e[11]=J):J=e[11];const x=!$&&J&&g,{data:_,isFetching:M}=Kc(x),Y=_==null?void 0:_.workspaces.some(ip);if(!(!M&&($?!!L:!!Y)&&g)){let F;return e[12]===Symbol.for("react.memo_cache_sentinel")?(F={shouldShow:!1},e[12]=F):F=e[12],F}let D;e[13]!==d?(D=as(d,"1200251816").get("enable-join-workspaces-banner",!1),e[13]=d,e[14]=D):D=e[14];const ee=D;let fe;return e[15]!==ee?(fe={shouldShow:ee},e[15]=ee,e[16]=fe):fe=e[16],fe}function ip(t){return!t.requested}function rp(t){return t.isEnterprisey()}function lp(t){return ht.hasUserMessage(t)}function eh(){"use forget";const t=It.c(22),e=tt(),{markAsViewed:n}=Vs(ps.hasSeenJoinWorkspaceBanner);let o;t[0]!==n?(o=()=>{gt.logEventWithStatsig("Thread Join Workspace Banner Button Dismissed","chatgpt_thread_join_workspace_banner_button_dismissed"),n()},t[0]=n,t[1]=o):o=t[1];const r=o;let d;t[2]===Symbol.for("react.memo_cache_sentinel")?(d=[],t[2]=d):d=t[2],T.useEffect(cp,d);let l;t[3]!==e||t[4]!==n?(l=()=>{gt.logEventWithStatsig("Thread Join Workspace Banner Button Clicked","chatgpt_thread_join_workspace_banner_button_clicked"),n(),is(e,op,{mode:"dismissible",section:"both",source:"join_workspace_banner"})},t[3]=e,t[4]=n,t[5]=l):l=t[5];const i=l;let p;t[6]===Symbol.for("react.memo_cache_sentinel")?(p=ut("group flex w-full items-center justify-center gap-1.5 rounded-full py-2 ps-3 sm:justify-start sm:gap-2","bg-primary shadow-short","hover:bg-token-surface-hover motion-safe:transition-colors motion-safe:duration-150 motion-safe:ease-out","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden","pe-7"),t[6]=p):p=t[6];let u;t[7]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx("span",{className:"hidden text-[#5856D6] sm:inline",children:s.jsx(np,{className:"icon-sm","aria-hidden":"true"})}),t[7]=u):u=t[7];let f,I;t[8]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsxs("span",{className:"flex items-center gap-1.5",children:[u,s.jsx("span",{className:"text-token-text-primary text-[13px] leading-[18px] sm:text-sm sm:leading-5",children:s.jsx(os,_t({},Sa.bannerBody))})]}),I=s.jsx("span",{className:ut("inline-flex items-center gap-1 text-sm font-medium","text-[#5856D6]"),children:s.jsx("span",{children:s.jsx(os,{id:"V/M/bo",defaultMessage:"Find Workspaces"})})}),t[8]=f,t[9]=I):(f=t[8],I=t[9]);let b;t[10]!==i?(b=s.jsxs("button",{type:"button",onClick:i,className:p,children:[f,I]}),t[10]=i,t[11]=b):b=t[11];let m;t[12]!==r?(m=c=>{c.stopPropagation(),r()},t[12]=r,t[13]=m):m=t[13];let A,S;t[14]===Symbol.for("react.memo_cache_sentinel")?(S=ut("mt-0.15 absolute end-1.5 top-1/2 -translate-y-1/2 rounded-full p-1","text-token-text-secondary hover:bg-token-main-surface-tertiary","focus-visible:ring-token-text-tertiary focus-visible:ring-2 focus-visible:ring-offset-1 focus-visible:ring-offset-transparent focus-visible:outline-hidden"),A=s.jsx(Yc,{className:"icon-xs","aria-hidden":"true"}),t[14]=A,t[15]=S):(A=t[14],S=t[15]);let h;t[16]===Symbol.for("react.memo_cache_sentinel")?(h=s.jsx("span",{className:"sr-only",children:s.jsx(os,_t({},Sa.dismissBanner))}),t[16]=h):h=t[16];let P;t[17]!==m?(P=s.jsxs("button",{type:"button",onClick:m,className:S,children:[A,h]}),t[17]=m,t[18]=P):P=t[18];let R;return t[19]!==P||t[20]!==b?(R=s.jsxs("div",{className:"relative",children:[b,P]}),t[19]=P,t[20]=b,t[21]=R):R=t[21],R}function cp(){gt.logEventWithStatsig("Thread Join Workspace Banner Button Shown","chatgpt_thread_join_workspace_banner_button_shown")}const dp=Qe(()=>Ye(()=>import("./ddurw41ljhd63sp4.js").then(t=>t._),__vite__mapDeps([8,1])),{loading:t=>Tt(t)});function Ca({clientThreadId:t,onClick:e}){T.useEffect(()=>{nd(t)},[t]);const n=Pt();return s.jsx(hs.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:s.jsx(Xa,{onClick:()=>{od(t),e()},label:n.formatMessage(Fn.moreStarterPrompts)})})}function up({starterPrompt:t,starterPrompts:e,index:n,disabled:o,onSelectStarterPrompt:r}){var u;const d=(u=t.theme)!=null?u:t.title,l=ed(),{mutate:i}=td(),p=t.category==="onboarding"?f=>{i({key:ps.hasUsedConversationalOnboardingStarterPrompt}),l(f,t,e,n)}:f=>r==null?void 0:r(f,t,e,n);return s.jsx(Xa,{disabled:o,onClick:p,icon:s.jsx(sd,{category:t.category,useV2Colors:!0}),label:d})}const mp=5,pp=3;function li({starterPrompts:t,onSelectStarterPrompt:e,disabled:n,clientThreadId:o,onExpand:r,mobileLayout:d=!1}){const l=d?pp:mp,[i,p]=T.useState(l),[u,f]=T.useState(!1),I=T.useRef(null),b=t.length<=i;T.useEffect(()=>{na(t.slice(0,l),o)},[o]),T.useEffect(()=>{if(!u&&!b&&I.current){const A=I.current,S=A.getBoundingClientRect(),h=S.width,P=Array.from(A.children);let R=0;for(let c=0;c<P.length&&P[c].getBoundingClientRect().right-S.left<=h;c++)R++;p(R),f(!0)}},[t,b,u]);const m=()=>{const A=t.slice(i,t.length).map(S=>Jt(_t({},S),{isAdditional:!0}));A.length>0&&na(A,o),p(t.length),r()};return s.jsxs("div",{"data-testid":"starter-prompt-chips",className:ut("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",u&&t.length>0?"opacity-100":"opacity-[0.01]",d?"flex-wrap":"flex-nowrap"),children:[s.jsxs("ul",{className:ut("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",b||d?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:I,children:[t.slice(0,i).map((A,S)=>{var h;return s.jsx(hs.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:s.jsx(up,{starterPrompt:A,starterPrompts:t,index:S,disabled:n,onSelectStarterPrompt:e})},(h=A.id)!=null?h:S)}),d&&t.length>i&&s.jsx(Ca,{clientThreadId:o,onClick:m})]}),!d&&t.length>i&&s.jsx(Ca,{clientThreadId:o,onClick:m})]})}const th=t=>{"use forget";const e=It.c(17),{clientThreadId:n,currentModelId:o}=t,[r,d]=T.useState(!1),l=Ks();let i;e[0]!==n||e[1]!==o?(i={shouldBeEnabledForDefaultAssistant:!0,clientThreadId:n,limit:8,modelSlug:o},e[0]=n,e[1]=o,e[2]=i):i=e[2];const{promptStarters:p,shouldShowStarterPrompts:u,onSelectStarterPrompt:f}=Qa(i);let I,b,m;e[3]===Symbol.for("react.memo_cache_sentinel")?(I={opacity:0},b={opacity:1},m={duration:.3},e[3]=I,e[4]=b,e[5]=m):(I=e[3],b=e[4],m=e[5]);const A=u&&!r&&"h-[116px]";let S;e[6]!==A?(S=ut(A),e[6]=A,e[7]=S):S=e[7];let h;e[8]!==n||e[9]!==l||e[10]!==f||e[11]!==p||e[12]!==u?(h=u&&p&&s.jsx(li,{starterPrompts:p,onSelectStarterPrompt:f,disabled:l,clientThreadId:n,onExpand:()=>d(!0),mobileLayout:!0}),e[8]=n,e[9]=l,e[10]=f,e[11]=p,e[12]=u,e[13]=h):h=e[13];let P;return e[14]!==S||e[15]!==h?(P=s.jsx(hs.div,{initial:I,animate:b,transition:m,className:S,children:h}),e[14]=S,e[15]=h,e[16]=P):P=e[16],P},sh=t=>{"use forget";const e=It.c(20),{currentModelId:n,clientThreadId:o}=t,{isUnauthenticated:r}=Ia(),d=Zc(),[l,i]=T.useState(!1),p=Ks();let u;e[0]!==o||e[1]!==n?(u={shouldBeEnabledForDefaultAssistant:!0,clientThreadId:o,limit:8,modelSlug:n},e[0]=o,e[1]=n,e[2]=u):u=e[2];const{promptStarters:f,shouldShowStarterPrompts:I,onSelectStarterPrompt:b}=Qa(u);let m;e[3]!==o?(m={clientThreadId:o,canShowBanner:!0},e[3]=o,e[4]=m):m=e[4];const{shouldShow:A}=ap(m),S=I&&f;if(A&&!S)return null;let h,P,R;e[5]===Symbol.for("react.memo_cache_sentinel")?(h={opacity:0},P={opacity:1},R={duration:.3},e[5]=h,e[6]=P,e[7]=R):(h=e[5],P=e[6],R=e[7]);const c=!d&&"min-h-[108px]",V=r&&l||d?"":"h-[70px]";let B;e[8]!==c||e[9]!==V?(B=ut("max-w-full max-sm:hidden",c,V),e[8]=c,e[9]=V,e[10]=B):B=e[10];let g;e[11]!==o||e[12]!==p||e[13]!==b||e[14]!==f||e[15]!==S?(g=S&&s.jsx(li,{starterPrompts:f,onSelectStarterPrompt:b,disabled:p,clientThreadId:o,onExpand:()=>i(!0)}),e[11]=o,e[12]=p,e[13]=b,e[14]=f,e[15]=S,e[16]=g):g=e[16];let j;return e[17]!==B||e[18]!==g?(j=s.jsx(hs.div,{initial:h,animate:P,transition:R,className:B,children:g}),e[17]=B,e[18]=g,e[19]=j):j=e[19],j};function fp({className:t,layout:e="grid",hideShuffleButton:n}){const o=Pt(),r=Ks(),d=Qc(),l=Wn(),i=Ee(Ya(l).shouldShowAutocomplete$),[p,u]=T.useState(sa(d,[],4,e==="carousel"?1:2)),f=()=>{u(sa(d,p,4,2))};return!d||d.length===0?null:s.jsxs("div",{className:ut("flex w-full flex-col gap-y-4 transition-opacity",t,i?"pointer-events-none opacity-0":"opacity-100"),children:[s.jsxs("div",{className:"flex items-center justify-between px-1",children:[s.jsx("div",{className:"text-token-text-secondary text-base leading-7 sm:text-sm",children:o.formatMessage(Fn.trySomethingNew)}),!n&&s.jsx(Dr,{type:"button",onClick:f,label:o.formatMessage(Fn.shuffleTiles),color:"ghost",size:"medium",icon:dp})]}),s.jsx("div",{"data-testid":"starter-prompt-tiles",className:ut(e==="grid"?"grid grid-cols-2 gap-4 sm:flex sm:flex-row":"-mx-(--thread-content-margin) flex flex-row gap-3 overflow-x-auto px-(--thread-content-margin) pb-4 sm:gap-4"),children:Array.from({length:4}).map((I,b)=>{const m=p[b];return m?s.jsx("div",{className:ut("max-sm:short:h-[116px] relative h-[132px] sm:h-[144px]",e==="carousel"?"flex-1 max-sm:w-[164px] max-sm:flex-none":"w-full flex-1 sm:basis-0"),children:s.jsx(Lr,{initial:!1,children:s.jsx(hs.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25,ease:"easeOut"},className:"absolute inset-0 h-full w-full",children:s.jsx(Xc,{starterPrompt:m,allPrompts:d,index:b,disabled:r,className:"h-full w-full"})},m.id)})},b):s.jsx("div",{},b)})})]})}const Fn=Gn({moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"},trySomethingNew:{id:"StarterPromptTiles.trySomethingNew",defaultMessage:"Try something new"},shuffleTiles:{id:"StarterPromptTiles.shuffle",defaultMessage:"Shuffle"}}),hp=Qe(()=>Ye(()=>import("./gsas8pb1acnf7jnd.js").then(t=>t._),__vite__mapDeps([9,1])),{loading:t=>Tt(t)}),gp=Qe(()=>Ye(()=>import("./pbw8dlpn7avzkj1f.js"),__vite__mapDeps([10,1,0,2,3,4,11])).then(t=>t.JawboneNotificationsBanner)),_p=T.memo(function({className:e}){const n=tt(),o=Ee(()=>Dt(n)),{store:r}=vt(),d=r.useIsHeaderContentAreaPopulated(),l=r.useContentAreaId(Js.HeaderTop);let i=l===_e.AgentModeAnnouncementBanner?"z-0":ad.PromptTextareaHeader;const p=as(n,"2206338824");return l===_e.BannersRateLimit&&p.get("web_design_style","control")==="composer_banner"&&(i="-z-1"),s.jsx("div",{className:ut(e!=null?e:"absolute start-0 end-0 bottom-full",i,o&&"start-2 end-2"),children:s.jsx(id,{shouldRender:d,contentArea:Js.Header,children:s.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[s.jsx(bp,{}),s.jsx(xp,{})]})})})});function bp(){const t=tt(),{store:e}=vt(),n=e.useSharedProps(u=>u==null?void 0:u.clientThreadId),o=e.useContentAreaId(Js.HeaderTop),r=rd(t),d=Ee(()=>n&&Gr(Pa(t,n)).id),l=Ys(Dt);let i;switch(o){case _e.ProjectConversationTaskNoFileAccess:i=s.jsx(Tp,{});break;case _e.AdvancedVoiceOnMobileAnnouncement:i=s.jsx(wd,{clientThreadId:n});break;case _e.BannerSignup:i=s.jsx(Cp,{});break;case _e.BannerTermsDisclaimer:i=s.jsx(Ap,{});break;case _e.NewUserBannerTermsDisclaimer:i=s.jsx(kp,{});break;case _e.PromptTextareaAction:i=s.jsx(Ip,{});break;case _e.BannersRateLimit:i=s.jsx(Pp,{});break;case _e.BannersBeaconUI:i=s.jsx(Ep,{});break;case _e.BannerSidekickAnnouncement:i=s.jsx(jd,{});break;case _e.SearchBrowserExtensionAnnouncement:i=s.jsx(Ed,{});break;case _e.MoonshineAnnouncement:i=s.jsx(Pd,{});break;case _e.GoldenHourAnnouncementBanner:i=!1;break;case _e.SearchBrowserExtensionReactiveAnnouncement:i=s.jsx(Id,{});break;case _e.BannerMemoryAlmostFull:i=s.jsx(ia,{memoryAlmostFullVariant:!0});break;case _e.BannerMemoryFull:i=s.jsx(ia,{});break;case _e.Box:i=s.jsxs("div",{id:"Box",className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",s.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",s.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;case _e.JawboneAnnouncement:r?i=s.jsx(gp,{}):i=null;break;case _e.JawboneMaxActiveAnnouncement:r?i=s.jsx(kd,{}):i=null;break;case _e.PromoRedemptionAnnouncement:i=s.jsx(Ad,{});break;case _e.OperatorAnnouncement:i=s.jsx(Td,{});break;case _e.BannerPlusUpsell:i=s.jsx(Cd,{});break;case _e.PlusFreeTrialHomepageAnnouncementBanner:i=s.jsx(Sd,{});break;case _e.BannerNoAuthTrials:i=s.jsx(yd,{});break;case _e.ReferrerRedemptionAvailableAnnouncement:i=s.jsx(xd,{});break;case _e.RefereeRedemptionAvailableAnnouncement:i=s.jsx(bd,{});break;case _e.ReferralProgramUpsellAnnouncement:i=s.jsx(_d,{});break;case _e.TatertotIntakeFormAnnouncement:i=!1;break;case _e.StudentsUpsellAnnouncement:i=s.jsx(gd,{});break;case _e.ModelDeprecationBanner:i=hd(d);break;case _e.TeamSeatsPromoAnnouncement:i=s.jsx(fd,{});break;case _e.TeamsContextualAnswersUpsell:i=s.jsx(pd,{});break;case _e.AgentModeAnnouncementBanner:i=Fr(t)&&!l&&s.jsx(ld,{});break;case _e.LanguageUpsellBanner:i=s.jsx(md,{onDismissSideEffect:()=>{gt.logEventWithStatsig("Language Upsell Banner Dismissed","chatgpt_web_language_upsell_banner_dismissed"),aa.set(t,!0)},onPrimaryCtaClickSideEffect:()=>{gt.logEventWithStatsig("Language Upsell Banner Primary CTA Clicked","chatgpt_web_language_upsell_banner_primary_cta_clicked"),aa.set(t,!0)}});break;case _e.StarterPrompts:i=s.jsx(fp,{hideShuffleButton:!0,layout:"carousel"});break;case _e.ImageGenBanner:i=s.jsx(ud,{className:"mb-3"});break;case _e.SystemHintSuggestion:i=s.jsx(dd,{});break;default:i=null;break}const p=!!i;return T.useEffect(()=>{oa.set(t,p)},[t,p]),T.useEffect(()=>()=>{oa.set(t,!1)},[t]),i}function xp(){const{store:t}=vt(),e=t.useContentAreaId(Js.HeaderBottom);let n;switch(e){case cd.DallePromptControls:n=s.jsx(Sp,{});break;default:n=null;break}return n}const yp=Qe(()=>Ye(()=>import("./fqr9t6mx0mgbb8wb.js"),__vite__mapDeps([12,1,2,3,0,4])).then(t=>t.default));function Sp(){const{store:t}=vt(),e=t.useSharedProps(n=>n==null?void 0:n.composerController);return e?s.jsx(yp,{composerController:e}):null}function Cp(){const t=tt(),{store:e}=vt(),n=e.useSharedProps(d=>d==null?void 0:d.clientThreadId),o=Bd(t),r=Dd(t);return n?o?s.jsx(Ld,{threadId:n,showSignUp:r}):s.jsx(Fd,{threadId:n,showLogin:r}):null}function Tp(){return T.useEffect(()=>()=>{Gs.getItem(Hs.TasksHasSeenProjectDisclaimerBanner)||Gs.setItem(Hs.TasksHasSeenProjectDisclaimerBanner,!0)},[]),s.jsx(Gd,{icon:s.jsx(hp,{}),title:s.jsx(os,{id:"ibX3g7",defaultMessage:"Tasks can’t access project files"}),content:s.jsx(os,{id:"fm94Tm",defaultMessage:"There’s a task in this conversation — just FYI, it won’t be able to access project files."}),onDismiss:()=>{Gs.setItem(Hs.TasksHasSeenProjectDisclaimerBanner,!0)}})}function Ap(){const{store:t}=vt(),e=t.useSharedProps(n=>n==null?void 0:n.clientThreadId);return e?s.jsx(Od,{threadId:e}):null}function kp(){const{store:t}=vt(),e=t.useSharedProps(n=>n==null?void 0:n.clientThreadId);return e?s.jsx(Nd,{threadId:e}):null}function Ip(){const{store:t}=vt(),e=t.useSharedProps();return e?s.jsx(vd,_t({},e)):null}function Pp(){const{store:t}=vt(),e=t.useSharedProps(o=>o==null?void 0:o.clientThreadId),n=t.useSharedProps(o=>o==null?void 0:o.composerController);return!e||!n?null:s.jsx(Rd,{clientThreadId:e,composerController:n})}function Ep(){const{store:t}=vt(),e=t.useSharedProps(r=>r==null?void 0:r.openFileDialog),n=t.useSharedProps(r=>r==null?void 0:r.clientThreadId),o=t.useSharedProps(r=>r==null?void 0:r.composerController);return!n||!o||!e?null:s.jsx(Md,{clientThreadId:n,openFileDialog:e})}const jp=Qe(()=>Ye(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yr),__vite__mapDeps([0,1,2,3,4])),{loading:t=>Tt(t)}),wp=Qe(()=>Ye(()=>import("./ktrkoq6ffn0gq1va.js").then(t=>t._),__vite__mapDeps([13,1])),{loading:t=>Tt(t)}),Mp=Qe(()=>Ye(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yx),__vite__mapDeps([0,1,2,3,4])),{loading:t=>Tt(t)}),ci="manage-prompts",Rp=Qe(()=>Ye(()=>import("./j0yo6uv6652vva62.js").then(t=>t.z9),__vite__mapDeps([0,1,2,3,4])).then(t=>t.AgentNuxModal));function vp({hint:t,isHighlighted:e,onHighlight:n,onClick:o}){"use no forget";const r=si(t.systemHint),d=s.jsx(il,{as:"div",hasManagedFocus:!0,disabled:r.isBlocked,highlighted:e,icon:s.jsx(ei,{hint:t,isNextToLabel:!0}),secondary:r.blockedLabel,onPointerMove:n,onClick:o,children:s.jsx("span",{className:"break-all",children:t.name})});return r.remainingLabel?s.jsx(qn,{side:"right",labelTextAlign:r.isBlocked?"left":"center",label:r.remainingLabel,secondaryLabel:r.remainingLabelSecondary,contentClassName:"cant-hover:hidden",triggerAs:null,children:d}):d}const Np=al(t=>{var e,n,o,r;return ms(t)?{targets:[t.command,...(e=t.aliases)!=null?e:[],...(n=t.regexMatches)!=null?n:[],t.secondary?"".concat(t.title," ").concat(t.secondary):t.title],weight:t.matchWeight}:{targets:[t.systemHint,...(o=t.aliases)!=null?o:[],...(r=t.regexMatches)!=null?r:[],t.name]}});function Op(t){"use forget";const e=It.c(129),{gptsAndAppsSlashCommands$:n,modelSlashCommands$:o,libraryPromptSlashCommands:r,slashCommands:d,systemHints:l,composerController:i,clientThreadId:p,layoutMode:u}=t,f=tt(),I=Wd(),b=Aa(),m=Pt(),A=u==="center"?"bottom-start":"top-start";let S;e[0]===Symbol.for("react.memo_cache_sentinel")?(S=[tl({mainAxis:10,alignmentAxis:-18}),sl({padding:6}),nl({apply:Hp})],e[0]=S):S=e[0];let h;e[1]!==A?(h={placement:A,middleware:S,whileElementsMounted:rl},e[1]=A,e[2]=h):h=e[2];const{refs:P,floatingStyles:R}=ol(h),[c,V]=T.useState(void 0);let B;e[3]!==i||e[4]!==P.setReference?(B=()=>{const w=Je(i);w.dispatch(ll(w.state.tr,{setReferencePosition:P.setReference,onHintMatch(q){V(X=>va(X,q)?X:q)}}))},e[3]=i,e[4]=P.setReference,e[5]=B):B=e[5];let g;e[6]!==i||e[7]!==P?(g=[i,P],e[6]=i,e[7]=P,e[8]=g):g=e[8],T.useEffect(B,g);const j=Ud(),$=Ra(p),{setThreadSystemHintMode:L,clearAllSystemHintModeTriggers:J}=$d(),U=Ys(Dt);let x;e[9]!==n||e[10]!==c?(x=()=>c&&(n==null?void 0:n()),e[9]=n,e[10]=c,e[11]=x):x=e[11];const _=Ee(x);let M;e[12]!==o?(M=()=>{var w;return(w=o==null?void 0:o())!=null?w:[]},e[12]=o,e[13]=M):M=e[13];const Y=Ee(M),ge=(c==null?void 0:c.triggerSymbol)==="@",pe=(c==null?void 0:c.triggerSymbol)==="/";let D;e[14]!==f?(D=ja(f),e[14]=f,e[15]=D):D=e[15];const ee=D;let fe;e[16]!==f?(fe=()=>{},e[16]=f,e[17]=fe):fe=e[17];const F=fe;let xe;e:{let w;e[18]!==_||e[19]!==ge?(w=ge?_:_==null?void 0:_.filter(Gp),e[18]=_,e[19]=ge,e[20]=w):w=e[20];const q=w;let X;if(e[21]!==m||e[22]!==pe||e[23]!==r||e[24]!==b||e[25]!==F||e[26]!==ee){if(X=[],pe&&ee)if(r&&r.length>0){let ce;e[28]!==r?(ce=[...r],e[28]=r,e[29]=ce):ce=e[29],X.push(ce);let me;e[30]!==m?(me=m.formatMessage({id:"composer.library.managePrompts",defaultMessage:"Manage prompts"}),e[30]=m,e[31]=me):me=e[31];let he;e[32]!==b?(he=()=>b("/library?tab=prompts&referer=at_cmd"),e[32]=b,e[33]=he):he=e[33];let Ge;e[34]!==me||e[35]!==he?(Ge=[{command:ci,title:me,icon:void 0,onSelect:he}],e[34]=me,e[35]=he,e[36]=Ge):Ge=e[36],X.push(Ge)}else{let ce;e[37]!==m?(ce=m.formatMessage({id:"composer.library.createPrompt",defaultMessage:"Create new prompt"}),e[37]=m,e[38]=ce):ce=e[38];let me;e[39]!==m?(me=m.formatMessage({id:"composer.library.createPromptDescription",defaultMessage:"Prompts are saved sequences of text that you can quickly add to your messages."}),e[39]=m,e[40]=me):me=e[40];let he;e[41]!==F||e[42]!==ce||e[43]!==me?(he=[{command:"create-prompt",title:ce,secondary:me,icon:void 0,onSelect:F}],e[41]=F,e[42]=ce,e[43]=me,e[44]=he):he=e[44],X.push(he)}e[21]=m,e[22]=pe,e[23]=r,e[24]=b,e[25]=F,e[26]=ee,e[27]=X}else X=e[27];let C;e[45]!==q?(C=q!=null?q:[],e[45]=q,e[46]=C):C=e[46];let K;e[47]!==C?(K=[C],e[47]=C,e[48]=K):K=e[48];const de=K;let Oe;e[49]!==de||e[50]!==u||e[51]!==X?(Oe=u==="bottom"?[...de,...X]:[...X,...de],e[49]=de,e[50]=u,e[51]=X,e[52]=Oe):Oe=e[52];const Be=Oe;if(!ge){let ce;if(e[53]!==d||e[54]!==Be||e[55]!==Y||e[56]!==l){let me;e[58]!==d||e[59]!==Y||e[60]!==l?(me=[d,l,Y],e[58]=d,e[59]=Y,e[60]=l,e[61]=me):me=e[61],ce=Be.concat(me),e[53]=d,e[54]=Be,e[55]=Y,e[56]=l,e[57]=ce}else ce=e[57];xe=ce;break e}if(U){let ce;e[62]===Symbol.for("react.memo_cache_sentinel")?(ce=[],e[62]=ce):ce=e[62],xe=ce;break e}xe=Be}const te=xe;let v;e:{if(!c){let C;e[63]===Symbol.for("react.memo_cache_sentinel")?(C=[],e[63]=C):C=e[63];let K;e[64]===Symbol.for("react.memo_cache_sentinel")?(K=[],e[64]=K):K=e[64];let de;e[65]===Symbol.for("react.memo_cache_sentinel")?(de={displayGroups:C,suggestions:K},e[65]=de):de=e[65],v=de;break e}let w,q;if(e[66]!==te||e[67]!==c.text||e[68]!==m||e[69]!==u){const C=c.text?[zd(la(te),c.text,Np,{locale:m.locale})]:te.map(Lp),K=u==="bottom"?C.reverse().map(Dp):C;w=K,q=la(K),e[66]=te,e[67]=c.text,e[68]=m,e[69]=u,e[70]=w,e[71]=q}else w=e[70],q=e[71];let X;e[72]!==w||e[73]!==q?(X={displayGroups:w,suggestions:q},e[72]=w,e[73]=q,e[74]=X):X=e[74],v=X}const{displayGroups:ae,suggestions:Se}=v,[ye,Xe]=T.useState(u==="bottom"?-1:0),we=ye==null?null:(ye+Se.length)%Se.length;let Le;e[75]!==j||e[76]!==Se?(Le=w=>{Xe(q=>{if(q==null)return null;const X=Se.length;for(let C=0;C<X;C++){const K=(q+X+(C+1)*w)%X,de=Se[K];if(!("systemHint"in de?j.includes(de.systemHint):de.disabled))return K}return null})},e[75]=j,e[76]=Se,e[77]=Le):Le=e[77];const ke=Ws(Le),re=Se.length,z=re===0;let st;e[78]!==u||e[79]!==ke?(st=()=>{u==="bottom"?(Xe(0),ke.current(-1)):(Xe(-1),ke.current(1))},e[78]=u,e[79]=ke,e[80]=st):st=e[80];let We;e[81]!==u||e[82]!==re||e[83]!==ke?(We=[re,u,ke],e[81]=u,e[82]=re,e[83]=ke,e[84]=We):We=e[84],T.useEffect(st,We);const Q=we==null?null:Se[we];let Re;e[85]!==i||e[86]!==c?(Re=()=>{if(c!=null&&c.range){const w=Je(i);cl(w,c.range.from,c.range.to)}},e[85]=i,e[86]=c,e[87]=Re):Re=e[87];const W=Re;let je;e[88]!==I||e[89]!==J||e[90]!==W||e[91]!==p||e[92]!==i||e[93]!==f||e[94]!==c||e[95]!==Q||e[96]!==$||e[97]!==L?(je=w=>{var me;const{hintToSave:q,expectPerfectMatch:X}=w,C=q===void 0?Q:q;if(!c||!C)return!1;const K=c.text.toLocaleLowerCase(),Oe=(ms(C)?C.command:C.name).toLocaleLowerCase()===K||((me=C.aliases)==null?void 0:me.some(he=>he.toLocaleLowerCase()===K));if(X&&!Oe)return!1;if(W(),vs(Je(i)),ms(C))return C.onSelect(),!0;gt.logEvent("System Hint Selected",{system_hint:C.systemHint,conversation_id:$!=null?$:An});const Be={clientThreadId:p};J();const ce=C.systemHint===Z.Search;return L(C.systemHint,!0,Be,ce?dl.CONVERSATION_COMPOSER_SLASH_SEARCH:ul.SLASH_COMMAND),C.systemHint===Z.Agent&&I==="show"&&is(f,Rp,{clientThreadId:p!=null?p:An,source:"slash_agent"}),!0},e[88]=I,e[89]=J,e[90]=W,e[91]=p,e[92]=i,e[93]=f,e[94]=c,e[95]=Q,e[96]=$,e[97]=L,e[98]=je):je=e[98];const Fe=je,ve=Ws(Fe);let Ne;e[99]!==i||e[100]!==ke||e[101]!==ve||e[102]!==z?(Ne=()=>{const w=Je(i);return z||ml(w,q=>{if(q==="up")ke.current(-1);else if(q==="down")ke.current(1);else if(q==="cancel")vs(w),pl(w);else{if(q==="submit")return vs(w),ve.current({expectPerfectMatch:!1});if(q==="checkMatch")return ve.current({expectPerfectMatch:!0})}}),()=>vs(w)},e[99]=i,e[100]=ke,e[101]=ve,e[102]=z,e[103]=Ne):Ne=e[103];let G;e[104]!==W||e[105]!==i||e[106]!==ke||e[107]!==ve||e[108]!==Q||e[109]!==z?(G=[i,z,Q,W,ke,ve],e[104]=W,e[105]=i,e[106]=ke,e[107]=ve,e[108]=Q,e[109]=z,e[110]=G):G=e[110],T.useEffect(Ne,G);const le=Ws($);let se,H;if(e[111]!==z||e[112]!==le?(se=()=>{var w;z||gt.logEvent("System Hint List Opened",{conversation_id:(w=le.current)!=null?w:An})},H=[le,z],e[111]=z,e[112]=le,e[113]=se,e[114]=H):(se=e[113],H=e[114]),T.useEffect(se,H),z)return null;let ne;e[115]!==P?(ne=w=>P.setFloating(w),e[115]=P,e[116]=ne):ne=e[116];const ue=Se.length>6?"max-h-[min(var(--radix-popper-available-height,50svh),--spacing(1.5)+5*var(--menu-item-height))]":"max-h-[var(--radix-popper-available-height,50svh)]";let y;e[117]!==ue?(y=ut("max-w-[min(var(--radix-popper-available-width,100vw),--spacing(100))] overflow-y-auto [scrollbar-width:none]",ue),e[117]=ue,e[118]=y):y=e[118];let k;e[119]!==i||e[120]!==ae||e[121]!==Fe||e[122]!==we?(k=ae.map((w,q)=>{let X=0;for(let C=0;C<q;C++)X=X+ae[C].length;return s.jsx(it.Group,{children:w.map((C,K)=>{const de=X+K;return ms(C)?s.jsx(qd,{command:C,isHighlighted:de===we,onHighlight:()=>Xe(de),onClick:()=>{Fe({hintToSave:C,expectPerfectMatch:!1}),Wt(Je(i))}},C.command):s.jsx(vp,{hint:C,isHighlighted:de===we,onHighlight:()=>Xe(de),onClick:()=>{Fe({hintToSave:C,expectPerfectMatch:!1}),Wt(Je(i))}},C.systemHint)})},q)}),e[119]=i,e[120]=ae,e[121]=Fe,e[122]=we,e[123]=k):k=e[123];let oe;return e[124]!==R||e[125]!==ne||e[126]!==y||e[127]!==k?(oe=s.jsx(fl,{ref:ne,style:R,className:y,onPointerDown:Bp,children:k}),e[124]=R,e[125]=ne,e[126]=y,e[127]=k,e[128]=oe):oe=e[128],oe}function Bp(t){t.preventDefault()}function Dp(t){return t.reverse()}function Lp(t){return t.filter(Fp)}function Fp(t){return!ms(t)||!t.noMatchEmpty}function Gp(t){return t.type!==Dn.App}function Hp(t){const{elements:e,availableWidth:n,availableHeight:o}=t;e.floating.style.setProperty("--radix-popper-available-width","".concat(n,"px")),e.floating.style.setProperty("--radix-popper-available-height","".concat(o,"px"))}function Wp(t){"use forget";var ve,Ne;const e=It.c(104),{systemHints:n,availableSystemHints:o,composerController:r,clientThreadId:d,layoutMode:l,composerLayer:i,canUseInlineTagging:p,isFileUploadEnabled:u,fileUploadDisabledReason:f,currentModelConfig:I,openFileDialog:b,connectionInstanceData:m,setActiveSystemHintType:A,selectModelId:S,gizmoId:h,hasGizmoFeatureRateLimit:P,setSelectedGizmoTag:R}=t,c=tt();let V;e[0]!==d||e[1]!==c?(V=Pa(c,d),e[0]=d,e[1]=c,e[2]=V):V=e[2];const B=V,g=Pt(),j=Aa(),{connectedTypes:$}=Hr(),L=Hn();let J;e[3]!==L?(J=L!=null&&Wr(L),e[3]=L,e[4]=J):J=e[4];const U=J;let x;e[5]!==c?(x=()=>Qs(c),e[5]=c,e[6]=x):x=e[6];const _=Ee(x),{isSingleLine:M,showModelSlashCommands:Y}=i,ge=Ea();let pe;e[7]===Symbol.for("react.memo_cache_sentinel")?(pe={onError:Zp},e[7]=pe):pe=e[7];const{mutate:D}=Ur(pe);m==null||m.connection_statuses;let ee;if(e[8]!==d||e[9]!==$||e[10]!==(m==null?void 0:m.connection_statuses)||e[11]!==c||e[12]!==(I==null?void 0:I.title)||e[13]!==f||e[14]!==g||e[15]!==_||e[16]!==u||e[17]!==U||e[18]!==M||e[19]!==j||e[20]!==b||e[21]!==A||e[22]!==n){if(ee=[],M){let H;e[24]===Symbol.for("react.memo_cache_sentinel")?(H=["file","attach","photo"],e[24]=H):H=e[24];const ne=!u,ue=I==null?void 0:I.title;let y;e[25]!==c||e[26]!==f||e[27]!==g||e[28]!==ne||e[29]!==ue?(y=Za(c,g,ne,f,ue),e[25]=c,e[26]=f,e[27]=g,e[28]=ne,e[29]=ue,e[30]=y):y=e[30];let k;e[31]===Symbol.for("react.memo_cache_sentinel")?(k=s.jsx(jp,{"aria-label":"",className:"icon"}),e[31]=k):k=e[31];const oe=!u;let w;e[32]!==b||e[33]!==oe||e[34]!==y?(w={command:"upload",aliases:H,title:y,icon:k,onSelect:b,disabled:oe},e[32]=b,e[33]=oe,e[34]=y,e[35]=w):w=e[35],ee.push(w)}let G;e[36]!==(m==null?void 0:m.connection_statuses)?(G=(ve=m==null?void 0:m.connection_statuses.filter(Xp).map(Qp))!=null?ve:[],e[36]=m==null?void 0:m.connection_statuses,e[37]=G):G=e[37];const le=G,se=n==null?void 0:n.some(Yp);if(U&&($.size>0||le.length>0)&&se){let H;e[38]!==g?(H=g.formatMessage({id:"6YT2cp",defaultMessage:"Use all connectors"}),e[38]=g,e[39]=H):H=e[39];let ne;e[40]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsx(Mp,{}),e[40]=ne):ne=e[40];let ue;e[41]!==d||e[42]!==le||e[43]!==$||e[44]!==A?(ue=()=>{A(Z.Slurm,{analyticsMetadata:{clientThreadId:d}}),Kt(d,k=>{var w,q;const oe=(q=(w=k.selectedSources)==null?void 0:w.get(Z.Slurm))!=null?q:new Set;k.selectedSources==null&&(k.selectedSources=new Map),k.selectedSources.set(Z.Slurm,new Set([...oe,...$,...le]))})},e[41]=d,e[42]=le,e[43]=$,e[44]=A,e[45]=ue):ue=e[45];let y;e[46]!==H||e[47]!==ue?(y={command:"all-connectors",title:H,icon:ne,noMatchEmpty:!0,onSelect:ue},e[46]=H,e[47]=ue,e[48]=y):y=e[48],ee.push(y)}if(_){let H;e[49]===Symbol.for("react.memo_cache_sentinel")?(H=["mcp"],e[49]=H):H=e[49];let ne;e[50]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsx(wp,{}),e[50]=ne):ne=e[50];let ue;e[51]!==j?(ue={command:"add-mcp",aliases:H,title:"Add MCP",icon:ne,noMatchEmpty:!0,onSelect:()=>{j(Xr(wa.Connectors))}},e[51]=j,e[52]=ue):ue=e[52],ee.push(ue)}e[8]=d,e[9]=$,e[10]=m==null?void 0:m.connection_statuses,e[11]=c,e[12]=I==null?void 0:I.title,e[13]=f,e[14]=g,e[15]=_,e[16]=u,e[17]=U,e[18]=M,e[19]=j,e[20]=b,e[21]=A,e[22]=n,e[23]=ee}else ee=e[23];const fe=ee;let F;e[53]!==B||e[54]!==S||e[55]!==Y?(F=$s(()=>{if(!Y)return[];const G=Un(B),le=[];for(const se of G.categories)se.defaultModel!==G.defaultModelSlug&&le.push({command:se.defaultModel,title:se.label,disabled:!1,icon:s.jsx(ra,{className:"icon"}),onSelect:()=>{S(se.defaultModel,"slash menu")}});for(const se of G.groups)for(const H of se.modelIds){const ne=G.models.get(H);if(ne&&!ne.tags.includes($r.HIDDEN)){let ue=ne.title;le.push({command:ne.id,title:ue,secondary:void 0,trailing:s.jsx(zr,{children:se.label}),noMatchEmpty:!0,matchWeight:.1,disabled:!1,icon:s.jsx(ra,{className:"icon"}),onSelect:()=>{S(ne.id,"slash menu")}})}}return le}),e[53]=B,e[54]=S,e[55]=Y,e[56]=F):F=e[56];const xe=F;let te;e[57]!==o?(te=o!=null?o:[],e[57]=o,e[58]=te):te=e[58];let v;e[59]!==te?(v=te.filter(Kp),e[59]=te,e[60]=v):v=e[60];const ae=v;let Se;e[61]!==o?(Se=o!=null?o:[],e[61]=o,e[62]=Se):Se=e[62];let ye;e[63]!==Se?(ye=Se.filter(Jp),e[63]=Se,e[64]=ye):ye=e[64];const Xe=ye;let we;e[65]!==ge||e[66]!==Xe||e[67]!==p||e[68]!==d||e[69]!==c||e[70]!==h||e[71]!==P||e[72]!==R?(we=$s(()=>{var k,oe,w,q,X;if(!p)return[];const{data:G}=qr(c),{data:le}=Vr(c),{data:se}=Hd(c),H=$n([...(k=G==null?void 0:G.items)!=null?k:[],...(w=(oe=le==null?void 0:le.list.items)==null?void 0:oe.map(Vp))!=null?w:[],...St(c,"773249106")?(X=(q=se==null?void 0:se.items)==null?void 0:q.map(qp))!=null?X:[]:[]],zp),ne=h?H.filter(C=>C.gizmo.id!==h):H,ue=Xe.map(C=>{var K,de;return{command:(K=C.actionLabel)!=null?K:C.name,title:(de=C.actionLabel)!=null?de:C.name,type:Dn.App,icon:s.jsx(ei,{hint:C,isNextToLabel:!0}),onSelect:()=>{ge(C.systemHint),Jr(C.systemHint,Yr.AtMention,Kr({clientThreadId:d}))}}}),y=ne.map(C=>{var K;return{command:C.gizmo.display.name,title:C.gizmo.display.name,type:Dn.Gizmo,disabled:P,icon:s.jsx(ti,{simple:!0,isFirstParty:((K=C.gizmo.tags)==null?void 0:K.includes(zn.FirstParty))===!0,src:C.gizmo.display.profile_picture_url,className:"icon",alt:""}),onSelect:()=>{gt.logEventWithStatsig("Composer GPT Selected","chatgpt_web_composer_gpt_selected",{gizmo:C.gizmo.id}),R(C)}}}).filter(C=>!ue.some(K=>K.command===C.command));return[...ue,...y]}),e[65]=ge,e[66]=Xe,e[67]=p,e[68]=d,e[69]=c,e[70]=h,e[71]=P,e[72]=R,e[73]=we):we=e[73];const Le=we;let at;e[74]!==c?(at=ja(c),e[74]=c,e[75]=at):at=e[75];const ke=at;let re;e[76]!==ke?(re={enabled:ke},e[76]=ke,e[77]=re):re=e[77];const{data:z,isLoading:st}=Qr(re);let We;e[78]!==d||e[79]!==r||e[80]!==B||e[81]!==D||e[82]!==j||e[83]!==A?(We=G=>{var se,H,ne;const le=Je(r);if(Zr(le,"@"),G===ci){j("/library?tab=prompts");return}if(G.id&&!G.created_by_openai&&D(String(G.id)),Ma.set(B,!0),gt.logEventWithStatsig("chatgpt_web_prompt_used","chatgpt_web_prompt_used",{referer:"at_cmd",hint:(se=G.system_hint)!=null?se:"none",sources:((H=G.sources)!=null?H:[]).join(",")}),el(le,G.prompt),G.system_hint&&(A(G.system_hint),(ne=G.sources)!=null&&ne.length)){const ue=G.sources.map($p).filter(Rn),y=G.system_hint,k=new Set(ue.filter(Up)),oe=new Set(ue.filter(Ut));Kt(d,w=>{w.selectedSources=new Map([[y,k]]),w.selectedMCPSources=new Map([[y,oe]]),w.hasModifiedSources=!0})}},e[78]=d,e[79]=r,e[80]=B,e[81]=D,e[82]=j,e[83]=A,e[84]=We):We=e[84];const Q=We;let Re;e:{if(st||z==null||!ke){let se;e[85]===Symbol.for("react.memo_cache_sentinel")?(se=[],e[85]=se):se=e[85],Re=se;break e}let G;e[86]!==z.pages[0].prompts?(G=(Ne=z.pages[0].prompts)!=null?Ne:[],e[86]=z.pages[0].prompts,e[87]=G):G=e[87];let le;if(e[88]!==Q||e[89]!==G){let se;e[91]!==Q?(se=H=>({command:H.name,title:H.name,icon:void 0,onSelect:()=>{Q(H)}}),e[91]=Q,e[92]=se):se=e[92],le=G.map(se),e[88]=Q,e[89]=G,e[90]=le}else le=e[90];Re=le}const W=Re;let je;e[93]!==ae?(je=ae!=null?ae:[],e[93]=ae,e[94]=je):je=e[94];let Fe;return e[95]!==d||e[96]!==r||e[97]!==Le||e[98]!==l||e[99]!==W||e[100]!==xe||e[101]!==fe||e[102]!==je?(Fe=s.jsx(Op,{gptsAndAppsSlashCommands$:Le,modelSlashCommands$:xe,libraryPromptSlashCommands:W,slashCommands:fe,systemHints:je,composerController:r,clientThreadId:d,layoutMode:l}),e[95]=d,e[96]=r,e[97]=Le,e[98]=l,e[99]=W,e[100]=xe,e[101]=fe,e[102]=je,e[103]=Fe):Fe=e[103],Fe}function Up(t){return!Ut(t)}function $p(t){return t.trim()}function zp(t){return t.gizmo.id}function qp(t){return t.gizmo}function Vp(t){return t.resource}function Jp(t){return t.isConnector}function Kp(t){return!(t.isConnector&&t.hideFromInitialSelection)}function Yp(t){return t.systemHint===Z.Slurm}function Qp(t){return t.user_connection_details.connection_type}function Xp(t){return t.user_connection_details.activation_status==="activated"&&["google_drive_oauth","google_drive_dwd"].includes(t.user_connection_details.knowledge_connector_type)}function Zp(){}function ef(t){"use forget";const e=It.c(33),{clientThreadId:n,modelSupportedImageMimeTypes:o,openFileDialog:r,historyDisabled:d,isDisabled:l,highlightTooltip:i,disabledReason:p,currentModelName:u,isLoadingConnectors:f,connectorConfig:I,onSelectConnector:b,showLabel:m,showUpsell:A,hideBorder:S,isSmall:h,showMenuForNoAuth:P,visualTreatment:R}=t,c=tt(),V=hl();let B;e[0]!==c?(B=gl(c),e[0]=c,e[1]=B):B=e[1];const{gdriveStatus:g,o365Status:j}=B,{isUnauthenticated:$}=Ia(),L=d?"text-white":i?"text-brand-blue-800":"",J=!A&&(g!=="false"||j!=="false"||V);let U;e[2]!==c?(U=()=>Vn(c),e[2]=c,e[3]=U):U=e[3];const{loggedOutAttachPlusIcon:x}=Ee(U),_=$&&!x?Vd:Jd;let M;e[4]!==L?(M=ut("icon",L),e[4]=L,e[5]=M):M=e[5];let Y;e[6]!==_||e[7]!==M?(Y=s.jsx(_,{"aria-label":"",className:M}),e[6]=_,e[7]=M,e[8]=Y):Y=e[8];const ge=Y,pe=o.length>0;let D;e[9]!==n||e[10]!==I||e[11]!==u||e[12]!==p||e[13]!==S||e[14]!==i||e[15]!==ge||e[16]!==l||e[17]!==f||e[18]!==h||e[19]!==$||e[20]!==o||e[21]!==pe||e[22]!==b||e[23]!==r||e[24]!==J||e[25]!==m||e[26]!==P||e[27]!==A||e[28]!==R?(D=J?s.jsx(Kd,{clientThreadId:n,icon:ge,showLabel:$&&m,modelSupportedImageMimeTypes:o,isLoadingConnectors:f,connectorConfig:I,onSelectConnector:b,openFileDialog:r,isDisabled:l,highlightTooltip:i,disabledReason:p,currentModelName:u}):s.jsx(Zm,{isSmall:h,hideBorder:S,clientThreadId:n,openFileDialog:r,showLabel:m,showUpsell:A,icon:ge,isDisabled:l,highlightTooltip:i,disabledReason:p,currentModelName:u,visualTreatment:R,showMenuForNoAuth:P,modelSupportsImages:pe}),e[9]=n,e[10]=I,e[11]=u,e[12]=p,e[13]=S,e[14]=i,e[15]=ge,e[16]=l,e[17]=f,e[18]=h,e[19]=$,e[20]=o,e[21]=pe,e[22]=b,e[23]=r,e[24]=J,e[25]=m,e[26]=P,e[27]=A,e[28]=R,e[29]=D):D=e[29];const ee=D;let fe;return e[30]!==ee||e[31]!==i?(fe=s.jsx(Yd,{showBackground:i,className:"bg-brand-blue-800/20",children:ee}),e[30]=ee,e[31]=i,e[32]=fe):fe=e[32],fe}const tf=Qe(()=>Ye(()=>import("./o6zuph8g9nfa6t2k.js").then(t=>t._),__vite__mapDeps([14,1])),{loading:t=>Tt(t)}),di=Qe(()=>Ye(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yv),__vite__mapDeps([0,1,2,3,4])),{loading:t=>Tt(t)}),sf=Qe(()=>Ye(()=>import("./nr1vc1815n1t71bd.js").then(t=>t._),__vite__mapDeps([15,1])),{loading:t=>Tt(t)}),nf=Qe(()=>Ye(()=>import("./bh6hb7ypq0ifozyx.js").then(t=>t._),__vite__mapDeps([16,1])),{loading:t=>Tt(t)}),ui=Qe(()=>Ye(()=>import("./fvwl5axm49dprhsf.js").then(t=>t._),__vite__mapDeps([17,1])),{loading:t=>Tt(t)}),of=Qe(()=>Ye(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yA),__vite__mapDeps([0,1,2,3,4])),{loading:t=>Tt(t)}),Ta=Qe(()=>Ye(()=>import("./e9gtc6k4kfmwzcn1.js"),__vite__mapDeps([18,1,2,3,0,4])).then(t=>t.ConnectorsOnboardingModal)),Ls=6,af=(t,e=!1,{systemHintType:n}={})=>{const o=t.some(p=>!p.disabled),r=e?[...t]:o?t.filter(p=>!p.disabled):[...t],d=Rt(n),l=d?new Set(Ha()):null,i=p=>!l||!p.connectorType?0:l.has(p.connectorType)?1:0;return r.sort((p,u)=>{if(p.connected&&!u.connected)return-1;if(!p.connected&&u.connected)return 1;if(p!=null&&p.isAutoConnected&&!(u!=null&&u.isAutoConnected)||p.type==="web"&&u.type!=="web")return-1;if(p.type!=="web"&&u.type==="web"||e&&p.disabled&&!u.disabled)return 1;if(e&&!p.disabled&&u.disabled||p.isEcosystemConnector&&!u.isEcosystemConnector)return-1;if(!p.isEcosystemConnector&&u.isEcosystemConnector)return 1;if(d&&!p.connected&&!u.connected){const f=i(p),I=i(u);if(f!==I)return I-f}return p.name.localeCompare(u.name)}),r},Zs=t=>{window.open(t,"","noopener,noreferrer")};function $t(t){switch(t.user_connection_details.activation_status){case"activated":case"partially_activated":return!0;case"activating":case"inactive":return!1}}function rf(t){return t.user_connection_details.auth_status==="admin_connected"||t.user_connection_details.auth_status==="user_connected"}const lf=new Set(["slack_sync_connector","github_sync_connector","notion_sync_connector","sharepoint_admin_sync_connector","teams_admin_sync_connector","confluence_sync_connector","jira_sync_connector","jira_servicemanagement_sync_connector"]),cf=t=>{"use forget";var xt,pt,Et,Lt,zt,jt;const e=It.c(175),{isLoading:n,clientThreadId:o,enabledConnectors:r,enabledEcosystemConnectors:d,includeWebSearch:l,includeCloudBrowser:i,includeSyncConnectors:p,connectorFilterFn:u,connectorConfigMap:f,fetchValidLinksOnly:I,systemHintType:b,selectedSources:m,selectedMCPSources:A,showConnectMore:S,toggleSource:h,contentRef:P,isDeveloperMode:R,defaultAutoConnectors:c}=t,V=n===void 0?!1:n,B=l===void 0?!0:l,g=i===void 0?!1:i,j=p===void 0?!1:p,$=S===void 0?!0:S,L=tt();let J;e[0]!==m?(J=m==null?void 0:m.has("cloud"),e[0]=m,e[1]=J):J=e[1];const U=!!J;let x;e[2]===Symbol.for("react.memo_cache_sentinel")?(x=zs(),e[2]=x):x=e[2];const _=x;let M;e[3]!==L?(M=()=>Dt(L),e[3]=L,e[4]=M):M=e[4];const Y=Ee(M),pe=b==="agent"&&_&&!U,D=Pt(),ee=Fa(),{openSettings:fe}=Zd(),F=Bt(o,mf);let xe;e[5]!==ee||e[6]!==R?(xe=(ee==null?void 0:ee.isWorkspacePlan())&&R,e[5]=ee,e[6]=R,e[7]=xe):xe=e[7];const te=xe,v=!R||F===!1&&!te,ae=F===!0&&!te;let Se;e[8]!==I?(Se={fetchValidLinksOnly:I},e[8]=I,e[9]=Se):Se=e[9];const{connectorLinks:ye,isLoading:Xe}=Na(Se);let we;e[10]!==L?(we=Kn(L),e[10]=L,e[11]=we):we=e[11];const Le=we,at=!j;let ke;e[12]!==at?(ke={skip:at},e[12]=at,e[13]=ke):ke=e[13];const{connectionInstanceData:re,refetch:z,isLoading:st}=Jn(ke);let We;if(e[14]!==(re==null?void 0:re.connection_statuses)||e[15]!==u){e:{const ie=$n((xt=re==null?void 0:re.connection_statuses)!=null?xt:[],pf);if(u){We=(pt=ie==null?void 0:ie.filter(ze=>u(ze.user_connection_details.connection_type)))!=null?pt:[];break e}We=ie!=null?ie:[]}e[14]=re==null?void 0:re.connection_statuses,e[15]=u,e[16]=We}else We=e[16];const Q=We;let Re;e[17]!==Q?(Re=new Set(Q.map(ff).filter(hf)),e[17]=Q,e[18]=Re):Re=e[18];const W=Re;let je;e[19]!==Q?(je=Q.some(gf),e[19]=Q,e[20]=je):je=e[20];const Fe=je;let ve;e[21]!==Q?(ve=Q.some(_f),e[21]=Q,e[22]=ve):ve=e[22];const Ne=ve;let G;e[23]!==d?(G=new Set((d!=null?d:[]).map(bf)),e[23]=d,e[24]=G):G=e[24];const le=G;let se;if(e[25]!==r||e[26]!==le){let ie;e[28]!==le?(ie=ze=>{var Ce;return!((Ce=ze.branding)!=null&&Ce.is_discoverable_app)||ze.conformance.implements_retrievable||typeof ze.type=="string"&&le.has(ze.type)},e[28]=le,e[29]=ie):ie=e[29],se=r.filter(ie),e[25]=r,e[26]=le,e[27]=se}else se=e[27];const H=se;let ne;e:{if(!j){let Ae;e[30]!==f||e[31]!==ye||e[32]!==H?(Ae={enabledConnectors:H,connectorConfigMap:f,connectorLinks:ye},e[30]=f,e[31]=ye,e[32]=H,e[33]=Ae):Ae=e[33],ne=Ae;break e}const ie=Yt[qe.GDRIVE_ACTION_CONNECTOR];let ze;e[34]!==ye?(ze=ye.has(ie),e[34]=ye,e[35]=ze):ze=e[35];const Ce=ze;let De;e[36]!==Q?(De=Q.some(xf),e[36]=Q,e[37]=De):De=e[37];const rt=De;let lt;e[38]!==Q?(lt=Q.some(yf),e[38]=Q,e[39]=lt):lt=e[39];const O=lt;let Ie,Te,Pe;if(e[40]!==f||e[41]!==ye||e[42]!==H||e[43]!==O||e[44]!==Ce||e[45]!==rt||e[46]!==Fe||e[47]!==Ne||e[48]!==D||e[49]!==Q){if(Pe=[...H],Ie=new Map(f),Te=new Map(ye),Ce&&!Pe.some(Sf)&&!rt){Pe.push({id:Yt[qe.GDRIVE_ACTION_CONNECTOR],type:qe.GDRIVE_ACTION_CONNECTOR,name:"Google Drive",description:"",logo_url:eu,connector_type:"SERVICE",service:"",base_url:null,actions:[],supported_auth:[],owners:[],access_list:[],conformance:{implements_retrievable:!0}});let Ae;e[53]!==D?(Ae=D.formatMessage(yt.contactAdmin),e[53]=D,e[54]=Ae):Ae=e[54];let Ke;e[55]!==Ae?(Ke={disabled:!0,disabledText:Ae,hasBetaTag:!1},e[55]=Ae,e[56]=Ke):Ke=e[56],Ie.set(qe.GDRIVE_ACTION_CONNECTOR,Ke),Te.delete(ie)}else O&&(Pe=Pe.filter(Ae=>{var Ke;if(Ae.type===qe.GDRIVE_ACTION_CONNECTOR){const et=(Ke=Te.get(Ae.id))==null?void 0:Ke[0];if(Q.some(ot=>ot.user_connection_details.backing_link_id===(et==null?void 0:et.id))||Ae.type===qe.GDRIVE_ACTION_CONNECTOR)return!1}return!0}));Q.forEach(Ae=>{$t(Ae)&&Ae.user_connection_details.backing_link_id?Te.forEach((Ke,et)=>{Ke.some(ot=>ot.id===Ae.user_connection_details.backing_link_id)&&(Pe=Pe.filter(ot=>ot.id!==et))}):Fe?Pe=Pe.filter(Cf):Ne&&(Pe=Pe.filter(Tf))}),e[40]=f,e[41]=ye,e[42]=H,e[43]=O,e[44]=Ce,e[45]=rt,e[46]=Fe,e[47]=Ne,e[48]=D,e[49]=Q,e[50]=Ie,e[51]=Te,e[52]=Pe}else Ie=e[50],Te=e[51],Pe=e[52];let Me;e[57]!==Ie||e[58]!==Te||e[59]!==Pe?(Me={enabledConnectors:Pe,connectorConfigMap:Ie,connectorLinks:Te},e[57]=Ie,e[58]=Te,e[59]=Pe,e[60]=Me):Me=e[60],ne=Me}const{enabledConnectors:ue,connectorConfigMap:y,connectorLinks:k}=ne;let oe;if(e[61]!==ye||e[62]!==H||e[63]!==Le||e[64]!==le||e[65]!==o||e[66]!==y||e[67]!==u||e[68]!==k||e[69]!==P||e[70]!==c||e[71]!==ae||e[72]!==v||e[73]!==pe||e[74]!==ue||e[75]!==Fe||e[76]!==Ne||e[77]!==g||e[78]!==j||e[79]!==B||e[80]!==D||e[81]!==U||e[82]!==z||e[83]!==A||e[84]!==m||e[85]!==Q||e[86]!==W||e[87]!==b||e[88]!==h){const ie=[];if(B){const O=ae||pe;let Ie;e[90]!==m?(Ie=m==null?void 0:m.has("web"),e[90]=m,e[91]=Ie):Ie=e[91];let Te;e[92]!==h?(Te=()=>{h("web")},e[92]=h,e[93]=Te):Te=e[93];let Pe;e[94]!==D?(Pe=D.formatMessage(yt.webSearch),e[94]=D,e[95]=Pe):Pe=e[95];let Me;e[96]!==O||e[97]!==Ie||e[98]!==Te||e[99]!==Pe?(Me=s.jsx(it.CheckboxItem,{icon:di,disabled:O,checked:Ie,onCheckedChange:Te,children:Pe}),e[96]=O,e[97]=Ie,e[98]=Te,e[99]=Pe,e[100]=Me):Me=e[100],ie.push({connected:!0,type:"web",name:"web",element:Me})}if(g){let O;e[101]!==h?(O=()=>{h("cloud")},e[101]=h,e[102]=O):O=e[102];let Ie;e[103]!==D?(Ie=D.formatMessage(yt.cloudBrowser),e[103]=D,e[104]=Ie):Ie=e[104];let Te;e[105]!==ae||e[106]!==U||e[107]!==O||e[108]!==Ie?(Te=s.jsx(it.CheckboxItem,{icon:ui,disabled:ae,checked:U,onCheckedChange:O,children:Ie}),e[105]=ae,e[106]=U,e[107]=O,e[108]=Ie,e[109]=Te):Te=e[109],ie.push({connected:!0,type:"cloud",name:"cloud",element:Te})}j&&Q.forEach(O=>{var Ke,et,ot,ct;if(u&&!u(O.user_connection_details.connection_type))return;const Ie=(Ke=y==null?void 0:y.get("sync_connector"))==null?void 0:Ke.disabled,Te=O.user_connection_details.backing_link_id,Pe=Te?[...k.keys()].find(At=>{var wt;return(wt=k.get(At))==null?void 0:wt.some(qt=>qt.id===Te)}):null,Me=Pe?(et=H.find(At=>At.id===Pe))==null?void 0:et.type:null;if(O.user_connection_details.connection_type==="gdrive_sync_connector"&&!$t(O))return;if(!$t(O)&&O.user_connection_details.backing_link_id&&Me)return;if(O.user_connection_details.connection_type==="github_sync_connector")return;if(!rf(O)&&!lf.has(O.user_connection_details.connection_type))return;if(Fe&&O.user_connection_details.connection_type==="sharepoint_sync_connector")return;if(Ne&&O.user_connection_details.connection_type==="teams_admin_sync_connector")return;const Ae=O.user_connection_details.auth_status==="admin_connected"?O.user_connection_details.activation_status!=="inactive":O.user_connection_details.auth_status!=="not_connected";ie.push({connected:Ae,type:"sync",name:Xs(O),connectorType:O.user_connection_details.connection_type,element:s.jsx(pi,{connection:O,disabled:Ie||pe,disabledText:Ie?(ot=y==null?void 0:y.get("sync_connector"))==null?void 0:ot.disabledText:D.formatMessage(yt.connectorsNeedCloudBrowserDisabledText),isSelectedInSource:(ct=m==null?void 0:m.has(O.user_connection_details.connection_type))!=null?ct:!1,location:"user_dropdown",refetch:z,showDetails:W.has(O.user_connection_details.connection_type),toggleSource:At=>{Me&&m.has(Me)&&h(Me),h(At)}},O.user_connection_details.connection_instance_id)})}),m&&ue.forEach(O=>{var Pe,Me,Ae,Ke,et,ot,ct,At;const Te=!!((Pe=k.get(O.id))==null?void 0:Pe[0]);if(O.type===Ga.MCP_CONNECTOR)ie.push({connected:Te,type:"access",name:O.name,connectorType:O.type,element:s.jsx(df,{connector:O,connectorLinks:k,selectedMCPSources:A,toggleSource:h,systemHintType:b,disabled:O.status==="ONLY_ME"&&v||O.status!=="ONLY_ME"&&ae||pe})});else{let wt=ae||((Ae=(Me=y==null?void 0:y.get(O.type))==null?void 0:Me.disabled)!=null?Ae:!1),qt=wt?(Ke=y==null?void 0:y.get(O.type))==null?void 0:Ke.disabledText:void 0;if(O.status==="DISABLED_BY_ADMIN"?(wt=!0,qt=D.formatMessage(Ho.disabledByAdmin)):pe&&(wt=!0,qt=D.formatMessage(yt.connectorsNeedCloudBrowserDisabledText)),O.type===qe.GITHUB_CONNECTOR)return;const rs=Le.includes(O.type)&&b===Z.Slurm,Qt=c==null?void 0:c.includes(O.type),Xt=typeof O.type=="string"&&le.has(O.type)&&!!((et=O.branding)!=null&&et.is_discoverable_app)&&!O.conformance.implements_retrievable;ie.push({connected:Te,disabled:wt,type:"access",name:O.name,isAutoConnected:rs||Qt,connectorType:O.type,isEcosystemConnector:Xt,element:s.jsx(mi,{connector:O,connectorLink:(ot=k.get(O.id))==null?void 0:ot[0],disabled:wt,disabledText:qt,hasBetaTag:(ct=y==null?void 0:y.get(O.type))==null?void 0:ct.hasBetaTag,isSelectedInSource:(At=m.has(O.type))!=null?At:!1,systemHintType:b,toggleSource:h,isDefaultAutoConnected:Qt})})}});let ze;e[110]!==H||e[111]!==m?(ze=m&&H.find(Af),e[110]=H,e[111]=m,e[112]=ze):ze=e[112];let Ce=ze;u&&!u(qe.GITHUB_CONNECTOR)&&(Ce=void 0);let De;e[113]!==j||e[114]!==Q?(De=j?Q.find(kf):void 0,e[113]=j,e[114]=Q,e[115]=De):De=e[115];const rt=De;if(Ce||rt){const O=rt&&rt.user_connection_details.auth_status!=="not_connected"&&rt.user_connection_details.activation_status!=="inactive";let Ie;e[116]!==ye?(Ie=(Et=ye.get(_l))==null?void 0:Et[0],e[116]=ye,e[117]=Ie):Ie=e[117];const Te=Ie,Pe=Ce&&!!Te;let Me;e[118]!==y||e[119]!==ae?(Me=ae||((zt=(Lt=y==null?void 0:y.get(qe.GITHUB_CONNECTOR))==null?void 0:Lt.disabled)!=null?zt:!1),e[118]=y,e[119]=ae,e[120]=Me):Me=e[120];let Ae=Me,Ke;e[121]!==y||e[122]!==Ae?(Ke=Ae?(jt=y==null?void 0:y.get(qe.GITHUB_CONNECTOR))==null?void 0:jt.disabledText:void 0,e[121]=y,e[122]=Ae,e[123]=Ke):Ke=e[123];let et=Ke;if((Ce==null?void 0:Ce.status)==="DISABLED_BY_ADMIN"){Ae=!0;let ct;e[124]!==D?(ct=D.formatMessage(Ho.disabledByAdmin),e[124]=D,e[125]=ct):ct=e[125],et=ct}else if(pe){Ae=!0;let ct;e[126]!==D?(ct=D.formatMessage(yt.connectorsNeedCloudBrowserDisabledText),e[126]=D,e[127]=ct):ct=e[127],et=ct}let ot;e[128]!==o||e[129]!==Te||e[130]!==P||e[131]!==et||e[132]!==Ae||e[133]!==Ce||e[134]!==rt||e[135]!==z||e[136]!==m||e[137]!==b||e[138]!==h?(ot=s.jsx(uf,{clientThreadId:o,githubSyncConnection:rt,githubAccessConnector:Ce,connectorLink:Te,selectedSources:m,toggleSource:h,systemHintType:b,refetch:z,contentRef:P,disabled:Ae,disabledText:et}),e[128]=o,e[129]=Te,e[130]=P,e[131]=et,e[132]=Ae,e[133]=Ce,e[134]=rt,e[135]=z,e[136]=m,e[137]=b,e[138]=h,e[139]=ot):ot=e[139],ie.push({disabled:Ae,connected:!!O||!!Pe,type:O?"sync":"access",name:"GitHub",connectorType:qe.GITHUB_CONNECTOR,element:ot})}oe=af(ie,ae||v,{systemHintType:b}).reduce(If,[[],[]]),e[61]=ye,e[62]=H,e[63]=Le,e[64]=le,e[65]=o,e[66]=y,e[67]=u,e[68]=k,e[69]=P,e[70]=c,e[71]=ae,e[72]=v,e[73]=pe,e[74]=ue,e[75]=Fe,e[76]=Ne,e[77]=g,e[78]=j,e[79]=B,e[80]=D,e[81]=U,e[82]=z,e[83]=A,e[84]=m,e[85]=Q,e[86]=W,e[87]=b,e[88]=h,e[89]=oe}else oe=e[89];const[w,q]=oe;let X;e[140]!==w||e[141]!==q?(X={connectedRows:w,disconnectedRows:q},e[140]=w,e[141]=q,e[142]=X):X=e[142];const{connectedRows:C,disconnectedRows:K}=X;let de;e:{if(Rt(b)){let ie;e[143]===Symbol.for("react.memo_cache_sentinel")?(ie=new Set(Ha()),e[143]=ie):ie=e[143];const ze=ie;let Ce;if(e[144]!==K||e[145]!==ze){let De;e[147]!==ze?(De=rt=>{var lt;return ze.has((lt=rt.connectorType)!=null?lt:"")},e[147]=ze,e[148]=De):De=e[148],Ce=K.filter(De),e[144]=K,e[145]=ze,e[146]=Ce}else Ce=e[146];de=Math.max(Ls-C.length,Ce.length);break e}de=Ls-C.length}const Oe=de;if(!o||!m)return null;if(st||Xe||V){let ie;return e[149]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx("div",{className:"w-50 px-4",children:s.jsx(Cl,{lines:5,size:"lg",widthVariance:0,width:100})}),e[149]=ie):ie=e[149],ie}const Be=C.length>Ls,ce=Be&&"border-token-border-secondary mb-1.5 border-b";let me;e[150]!==ce?(me=ut(ce,"overflow-y-auto"),e[150]=ce,e[151]=me):me=e[151];let he;e[152]!==Be?(he=Be?{maxHeight:"calc(2.25rem * ".concat(Ls+.5,")")}:void 0,e[152]=Be,e[153]=he):he=e[153];let Ge;e[154]!==C?(Ge=C.map(Pf),e[154]=C,e[155]=Ge):Ge=e[155];let nt;e[156]!==me||e[157]!==he||e[158]!==Ge?(nt=s.jsx("div",{className:me,style:he,children:Ge}),e[156]=me,e[157]=he,e[158]=Ge,e[159]=nt):nt=e[159];let Ve;e[160]!==Oe||e[161]!==K?(Ve=K.length>0&&Oe>0&&s.jsx(s.Fragment,{children:K.slice(0,Oe).map(Ef)}),e[160]=Oe,e[161]=K,e[162]=Ve):Ve=e[162];let Ze;e[163]!==L||e[164]!==pe||e[165]!==D||e[166]!==Y||e[167]!==fe||e[168]!==$||e[169]!==b?(Ze=$&&s.jsx(it.Item,{disabled:pe,icon:nf,onPointerOver:()=>{Rt(b)&&Ta.prefetch()},onSelect:()=>{gt.logEventWithStatsig("chatgpt_connectors_dropdown_connect_more_clicked","chatgpt_connectors_dropdown_connect_more_clicked"),Y?Zs(Tl):Rt(b)?is(L,Ta,{}):fe(wa.Connectors)},children:D.formatMessage(yt.connectApps)}),e[163]=L,e[164]=pe,e[165]=D,e[166]=Y,e[167]=fe,e[168]=$,e[169]=b,e[170]=Ze):Ze=e[170];let mt;return e[171]!==nt||e[172]!==Ve||e[173]!==Ze?(mt=s.jsxs("div",{className:"w-70",children:[nt,Ve,Ze]}),e[171]=nt,e[172]=Ve,e[173]=Ze,e[174]=mt):mt=e[174],mt},ds=({isLoading:t=!1,clientThreadId:e,enabledConnectors:n,enabledEcosystemConnectors:o,trigger:r,includeWebSearch:d,includeCloudBrowser:l,selectedSources:i,selectedMCPSources:p,addSource:u,deleteSource:f,toggleSource:I,includeSyncConnectors:b=!1,connectorFilterFn:m,connectorConfigMap:A,fetchValidLinksOnly:S,systemHintType:h,showConnectMore:P=!0,isDeveloperMode:R,defaultAutoConnectors:c})=>{const V=tt(),{refetch:B}=Na({fetchValidLinksOnly:S}),g=Oa(),j=Rt(h)?Ba(V):!0,L=Bt(e,_=>_==null?void 0:_.startedWithByoMcp)===!0,J=T.useRef(null),U=T.useMemo(()=>{const _=o!=null?o:[],M=new Set(_.map(ge=>ge.id)),Y=n.filter(ge=>!M.has(ge.id));return[..._,...Y]},[n,o]),x=T.useRef(!1);return T.useEffect(()=>{var M,Y;const _=((M=i==null?void 0:i.size)!=null?M:0)+((Y=p==null?void 0:p.size)!=null?Y:0);!x.current&&_===0&&!L&&(u("web"),x.current=!0)},[i,p,u,L]),s.jsxs(it.Root,{"data-testid":"sources-pill",onOpenChange:_=>{var M,Y;_?B():(!Qd(Xd(vn(e),h))&&j&&(f(qe.GITHUB_CONNECTOR),g&&f("github_sync_connector")),((M=i==null?void 0:i.size)!=null?M:0)+((Y=p==null?void 0:p.size)!=null?Y:0)===0&&!L&&u("web"))},children:[r,s.jsx(it.Portal,{children:s.jsx(it.Content,{alignOffset:-7,size:"auto",ref:J,children:s.jsx(cf,{isLoading:t,clientThreadId:e,enabledConnectors:U,enabledEcosystemConnectors:o,includeWebSearch:d,includeCloudBrowser:l,includeSyncConnectors:b,connectorFilterFn:m,connectorConfigMap:A,fetchValidLinksOnly:S,systemHintType:h,selectedSources:i,selectedMCPSources:p,showConnectMore:P,toggleSource:I,contentRef:J,isDeveloperMode:R,defaultAutoConnectors:c})})})]})},Fs=3,us=({includeSyncConnectors:t,includeWebSearch:e,connectorFilterFn:n,selectedSources:o,selectedMCPSources:r,isDeveloperMode:d})=>{var U;const l=tt(),i=Pt(),p=Da(),{availableConnectors:u,isLoading:f}=La({productSku:Nn.PROMPT_TEXT_AREA}),{connectionInstanceData:I,isLoading:b}=Jn({skip:!t}),m=f||b,A=e?o!=null&&o.has("web")?s.jsx(di,{className:"icon"}):s.jsx(sf,{className:"icon"}):void 0,S=o!=null&&o.has("cloud")?s.jsx(ui,{className:"icon"}):void 0,h=[...o!=null?o:[]].filter(x=>x!=="web"&&x!=="cloud").filter(x=>n?n(x):!0).map(x=>{const _=u.find(M=>M.type===x);return _?{name:_.name,icon:s.jsx(fs,{connector:_,size:"xsmall"})}:null}).filter(x=>!!x),P=t?Array.from(new Map(((U=I==null?void 0:I.connection_statuses)!=null?U:[]).filter(x=>$t(x)&&(n?n(x.user_connection_details.connection_type):!0)&&(o==null?void 0:o.has(x.user_connection_details.connection_type))).map(x=>{var _;return[x.user_connection_details.connection_type,{name:Xs(x),icon:s.jsx("img",{src:p&&x.connection_display_info.icon_dark_url?x.connection_display_info.icon_dark_url:(_=x.connection_display_info.icon_url)!=null?_:"",alt:x.connection_display_info.display_name,className:"icon"})}]})).values()):[],R=Array.from(r!=null?r:[]).map(x=>{const _=u.find(M=>M.id===x);return _?{name:_.name,icon:s.jsx(fs,{connector:_,size:"xsmall"})}:null}).filter(x=>!!x),c=$n([...R,...h,...P].reverse(),x=>x.name).reverse();c.sort((x,_)=>x.name.localeCompare(_.name));const V=[...A?[{name:"web",icon:A}]:[],...S?[{name:"cloud",icon:S}]:[],...c],B=V.length>Fs?[...V.slice(0,Fs-1),{name:"__plus_overflow",icon:s.jsx("span",{className:"text-token-text-secondary bg-token-bg-secondary text-caption-regular flex h-4.5 w-4.5 items-center justify-center rounded-full",children:V.length-Fs+1},"more")}]:V,j=T.useMemo(()=>ka(l,"3282868491"),[l]).get("short_text","Connectors"),$=j==="Sources"?i.formatMessage({id:"hocZEX",defaultMessage:"Add"}):i.formatMessage({id:"UjEzZf",defaultMessage:"Add sources"}),L=j==="Sources"?null:i.formatMessage({id:"DhW8Wx",defaultMessage:"Sources"}),J=B.length===0&&!m?$:L;return s.jsx(it.BasicTrigger,{asChild:!0,children:s.jsxs("button",{type:"button",className:ut("composer-btn px-2",d&&B.length>0&&"rounded-full bg-orange-400/10 hover:bg-orange-400/20"),children:[B.length>0&&!m?s.jsx("div",{className:"flex items-center gap-1",children:B.map(x=>s.jsx("div",{className:"icon flex items-center justify-center",children:x.icon},x.name))}):s.jsx(tf,{className:"icon"}),d&&B.length>0?s.jsx("span",{className:"ms-1.5 text-orange-400 [[data-collapse-labels]_&]:sr-only",children:B.length===1?B[0].name:s.jsx(os,{id:"+Fsfxz",defaultMessage:"Multiple Connectors"})}):(B.length<Fs||m)&&J&&s.jsx("span",{className:"ms-1.5 [[data-collapse-labels]_&]:sr-only",children:J}),s.jsx(of,{className:"icon-sm xs:ms-1.5 ms-1"})]})})},mi=({connector:t,connectorLink:e,disabled:n=!1,disabledText:o="",hasBetaTag:r=!1,isSelectedInSource:d,systemHintType:l,toggleSource:i,isDefaultAutoConnected:p=!1})=>{var L;const u=tt(),f=Pt(),I=Xn(),b=Kn(u),m=Yn(u),A=Ee(()=>Dt(u)),S=J=>{A?Zs(Zn(J)):I(J)},h=!!e,P=d&&h,R=b.includes(t.type)&&l===Z.Slurm||!m&&Rt(l)||p,c=T.useMemo(()=>!!(Rt(l)&&t.type===qe.GDRIVE_ACTION_CONNECTOR),[t.type,l]);if(t.type===Ga.MCP_CONNECTOR)return null;const V=(L=Sl[t.type])==null?void 0:L.title,B=V?f.formatMessage(V):t.name,g=s.jsx(fs,{connector:t,size:"xsmall"}),j=s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"truncate",children:B}),r&&s.jsx(ou,{})]}),$=R&&h?s.jsx(it.Item,{disabled:n,label:j,onSelect:()=>{window.location.href=su(t.type)},icon:g,trailing:s.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:f.formatMessage(yt.auto)})}):h?s.jsx(it.CheckboxItem,{disabled:n,label:j,icon:g,checked:P,onCheckedChange:()=>{i(t.type)}}):s.jsx(it.Item,{disabled:n,onSelect:()=>{S({connectorId:t.id,redirectAfter:l?"/?system_hints=".concat(l):void 0,systemHintType:l,referrer:qs.SourcesDropdown,syncOnly:c||void 0})},label:j,icon:g,trailing:n?void 0:s.jsx("div",{className:"text-token-text-tertiary",children:f.formatMessage(yt.connect)})});return o=R?n?f.formatMessage(yt.autoConnectorDisabled):f.formatMessage(yt.autoConnected):o,s.jsx(s.Fragment,{children:(n||R&&h)&&o?s.jsx(qn,{label:o,side:"right",align:"center",contentClassName:"w-50",children:$}):$})},df=({connector:t,connectorLinks:e,selectedMCPSources:n,toggleSource:o,systemHintType:r,disabled:d=!1})=>{var P;const l=tt(),i=Pt(),p=Xn(),u=Ee(()=>Dt(l));if(!t.conformance.implements_retrievable&&(r===Z.Research||r===Z.Slurm))return null;const I=!!((P=e.get(t.id))==null?void 0:P[0]),b=n.has(t.id)&&I,m=t.name,A=s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"truncate",children:m}),s.jsx(nu,{connector:t})]}),S=s.jsx(fs,{connector:t,size:"xsmall"}),h=R=>{u?Zs(Zn(R)):p(R)};return s.jsx(s.Fragment,{children:I?s.jsx(it.CheckboxItem,{icon:S,checked:b,label:A,disabled:d,onCheckedChange:()=>{o(t.id)}}):s.jsx(it.Item,{onSelect:()=>{d||h({connectorId:t.id,redirectAfter:r?"/?system_hints=".concat(r):void 0,systemHintType:r,referrer:qs.SourcesDropdown})},icon:S,label:A,trailing:s.jsx("div",{className:"text-token-text-tertiary",children:i.formatMessage(yt.connect)}),disabled:d})})},pi=({connection:t,refetch:e,location:n,isSelectedInSource:o,toggleSource:r,showDetails:d,disabled:l=!1,disabledText:i=""})=>{var te;const p=tt(),u=Yn(p),f=Pt(),I=Da(),[b,m]=T.useState(!1),[A,S]=T.useState(),h=Qn(),P=Xn(),R=Ee(()=>Dt(p)),c=v=>{R?Zs(Zn(v)):P(v)},V=()=>{r(t.user_connection_details.connection_type)},B=t.user_connection_details.connection_instance_id,g=Wa(),j=bl(p),$=t.user_connection_details.knowledge_connector_type,L=$==="google_drive_oauth",J=t.user_connection_details.connection_type==="notion_sync_connector"&&t.user_connection_details.connection_instance_id.startsWith("ks--merge"),U=Rt(h)?!u&&["activated","partially_activated"].includes(t.user_connection_details.activation_status):!1,x=T.useCallback(async()=>{try{m(!0),await xl({connectorType:$,connectionId:B,location:n,intl:f})}catch(v){v instanceof Error?g.danger(v.message,{toastId:"sources_dropdown_oauth_error"}):g.danger({defaultMessage:"Encountered an error connecting your account. Please try again later.",description:"Error message shown when a user tries to link their account but it fails."},{toastId:"sources_dropdown_oauth_error"})}finally{m(!1),e==null||e()}},[B,$,f,n,e,g]),[_,M]=T.useState(!1),Y=()=>{L?Rt(h)?c({connectorId:Yt[qe.GDRIVE_ACTION_CONNECTOR],redirectAfter:h?"/?system_hints=".concat(h):void 0,systemHintType:h!=null?h:void 0,referrer:qs.SourcesDropdown,syncOnly:!0}):M(!0):J?c({connectorId:Yt[qe.NOTION_CONNECTOR],redirectAfter:h?"/?system_hints=".concat(h):void 0,systemHintType:h!=null?h:void 0,referrer:qs.SourcesDropdown,syncOnly:!0}):x()},ge=t.user_connection_details.activation_status==="inactive"&&t.user_connection_details.auth_status==="not_connected",pe=["activating","partially_activated"].includes(t.user_connection_details.activation_status),D=ge&&!j||pe,ee=s.jsx("img",{src:I&&t.connection_display_info.icon_dark_url?t.connection_display_info.icon_dark_url:(te=t.connection_display_info.icon_url)!=null?te:"",alt:t.connection_display_info.display_name,className:"icon"}),fe=v=>{if(v.stopPropagation(),v.preventDefault(),ge){Y();return}if(pe){S(t);return}},F={key:t.connection_display_info.display_name,disabled:l,icon:ee,label:Xs(t),secondary:d?s.jsx("div",{className:"truncate",children:t.connection_display_info.display_name}):void 0};U&&(F.trailing=s.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:f.formatMessage(yt.auto)}));let xe=null;switch(t.user_connection_details.activation_status){case"activated":xe=s.jsx(it.CheckboxItem,Jt(_t({},F),{checked:o,onCheckedChange:V}));break;case"partially_activated":xe=s.jsx(it.CheckboxItem,Jt(_t({},F),{checked:o,onCheckedChange:V,secondary:s.jsx("div",{className:"group-radix-disabled:opacity-50 flex items-center gap-1.5",children:s.jsx(Pl,{className:"flex-row-reverse",connection:t})})}));break;case"activating":xe=s.jsx(it.Item,Jt(_t({},F),{style:{cursor:D?void 0:"default"},onSelect:fe,trailing:s.jsx("div",{className:"group-radix-disabled:opacity-50",children:s.jsx(Il,{connection:t})})}));break;case"inactive":xe=s.jsx(it.Item,Jt(_t({},F),{style:{cursor:D?void 0:"default"},onSelect:fe,trailing:s.jsx("div",{className:"group-radix-disabled:opacity-50",children:b?s.jsx(Al,{className:"icon"}):s.jsx(kl,{connection:t,refetch:e,location:"user_dropdown"})})}));break}return s.jsxs(s.Fragment,{children:[A&&s.jsx(tu,{connection:A,onClose:()=>S(void 0)}),_&&s.jsx(yl,{isAdminFlow:!1,onClose:()=>M(!1),connectionId:B,location:n,onSuccess:e}),l&&i?s.jsx(qn,{label:i,side:"right",align:"center",contentClassName:"w-50",children:xe}):xe]})},uf=({clientThreadId:t,githubSyncConnection:e,githubAccessConnector:n,connectorLink:o,selectedSources:r,toggleSource:d,systemHintType:l,refetch:i,contentRef:p,disabled:u,disabledText:f})=>{var J,U;const I=tt(),b=Pt(),m=El("installations/select_target"),A=Oa(),S=Rt(l)?Ba(I):!0,P=Bt(t,x=>x==null?void 0:x.startedWithByoMcp)===!0,{data:R,isLoading:c}=au({linkId:(J=o==null?void 0:o.id)!=null?J:""}),V=!!R,B=o==null?void 0:o.id,g=!!B&&!V;if(!n&&!e)return null;const j=x=>{const _=x==="github_sync_connector",M=x===qe.GITHUB_CONNECTOR;if((_||M)&&n&&e){const Y=r==null?void 0:r.has("github_sync_connector"),ge=r==null?void 0:r.has(qe.GITHUB_CONNECTOR);Y===ge&&d(_?qe.GITHUB_CONNECTOR:"github_sync_connector")}d(x)},$=n?s.jsx(fs,{connector:n,size:"xsmall"}):e?s.jsx("img",{src:(U=e.connection_display_info.icon_url)!=null?U:"",alt:e.connection_display_info.display_name,className:"icon"}):null,L=n?n.name:e?Xs(e):"";if(g&&!c&&S)return s.jsx(it.Item,{label:L,icon:$,onSelect:()=>{window.open(m,"_blank")},trailing:s.jsx("div",{className:"text-token-text-tertiary",children:b.formatMessage(yt.finishSetup)})});if(e&&($t(e)||!n)){const x=r.has("github_sync_connector");return s.jsxs(s.Fragment,{children:[s.jsx(pi,{connection:e,refetch:i,location:"user_dropdown",isSelectedInSource:x,toggleSource:j,showDetails:!1,disabled:c||u,disabledText:f},e.user_connection_details.connection_instance_id),x&&A&&S&&s.jsx(ca,{clientThreadId:t,allowSelectAllRepos:!1,githubSyncEnabled:!0,linkId:B,syncConnectionId:e.user_connection_details.connection_instance_id,contentRef:p})]})}else if(n){const x=r.has(qe.GITHUB_CONNECTOR);return s.jsxs(s.Fragment,{children:[s.jsx(mi,{connector:n,connectorLink:o,disabled:P||u,disabledText:f,hasBetaTag:!1,isSelectedInSource:x,systemHintType:l,toggleSource:j}),x&&S&&s.jsx(ca,{clientThreadId:t,linkId:o==null?void 0:o.id,allowSelectAllRepos:!1,githubSyncEnabled:!1,contentRef:p})]})}return null},yt=Gn({contactAdmin:{id:"JGCH/x",defaultMessage:"Contact your admin to enable Google Drive for chat"},allRepositories:{id:"EzHFPp",defaultMessage:"All Repositories"},connect:{id:"OODbh3",defaultMessage:"Connect"},finishSetup:{id:"j12ad3",defaultMessage:"Finish Setup"},sourcesEnabled:{id:"aEIPI+",defaultMessage:"On"},webSearch:{id:"XoUbAe",defaultMessage:"Web search"},cloudBrowser:{id:"RA2J7e",defaultMessage:"Use cloud browser"},connectorsNeedCloudBrowserDisabledText:{id:"lm1ZXj",defaultMessage:"Connectors can only be enabled for cloud browser"},sourcesDisabled:{id:"j32+iI",defaultMessage:"Off"},connectApps:{id:"wwlf43",defaultMessage:"Connect more"},autoConnected:{id:"7IJBNd",defaultMessage:"This connector is searched automatically"},autoConnectorDisabled:{id:"KJQcAS",defaultMessage:"To enable this connector, toggle off all custom connectors"},auto:{id:"uW03xX",defaultMessage:"Auto"}});function mf(t){return t==null?void 0:t.startedWithByoMcp}function pf(t){return t.user_connection_details.connection_instance_id}function ff(t){return t.user_connection_details.connection_type}function hf(t,e,n){return n.indexOf(t)!==e}function gf(t){return $t(t)&&t.user_connection_details.connection_type==="sharepoint_admin_sync_connector"}function _f(t){return $t(t)&&t.user_connection_details.connection_type==="teams_admin_sync_connector"}function bf(t){return t.type}function xf(t){return t.user_connection_details.connection_type==="gdrive_sync_connector"}function yf(t){return t.user_connection_details.connection_type==="gdrive_sync_connector"&&$t(t)}function Sf(t){return t.type===qe.GDRIVE_ACTION_CONNECTOR}function Cf(t){return t.id!==Yt[qe.SHAREPOINT_CONNECTOR]}function Tf(t){return t.id!==Yt[qe.TEAMS_CONNECTOR]}function Af(t){return t.type===qe.GITHUB_CONNECTOR}function kf(t){return t.user_connection_details.connection_type==="github_sync_connector"}function If(t,e){const[n,o]=t;return e.connected?[[...n,e],o]:[n,[...o,e]]}function Pf(t){const{element:e,name:n}=t;return s.jsx(T.Fragment,{children:e},n)}function Ef(t){const{element:e}=t;return s.jsx(s.Fragment,{children:e})}function jf({clientThreadId:t,activeSystemHint:e,selectedSources:n,selectedMCPSources:o,addSource:r,deleteSource:d,toggleSource:l,currentModelConfigId:i,connectionStatuses:p,connectedOnly:u=!1,hiddenTypes:f,hideMcpConnectors:I=!1}){var xe,te;const b=tt(),m=jl(),A=Fa(),S=Ee(()=>Qs(b)),h=(e==null?void 0:e.systemHint)===Z.Research,P=(e==null?void 0:e.systemHint)===Z.ApiTool,R=(e==null?void 0:e.systemHint)===Z.Glaux,c=(e==null?void 0:e.systemHint)===Z.Slurm,V=ni(i,e==null?void 0:e.systemHint),{availableConnectors:B,isLoading:g,enabled:j}=wl(),{availableConnectors:$,enabled:L,isLoading:J}=Ml({includeDisabledByAdmin:!0,includeAutoConnectors:c,filterDisabledAutoConnectors:c}),{availableConnectors:U,enabled:x,isLoading:_}=iu({includeDisabledByAdmin:!0}),M=Rl({includeDisabledByAdmin:!0}),Y=vl(b),{connectorConfigMap:ge}=ru({clientThreadId:t}),pe=La(),D=v=>{!Ut(v)&&R&&n.has(v)&&n.size<=1||l(v)},ee=c&&(((xe=p==null?void 0:p.length)!=null?xe:0)>0||L&&$.length>0),fe=v=>I!=null&&I?v.filter(ae=>!Ut(ae.type)&&!(f!=null&&f.has(ae.type))):f?v.filter(ae=>!f.has(ae.type)):v,F=v=>f?!f.has(v):!0;if(j&&h)return s.jsx(ds,{clientThreadId:t,selectedSources:n,selectedMCPSources:o,addSource:r,deleteSource:d,toggleSource:D,isLoading:g,enabledConnectors:fe(B),fetchValidLinksOnly:!0,systemHintType:e==null?void 0:e.systemHint,isDeveloperMode:S,connectorFilterFn:F,trigger:s.jsx(us,{selectedSources:n,selectedMCPSources:o,includeSyncConnectors:!1,includeWebSearch:!0,connectorFilterFn:F})});if(ee){const v=A!=null&&A.isPersonalAccount()?m:!0;return s.jsx(ds,{clientThreadId:t,selectedSources:n,selectedMCPSources:o,addSource:r,deleteSource:d,toggleSource:D,isLoading:J,enabledConnectors:fe($),includeWebSearch:!1,includeSyncConnectors:v,isDeveloperMode:S,connectorConfigMap:ge,systemHintType:e==null?void 0:e.systemHint,connectorFilterFn:F,trigger:s.jsx(us,{selectedSources:n,selectedMCPSources:o,includeSyncConnectors:v,includeWebSearch:!1,isDeveloperMode:S,connectorFilterFn:F})})}if(P){const v=pe.availableConnectors.filter(ae=>ae.connector_type==="MCP");return s.jsx(ds,{clientThreadId:t,selectedSources:n,selectedMCPSources:o,addSource:r,deleteSource:d,toggleSource:D,isLoading:pe.isLoading,enabledConnectors:v,includeWebSearch:!1,includeSyncConnectors:!1,connectorConfigMap:ge,systemHintType:e==null?void 0:e.systemHint,isDeveloperMode:!0,connectorFilterFn:F,trigger:s.jsx(us,{selectedSources:n,selectedMCPSources:o,includeSyncConnectors:!1,includeWebSearch:!1,isDeveloperMode:!0,connectorFilterFn:F})})}if(x&&V){const v=zs();return s.jsx(ds,{clientThreadId:t,selectedSources:n,selectedMCPSources:o,addSource:r,deleteSource:d,toggleSource:D,isLoading:_,enabledConnectors:U,fetchValidLinksOnly:!0,systemHintType:e==null?void 0:e.systemHint,includeCloudBrowser:v,isDeveloperMode:S,connectorFilterFn:F,trigger:s.jsx(us,{selectedSources:n,selectedMCPSources:o,includeSyncConnectors:!1,includeWebSearch:!0,connectorFilterFn:F})})}return R?s.jsx(ds,{clientThreadId:t,selectedSources:n,selectedMCPSources:o,addSource:r,deleteSource:d,toggleSource:D,isLoading:M==null?void 0:M.isLoading,enabledConnectors:(te=M==null?void 0:M.availableConnectors)!=null?te:[],includeWebSearch:!1,includeSyncConnectors:!0,systemHintType:e==null?void 0:e.systemHint,connectorFilterFn:v=>(v.endsWith("_sync_connector")?Y.includes(v):!0)&&F(v),trigger:s.jsx(us,{selectedSources:n,selectedMCPSources:o,includeSyncConnectors:!0,connectorFilterFn:v=>(v.endsWith("_sync_connector")?Y.includes(v):!0)&&F(v),includeWebSearch:!1})}):null}function wf({activeSystemHint:t,clientThreadId:e,connectionStatuses:n,currentModelConfig:o}){const{selectedSources:r=new Set,selectedMCPSources:d=new Set,addSource:l,deleteSource:i,toggleSource:p}=oi(e);return s.jsx(jf,{clientThreadId:e,activeSystemHint:t,selectedSources:r,selectedMCPSources:d,addSource:l,deleteSource:i,toggleSource:p,currentModelConfigId:o==null?void 0:o.id,connectionStatuses:n})}const Mf=t=>{"use forget";const e=It.c(120),{conversation:n,composerController:o,pendingFiles:r,hasFiles:d,placeholder:l,shouldUseRotatingPlaceholders:i,isTemporaryChat:p,state:u,inputState:f,disableReason:I,currentModelConfig:b,gizmoId:m,replyRegions:A,includeSidebarContextTray:S,onSubmit:h,leadingAction:P,legacyFooterActions:R,activeSystemHint:c,activeConnectorSystemHints:V,hideSystemHint:B,isSystemHintLocked:g,onRemoveSystemHint:j,onRemoveModel:$,contextualAnswerUserConnectionData:L,fileInput:J,expanded:U,expandOnMultilineInput:x,layoutMode:_,shouldShowAgentSessionModeDropdown:M,agentSessionModeNuxModal:Y,isAgentSessionModeDropdownDisabled:ge,forceStopButton:pe}=t,D=i===void 0?!1:i,ee=B===void 0?!1:B,fe=M===void 0?!1:M,F=ge===void 0?!1:ge,xe=pe===void 0?!1:pe,te=tt(),v=Ys(Dt);let ae;e[0]!==te?(ae=()=>Qs(te),e[0]=te,e[1]=ae):ae=e[1];const Se=Ee(ae),ye=Bt(n.id,ht.getIsNewConversation),Xe=Qn();let we;e[2]!==te?(we=()=>Vn(te),e[2]=te,e[3]=we):we=e[3];const{showSelectedModelInComposer:Le,showThinkingEffortPicker:at,fontSize:ke,disableMotion:re}=Ee(we);let z;e[4]!==o?(z=Ua(o),e[4]=o,e[5]=z):z=e[5];const{composerThinkingEffort$:st,setThinkingEffort:We}=z,Q=Ee(st),Re=(b==null?void 0:b.id)===$a&&Q&&at&&(c==null?void 0:c.systemHint)!==Z.Agent&&(c==null?void 0:c.systemHint)!==Z.Research;let W;e[6]!==n||e[7]!==te||e[8]!==b||e[9]!==Re||e[10]!==Le?(W=()=>{var zt;if(!b||!Le&&!Re)return[null];if(Va(te).id===b.id)return[null];const pt=Un(n),Et=pt.categories.find(jt=>{var ie;return jt.defaultModel===b.id||((ie=jt.supportedModels)==null?void 0:ie.includes(b.id))});if(Et)return[(zt=Et.actionPillShortName)!=null?zt:Et.label];const Lt=pt.groups.find(jt=>jt.modelIds.includes(b.id));return Lt?[Lt.label,b.title]:[b.title||b.id]},e[6]=n,e[7]=te,e[8]=b,e[9]=Re,e[10]=Le,e[11]=W):W=e[11];const[je,Fe]=Ee(W);let ve;e[12]!==o?(ve=ai(o),e[12]=o,e[13]=ve):ve=e[13];const Ne=Ee(ve.isWhisperActive$),G=ii(Rf);let le;e[14]!==G?(le=ri(),e[14]=G,e[15]=le):le=e[15];const H=d||le,ne=D&&!H;let ue;e[16]!==o||e[17]!==v?(ue=()=>(Ol()||v)&&!On(o),e[16]=o,e[17]=v,e[18]=ue):ue=e[18];const y=Ee(ue),k=eo(),oe=v&&"text-sm shadow-none! dark:border-token-border-heavy border-t border-gray-100 rounded-none";let w;e[19]!==oe?(w=ut(oe),e[19]=oe,e[20]=w):w=e[20];let q;e[21]!==o||e[22]!==ke||e[23]!==Ne||e[24]!==l||e[25]!==ne?(q=s.jsx(_u,{children:Ne?s.jsx("div",{className:"max-w-full min-w-0 flex-1",children:s.jsx(bu,{composerController:o,className:"h-14"})}):s.jsx(xu,{composerController:o,placeholder:l,fontSize:ke,enableRotatingPlaceholders:ne})}),e[21]=o,e[22]=ke,e[23]=Ne,e[24]=l,e[25]=ne,e[26]=q):q=e[26];let X;e[27]!==J?(X=J&&s.jsx(da,{children:J}),e[27]=J,e[28]=X):X=e[28];let C;e[29]!==A?(C=A&&A.length>0&&s.jsx(wn,{children:s.jsx(lu,{replyRegions:A})}),e[29]=A,e[30]=C):C=e[30];let K;e[31]!==(c==null?void 0:c.systemHint)||e[32]!==H||e[33]!==r||e[34]!==G?(K=H&&s.jsx(wn,{children:s.jsx(cu,{files:r,selectedApps:G,activeSystemHintType:c==null?void 0:c.systemHint,className:"no-scrollbar horizontal-scroll-fade-mask flex flex-nowrap gap-2 overflow-x-auto px-2.5 pt-2.5 pb-1.5 [--edge-fade-distance:1rem]"})}),e[31]=c==null?void 0:c.systemHint,e[32]=H,e[33]=r,e[34]=G,e[35]=K):K=e[35];let de;e[36]!==S?(de=S&&s.jsx(wn,{children:s.jsx(yu,{})}),e[36]=S,e[37]=de):de=e[37];let Oe;e[38]!==P?(Oe=P&&s.jsx(Su,{children:P}),e[38]=P,e[39]=Oe):Oe=e[39];let Be;e[40]!==k||e[41]!==R?(Be=!k&&(R==null?void 0:R.map(vf)),e[40]=k,e[41]=R,e[42]=Be):Be=e[42];let ce;e[43]!==o||e[44]!==te||e[45]!==b||e[46]!==k||e[47]!==Re||e[48]!==Q||e[49]!==je||e[50]!==Fe||e[51]!==$||e[52]!==We||e[53]!==Le?(ce=!k&&Re&&je?s.jsx(Mn,{children:s.jsx(du,{thinkingEffort:Q,onChangeThinkingEffort:pt=>{We(pt),qa(te).mutate({modelSlug:b.id,thinkingEffort:pt})},modelLabel:je,modelSlug:b.id,onRemoveModel:$,onCloseAutoFocus:pt=>{za(te).composer.autofocusDisabled$()||(pt.preventDefault(),Wt(Je(o)))}})},"effort-selector"):!k&&Le&&je?s.jsx(Mn,{children:s.jsx(uu,{label:je,tooltipLabel:Fe,onRemoveModel:$})},"active-model-pill"):null,e[43]=o,e[44]=te,e[45]=b,e[46]=k,e[47]=Re,e[48]=Q,e[49]=je,e[50]=Fe,e[51]=$,e[52]=We,e[53]=Le,e[54]=ce):ce=e[54];let me;e[55]!==V||e[56]!==c||e[57]!==Xe||e[58]!==n.id||e[59]!==ee||e[60]!==k||e[61]!==F||e[62]!==g||e[63]!==j||e[64]!==fe?(me=!k&&(c!=null?c:Xe)&&!ee&&s.jsx(Mn,{children:s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(mu,{clientThreadId:n.id,activeSystemHint:c,activeSystemHintType:Xe,activeConnectorSystemHints:V!=null?V:[],locked:g,onRemoveSystemHint:j}),fe&&s.jsx(pu,{disabled:F})]})},"active-hint-tag"),e[55]=V,e[56]=c,e[57]=Xe,e[58]=n.id,e[59]=ee,e[60]=k,e[61]=F,e[62]=g,e[63]=j,e[64]=fe,e[65]=me):me=e[65];let he;e[66]!==Y?(he=Y&&s.jsx(da,{children:Y}),e[66]=Y,e[67]=he):he=e[67];let Ge;e[68]!==c||e[69]!==(L==null?void 0:L.connection_statuses)||e[70]!==n.id||e[71]!==te||e[72]!==b||e[73]!==k||e[74]!==_?(Ge=!k&&c&&b&&s.jsxs(Ln,{children:[s.jsx(wf,{activeSystemHint:c!=null?c:void 0,clientThreadId:n.id,connectionStatuses:L==null?void 0:L.connection_statuses,currentModelConfig:b}),(c==null?void 0:c.systemHint)===Z.Agent&&Nl(te)&&s.jsx(fu,{clientThreadId:n.id,activeSystemHintType:c.systemHint,layoutMode:_})]},"sources-tag"),e[68]=c,e[69]=L==null?void 0:L.connection_statuses,e[70]=n.id,e[71]=te,e[72]=b,e[73]=k,e[74]=_,e[75]=Ge):Ge=e[75];let nt;e[76]!==(c==null?void 0:c.systemHint)||e[77]!==o||e[78]!==k?(nt=!k&&(c==null?void 0:c.systemHint)===Z.PictureV2&&s.jsx(Ln,{children:s.jsx(hu,{composerController:o})},"image-style-picker"),e[76]=c==null?void 0:c.systemHint,e[77]=o,e[78]=k,e[79]=nt):nt=e[79];let Ve;e[80]!==o||e[81]!==k||e[82]!==y?(Ve=!y&&!k&&s.jsx(Cu,{composerController:o,composerType:"composer-btn"}),e[80]=o,e[81]=k,e[82]=y,e[83]=Ve):Ve=e[83];let Ze;e[84]!==o||e[85]!==n.id||e[86]!==I||e[87]!==xe||e[88]!==m||e[89]!==f||e[90]!==Ne||e[91]!==h||e[92]!==u?(Ze=!Ne&&s.jsx(gu,{forceStopButton:xe,inputState:f,state:u,onSubmit:h,composerController:o,clientThreadId:n.id,gizmoId:m,disableReason:I}),e[84]=o,e[85]=n.id,e[86]=I,e[87]=xe,e[88]=m,e[89]=f,e[90]=Ne,e[91]=h,e[92]=u,e[93]=Ze):Ze=e[93];let mt;e[94]!==Ve||e[95]!==Ze?(mt=s.jsxs(Tu,{children:[Ve,Ze]}),e[94]=Ve,e[95]=Ze,e[96]=mt):mt=e[96];let xt;return e[97]!==o||e[98]!==re||e[99]!==x||e[100]!==U||e[101]!==Se||e[102]!==ye||e[103]!==p||e[104]!==h||e[105]!==w||e[106]!==q||e[107]!==X||e[108]!==C||e[109]!==K||e[110]!==de||e[111]!==Oe||e[112]!==Be||e[113]!==ce||e[114]!==me||e[115]!==he||e[116]!==Ge||e[117]!==nt||e[118]!==mt?(xt=s.jsxs(Au,{isTemporaryChat:p,isDeveloperMode:Se,isNewConversation:ye,composerController:o,expanded:U,expandOnMultilineInput:x,onSubmit:h,backgroundClassName:w,disableMotion:re,children:[q,X,C,K,de,Oe,Be,ce,me,he,Ge,nt,mt]}),e[97]=o,e[98]=re,e[99]=x,e[100]=U,e[101]=Se,e[102]=ye,e[103]=p,e[104]=h,e[105]=w,e[106]=q,e[107]=X,e[108]=C,e[109]=K,e[110]=de,e[111]=Oe,e[112]=Be,e[113]=ce,e[114]=me,e[115]=he,e[116]=Ge,e[117]=nt,e[118]=mt,e[119]=xt):xt=e[119],xt};function Rf(t){return t.selectedApps}function vf(t,e){return s.jsx(Ln,{children:t},"legacy-footer-action-".concat(e))}const Nf=Qe(()=>Ye(()=>import("./e9gtc6k4kfmwzcn1.js"),__vite__mapDeps([18,1,2,3,0,4])).then(t=>t.ConnectorsOnboardingModal)),Of=Qe(()=>Ye(()=>import("./j0yo6uv6652vva62.js").then(t=>t.z6),__vite__mapDeps([0,1,2,3,4])).then(t=>t.TatertotNuxModal)),Bf=Qe(()=>Ye(()=>import("./b4xre65mpwtmpsm5.js"),__vite__mapDeps([19,1,2,3,0,4,20])).then(t=>t.GithubOnboardingModal)),Df=()=>null;function Lf({onCreateNewCompletion:t,onContinueGenerating:e,account:n,currentModelId:o,currentModelConfig:r,disableDraftPersistence:d=!1,conversation:l,isNewThread:i,isCompletionInProgress:p,disabled:u=!1,disabledReason:f,canPause:I=!1,canContinue:b=!1,isInteractableSharedThread:m,headerClassName:A,hideHeader:S,onlyAllowImageUploads:h,layoutMode:P,availableSystemHints:R,isSnorlaxEnabledForGizmo:c,gizmoId:V,hydratedConversationModeWithGizmoOverridePayload:B}){"use no forget";var wo,Mo,Ro,vo,No,Oo,Bo,Do;ua.markStart("PromptTextarea"),ua.markRendered("PromptTextarea");const g=tt(),[j,$,L,J]=B,[U,x]=vr(),_=Wn();ku(_),Iu();const M=Hn(),Y=n==null?void 0:n.isSelfServeBusiness(),ge=n==null?void 0:n.isEnterprisey(),pe=n==null?void 0:n.isEnterpriseCBP(),D=n==null?void 0:n.isEdu(),ee=Us(g),fe=zs(),F=Pt(),xe=Wa(),te=Bl(),v=Pu.useStore(),ae=Xl(),Se=(wo=Y||ge||pe||D)!=null?wo:!1,[ye,Xe,we,Le,at,ke,re]=Bt(l.id,a=>{var E,N,be,Ue,$e,kt;return[ht.getCurrentLeafId(a),ht.getRequestId(a),ht.findAsyncTaskMetadataNode(a),(be=(N=(E=ht.lastUserMessage(a))==null?void 0:E.metadata)==null?void 0:N.system_hints)==null?void 0:be.includes(Z.Agent),!!(a!=null&&a.interruptionInProgress)&&!!(($e=(Ue=ht.getCurrentNode(a))==null?void 0:Ue.message.metadata)!=null&&$e.n7jupd_message),a==null?void 0:a.startedWithByoMcp,(kt=ht.getCurrentNode(a))==null?void 0:kt.message]}),z=ma(a=>{var E,N;return(E=re==null?void 0:re.metadata)!=null&&E.async_completion_id&&(re==null?void 0:re.status)==="in_progress"?a.tasks[(N=re.metadata.async_task_id)!=null?N:""]:null}),st=T.useMemo(()=>{var a;return!!((a=re==null?void 0:re.metadata)!=null&&a.async_completion_id&&(re==null?void 0:re.status)==="in_progress"&&(z==null?void 0:z.status)!==pa.CANCELLED)},[re,z]),We=Bt(l.id,ht.getSteeringAsyncTaskId),Q=!!We,Re=Eu({clientThreadId:l.id,isKaur1br5Client:fe}),W=T.useMemo(()=>Q?[]:R,[Q,R]),{gizmoEditorData:je,mode:Fe,getGizmoId:ve}=Dl(),Ne=Ll(),G=Ja(),le=ju(),se=Ra(l.id),H=!!Fl(),ne=wu.useIsEnabled(l.id),ue=!!Ks(),y=Qn(),k=T.useMemo(()=>{var a;return(a=y&&(W==null?void 0:W.find(E=>E.systemHint===y)))!=null?a:null},[W,y]),oe=Gl(),w=Ee(()=>Hl(g)),q=Ea(),X=y===Z.Agent||(k==null?void 0:k.systemHint)===Z.Agent,C=St(g,"3269508448"),K=fe&&X&&C,{agentSessionModeNuxModal:de,ensureAgentSessionModeNux:Oe}=Mu({isAgentHintActive:X,isAgentSessionModeDropdownEnabled:K});Ru(_);const Be=vu(g),ce=Vs(ps.hasSeenAgentModeAnnouncementBanner),me=Wl(g),he=Ys(Dt),Ge=Ul(g),nt=Nu(g),Ve=Ee(()=>!$l()&&!zl()),Ze=ql(g).getLayer("3081064739"),mt=!nt&&!me&&Ve&&Ze.get("composer-plus-menu",!1),xt=T.useRef(!1),pt=St(g,"3457598265");T.useEffect(()=>{if(!pt||!Ge||!he||xt.current)return;const a=Je(_),E=a==null?void 0:a.dom;if(!E)return;const N=()=>{if(xt.current)return;xt.current=!0;const be=[];k&&be.push(k.systemHint),Bc(void 0,ba,be,l.id).catch(()=>{})};return E.addEventListener("input",N,{once:!0}),()=>{E.removeEventListener("input",N)}},[Ge,_,he,pt,k,l.id]);const Et=Bn.useStore(),Lt=Bn.useState(({locked:a})=>a),zt=Vl(),jt=Jl(g),{connectionInstanceData:ie,isLoading:ze}=Jn({skip:!zt}),{selectedSources:Ce,selectedMCPSources:De,addSource:rt}=oi(l.id),lt=Kl();T.useEffect(()=>{const a=U.get("add_source");a&&y&&(rt(a),U.delete("add_source"),x(U))},[y,rt,U,x]),T.useEffect(()=>{W!=null&&W.some(a=>a.systemHint===Z.Glaux)&&U.get("company-knowledge")!=null&&(is(g,Nf,{onContinue:()=>{oe(Z.Glaux,{analyticsMetadata:{clientThreadId:l.id}})}}),U.delete("company-knowledge"),x(U))},[U,W,g,l.id,oe,x]);const{eligible:O,isLoading:Ie}=Vs(ps.hasSeenTatertotNux);T.useEffect(()=>{y===Z.Tatertot&&St(g,"1586944302")&&O&&!Ie&&is(g,Of)},[y,O,Ie,g]);const Te=Ou(g),Pe=Te&&(((Mo=De==null?void 0:De.size)!=null?Mo:0)>0||ae||lt.size>0);Yl({skip:!Te,productSku:Nn.PROMPT_TEXT_AREA});const{platformConnectors:Me,isLoading:Ae}=Ql(Pe,Nn.PROMPT_TEXT_AREA),[Ke,et]=T.useState(!1);T.useEffect(()=>{et(!1)},[ae,i]);const ot=Yn(g),ct=Kn(g);Zl({platformConnectors:Me,enabled:ct.length>0&&Se});const At=T.useMemo(()=>Array.from(De!=null?De:[]).map(a=>Me.get(a)).filter(a=>a!==void 0),[De,Me]),{selectedConnectorIds:wt,selectedSyncKnowledgeStoreIds:qt}=T.useMemo(()=>{var N;if(!ot)return{selectedConnectorIds:void 0,selectedSyncKnowledgeStoreIds:void 0};const a=new Set,E=new Set;for(const be of Ce!=null?Ce:[]){const Ue=Yt[be];Ue&&a.add(Ue);const $e=(N=ie==null?void 0:ie.connection_statuses)==null?void 0:N.find(kt=>kt.user_connection_details.connection_type===be);$e&&E.add($e.user_connection_details.connection_instance_id)}return{selectedConnectorIds:a,selectedSyncKnowledgeStoreIds:E}},[Ce,ie==null?void 0:ie.connection_statuses,ot]),rs=T.useRef(0),Qt=as(g,"3396794266").get("restore_prompt_on_stop",!1),Xt=T.useRef(null),fi=Bu(),hi=Du(),en=Lu(l.id)&&!st,gi=T.useCallback(()=>{const a=Fu(g);a.isFeedbackModalOpen$()&&a.feedbackModalState$().type!==fa.FeedbackConversation&&a.feedbackModalState$.set({type:fa.FeedbackConversation})},[g]),Zt=Wo(r,j,y),tn=ec(),gs=tc(g).flags,_s=gs==null?void 0:gs.includes(sc.NoAuthEnableFileUploads),_i=W==null||W.length>0,bi=T.useMemo(()=>{var a;return(a=W==null?void 0:W.filter(E=>lt.has(E.systemHint)))!=null?a:[]},[W,lt]),xi=T.useMemo(()=>{const a=Array.from(lt).filter(N=>N.startsWith("connector:")).map(N=>N.replace(/^connector:/,""));if(a.length===0)return[];const E=a.filter(N=>{var be,Ue;return ha(N)?!0:(Ue=(be=Me.get(N))==null?void 0:be.conformance)==null?void 0:Ue.implements_retrievable});return Array.from(new Set(E))},[lt,Me]),yi=T.useMemo(()=>Array.from(lt).filter(a=>a.startsWith("connector:")).map(a=>a.replace(/^connector:/,"")).filter(a=>{var E,N;return!((N=(E=Me.get(a))==null?void 0:E.supports_full_actions)!=null&&N)&&!ha(a)}),[lt,Me]),sn=T.useCallback(()=>{oe(null,{analyticsMetadata:{clientThreadId:l.id}})},[oe,l.id]),nn=Ee(()=>Va(g).id),bs=T.useCallback((a,E)=>{gt.logEventWithStatsig("Model Switcher Model Changed","chatgpt_model_switcher_model_changed",{from:o,to:a,location:E}),a&&!nc(g,a)&&(St(g,"1333611684")?qa(g).mutate({modelSlug:a}):oc(g,a)),ac(l,a),Uo(l.id)},[o,g,l]),to=T.useCallback(a=>{ic()&&(a==null||a.preventDefault()),bs(nn,"remove non-default model")},[bs,nn]),xs=ni(o,(Ro=k==null?void 0:k.systemHint)!=null?Ro:null),Si=xs&&C,Ci=!u&&Zt!==kn.None&&(ee||_s),Mt=rc(r,j),ys=lc(r,j),Ft=$o(a=>Fe==="magic"?a.files.filter(E=>E.gizmoId!=null):a.files.filter(E=>E.gizmoId==null),va),[on]=T.useState(()=>Gu()),Ti=Hu(),an=Ft.length>0||Ti,rn=$o(cc.hasUploadInProgress),Ai=ii(a=>a.selectedApps),so=ri(),ki=Wu(l.id),Ii=T.useMemo(()=>$s(()=>Uu(r,dc(_))),[r,_]),ln=Ee(Ii),Ss=Ee(()=>On(_)),no=!Ss,oo=!ln&&!rn&&(no||an),{composerThinkingEffort$:Pi}=Ua(_),{maxUploads:Ei,remaining:ao,baseLimit:ji}=uc(Zt),io=Math.max(0,Ei-Ft.length),cn=io<=0,wi=ao!=null&&ao<ji,Mi=(k==null?void 0:k.systemHint)===Z.Research,Ri=St(g,"3544641259"),{selectedRepos:dn}=$u(l.id),ro=(Mi||xs)&&Ri&&(Ce==null?void 0:Ce.size)===0&&(De==null?void 0:De.size)===0,lo=(vo=we==null?void 0:we.message.metadata)==null?void 0:vo.async_task_id,Gt=ma(a=>lo?a.tasks[lo]:null),co=zu({taskId:z==null?void 0:z.taskId,intl:F,toaster:xe}),Cs=(Gt==null?void 0:Gt.status)===pa.RUNNING&&!en,uo=(Oo=qu((No=In(l.id))!=null?No:l.id))==null?void 0:Oo.value,vi=uo===zo.STREAMING,mo=uo===zo.REALTIME,Ts=p&&I||vi||mo||Cs||st,As=oo&&!u&&!ue&&(!Ts||en)&&!ro,{targetedContent:ks,setTargetedContent:Is}=Vu(),He=ks!=null&&ks.isFocusedViewContent&&!le?void 0:ks,Ps=za(g);T.useEffect(()=>{!He||Ps.composer.autofocusDisabled$()||requestAnimationFrame(()=>requestAnimationFrame(()=>{Wt(Je(_))}))},[He,Ps,_]);const{getUpsellLabelType:Ni,getUpsellShowsAttach:Oi}=Ju(),un=Ee(()=>Vn(g)),{isSingleLine:Bi,plusButtonAddsFiles:Di,loggedOutAttachLabel:Li,loggedOutHideToolButtons:mn,isImageGenButtonEnabled:Fi,showSelectedModelInComposer:Gi}=un,Nt=Bi,Hi=_i&&ee&&(!Y||!ze)&&!qo(y)&&!Nt,ls=Ee(ai(_).isWhisperActive$),Wi=T.useCallback(()=>{x(a=>(a.delete("share_prompt"),a))},[x]),pn=T.useCallback(a=>{if(Ma.set(l,!0),Ns(Je(_),a.prompt),a.system_hint){const E=a.system_hint;if(oe(E),a.sources){const N=a.sources.map($e=>$e.trim()).filter(Rn),be=new Set(N.filter($e=>!Ut($e))),Ue=new Set(N.filter(Ut));Kt(l.id,$e=>{$e.selectedSources=new Map([[E,be]]),$e.selectedMCPSources=new Map([[E,Ue]]),$e.hasModifiedSources=!0})}}},[l,_,oe]);Ku(g,U.get("share_prompt"),Wi,pn),T.useEffect(()=>{!w||w.skipConversationId===l.id||(mc(g),Vo(Je(_)),pn(w.prompt))},[_,l.id,g,pn,w]),T.useEffect(()=>{if(!(M!=null&&M.id))return;const a=ga.getAndReset(M.id,se);a&&Ns(Je(_),a.inputText)},[M==null?void 0:M.id,se,_]),T.useEffect(()=>{var E;const a=(E=U.get("prompt"))!=null?E:"";On(_)&&a.length>0&&Ns(Je(_),a)},[_,U]);const fn=T.useCallback(()=>{y!==Z.Slurm&&y!=null&&!(W!=null&&W.some(a=>a.systemHint===Z.Slurm))||(k==null&&oe(Z.Slurm),Kt(l.id,a=>{var N,be;const E=(be=(N=a.selectedSources)==null?void 0:N.get(Z.Slurm))!=null?be:new Set;a.selectedSources==null&&(a.selectedSources=new Map),a.selectedSources.set(Z.Slurm,new Set([...E,qe.GITHUB_CONNECTOR]))}))},[y,k,l.id,oe,W]);T.useEffect(()=>{if(U.has("github_onboarding")){const a=U.get("github_onboarding");let E=cs.ConfigureRepos;a&&[cs.ConfigureRepos,cs.SyncRepos,cs.IndexRepos].includes(a)&&(E=a),jt&&E!==cs.ConfigureRepos?fn():is(g,Bf,{initialState:E,onFinishFlow:fn}),x(N=>(N.delete("github_onboarding"),N))}},[U,x,g,y,k,l.id,oe,W,fn,jt]),T.useEffect(()=>{const a=pc(U,{availableHints:W}),E=y!=null?y:a[0],N=E===Z.Slurm,be=E===Z.Research,Ue=E===Z.ApiTool;if(!N&&!be&&!Ue)return;const $e=U.getAll("sources");if(!$e.length)return;const kt=U.get("redirect_source");if(Ue)for(const dt of $e)q(dt.trim());else{const dt=$e.map(Ht=>Ht.trim()).filter(Rn),ts=new Set(dt.filter(Ht=>!Ut(Ht))),ss=new Set(dt.filter(Ut));Kt(l.id,Ht=>{Ht.selectedSources=new Map([[E,ts]]),Ht.selectedMCPSources=new Map([[E,ss]]),Ht.hasModifiedSources=!0})}x(dt=>(dt.delete("sources"),dt)),kt==="suggested_ca_prompts"&&gt.logEventWithStatsig("chatgpt_contextual_answers_connector_activated","chatgpt_contextual_answers_connector_activated",{source:"suggested_ca_prompts"})},[l.id,rt,U,oe,x,y,q,W]);const Ct=fc(r,j),hn=Ee(hc(g,l.id)),{handleFileAccepted:po}=ep(F,Wo(r,j,y),Mt,"mouse",ve,Ct==null?void 0:Ct.attachments,hn),Ui=T.useCallback((a,E)=>{const N=ns(g);return N.keepSheetOpen$.set(!1),N.isSheetOpen$.set(!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{Wt(Je(_))})}),po(a,E)},[_,po,g]),fo=Ee(ns(g).keepSheetOpen$);T.useEffect(()=>{if(!fo)return;const a=new AbortController,E=document.getElementById("upload-camera"),N=[];function be(){for(const dt of N)dt();a.abort(),N.length=0}function Ue(dt){var ss;if(dt.target instanceof HTMLInputElement&&((ss=dt.target.files)==null?void 0:ss.length)===0)return;const ts=ns(g);ta(()=>{ts.keepSheetOpen$.set(!1),ts.isSheetOpen$.set(!1),be()})}function $e(){const dt=ns(g);ta(()=>{dt.keepSheetOpen$.set(!1),dt.isSheetOpen$.set(!1),be()})}E&&N.push(Jo(E,{change:Ue,cancel:$e}));const kt=document.getElementById("upload-photos");return kt&&N.push(Jo(kt,{change:Ue,cancel:$e})),be},[fo,g]);const Ot=!u&&!cn&&Ci&&tn==null&&!Q,{getInputProps:$i,open:ho}=sp(_t({disabled:!Ot,noClick:!0,onFileDialogCancel:()=>{ns(g).keepSheetOpen$.set(!1)},onDropAccepted:Ui,onDropRejected:a=>{tp(a,F,xe,Zt),ns(g).keepSheetOpen$.set(!1)},multiple:!0,maxSize:_c,maxFiles:io},gc(!ee||h?Mt:ys))),Vt=T.useCallback(()=>{Ot&&(gt.logEventWithStatsig("Open File Viewer","chatgpt_web_file_viewer_opened",{intent:Zt.toString()}),ho())},[Ot,ho,Zt]),go=bc(on),gn=T.useCallback(()=>{Vo(Je(_)),go.clearMessages(),_a(_).resetData();for(const a of Ft)Os.remove(te,a.tempId,"none");Yu.markAllAsSent()},[_,go,Ft,te]),zi=T.useMemo(()=>{if(he)return ba;if(me)return Qu;if(zs())return Xu},[he,me]),_o=Ee(()=>he&&Ge&&Ko.sidebarUrlTrayOpen$());Zu();const qi=xc(g),{systemHints:_n}=Ka(),bn=Pn((a,E,N)=>{var Lo;if(a.preventDefault(),u||!oo&&!E||!j||at)return;if(!(N!=null&&N.bypassAgentSessionModeGate)){const ft=Jt(_t({},N!=null?N:{}),{bypassAgentSessionModeGate:!0});if(Oe(()=>bn(a,E,ft))){"persist"in a&&typeof a.persist=="function"&&a.persist();return}}const be=Yo(Je(_).state.doc),Ue=be.content;Tn==="streaming"&&(gt.logEventWithStatsig("chatgpt_web_conversation_stream_interrupted","chatgpt_web_conversation_stream_interrupted",{interrupted_message_length:Ue.length}),En.count(jn.DEFAULT,"chatgpt_web_conversation_stream_interrupted",[])),En.count(jn.DEFAULT,"chatgpt_web_conversation_completion_sent",[]);const{content:$e,attachments:kt}=em(te,Ue,r,j,y),dt=Qo(Et).some(ft=>ft===Z.Slurm||ft===Z.Research);Kt(l.id,ft=>{ft.hasModifiedSources=!1,ft.hasModifiedGithubRepos=!1,ft.startedWithByoMcp===void 0&&dt&&(ft.startedWithByoMcp=At.some(Rs=>Rs.status==="ONLY_ME"))}),fi(),hi(),gi();const ts=xa.getState().attachedTempTextdocs;Qt?Xt.current={content:be.content,files:Ft.map(ft=>_t({},ft)),attachedTempTextdocs:Object.fromEntries(Object.entries(ts).map(([ft,Rs])=>[ft,_t({},Rs)])),systemHintType:y!=null?y:null,selectedSources:Ce?[...Ce]:void 0,selectedMCPSources:De?[...De]:void 0}:Xt.current=null;const ss=o===$a?yc(Pi):void 0;t(_t({clientThreadId:l.id,ctx:g,sourceEvent:a,attachments:kt,content:$e,contentToSend:be,conversationMode:j,hasSelectedApps:so,isMessageFollowupsEnabled:ne,selectedApps:Ai,desktopOrigin:zi,shouldCollectSidebarContext:_o,desktopSidebarContext:Ko.context$(),selectedGizmoTag:L,selectedRepos:{selectedAllRepos:dn.selectedAllRepos,selectedRepos:dn.selectedRepos?[...dn.selectedRepos]:null},selectedSources:Ce,selectedMCPConnectors:At,selectedConnectorIds:wt,selectedSyncKnowledgeStoreIds:qt,searchConnectorIds:xi,noFullActionConnectorIds:yi,startedWithByoMcp:ke===!0,systemHints:Qo(Et),allSystemHints:_n!=null?_n:[],isN7jupdActive:Si,isForceAllowCustomMcpModeEnabled:qi,thinkingEffort:ss},_a(_).getData(be.content))),(Lo=He==null?void 0:He.onCreateCompletion)==null||Lo.call(He,{serverThreadId:se,currentLeafId:ye}),(He==null?void 0:He.shouldPersistAcrossMessages)!==!0&&Is(void 0),ya.hideThreadHeader();for(const ft of Ft)ft.status===Sc.Ready&&v.addFile(ft);as(g,"1925940714").get("reset_state_after_submit",!1)?Cc.postTask(gn):gn(),Be&&y===Xo&&ce.markAsViewed()}),Vi=a=>{Is(a.targetedReply),a.targetedReply&&gt.logEventWithStatsig("Targeted Reply Button Clicked","chatgpt_targeted_reply_button_clicked",{conversationId:se,sourceMessageId:a.messageId})},{maybeSetWaitingForRealtimeOnAbort:bo,isWatingForRealtimeStatusChange:Ji}=tm(l.id),xn=T.useCallback((a,E="other")=>{bo(),sm(a,void 0,{clientInitiated:!0,reason:E,isLastTurnAgent:Le,hasAgentSystemHint:y===Xo})},[bo,Le,y]),xo=T.useCallback(()=>{var a;(a=He==null?void 0:He.onCleared)==null||a.call(He,{serverThreadId:se,currentLeafId:ye}),Is(void 0),Wt(Je(_))},[ye,se,He,Is,_]),Es=Tc(g,r==null?void 0:r.tags,j==null?void 0:j.kind),{autocompletions$:Ki,shouldShowAutocomplete$:js}=Ya(_),Yi=T.useCallback(()=>js()&&i,[js,i]),yo=Pn(a=>nm(a,{toaster:xe,canSubmit:As,isTextContentTooLong:ln,requestCompletion:bn})),Qi=Cs||mo,So=Pn(a=>om(a,{canAbortCompletion:I&&p&&!Qi,clientThreadId:l.id,isAutocompletionActive:Yi,clearAutocompletions:()=>Ki.set([]),abortCompletion:()=>xn(l.id,"escape_key"),isEmpty:Ss,hasTargetedContent:He!=null,clearTargetedContent:xo,hasSystemHint:k!=null,removeSystemHint:sn,hasSelectedTarget:L!=null,removeSelectedTarget:()=>J(null),hasNonDefaultModel:Gi&&o!==nn,removeNonDefaultModel:to}));T.useEffect(()=>{if(!As)return;St(g,"4178431533")||am(!0).then(E=>{im.startEnforcement(E),rm.startEnforcement(E)})},[As,g]),T.useEffect(()=>Ac(Je(_),{Enter:yo,Escape:So}),[_,yo,So]);const Xi=a=>{Q||Fm({filePickerStore:te,event:a.nativeEvent,intl:F,toaster:xe,clientThreadId:l.id,conversationMode:j,currentModelConfig:r,getEditorGizmoId:ve,modelSupportedImageMimeTypes:Mt,activeSystemHintType:y,ctx:g,contextScopes:hn})},Zi=kc(l.id,on,Mt,Ct==null?void 0:Ct.attachments),er=T.useCallback((a,E)=>{if(a.preventDefault(),st){co.mutate();return}xn(l.id,E),gt.logEventWithStatsig("Pause Completion","chatgpt_pause_completion",{threadId:In(l.id),currentLeafId:ht.getCurrentNode(vn(l.id)).message.id,eventSource:"mouse"});const N=Xt.current;Qt&&N&&(Ns(Je(_),N.content),Os.restoreFiles(te,N.files),xa.setState({attachedTempTextdocs:N.attachedTempTextdocs}),N.systemHintType&&(oe(N.systemHintType),Kt(l.id,be=>{var Ue,$e;N.selectedSources&&(be.selectedSources=(Ue=be.selectedSources)!=null?Ue:new Map,be.selectedSources.set(N.systemHintType,new Set(N.selectedSources))),N.selectedMCPSources&&(be.selectedMCPSources=($e=be.selectedMCPSources)!=null?$e:new Map,be.selectedMCPSources.set(N.systemHintType,new Set(N.selectedMCPSources)))})),Xt.current=null),lm()},[l.id,xn,_,te,oe,Qt,st,co]),Co=T.useCallback(()=>{ga.set(M==null?void 0:M.id,se,cm(_))},[se,M==null?void 0:M.id,_]),To=je!=null;T.useEffect(()=>{To||Ps.composer.autofocusDisabled$()||Wt(Je(_))},[_,To,Ps]);const Ao=Ws(Ft);T.useEffect(()=>{var E;if(Mt.length>0)for(const N of Ao.current)dm((E=N.fileSpec)==null?void 0:E.mimeType,ys)||Os.remove(te,N.tempId,"none");else Os.reset(te)},[o,te,ys,Mt.length,Ao]),T.useEffect(()=>{(!Es&&L||H)&&J(null)},[Es,L,H,J]);const yn=Ee(()=>um(l).fullscreenWidgetPlaceholder$(F)),tr=Xm(),[ws,sr]=(()=>{const a=f?mm(f):void 0;if(a)return[a.placeholder,a.isLastingDisabledStyle];if(m)return[bt.placeholderWithName,!1];if((He==null?void 0:He.placeholderTextOverride)!=null)return[He.placeholderTextOverride,!1];if((r==null?void 0:r.id)===Ic)return[bt.n7jupdSystemHintPlaceholder,!1];if(k){if(qo(k.systemHint))return Ts?[bt.n7jupdActivePlaceholder,!1]:[bt.n7jupdSystemHintPlaceholder,!1];switch(k.systemHint){case Z.Search:return[bt.searchPlaceholder,!1];case Z.Think:return[bt.thinkPlaceholder,!1];case Z.Slurm:return[bt.connectorPlaceholder,!1];case Z.ApiTool:return[bt.apiToolPlaceholder,!1];case Z.Research:return[bt.researchPlaceholder,!1];case Z.Canvas:return[bt.canvasPlaceholder,!1];case Z.Picture:return[bt.picturePlaceholder,!1];case Z.PictureV2:return[bt.pictureV2Placeholder,!1];case Z.Tatertot:return[bt.tatertotPlaceholder,!1];case Z.Glaux:return[bt.internalSearchPlaceholder,!1]}}return[bt.placeholderAskAnythingVariant,!1]})(),ko=eo(),nr=an||so,or=un.dynamicPlaceholderEnabled,ar=i&&or&&!ko&&!c&&!yn&&!nr&&!rn,ir=(()=>{var a,E;return ko?F.formatMessage(pm):c?i?F.formatMessage(fm.newChatInProject,{projectName:(a=$==null?void 0:$.gizmo.display.name)!=null?a:"this project"}):ws?F.formatMessage(ws,{name:"ChatGPT"}):"​":yn||(ws?F.formatMessage(ws,{name:je!=null?Fe==="magic"?Pc:je.name||"GPT":(E=$==null?void 0:$.gizmo.display.name)!=null?E:"ChatGPT",workspaceName:tr}):"​")})();T.useEffect(()=>Zo(()=>ea(_),()=>{rs.current=performance.now(),hm(g).getState().isThreadHeaderVisible&&ya.hideThreadHeader(),gm(l.id)&&_m(l.id)}));const{shouldHighlight$:rr}=bm(_),Sn=Ee(()=>rr()),{connectorConfig:Ms,isLoading:lr}=Ec(),{onSelectConnector:Cn}=xm({connectorConfig:Ms,modelSupportedImageMimeTypes:Mt,modelAcceptedMimeTypes:ys,attachmentsProductFeature:Ct==null?void 0:Ct.attachments,onOauthRedirect:Co});ym(Ms,Cn);let Io=null;const Po=Oi(),cr=ee||Po||_s,es=Zt===kn.None?Ds.ModelNotSupported:cn&&wi?Ds.RateLimitReached:cn?Ds.HasReachedMaxFiles:tn!=null?Ds.RateLimitReached:void 0,dr=s.jsx("div",{"data-testid":"composer-action-file-upload",style:{viewTransitionName:"var(--vt-composer-attach-file-action)"},children:s.jsx(ef,{clientThreadId:l.id,modelSupportedImageMimeTypes:Mt,openFileDialog:Vt,historyDisabled:G,highlightTooltip:Sn,isLoadingConnectors:lr,connectorConfig:Ms,onSelectConnector:Cn,showLabel:Ni()==="all"&&(Us(g)||Li),showUpsell:Po&&!_s,showMenuForNoAuth:_s,isDisabled:!Ot||ls,disabledReason:es,currentModelName:(Bo=r==null?void 0:r.title)!=null?Bo:"",visualTreatment:ee?"composer-btn":"legacy"})},"file-upload-button");T.useEffect(()=>jc(g).addAction({key:"uploadFile",action:Vt,actionMessageDescriptor:Za(g,F,!Ot,es,r==null?void 0:r.title),group:Cm.Chat,keyboardBinding:Sm}),[g,r,es,F,Ot,Vt]);const ur=as(g,"853191128"),mr=V!=null&&V.trim().length>0,pr=!ee&&(!mr||c)&&St(g,"3259514411")&&ur.get("is_tatertot_enabled",!1);Nt&&!Q&&(Io=Di?s.jsx(Tm,{disabled:u,clientThreadId:l.id,rateLimitPopup:tn,highlightTooltip:Sn,label:ee?F.formatMessage({id:"composer.plusMenu.label",defaultMessage:"Add files and more"}):F.formatMessage({id:"composer.plusMenu.label.loggedOut.photosOnly",defaultMessage:"Add photos"}),children:s.jsx(Am,{onClick:Vt,disabled:ls})}):s.jsx(km,{conversation:l,composerController:_,composerDisabled:ls,layoutMode:P,shouldUseBottomSheet:mt,openFileDialog:Vt,modelSupportedImageMimeTypes:Mt,isFileUploadEnabled:Ot,fileUploadDisabledReason:es,currentModelId:o,currentModelConfig:r,selectModelId:bs,connectorConfig:Ms,onSelectConnector:Cn,availableSystemHints:W,activeConnectorSystemHintTypes:lt,activeSystemHintType:y}));const[fr,Eo]=T.useState(!1),hr=sr||Ji?"disabled":"default",gr=!As,_r=Dm({promptDisabledReason:f,hasPendingFiles:rn,hasTextContent:no,isTextContentTooLong:ln,hasAsyncTaskPending:ki,noSourceSelectedDr:!ro,isDeepResearchTaskStreaming:Cs,isThreadHardBlocked:ue}),Tn=Ts?"streaming":gr?"disabled":"idle",br=St(g,"222560275")||o&&!o.startsWith("o1")&&!o.startsWith("o3"),jo=[He!=null&&He.label?{type:He.type,value:He.label,onRemoveRegion:xo}:null,L!=null?{type:"mention",value:L.gizmo.display.name,icon:s.jsx(ti,{isFirstParty:!!((Do=L.gizmo.tags)!=null&&Do.includes(zn.FirstParty)),src:L.gizmo.display.profile_picture_url,className:"icon"}),onRemoveRegion:()=>{J(null),Wt(Je(_))}}:null].filter(a=>a!=null);We&&Gt&&Gt.taskId===We&&jo.push({type:"text",value:Gt.title,hideQuotes:!0,onRemoveRegion:()=>Uo(l.id)});const xr=T.useMemo(()=>$s(()=>i&&(k==null?void 0:k.systemHint)!==Z.Research&&(k==null?void 0:k.systemHint)!==Z.ApiTool&&!xs&&js()),[i,k,xs,js]),yr=a=>{if(a.preventDefault(),a.stopPropagation(),rs.current>0){const E=performance.now()-rs.current;En.hist(jn.DEFAULT,"final_user_input_to_submit_ms",[],E)}Tn==="streaming"&&(!en||Ss)||st?Cs?Eo(!0):er(a,Ss?"stop_button":"stop_button_with_prompt"):(bn(a),et(!0))};T.useEffect(()=>{const a=In(l.id),E=n==null?void 0:n.normalizedAccountUserId;if(!E||d||he||G)return;const N=wc(be=>{if(Mc(be.doc))Rc(a);else{const Ue=Yo(be.doc).content;vc(a,Ue,E)}},1e3);return Zo(()=>ea(_),N)},[n,l.id,_,d,he,G,se]),T.useEffect(()=>{setTimeout(()=>{Nc.addFirstTiming("composer.ttfi")},0)},[]);const Sr=s.jsx(Im,{canUseInlineTagging:Es,isDisabled:u,clientThreadId:l.id,currentLeafId:ye,currentRequestId:Xe,canContinue:b,composerController:_,isNewThread:i,onContinueGenerating:a=>{var E;return e({event:a,conversationMode:(E=vn(l.id))==null?void 0:E.mode,systemHints:y?[y]:[]})},onResetState:gn,openFileDialog:Vt,conversationMode:j}),Cr=!Ts&&j!=null&&br&&Pm.includes(j.kind)&&s.jsx(Em,{conversation:l,onTargetedReply:Vi}),Tr=s.jsx(Gm,{composerController:_,parsedDocumentHandler:Zi}),Ar=!S&&s.jsx(_p,{className:A}),kr=s.jsx(jm,{modelSupportedImageMimeTypes:Mt,uploadType:kn.Multimodal,attachmentsProductFeature:Ct==null?void 0:Ct.attachments,contextScopes:hn}),Ir=St(g,"3127600850"),Pr=[!Nt&&cr?dr:null,null,!ee&&!Nt&&!mn&&!ae?s.jsx(wm,{account:n,clientBootstrapFlags:gs,features:Ne,currentModelConfig:r,isDisabled:ls,clientThreadId:l.id,composerController:_,gizmoId:V}):Hi&&!ae?s.jsx(Mm,{activeSystemHintType:y,systemHints:W,composerController:_,clientThreadId:l.id,disabled:ls}):null,!ee&&!Nt&&!mn&&pr&&!ae?s.jsx(Rm,{composerController:_,clientThreadId:l.id}):null,!ee&&!Nt&&!mn&&!ae&&Fi?s.jsx(vm,{}):null].filter(a=>a!=null);return s.jsxs(Nm.Provider,{value:on,children:[s.jsxs("div",{className:ut("pointer-events-auto relative z-1 flex h-[var(--composer-container-height,100%)] max-w-full flex-[var(--composer-container-flex,1)] flex-col"),onPaste:Xi,children:[s.jsx(Om,{onOauthRedirect:Co}),Ir&&s.jsx(Df,{}),Ar,Gt&&fr&&s.jsx(Bm,{taskId:Gt.taskId,clientThreadId:l.id,onClose:()=>Eo(!1)}),s.jsx(Mf,{hasFiles:an,pendingFiles:Ft,isUploadDisabled:!Ot,conversation:l,highlightUploadTooltip:Sn,disableReason:_r,uploadButtonDisabledReason:es,currentModelConfig:r,conversationMode:j,state:Tn,inputState:hr,gizmoId:V,includeSidebarContextTray:_o,isTemporaryChat:G,placeholder:ir,shouldUseRotatingPlaceholders:ar,composerController:_,onSubmit:yr,replyRegions:jo,leadingAction:Io,legacyFooterActions:Pr,activeSystemHint:k,activeConnectorSystemHints:bi,shouldShowAgentSessionModeDropdown:K,hideSystemHint:Lt||!ee&&!Nt,isSystemHintLocked:Lt,onRemoveSystemHint:sn,forceStopButton:st,onRemoveModel:to,contextualAnswerUserConnectionData:ie,fileInput:s.jsx("input",_t({},$i())),expanded:Nt?void 0:!0,expandOnMultilineInput:Nt,layoutMode:P,agentSessionModeNuxModal:de,isAgentSessionModeDropdownDisabled:Re||(Ce==null?void 0:Ce.has("cloud"))}),!1,s.jsx(Wp,{systemHints:W!=null?W:[],availableSystemHints:W!=null?W:[],composerController:_,clientThreadId:l.id,layoutMode:P,composerLayer:un,canUseInlineTagging:Es,isFileUploadEnabled:Ot,fileUploadDisabledReason:es,currentModelConfig:r!=null?r:null,openFileDialog:Vt,connectionInstanceData:ie,setActiveSystemHintType:oe,selectModelId:bs,gizmoId:V!=null?V:null,hasGizmoFeatureRateLimit:H,setSelectedGizmoTag:J}),!1,y!==Oc&&s.jsx(Lm,{canShowAutocomplete$:xr,layoutMode:P,composerController:_,clientThreadId:l.id})]}),Tr,Sr,Cr,kr,y&&W&&s.jsx(Ff,{conversation:l,availableSystemHints:W,systemHintType:y,onRemoveSystemHint:sn})]})}const Ff=({conversation:t,availableSystemHints:e,systemHintType:n,onRemoveSystemHint:o})=>{const r=e!=null&&!Dc(n)&&e.every(u=>u.systemHint!==n),d=Ee(()=>Lc(t)),{isBlocked:l}=si(n),i=tt(),p=!Us(i);return T.useEffect(()=>{d&&(r||l)&&!p&&o()},[r,l,p,o,n,d]),null},Gf=Qe(()=>Ye(()=>import("./db2vbext8urnm82g.js").then(t=>t.v),__vite__mapDeps([21,1,22,2,3,0,4,23,24,25,26,27,28,29,30,31])).then(t=>t.VoiceHintContainer));function nh(t){"use forget";var mt,xt,pt;const e=It.c(75),{conversation:n,currentModelId:o,disableDraftPersistence:r,isNewThread:d,isProjectThread:l,onRequestCompletion:i,onContinueGenerating:p,headerClassName:u,hideHeader:f,onlyAllowImageUploads:I,layoutMode:b}=t,m=r===void 0?!1:r,A=l===void 0?!1:l,S=b===void 0?"bottom":b,h=tt();let P;e[0]!==n?(P=()=>Un(n),e[0]=n,e[1]=P):P=e[1];const R=Ee(P),[c,V,B,g,j,$,L,J,U]=Bt(n.id,Wf),x=Fc(h),_=Wn();let M;e[2]!==n.id?(M={clientThreadId:n.id},e[2]=n.id,e[3]=M):M=e[3];const Y=Hm(M);let ge;e[4]===Symbol.for("react.memo_cache_sentinel")?(ge={type:"just-hit-rate-limit"},e[4]=ge):ge=e[4];const{isOpen:pe,onClose:D}=Wm(ge);let ee;e:{if(!Y){ee=!c&&V;break e}ee=!1}const fe=ee,F=Y,xe=Gc(n.id),te=Bt(n.id,ht.hasRecentPIMWarning),v=Hc(xe).data,ae=Um();let Se;e:{if(te){Se="pimBlock";break e}if(g){Se="readOnlyConversation";break e}if(((mt=v==null?void 0:v.gizmo.tags)==null?void 0:mt.includes(zn.WorkspaceDisabled))&&!ae){Se="workspaceDisallowsGizmo";break e}if(R.models.size===0){Se="noModelsAvailable";break e}if((B==null?void 0:B.kind)===Bs.GizmoTest&&B.gizmo_id==null){Se="noTestGizmoId";break e}Se=null}const ye=Se,Xe=Nr(),we=$m(),Le=Xe.action==="moderate";let at;e[5]!==h?(at=St(h,"1860647109"),e[5]=h,e[6]=at):at=e[6];const ke=at,re=zm(n.id),[z]=re,{systemHints:st}=Ka(),We=Bn.useState(Hf),Q=Wc(),Re=(xt=v==null?void 0:v.gizmo.id)!=null?xt:Q;let W;e[7]!==h||e[8]!==Re?(W=Uc(h,Re),e[7]=h,e[8]=Re,e[9]=W):W=e[9];const je=W,Fe=Ja();let ve;e[10]!==o||e[11]!==R?(ve=$c(R,o),e[10]=o,e[11]=R,e[12]=ve):ve=e[12];const Ne=ve;let G;e[13]!==h?(G=St(h,"3084799213"),e[13]=h,e[14]=G):G=e[14];const le=!G,se=L||(J!=null?J:!1)||le,H=!We&&(z==null||(z==null?void 0:z.kind)===Bs.PrimaryAssistant||(z==null?void 0:z.kind)===Bs.GizmoInteraction&&je);let ne;e[15]!==h?(ne=()=>Qs(h),e[15]=h,e[16]=ne):ne=e[16];const ue=Ee(ne);let y;e[17]!==v||e[18]!==(z==null?void 0:z.kind)?(y=(z==null?void 0:z.kind)===Bs.GizmoInteraction&&v!=null&&(!qc(v)||zc(v)),e[17]=v,e[18]=z==null?void 0:z.kind,e[19]=y):y=e[19];const k=y,oe=Uf(H,st,Ne,z,Fe,se,ue,(pt=x==null?void 0:x.isWorkspaceAccount())!=null?pt:!1,U,k);let w;e[20]!==h?(w=qm(h),e[20]=h,e[21]=w):w=e[21];const q=!w,X=eo();let C;e[22]!==oe||e[23]!==_||e[24]!==n.id||e[25]!==o||e[26]!==q||e[27]!==Y?(C=s.jsx(Vm,{availableSystemHints:oe,composerController:_,clientThreadId:n.id,currentModelId:o,isCompletionInProgress:Y,expireConduit:q}),e[22]=oe,e[23]=_,e[24]=n.id,e[25]=o,e[26]=q,e[27]=Y,e[28]=C):C=e[28];let K;e[29]!==Le||e[30]!==ke||e[31]!==we?(K=we&&Le&&ke?s.jsx(Ym,{}):null,e[29]=Le,e[30]=ke,e[31]=we,e[32]=K):K=e[32];let de;e[33]!==K?(de=s.jsx("div",{className:"flex justify-center empty:hidden",children:K}),e[33]=K,e[34]=de):de=e[34];let Oe;e[35]!==pe||e[36]!==D?(Oe=pe?s.jsx(Qm,{onClose:D}):null,e[35]=pe,e[36]=D,e[37]=Oe):Oe=e[37];let Be;e[38]!==(x==null?void 0:x.normalizedAccountUserId)||e[39]!==n.id||e[40]!==A?(Be=A&&s.jsx(Jm,{clientThreadId:n.id,accountUserId:x==null?void 0:x.normalizedAccountUserId}),e[38]=x==null?void 0:x.normalizedAccountUserId,e[39]=n.id,e[40]=A,e[41]=Be):Be=e[41];let ce;e[42]!==n.id||e[43]!==X?(ce=X?s.jsx("div",{className:"relative flex items-center justify-center",children:s.jsx(Gf,{conversationId:n.id})}):null,e[42]=n.id,e[43]=X,e[44]=ce):ce=e[44];const me=n.id,he=!!ye,Ge=ye!=null?ye:void 0,nt=we||j||$;let Ve;e[45]!==x||e[46]!==oe||e[47]!==fe||e[48]!==F||e[49]!==n||e[50]!==Ne||e[51]!==o||e[52]!==m||e[53]!==Re||e[54]!==u||e[55]!==f||e[56]!==re||e[57]!==Y||e[58]!==d||e[59]!==je||e[60]!==S||e[61]!==p||e[62]!==i||e[63]!==I||e[64]!==he||e[65]!==Ge||e[66]!==nt?(Ve=s.jsx(Lf,{conversation:n,disableDraftPersistence:m,onCreateNewCompletion:i,onContinueGenerating:p,currentModelId:o,account:x,currentModelConfig:Ne,isNewThread:d,isCompletionInProgress:Y,className:"w-full",canContinue:fe,disabled:he,disabledReason:Ge,canPause:F,isInteractableSharedThread:nt,headerClassName:u,hideHeader:f,onlyAllowImageUploads:I,layoutMode:S,availableSystemHints:oe,isSnorlaxEnabledForGizmo:je,gizmoId:Re,hydratedConversationModeWithGizmoOverridePayload:re},me),e[45]=x,e[46]=oe,e[47]=fe,e[48]=F,e[49]=n,e[50]=Ne,e[51]=o,e[52]=m,e[53]=Re,e[54]=u,e[55]=f,e[56]=re,e[57]=Y,e[58]=d,e[59]=je,e[60]=S,e[61]=p,e[62]=i,e[63]=I,e[64]=he,e[65]=Ge,e[66]=nt,e[67]=Ve):Ve=e[67];let Ze;return e[68]!==C||e[69]!==de||e[70]!==Oe||e[71]!==Be||e[72]!==ce||e[73]!==Ve?(Ze=s.jsxs(s.Fragment,{children:[C,de,Oe,Be,ce,Ve]}),e[68]=C,e[69]=de,e[70]=Oe,e[71]=Be,e[72]=ce,e[73]=Ve,e[74]=Ze):Ze=e[74],Ze}function Hf(t){const{locked:e}=t;return e}function Wf(t){var n,o,r,d;const e=ht.getCurrentNode(t);return[((n=e.message.clientMetadata)==null?void 0:n.errType)!=null&&e.message.clientMetadata.errType!=="info",Vc(ht.getCurrentNode(t).message),t==null?void 0:t.mode,ht.getIsReadOnly(t),!!(t!=null&&t.continuingFromSharedPostId),(t==null?void 0:t.continuingFromSharedProjectConversationId)!=null,ht.getIsNewConversation(t),(d=(r=(o=ht.lastUserMessage(t))==null?void 0:o.metadata)==null?void 0:r.system_hints)==null?void 0:d.includes(Z.Agent),t==null?void 0:t.startedWithByoMcp]}function Uf(t,e,n,o,r,d,l,i,p,u){"use forget";var b,m;const f=It.c(11);let I;e:{if(!t){let S;f[0]===Symbol.for("react.memo_cache_sentinel")?(S=[],f[0]=S):S=f[0],I=S;break e}let A;f[1]!==d||f[2]!==o||f[3]!==n||f[4]!==u||f[5]!==l||f[6]!==r||f[7]!==i||f[8]!==p||f[9]!==e?(A=(m=(b=e==null?void 0:e.filter(S=>Km({systemHint:S,modelConfig:n,conversationMode:o,isTemporaryChat:r,isDeveloperMode:l,isWorkspaceTenant:i,startedWithByoMcp:p})))==null?void 0:b.filter(S=>S.systemHint!==Z.Agent?!0:d))==null?void 0:m.filter(S=>S.systemHint!==Z.Slurm?!0:!u),f[1]=d,f[2]=o,f[3]=n,f[4]=u,f[5]=l,f[6]=r,f[7]=i,f[8]=p,f[9]=e,f[10]=A):A=f[10],I=A}return I}export{jf as C,sh as D,th as M,nh as P,fp as S,eh as T,_p as a,ap as u};
//# sourceMappingURL=hht3m8p9e0s4tqnx.js.map
