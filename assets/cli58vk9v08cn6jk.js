const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mbhfxri3syrb9rbq.js","assets/i8clt0mfz495j7ii.js","assets/pdp94tw1ktf1pj0a.js","assets/bzgf4ifuffcltugf.js","assets/gsas8pb1acnf7jnd.js","assets/b8lmybnmedr4n7bh.js"])))=>i.map(i=>d[i]);
import{j as e,e as B,_ as M,M as D,l as ie,r as L}from"./i8clt0mfz495j7ii.js";import{m as V,i as ce,c as me,b as xe,T as fe}from"./o564tkn3ln8nzryq.js";import{ad as ue,fd as he,kg as pe,n3 as be,c as ge,f8 as Q,fc as ve,n4 as je,n5 as ye,n6 as ke,d6 as Ne}from"./j0yo6uv6652vva62.js";import{u as _e,c as Me,D as Ce}from"./lo4w8zafp8iqjpvk.js";import{bi as X,d as v,e4 as j,T as N,o as C,L as E,$,pu as Ee,u as U,ff as we,cE as Te,l$ as I,aV as J}from"./ghewn7l2ynbm32fm.js";import{t as Le}from"./fna9z31n721lpf9f.js";import{C as P,T as De}from"./epmur8ofujia0j6q.js";import{g as Be}from"./bj1ejin6tzi0v3v8.js";import"./ns51nblw8ziscsgd.js";import"./ce3hgmw4iyyhicud.js";import"./mqebxepg7t6q2tie.js";import"./mstl8wgfzorpgdoe.js";import"./pc7u7c6vz2ia5xux.js";import"./kfdkis1zwf4ccfgg.js";import"./ol9d5wxhynx9q2is.js";import"./mbmcx8v24u1ao1ke.js";import"./jh95iaetowvobxaf.js";import"./dxyrjy681bkwlnj8.js";import"./deakbbf27g8e7ba0.js";import"./omoqxnq6po1pmb00.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./hu1kfuw35sk0pi95.js";function Ae({textdocVersion:t,clientThreadId:o}){const{handleCopy:c,copyLabel:m}=_e({textdocVersion:t,clientThreadId:o}),d=!X();return e.jsx(ue,{onCopy:c,className:"px-1.5 py-1",iconClassName:v("icon-md",!d&&"hidden"),iconOnly:d,buttonText:d?void 0:m})}const K=C(()=>M(()=>import("./mbhfxri3syrb9rbq.js").then(t=>t._),__vite__mapDeps([0,1])),{loading:t=>E(t)});function Se({textdocVersion:t,isDisabled:o=!1,clientThreadId:c}){const m=B(),{handleFileDownload:d,handleBlobDownload:f,isLoading:u,downloadCopyLabel:a,isDocument:n}=Me({textdocVersion:t,clientThreadId:c});return o||(o=u||!t||t.type===he.LOADING),n?e.jsxs(j.Root,{open:!u&&!o?void 0:!1,children:[e.jsx(j.BasicTrigger,{className:"hover:bg-transparent focus-visible:bg-transparent",children:e.jsxs("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:o,children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(N,{label:a,children:e.jsx(K,{className:"icon-md"})})}),e.jsx("span",{className:"hidden sm:block",children:m.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})]})}),e.jsx(j.Portal,{children:e.jsxs(j.Content,{align:"end",children:[e.jsx(j.Item,{onClick:l=>{l.preventDefault(),d("pdf")},children:m.formatMessage({id:"canvas.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),e.jsx(j.Item,{onClick:l=>{l.preventDefault(),d("docx")},children:m.formatMessage({id:"canvas.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})}),e.jsx(j.Item,{onClick:l=>{l.preventDefault(),d("md")},children:m.formatMessage({id:"canvas.download-md-button.menu",defaultMessage:"Markdown Document (.md)"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(N,{label:a,children:e.jsx("button",{className:"flex items-center gap-1 px-1.5 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:o,onClick:f,children:e.jsx(K,{className:"icon-md"})})})}),e.jsx("span",{className:"hidden sm:block",children:e.jsx("button",{className:"flex items-center gap-1 py-1 ps-1.5 pe-2.5 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:o,onClick:f,children:m.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})})]})}const Re=C(()=>M(()=>import("./pdp94tw1ktf1pj0a.js").then(t=>t._),__vite__mapDeps([2,1])),{loading:t=>E(t)});function Fe({onClick:t}){const o=B();return e.jsxs("button",{className:"flex items-center px-1.5 py-1 select-none",onClick:t,children:[e.jsx(N,{label:e.jsx(D,{id:"EditCanvasButton.editTooltip",defaultMessage:"Edit canvas"}),children:e.jsx(Re,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:o.formatMessage({id:"dd2tHH",defaultMessage:"Edit"})})]})}const Y=C(()=>M(()=>import("./bzgf4ifuffcltugf.js").then(t=>t._),__vite__mapDeps([3,1])),{loading:t=>E(t)});function He({onClick:t,disabled:o,isCodePreviewable:c}){const d=B().formatMessage(c?V.previewCode:V.runCode);return o?e.jsx($,{className:"-my-1 -me-3 flex cursor-not-allowed items-center gap-1 py-1 opacity-50 select-none",disabled:!0,children:e.jsxs(N,{label:e.jsx(D,{id:"PreviewCanvasButton.canvasStillStreaming",defaultMessage:"Content is being generated..."}),children:[e.jsx(Y,{className:"block sm:hidden"}),e.jsx("span",{className:"hidden sm:block",children:d})]})}):e.jsxs($,{className:"-my-1 -me-3 flex items-center gap-1 py-1 select-none",onClick:t,disabled:!1,children:[e.jsx(N,{label:e.jsx(D,{id:"PreviewCanvasButton.previewTooltip",defaultMessage:"Run code"}),children:e.jsx(Y,{className:"block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:d})]})}var F,Z;function We(){if(Z)return F;Z=1;var t=be(),o=pe(),c=Ee(),m=parseFloat,d=Math.min,f=Math.random;function u(a,n,l){if(l&&typeof l!="boolean"&&o(a,n,l)&&(n=l=void 0),l===void 0&&(typeof n=="boolean"?(l=n,n=void 0):typeof a=="boolean"&&(l=a,a=void 0)),a===void 0&&n===void 0?(a=0,n=1):(a=c(a),n===void 0?(n=a,a=0):n=c(n)),a>n){var s=a;a=n,n=s}if(l||a%1||n%1){var h=f();return d(a+h*(n-a+m("1e-"+((h+"").length-1))),n)}return t(a,n)}return F=u,F}var qe=We();const ze=ie(qe),Ge=C(()=>M(()=>import("./gsas8pb1acnf7jnd.js").then(t=>t._),__vite__mapDeps([4,1])),{loading:t=>E(t)}),Ve=C(()=>M(()=>import("./b8lmybnmedr4n7bh.js").then(t=>t._),__vite__mapDeps([5,1])),{loading:t=>E(t)}),$e=({isCanvasHovered:t=!1,onClick:o})=>{const c=B();return e.jsx(N,{label:c.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:e.jsx(Ne,{color:t?"primary":"secondary",icon:Ve,onClick:o})})},Ie=({textdocId:t,clientThreadId:o,name:c,tag:m,icon:d,iconSelected:f,marginBottom:u,size:a="large",height:n=a==="large"?"22rem":"10rem",minHeight:l,isCanvasOpen:s=!1,isDisabled:h=!1,isFocused:b=!1,isInferring:A=!1,isInlinePreview:r=!1,isStreaming:g=!1,isUserMessage:y=!1,onClick:p,onPreview:S,children:R})=>{const _=L.useRef(null),[k,H]=L.useState(!1),[O]=L.useState(()=>ze(100,180,!1)),ee=U(),w=ge(t),te=we(o),i=Te(w==null?void 0:w.versions),x=Q(ee),T=!x,ae=w==null&&te===void 0,se=i==null||g,W=!!i&&ce(i.type,i.content),ne=!!i&&me(i.type),oe=W||ne,q=b&&s&&f!=null?f:d,re=q?e.jsx("span",{className:v("shrink-0 transition-[filter]",{grayscale:!b&&!k}),children:q}):e.jsx("div",{className:"icon flex items-center overflow-hidden",children:e.jsx(I,{lines:1,size:"base",width:100,widthVariance:0})}),z=i!=null&&i.type&&ve(i.type)?xe(i.type):void 0,G=!c||A?e.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:O},children:e.jsx(I,{lines:1,size:"base",width:100,widthVariance:0})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:v("min-w-0 truncate",{"text-token-text-primary font-semibold":x}),children:c}),x&&z&&e.jsxs("span",{className:"text-token-text-tertiary font-normal",children:["Â· ",z]})]}),le=()=>{!_.current||h||(je.logButtonClick(ye.MESSAGE_ATTACHMENT,{type:m}),ke(_.current),p==null||p())},de=X();return e.jsxs(J.div,{role:T?"button":void 0,id:Be(t),initial:{opacity:g?0:1,scale:g?.9:1},animate:{opacity:1,scale:1},transition:{bounce:0,duration:x?0:.72},className:v("popover bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light relative z-0 border [--canvas-bg:var(--bg-primary)] dark:[--canvas-bg:var(--bg-elevated-secondary)]",x?"overflow-visible":"overflow-hidden",h?"cursor-default":T?"cursor-pointer":"cursor-text",{"select-none":T,"border-token-text-tertiary font-medium dark:border-gray-600":b&&s,"font-regular":!b,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":s||!r,"rounded-3xl":!s&&r,"max-w-full":!y&&(s||!r),"max-w-[var(--user-chat-width,70%)]":y&&(s||!r),[de?"w-full":"".concat(Le.tableContainer," rounded-none")]:!y&&!s&&r,"w-[var(--user-chat-width,70%)]":y&&!s&&r,"w-full pt-1 pb-3 sm:max-w-none":r&&x}),onMouseEnter:()=>!h&&H(!0),onMouseLeave:()=>H(!1),onClick:()=>T?le():void 0,ref:_,style:{marginBottom:u,height:r&&!s?n:void 0,minHeight:r&&!s?l:void 0,width:a==="small"?"300px":void 0},children:[!(x&&r)&&e.jsxs("div",{className:v("flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!k&&!b,"border-token-border-heavy":k&&!b,"text-token-text-primary text-sm font-medium":!s&&k&&r,"py-2":s||!r,"py-3":!x&&!s&&r,"text-token-text-secondary text-sm font-medium":!s&&!k&&r,"pt-0 pb-2 sm:px-6":x}),children:[e.jsxs("div",{className:v("flex min-w-0 items-center",{"gap-2":s||!r,"gap-3.5":!s&&r}),children:[!x&&re,G]}),s?e.jsx(J.span,{animate:g?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:g&&e.jsx(fe,{gap:1,padding:0})}):e.jsx($e,{isCanvasHovered:k,onClick:p})]}),x&&r&&!h?e.jsx("div",{className:"thread-xl:-top-[var(--header-height)] sticky top-0 z-20 overflow-hidden rounded-[inherit]",children:e.jsxs("div",{className:v("text-token-text-secondary bg-token-bg-primary/80 dark:bg-token-bg-elevated-secondary/80 z-20 flex w-full items-center justify-between gap-3 px-4 py-3 font-sans text-sm font-normal backdrop-blur-sm sm:px-6"),children:[e.jsx("div",{className:"flex min-w-0 items-center gap-2 truncate",children:G}),e.jsx("div",{className:"flex items-center justify-end",children:ae&&!s?e.jsxs("span",{className:"bg-token-surface-tertiary/40 text-token-text-tertiary inline-flex items-center px-2.5 py-0.5 text-xs font-normal",children:[e.jsx(Ge,{className:"me-1 h-3 w-3 shrink-0"}),e.jsx(D,{id:"m8Uz8Y",defaultMessage:"Canvas is not supported in shared conversations"})]}):x&&!s?e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Ae,{textdocVersion:i!=null?i:null,clientThreadId:o})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Fe,{onClick:p})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Se,{isDisabled:se,textdocVersion:i!=null?i:null,clientThreadId:o})}),oe&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(He,{isCodePreviewable:W,disabled:g,onClick:S})})]}):null})]})}):null,e.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!s&&R,r&&!s&&!x&&e.jsx(P,{size:a,position:"bottom"}),r&&a==="small"&&!s&&!x&&e.jsx(P,{size:a,position:"right"})]})]})},ut=({textdocId:t,clientThreadId:o,name:c,tag:m,icon:d,iconSelected:f,isCanvasOpen:u=!1,isFetching:a=!1,isFocused:n=!1,isInlinePreview:l=!1,isStreaming:s=!1,isUserMessage:h=!1,onClick:b,onPreview:A})=>{const[r,g]=L.useState(!1),y=U(),p=Q(y),S=_=>{g(_>0)},R=l&&!u?16:12;return e.jsx(Ie,{textdocId:t,name:c,tag:m,icon:d,height:p?"auto":void 0,iconSelected:f,marginBottom:R,isCanvasOpen:u,isFocused:n,isInlinePreview:l,isStreaming:s,isUserMessage:h,onClick:b,onPreview:A,clientThreadId:o,children:l&&e.jsx("div",{className:v("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":r,"border-transparent":!r}),children:a&&!(p&&s)?e.jsx(Ce,{numLines:20}):!!t&&e.jsx(De,{disableScroll:p,onScroll:S,textdocId:t,clientThreadId:o})})})};export{ut as CanvasMessageAttachment,Ie as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=cli58vk9v08cn6jk.js.map
