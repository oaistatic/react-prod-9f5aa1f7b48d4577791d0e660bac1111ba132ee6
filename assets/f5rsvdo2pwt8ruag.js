const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j0yo6uv6652vva62.js","assets/i8clt0mfz495j7ii.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/fqz8sozslskhjbvs.js"])))=>i.map(i=>d[i]);
import{e as E,u as ae,h as W,a as $,j as e,M as i,_ as V,ab as se,ai as ne,r as F,F as ie,A as re}from"./i8clt0mfz495j7ii.js";import{e as z,C as q,M as p,d as oe,o as U,L as X,nn as le,a5 as me,B as de,u as ce,h as j,b0 as ue,T as _,$ as h}from"./ghewn7l2ynbm32fm.js";import{d_ as ge}from"./j0yo6uv6652vva62.js";import{W as he}from"./kzwmj5bk0a8ido2q.js";import{W as fe}from"./i94vqq9eycryltby.js";import{R as pe,I as L,S as xe}from"./dl4laahs2jdlkw19.js";import{u as ve}from"./on3wbdiot3wz4dn8.js";import{l as f,W as G,x as Me,i as we,d as je}from"./g5lgy1otfli5p2x7.js";import{E as _e}from"./f7dlqei0boki32af.js";import{P as Ee,a as be}from"./lptwpbjabrvjmhsj.js";import"./fgm9uzc3b50cz4e0.js";import"./d30gyor263984jzn.js";import"./kgnykbdth8mb50na.js";import"./g8i6bixylsxyemsr.js";import"./o108mlelkx5ejfzn.js";import"./fv135gy2k0pewip3.js";import"./pbvsc3do5o365cxq.js";import"./mpzbsmypy64alaao.js";import"./fvjpw0lui4wq7vv3.js";import"./olrcssu7duieo6m7.js";import"./gzhyo73bmtx9f3d9.js";import"./o56jrqjpjpipvc65.js";import"./chs4g5r39qlnqw6r.js";import"./c80gqv0732s10rnu.js";import"./o6tyvbjf9zh9qku3.js";import"./opd3w2dk1rgqmcsu.js";import"./k0yjsblyrvonk8x1.js";import"./ieykhlrsk25lij4e.js";import"./i03gut32e8jn5ajq.js";import"./h1em0bjkpkjv8ykw.js";import"./e26n6uhwwtwdmiki.js";import"./mjq17q47489shd3e.js";import"./hxdh3tr5l8kut4ed.js";import"./hu1bt0oauegdhua6.js";function De({environmentId:s,onClose:t}){const n=E(),o=z(),l=ae(),d=W(),g=f(c=>c.setEnvironmentId),x=f(c=>c.setBranch),{mutate:a,isPending:v}=$({mutationFn:()=>G.deleteEnvironment(s),onSuccess:async()=>{Me(l,s),await we(l),f.getState().environmentId===s&&(g(null),x(null)),o.success(n.formatMessage({id:"wham.deleteEnvironmentModal.environmentDeletedSuccessfully",defaultMessage:"Environment deleted successfully"})),t(),d("/codex/settings/environments")},onError:()=>{o.danger(n.formatMessage({id:"wham.deleteEnvironmentModal.failedToDeleteEnvironment",defaultMessage:"Failed to delete environment"}))}});return e.jsx(q,{testId:"modal-wham-delete-environment",isOpen:!0,type:"danger",title:e.jsx(i,{id:"wham.deleteEnvironmentModal.title",defaultMessage:"Delete environment"}),onClose:t,primaryButton:e.jsx(p.Button,{title:n.formatMessage({id:"wham.deleteEnvironmentModal.delete",defaultMessage:"Delete"}),color:"danger",loading:v,onClick:()=>{a()}}),secondaryButton:e.jsx(p.Button,{title:n.formatMessage({id:"wham.deleteEnvironmentModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:t}),children:e.jsx("div",{className:"text-sm",children:e.jsx(i,{id:"wham.deleteEnvironmentModal.message",defaultMessage:"Tasks that use it will remain, but users wonâ€™t be able to create follow-up tasks."})})})}function r({label:s,children:t,className:n}){return e.jsxs("div",{className:oe("flex flex-col gap-1",n),children:[e.jsx("dt",{className:"text-token-text-primary text-sm font-medium",children:s}),e.jsx("dd",{className:"text-token-text-primary text-sm font-normal",children:t})]})}function Pe({environmentId:s,onClose:t}){const n=E(),o=z(),{mutate:l,isPending:d}=$({mutationFn:()=>G.invalidateEnvironmentCache(s),onSuccess:()=>{o.success(n.formatMessage({id:"wham.resetCacheModal.cacheResetSuccessfully",defaultMessage:"Cache reset successfully"})),t()},onError:()=>{o.danger(n.formatMessage({id:"wham.resetCacheModal.failedToResetCache",defaultMessage:"Failed to reset cache"}))}});return e.jsx(q,{testId:"modal-wham-delete-environment",isOpen:!0,type:"danger",title:e.jsx(i,{id:"wham.resetEnvironmentCacheModal.title",defaultMessage:"Reset cache"}),onClose:t,primaryButton:e.jsx(p.Button,{title:n.formatMessage({id:"wham.resetEnvironmentCacheModal.delete",defaultMessage:"Reset"}),color:"danger",loading:d,onClick:()=>{l()}}),secondaryButton:e.jsx(p.Button,{title:n.formatMessage({id:"wham.resetEnvironmentCacheModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:t}),children:e.jsx("div",{className:"text-sm",children:e.jsx(i,{id:"wham.resetEnvironmentCacheModal.message",defaultMessage:"All currently cached containers will be invalidated. The cache will be cleared for all users."})})})}const ye=U(()=>V(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yy),__vite__mapDeps([0,1,2,3,4])),{loading:s=>X(s)}),Ne=U(()=>V(()=>import("./fqz8sozslskhjbvs.js").then(s=>s._),__vite__mapDeps([5,1])),{loading:s=>X(s)});function Ce(){const{environmentId:s}=se(),{eligible:t}=ge();return t?e.jsx(ne,{to:"/codex"}):s?e.jsx(Oe,{environmentId:s}):e.jsx(le,{})}function Se(s){return s==null||s.setup==null?!1:Array.isArray(s.setup)?s.setup.length>0&&s.setup.every(t=>t!==""):s.setup!==""}function ke(s,t,n){var o,l;return s?!!((l=(o=s.permissions)==null?void 0:o.can_write)!=null&&l||n!=null&&n.isAdminOfAccount()||(t==null?void 0:t.email)===s.creator.email):!1}function Ae(s,t,n){var o,l;return s?!!((l=(o=s==null?void 0:s.permissions)==null?void 0:o.can_delete)!=null&&l||n!=null&&n.isAdminOfAccount()||(t==null?void 0:t.email)===s.creator.email):!1}function Oe({environmentId:s}){var y,N,C,S,k,A,O,R,B,T;const t=E(),n=W(),[o,l]=F.useState(!1),[d,g]=F.useState(!1),x=f(m=>m.setEnvironmentId),{data:a,isLoading:v,isError:c}=je(s),b=me(),u=de(),M=ce(),D=ke(a,b,u),P=Ae(a,b,u),H=ve(),w=u==null?void 0:u.name,Q=w!=null?w:t.formatMessage({id:"wham.environmentDetailsPage.workspace",defaultMessage:"Workspace"}),Z=j(M,"2134057841"),J=j(M,"1535847699"),K=j(M,"3899518838"),Y=!Se(a)&&(a==null?void 0:a.auto_setup_settings)==null,ee=(N=(y=a==null?void 0:a.auto_setup_settings)==null?void 0:y.use_auto_setup)!=null?N:Y;return e.jsxs(he,{topPadding:!0,showSidebar:!1,children:[e.jsx("div",{className:"flex flex-col px-8 md:px-16",children:v?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(ue,{})}):c?e.jsx(_e,{title:t.formatMessage({id:"wham.environmentDetailsPage.errorLoadingEnvironment",defaultMessage:"Error loading environment"}),description:t.formatMessage({id:"wham.environmentDetailsPage.errorLoadingEnvironmentDescription",defaultMessage:"Error loading environment description"})}):a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-token-border-default flex flex-col justify-between gap-2 border-b pb-4",children:e.jsxs("div",{className:"flex flex-row items-center justify-between",children:[e.jsxs(pe,{children:[e.jsx(L,{label:t.formatMessage({id:"wham.environmentDetailsPage.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),e.jsx(xe,{}),e.jsx(L,{label:a.label,url:"/codex/settings/environment/".concat(s),className:"text-token-text-primary font-medium"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(_,{label:P?void 0:t.formatMessage({id:"wham.environmentDetailsPage.deleteEnvironmentTooltip",defaultMessage:"Only creators or editors of the environment, or an admin, can delete an environment"}),children:e.jsx(h,{color:"danger-outline",onClick:()=>l(!0),disabled:!P,"aria-label":t.formatMessage({id:"wham.environmentDetailsPage.deleteEnvironmentAriaLabel",defaultMessage:"Button to delete {environmentName}"},{environmentName:a.label}),children:e.jsx(i,{id:"wham.environmentDetailsPage.deleteEnvironment",defaultMessage:"Delete"})})}),e.jsx(_,{label:D?void 0:t.formatMessage({id:"wham.environmentDetailsPage.editEnvironmentTooltip",defaultMessage:"Only creators or editors of the environment, or an admin, can edit an environment"}),children:e.jsx(h,{icon:ye,onClick:()=>{n("/codex/settings/environment/".concat(s,"/edit"))},color:"secondary",disabled:!D,"aria-label":t.formatMessage({id:"wham.environmentDetailsPage.editEnvironmentAriaLabel",defaultMessage:"Button to edit {environmentName}"},{environmentName:a.label}),children:e.jsx(i,{id:"wham.environmentDetailsPage.editEnvironment",defaultMessage:"Edit"})})}),e.jsx(h,{size:"small",color:"secondary",onClick:()=>{x(s),fe.recordClickEnv(),n("/codex")},"aria-label":t.formatMessage({id:"wham.environmentDetailsPage.useEnvironmentAriaLabel",defaultMessage:"Button to use environment {environmentName} in a codex task"},{environmentName:a.label}),children:e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx(i,{id:"wham.turnInfoRow.useEnvironment",defaultMessage:"Use this"}),e.jsx(Ne,{className:"icon-sm"})]})})]})]})}),e.jsx("div",{className:"text-token-text-primary py-8 text-xl",children:a.label}),e.jsxs("div",{className:"grid gap-x-12 gap-y-6 md:grid-cols-2",children:[e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.creator",defaultMessage:"Creator"}),children:a.creator.email}),e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.image",defaultMessage:"Image"}),children:a.machine.label||e.jsx(i,{id:"wham.environmentDetailsPage.noImage",defaultMessage:"No image"})}),e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.description",defaultMessage:"Description"}),children:(C=a.description)!=null?C:e.jsx(i,{id:"wham.environmentDetailsPage.noDescription",defaultMessage:"N/A"})}),Z&&e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.agentNetworkAccess",defaultMessage:"Agent internet access"}),children:((S=a.agent_network_access)==null?void 0:S.mode)==="on"?a.agent_network_access.preset_allowlist===Ee?e.jsx(i,{id:"wham.environmentDetailsPage.agentNetworkAccess.unrestricted",defaultMessage:"On: unrestricted"}):a.agent_network_access.preset_allowlist===be?e.jsx(i,{id:"wham.environmentDetailsPage.agentNetworkAccess.codex",defaultMessage:"On: common dependencies"}):e.jsx(i,{id:"wham.environmentDetailsPage.agentNetworkAccess.custom",defaultMessage:"On: custom domains"}):a.agent_network_access==null||a.agent_network_access.mode==="off"?e.jsx(i,{id:"wham.environmentDetailsPage.agentNetworkAccess.off",defaultMessage:"Off"}):null}),K&&e.jsxs(e.Fragment,{children:[e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.postSetupCaching",defaultMessage:"Post setup caching"}),children:e.jsxs("div",{className:"flex items-center gap-2",children:[((k=a.cache_settings)==null?void 0:k.post_setup_cache_enabled)===!0?e.jsx(i,{id:"wham.environmentDetailsPage.postSetupCaching.on",defaultMessage:"On"}):e.jsx(i,{id:"wham.environmentDetailsPage.postSetupCaching.off",defaultMessage:"Off"}),((A=a.cache_settings)==null?void 0:A.post_setup_cache_enabled)&&e.jsx(_,{label:t.formatMessage({id:"wham.environmentDetailsPage.resetCacheTooltip",defaultMessage:"Invalidate any currently cached containers"}),children:e.jsx(h,{size:"small",onClick:()=>g(!0),color:"secondary","aria-label":t.formatMessage({id:"wham.environmentDetailsPage.resetCacheAriaLabel",defaultMessage:"Button to invalidate cache for {environmentName}"},{environmentName:a.label}),children:e.jsx(i,{id:"wham.environmentDetailsPage.resetCache",defaultMessage:"Reset cache"})})})]})}),((O=a.cache_settings)==null?void 0:O.post_setup_cache_enabled)&&e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.maintenanceSetupScript",defaultMessage:"Maintenance setup script"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:(Array.isArray(a.maintenance_setup)?a.maintenance_setup:[a.maintenance_setup]).filter(Boolean).join("\n")})})]}),e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.environmentVariables",defaultMessage:"Environment variables"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:Object.keys((R=a.env_vars)!=null?R:{}).filter(m=>!m.startsWith("CODEX_ENV_")).join("\n")})}),e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.secrets",defaultMessage:"Secrets"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:Object.keys((B=a.secrets)!=null?B:{}).join("\n")})}),e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.createdAt",defaultMessage:"Created at"}),children:a.created_at?e.jsx(ie,{value:new Date(a.created_at*1e3),year:"numeric",month:"long",day:"numeric"}):e.jsx(i,{id:"wham.environmentDetailsPage.noCreationDate",defaultMessage:"No creation date"})}),e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.setupScript",defaultMessage:"Setup script"}),children:J&&ee?e.jsx(i,{id:"wham.environmentDetailsPage.autoSetup.automatic",defaultMessage:"Automatic"}):e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:(Array.isArray(a.setup)?a.setup:[a.setup]).filter(Boolean).join("\n")})}),e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.repository",defaultMessage:"Repository"}),children:a.repo_map?Object.values(a.repo_map).map(m=>m.repository_full_name):e.jsx(i,{id:"wham.environmentDetailsPage.noRepository",defaultMessage:"No repository"})}),e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.numTasks",defaultMessage:"No. of tasks"}),children:(T=a.task_count)!=null?T:0}),H&&e.jsxs(e.Fragment,{children:[e.jsx(r,{label:t.formatMessage({id:"94ZVks",defaultMessage:"Share"}),children:a.share_settings==="workspace"?t.formatMessage({id:"wham.environmentDetailsPage.sharedWithWorkspace",defaultMessage:"Shared with {workspaceName}"},{workspaceName:Q}):t.formatMessage({id:"wham.environmentDetailsPage.private",defaultMessage:"Private"})}),a.share_settings!=="private"&&e.jsx(r,{label:t.formatMessage({id:"wham.environmentDetailsPage.shareTargets",defaultMessage:"Additional editors"}),children:a.share_targets&&a.share_targets.length>0?e.jsx("div",{className:"flex flex-col gap-1",children:a.share_targets.map((m,te)=>{var I;return e.jsx("span",{children:m.email},"".concat((I=m.type)!=null?I:"user","-").concat(m.email,"-").concat(te))})}):e.jsx(i,{id:"wham.environmentDetailsPage.shareTargetsNone",defaultMessage:"None"})})]})]})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(i,{id:"wham.environmentDetailsPage.environmentNotFound",defaultMessage:"Environment not found"})})}),o&&e.jsx(De,{environmentId:s,onClose:()=>l(!1)}),d&&e.jsx(Pe,{environmentId:s,onClose:()=>g(!1)})]})}const ht=()=>[{title:"Codex"}],ft=re(function(){return e.jsx(Ce,{})});export{ft as default,ht as meta};
//# sourceMappingURL=f5rsvdo2pwt8ruag.js.map
