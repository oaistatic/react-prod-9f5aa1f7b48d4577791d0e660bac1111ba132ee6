const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fwyctp3zfyh6emd2.js","assets/i8clt0mfz495j7ii.js","assets/rsi9kppw43ykrsgk.js"])))=>i.map(i=>d[i]);
var ge=Object.defineProperty,pe=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var Y=(s,a,i)=>a in s?ge(s,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[a]=i,_=(s,a)=>{for(var i in a||(a={}))me.call(a,i)&&Y(s,i,a[i]);if(W)for(var i of W(a))xe.call(a,i)&&Y(s,i,a[i]);return s},w=(s,a)=>pe(s,fe(a));import{r as d,j as e,e as J,u as he,f as ye,M as u,_ as Z}from"./i8clt0mfz495j7ii.js";import{T as ve,o as $,u as X,f as z,W as Me,e as ee,o2 as je,o3 as ke,o4 as Te,e_ as Se,eU as K,G as n,n as Pe,aG as Ce,h as _e,C as se,$ as k,o5 as R,eV as b,L as ae}from"./ghewn7l2ynbm32fm.js";import{dt as we,du as Re,dv as be,dw as Le,dx as Ie,dy as te,dz as Ae}from"./j0yo6uv6652vva62.js";import{S as Be,i as Ne,G as Ue,A as Ve,M as qe}from"./g7azkxfkm9n8omkv.js";import"./n3bxkos2zhscnn5x.js";const Ge=$(()=>Z(()=>import("./fwyctp3zfyh6emd2.js").then(s=>s._),__vite__mapDeps([0,1])),{loading:s=>ae(s)}),Fe=$(()=>Z(()=>import("./rsi9kppw43ykrsgk.js").then(s=>s._),__vite__mapDeps([2,1])),{loading:s=>ae(s)});function Je({gizmo:s,updateGizmo:a,publishedGizmo:i,promoteGizmo:g,appealGizmo:p,setAppealState:f,showActionsModal:y,shareOnly:T,onClose:M}){const[m,j]=d.useState({type:"privacy"});return m.type==="privacy"?e.jsx(Ee,{gizmo:s,updateGizmo:a,publishedGizmo:i,promoteGizmo:g,appealGizmo:p,setAppealState:f,setStep:j,showActionsModal:y,shareOnly:T,onClose:M}):e.jsx(He,{publishedGizmo:m.publishedGizmo,onClose:M})}function Oe(s){return s?n.Workspace:n.Link}function Ee({gizmo:s,publishedGizmo:a,updateGizmo:i,promoteGizmo:g,appealGizmo:p,setAppealState:f,setStep:y,showActionsModal:T,shareOnly:M,onClose:m}){var F,O,E,H,Q;const j=X(),[ie,I]=d.useState(!1),A=z(Me.isBusinessWorkspace),l=J(),x=ee(),[r,B]=d.useState(je(s)?Oe(!!A):s.sharingRecipient),re=he(),N=Ne(r,s.sharingTargets),{data:S,isLoading:ne}=ke(),U=Te(),[c,P]=d.useState(a!=null&&a.gizmo.display.categories.length>0?(O=(F=U.data)==null?void 0:F.categories.find(t=>t.id===a.gizmo.display.categories[0]))==null?void 0:O.id:void 0);d.useEffect(()=>{P(a==null?void 0:a.gizmo.display.categories[0])},[a==null?void 0:a.gizmo.display.categories]);const[oe,V]=d.useState(void 0),le=d.useRef(Se((t,o)=>K.generateCategory(t,o),1e3)),v=S!=null&&S.is_verified?void 0:l.formatMessage({id:"qUMu4e",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile in the user settings page."});r===n.Marketplace&&v!=null&&!ne&&B(n.Link);const ce=A&&!((E=s.sharingTargets)!=null&&E.some(t=>t.recipient===n.Link)),q=be(s,r,c),de=q.includes(Le.MissingPublicActionPrivacyPolicyURL),C=s.tools.find(t=>t.type===Pe.JIT_PLUGIN&&!t.metadata.privacy_policy_url),h=z(t=>t.currentWorkspace),ue=Ce();d.useEffect(()=>{let t=!0;return(async()=>{try{if(c!=null)return;const o=await le.current(s.name,s.instructions);t&&c==null&&(o?P(o.id):V(!0))}catch(o){t&&c==null&&V(!0)}})(),()=>{t=!1}},[s.instructions,s.name,ue,c]);const G=_e(j,"4226692983");return e.jsx(se,{testId:"modal-simple-share-gizmo",type:"success",isOpen:!0,onClose:m,title:e.jsx(u,{id:"9viumf",defaultMessage:"Share GPT"}),showCloseButton:!0,primaryButton:N?e.jsx(k,{color:"primary",disabled:q.length>0,loading:ie,onClick:async()=>{try{if(I(!0),M){if(!(a!=null&&a.gizmo.id)){x.danger(l.formatMessage({id:"QYVEx8",defaultMessage:"Error sharing GPT"}),{toastId:"simple_share_gizmo_modal",loggingTitle:"Error sharing GPT",loggingDescription:"Error message when GPT ID is missing (shouldn't happen)"});return}const t=await K.shareGizmo(a.gizmo.id,c?{sharing:R(r,[],b),categories:[c]}:{sharing:R(r,[],b)});t.error?(x.warning(l.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})),i({sharingTargets:t.sharing_targets}),f({gizmoId:a.gizmo.id,sharingRecipient:r,categories:a.gizmo.display.categories,moderationType:qe.PublishBlocked,sharingTargets:t.sharing_targets,showModal:Ve.AppealAvailable})):(re.setQueryData(["gizmo",{gizmoId:a.gizmo.id},{draft:!1}],o=>t.resource),i(o=>w(_({},o),{sharingRecipient:r})),x.success(l.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),m())}else{const t=await g({recipient:r,subjects:R(r,[],b)},c);t?(y({type:"published",publishedGizmo:t}),i(o=>w(_({},o),{id:t.gizmo.id,sharingRecipient:r})),t.gizmo.live_version!=null&&i({liveVersion:t.gizmo.live_version}),x.success(l.formatMessage({id:"R5zko1",defaultMessage:"GPT published"}),{testId:"gpt-published-toast"})):(x.warning(l.formatMessage({id:"uf7WYw",defaultMessage:"Unable to publish GPT"})),m())}}finally{I(!1)}},"data-testid":"save-gizmo-button",children:e.jsx(u,{id:"SW4DG4",defaultMessage:"Save"})}):G?e.jsx(e.Fragment,{children:e.jsx(k,{color:"primary",onClick:async()=>{await p(r,c)},children:e.jsx(u,{id:"bBmLUr",defaultMessage:"Appeal"})})}):null,secondaryButton:a?e.jsx(k,{color:"secondary",onClick:t=>te(j,a,x,t,l.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(u,{id:"wvL15a",defaultMessage:"Copy link"})}):null,children:e.jsxs("div",{className:"mx-[-16px] flex flex-col gap-3 text-sm",children:[e.jsx("div",{className:"space-y-1.5",children:e.jsxs(Ie,{value:r,onValueChange:t=>B(t),children:[s.sharingTargets&&s.sharingTargets.map((t,o)=>e.jsx(L,{value:t.recipient,disabled:t.recipient===n.Marketplace&&v!=null,tooltipText:t.recipient===n.Marketplace?v!=null?v:l.formatMessage({id:"0Rcb4e",defaultMessage:"Your GPT will appear in the Explore GPTs page"}):void 0,shareLevel:t.recipient},o)),ce&&e.jsxs(e.Fragment,{children:[e.jsx(L,{value:n.Link,disabled:!0,tooltipText:l.formatMessage(D.workspaceDisabledHint),shareLevel:n.Link,workspaceName:h==null?void 0:h.name}),e.jsx(L,{value:n.Link,disabled:!0,tooltipText:l.formatMessage(D.workspaceDisabledHint),shareLevel:n.Marketplace,workspaceName:h==null?void 0:h.name})]})]})}),de&&e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(u,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:t=>e.jsx("button",{onClick:()=>{T(C==null?void 0:C.metadata.action_id)},className:"underline",children:t})}})}),r!==n.Private&&e.jsx(Ue,{gizmo:s,category:c,categories:r===n.Marketplace?(Q=(H=U.data)==null?void 0:H.categories)!=null?Q:[]:void 0,onCategoryChange:r===n.Marketplace?t=>P(t.id):void 0}),r===n.Marketplace&&(oe?e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(u,{id:"tpC3ui",defaultMessage:"There was an error updating the list of categories"})}):null),!N&&G&&e.jsx("div",{className:"text-token-text-secondary flex items-center justify-between text-sm",children:e.jsx(u,{id:"jLCMMV",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."})})]})})}function He({publishedGizmo:s,onClose:a}){const i=X(),g=Ae(i,s),p=J(),f=ee();return e.jsx(se,{testId:"modal-simple-share-published",type:"success",isOpen:!0,onClose:a,title:e.jsx(u,{id:"rCRRmx",defaultMessage:"Settings Saved"}),showCloseButton:!0,primaryButton:e.jsx(k,{color:"primary",as:"link",to:g,children:e.jsx(u,{id:"lyZz44",defaultMessage:"View GPT"})}),children:e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"bg-token-main-surface-secondary flex gap-1 rounded-sm px-2 py-1",children:[e.jsx("div",{className:"line-clamp-1 break-all text-ellipsis",children:g}),e.jsx("button",{onClick:y=>{te(i,s,f,y,p.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"}))},className:"text-token-text-secondary hover:text-token-text-primary transition","data-testid":"copy-saved-gpt-url-button",children:e.jsx(Ge,{className:"icon-sm"})})]})})})}const D=ye({workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"}});function L({shareLevel:s,workspaceName:a,value:i,disabled:g=!1,tooltipText:p}){const f=d.useId();return e.jsx(ve,{disabled:p==null,label:p,side:"top",triggerAs:null,children:e.jsxs(we,{id:f,value:i,disabled:g,className:"hover:bg-token-main-surface-secondary flex h-14 w-full cursor-pointer flex-row items-center justify-between gap-2 rounded-md px-3 py-4 font-semibold",children:[e.jsx("label",{htmlFor:f,className:"flex cursor-pointer items-center gap-1",children:e.jsx(Be,{shareLevel:s,workspaceName:a!=null?a:"",hasInviteSharing:!1})}),e.jsx(Re,{children:e.jsx(Fe,{className:"icon-lg me-1"})})]})})}export{L as ShareLevelRadioOption,Je as SimpleShareGizmoModal};
//# sourceMappingURL=bg6sf480373dssa5.js.map
