const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j0yo6uv6652vva62.js","assets/i8clt0mfz495j7ii.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/mac79w4mfw6b5s9m.js","assets/n7oqrmjgqin40oze.js","assets/e3jwynezq3sbw7bs.js","assets/b8xidkl0ars31gwj.js","assets/2uk20wu2pu1737un.js","assets/j7q6dd79tspx35h1.js","assets/hkdu34erhu96s165.js","assets/gsas8pb1acnf7jnd.js"])))=>i.map(i=>d[i]);
var _s=Object.defineProperty,ks=Object.defineProperties;var Ts=Object.getOwnPropertyDescriptors;var Rt=Object.getOwnPropertySymbols;var Ns=Object.prototype.hasOwnProperty,Cs=Object.prototype.propertyIsEnumerable;var it=(e,n,r)=>n in e?_s(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,lt=(e,n)=>{for(var r in n||(n={}))Ns.call(n,r)&&it(e,r,n[r]);if(Rt)for(var r of Rt(n))Cs.call(n,r)&&it(e,r,n[r]);return e},ct=(e,n)=>ks(e,Ts(n));var Ot=(e,n,r)=>it(e,typeof n!="symbol"?n+"":n,r);import{r as i,j as t,M as Ie,_ as Ee,f as ts,e as je,R as ut}from"./i8clt0mfz495j7ii.js";import{aV as ne,d as Z,o as Me,L as Re,$ as ss,eR as gt,r5 as Ne,cE as yt,ak as Ss,u as rt,be as ns,hw as os,aW as Be,gC as Is,a_ as As,a$ as Es,pO as Pt,pj as Lt,ic as Ms,id as Rs,ie as Os,il as Ps,q$ as dt,J as Fe,ba as Ls,bR as rs,bh as Ds,h as as,dA as Vs,hv as xe,cn as $e,dw as Dt,eI as $s,eu as Hs,a as Ws,co as zs,cH as qs,bb as is,bc as ls,P as Vt,aX as Bs,cO as Us}from"./ghewn7l2ynbm32fm.js";import{oY as Qs,o_ as Xs,bU as at,wG as cs,p3 as nt,gt as Ys,b$ as V,wH as jt,cv as us,mR as Zs,i0 as Js,mi as Fs,q as Gs,t as Ks,wI as en,wJ as tn,wK as sn,wL as nn,wM as on,wN as rn,gu as an,wO as $t,wP as ft,wQ as Ht,gw as ds,ac as ln,E as cn,wR as un,oX as dn,wS as fn,gv as Wt,lu as mn,nr as pn}from"./j0yo6uv6652vva62.js";import{C as hn}from"./gla0jqw9ed8nrnoj.js";import{g as xn,c as gn,d as yn,a as zt,e as mt,f as qt,b as wn,C as bn,S as jn}from"./owvt7s3ln6qx5fou.js";import{M as vn}from"./olrcssu7duieo6m7.js";import{s as _n}from"./ivb8c1xam3e690hh.js";import{p as kn}from"./o2ch1u40q6bs5ljp.js";import{S as Tn,C as Nn,H as Cn,t as qe}from"./k1t8elp5z7nmkg2d.js";import{shell as Sn}from"./pbl95wx6493wq92j.js";import{E as wt,e as In,V as An,R as En,D as fs}from"./gdq1l97elemowxcc.js";import{a as Mn}from"./hk7ym2rzlomukbdz.js";import{C as Rn}from"./o56jrqjpjpipvc65.js";import{D as On}from"./lktqd4c5dfo8cx5l.js";import{u as Pn}from"./ov015nmz1yxh95ok.js";import"./ksuwacyo5m7qmkk7.js";import"./dwikchly7agkd2y3.js";import"./bbipyj9bituayr8q.js";import"./pbvsc3do5o365cxq.js";const Ln=({url:e,withBorder:n=!1})=>{const{isSuccess:r,isError:o}=Qs(Xs(e,32)),[s]=i.useState(r);return o?null:t.jsx(ne.div,{initial:{opacity:s?1:0},animate:{opacity:r?1:0},className:Z("bg-primary -ms-3 box-content size-4 shrink-0 overflow-hidden rounded-full first:-ms-1",n&&"border-token-main-surface-secondary group-hover:border-token-text-primary dark:group-hover:border-token-text-primary border"),children:t.jsx(at,{url:e,size:32,className:"m-0"})})},Dn=Me(()=>Ee(()=>import("./j0yo6uv6652vva62.js").then(e=>e.yv),__vite__mapDeps([0,1,2,3,4])),{loading:e=>Re(e)});function Vn({tabs:e,activeTab:n,setActiveTab:r,initializing:o=!1}){const s=t.jsx(Ie,{id:"odyssey.tabBar.newTab",defaultMessage:"New tab"});return o?t.jsx("nav",{className:"bg-token-bg-tertiary flex flex-1 items-center gap-1 rounded-t-xl",children:t.jsx("div",{className:"flex flex-1 items-center gap-1",children:t.jsx(Ut,{onClick:()=>{},active:!0,children:s})})}):t.jsx("nav",{className:"bg-token-bg-tertiary flex flex-1 items-center gap-1 rounded-t-xl",children:t.jsx("div",{className:"flex flex-1 items-center gap-1",children:e.map(l=>t.jsx(Ut,{active:n===l.label,icon:l.icon,onClick:()=>r(l.label),children:l.label},l.icon))})})}function Bt({side:e}){return t.jsx("span",{"aria-hidden":!0,className:Z("pointer-events-none absolute bottom-0 h-3 w-3 bg-transparent z-10",e==="left"?"end-full rounded-ee-[50%] shadow-[4px_0_0_0_var(--bg-primary)]":"start-full rounded-es-[50%] shadow-[-4px_0_0_0_var(--bg-primary)]")})}function Ut({active:e=!1,icon:n,children:r,onClick:o}){return t.jsxs("div",{className:Z("relative rounded-t-xl py-2 ps-4 pe-4.5 text-[11px] leading-[13px] font-medium whitespace-nowrap",e?"bg-token-bg-primary text-token-text-primary":"text-token-text-secondary hover:bg-token-bg-primary/60 hover:text-token-text-primary"),onClick:o,children:[e&&t.jsxs(t.Fragment,{children:[t.jsx(Bt,{side:"left"}),t.jsx(Bt,{side:"right"})]}),t.jsxs("div",{className:"flex flex-row items-center gap-1",children:[n?t.jsx(Ln,{url:n}):t.jsx(Dn,{className:"size-4"}),r]})]})}const $n=Me(()=>Ee(()=>import("./mac79w4mfw6b5s9m.js").then(e=>e._),__vite__mapDeps([5,1])),{loading:e=>Re(e)}),Hn=({chunk:e,isFinalAssistantTurn:n,hidePowTombstone:r,isKAUR1BR5:o})=>{const s=e.screenshots.at(-1),{origin:l,domain:d}=i.useMemo(()=>cs(s),[s]),c=nt(s,void 0),{open:x,isVNCEnabled:f}=Ys(),[m,h]=i.useState(null),[y,w]=i.useState(!1);return i.useEffect(()=>{if(!c)return;let b=!1;w(!1);const j=new Image;return j.src=c,j.onload=()=>!b&&h(c),j.onerror=()=>{b||(w(!0),h(null))},()=>{b=!0}},[c]),n?t.jsxs(ne.div,{className:"group border-token-border-heavy relative flex max-w-md flex-1 cursor-default flex-col gap-2 overflow-hidden rounded-2xl border",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.4,ease:"easeInOut"},children:[t.jsxs("div",{className:"bg-token-bg-tertiary flex flex-col",children:[t.jsx("div",{className:"align-start flex flex-row gap-1 px-1 pt-1 text-sm",children:t.jsx(Vn,{tabs:[{icon:l!=null?l:"",label:d!=null?d:""}],activeTab:d,setActiveTab:()=>{},initializing:!1})}),t.jsx("div",{className:"group relative aspect-[1024/698] w-full",children:m?t.jsx("img",{src:m,alt:"Screenshot that shows the model used the computer",className:"absolute inset-0 h-full w-full object-cover object-bottom"},m):t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:t.jsx("div",{className:"border-token-border-heavy h-4 w-4 animate-spin rounded-full border-2 border-t-transparent"})})})]}),f&&t.jsx("div",{className:"absolute inset-0 z-100 flex h-full w-full items-center justify-center bg-black/50 opacity-0 transition-opacity group-hover:opacity-100",children:t.jsx(ss,{color:"primary-inverse",onClick:()=>x(),children:t.jsx("div",{className:"flex items-center gap-1",children:o?t.jsx(Ie,{id:"ahugQu",defaultMessage:"Open tabs"}):t.jsx(Ie,{id:"Kj2mXr",defaultMessage:"Take over"})})})})]},"proof-of-work"):r?null:t.jsx(Wn,{})},Wn=()=>t.jsxs(ne.div,{className:"border-token-border-default group flex max-w-xs items-center gap-2 rounded-2xl border p-4 select-none",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25,ease:"easeInOut"},children:[t.jsx($n,{className:"icon"}),t.jsx("span",{className:"flex-1 truncate text-sm font-medium",children:t.jsx(Ie,{id:"cot.proofofwork.tombstone",defaultMessage:"Used the browser"})})]},"tombstone"),zn=({chunks:e,isExpanded:n,isFinalAssistantTurn:r,hidePowTombstone:o,isKAUR1BR5:s})=>{const l=i.useMemo(()=>Bn(e),[e]);return l?t.jsx(Un,{chunk:l,isExpanded:n,isFinalAssistantTurn:r,hidePowTombstone:o,isKAUR1BR5:s}):null},qn=i.memo(zn),Bn=e=>gt(e,n=>{var r;return n.type===V.ComputerOutput&&!n.isBlank&&((r=n.screenshots)==null?void 0:r.length)>0}),Un=({chunk:e,isExpanded:n,isFinalAssistantTurn:r,hidePowTombstone:o,isKAUR1BR5:s})=>{switch(e.type){case V.ComputerOutput:return t.jsx(Hn,{chunk:e,isExpanded:n,isFinalAssistantTurn:r,hidePowTombstone:o,isKAUR1BR5:s});default:return null}};function Qn(e,n,r,o,s){const[l,d]=i.useState(Ne.Setup),c=i.useMemo(()=>e.every(f=>f.type===V.N7jupdLoading)&&n,[e,n]),x=i.useMemo(()=>{const f=yt(e);return(f==null?void 0:f.type)!==V.N7jupdLoading?!1:f==null?void 0:f.needs_startup},[e]);return i.useEffect(()=>{const f=setTimeout(()=>{d(Ne.Random)},7e3),m=setTimeout(()=>{d(Ne.Animation)},15e3);return()=>{clearTimeout(f),clearTimeout(m)}},[]),o&&c?Ne.Autoswitch:r===Ss.Research&&c?Ne.Research:c?x?l:s?Ne.KAUR1BR5:Ne.Thinking:Ne.Done}function Xn(){const e=rt(),r=ns(e,"chatgpt_cot_config").get("shimmer_duration_ms",2e3);i.useEffect(()=>{document.documentElement.style.setProperty("--cot-shimmer-duration","".concat(r,"ms"))},[r])}function Yn(e){const n=new Set,r=new Set;for(const o of e)if(o.type===V.Search){for(const s of o.queries)n.add(s.q);for(const s of o.sources)r.add(s.domain)}return{queries:n.size,sources:r.size}}const Zn=({radius:e=8,className:n=""})=>t.jsx("svg",{width:e,height:e,viewBox:"0 0 ".concat(e," ").concat(e),className:n,xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"\n        M 0 0 H ".concat(e," V ").concat(e," H 0 Z\n        M ").concat(e," 0\n          A ").concat(e," ").concat(e," 0 0 1 0 ").concat(e,"\n          L 0 0 Z\n      "),fill:"currentColor",fillRule:"evenodd"})}),Jn=({radius:e=8,className:n=""})=>t.jsx("svg",{width:e,height:e,viewBox:"0 0 ".concat(e," ").concat(e),className:n,xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"\n        M 0 0 H ".concat(e," V ").concat(e," H 0 Z\n        M 0 0\n          A ").concat(e," ").concat(e," 0 0 0 ").concat(e," ").concat(e,"\n          L ").concat(e," 0 Z\n      "),fill:"currentColor",fillRule:"evenodd"})}),Ce=ts({live:{id:"odyssey.live",defaultMessage:"LIVE"},search:{id:"odyssey.search",defaultMessage:"Search"},restoringDesktop:{id:"odyssey.restoringDesktop",defaultMessage:"Restoring my virtual desktop..."},terminal:{id:"odyssey.terminal",defaultMessage:"Terminal"},newTab:{id:"odyssey.newTab",defaultMessage:"New tab"},libreoffice:{id:"odyssey.libreoffice",defaultMessage:"LibreOffice"},reader:{id:"odyssey.reader",defaultMessage:"Browser"},readingMode:{id:"odyssey.readingMode",defaultMessage:"Reading mode"},imageViewer:{id:"odyssey.imageViewer",defaultMessage:"Image Viewer"},stopAgent:{id:"odyssey.stopAgent",defaultMessage:"Stop agent"},generatingImage:{id:"odyssey.generatingImage",defaultMessage:"Generating image"}}),Fn=({lines:e=10,speed:n=5,width:r="100%",height:o=400,className:s=""})=>{const d=os()?4:3,c=i.useMemo(()=>Array.from({length:e+d},()=>"".concat(60+Math.random()*40,"%")),[e,d]),x="bg-token-bg-tertiary rounded-md h-6",f=()=>t.jsxs("div",{className:"flex shrink-0 flex-col gap-4 pb-4",style:{width:"100%",height:o},children:[t.jsxs("div",{className:"flex w-full flex-row items-start gap-4",children:[t.jsx("div",{style:{width:"25%",aspectRatio:"1 / 1",position:"relative"},children:t.jsx("div",{className:x,style:{position:"absolute",inset:0,width:"100%",height:"100%"}})}),t.jsx("div",{className:"flex h-full flex-1 flex-col gap-4",style:{height:"100%"},children:Array.from({length:d}).map((h,y)=>t.jsx("div",{className:x,style:{width:c[y],flex:1}},y))})]}),c.slice(d).map((h,y)=>t.jsx("div",{className:x,style:{width:h}},y+d))]}),m=typeof o=="number"?"".concat(o,"px"):o;return i.useEffect(()=>{const h=document.createElement("style");return h.innerHTML="\n      @keyframes ws-scroll {\n        0% {\n          transform: translateY(calc(-1 * var(--ws-page-h)));\n        }\n        100% {\n          /* Move up exactly one page height */\n          transform: translateY(calc(-2* var(--ws-page-h)));\n        }\n      }\n      .animate-ws-scroll {\n        animation-name: ws-scroll;\n        animation-timing-function: ease-in-out;\n        animation-iteration-count: infinite;\n      }\n    ",document.head.appendChild(h),()=>{document.head.removeChild(h)}},[]),t.jsx("div",{className:"relative ".concat(s),style:{width:r,height:m},children:t.jsxs("div",{className:"animate-ws-scroll absolute inset-0 flex flex-col",style:{"--ws-page-h":m,animationDuration:"".concat(n,"s")},children:[t.jsx(f,{}),t.jsx(f,{})," ",t.jsx(f,{})," "]})})},Ge=({children:e,isKAUR1BR5:n=!1})=>t.jsx("div",{className:Z("bg-token-bg-tertiary flex h-7 w-full flex-row px-1",n?"h-12 shrink-0":"pt-1 text-[11px]"),children:e}),He=({children:e,className:n,isActive:r=!0,isKAUR1BR5:o=!1})=>{const[s,l]=i.useState(!1);i.useEffect(()=>{l(!0)},[]);const d=s?.5:.8,c=o?.9:.8,x=o?r?[c,1,1]:c:[c,1,1];return t.jsx("div",{className:Z("flex w-full shrink-0 flex-row p-4",n),children:t.jsx(ne.div,{className:"text-token-text-secondary bg-token-bg-primary flex size-full shrink-0 flex-col overflow-hidden rounded-lg shadow-md",initial:{opacity:0,scale:c,y:20},animate:{opacity:[0,1,1],scale:x,y:[20,0,0]},transition:{delay:d,duration:.55,times:[0,.75,1],ease:[.16,1,.3,1]},children:e})})},Gn=Me(()=>Ee(()=>import("./n7oqrmjgqin40oze.js"),__vite__mapDeps([6,1])),{loading:e=>Re(e)});function Kn({title:e,url:n,domain:r}){const{formatMessage:o}=je();return t.jsxs(He,{children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center text-center",children:o(Ce.reader)})}),t.jsx("div",{className:"flex flex-1 flex-col bg-black/10 px-16 pt-16",children:t.jsx(ms,{title:e})})]})}function ms({title:e}){const{formatMessage:n}=je();return t.jsx("div",{className:"bg-token-bg-primary justify-top relative flex h-full w-full flex-col items-center rounded-t-xl",children:t.jsxs("div",{className:"w-full overflow-clip",children:[t.jsxs("div",{className:"bg-token-bg-primary relative z-2 flex flex-col items-center justify-start rounded-t-xl pt-0 pb-0",style:{WebkitMaskImage:"linear-gradient(to top, transparent 0px, black 12px, black 12px, black 100%)",maskImage:"linear-gradient(to top, transparent 0px, black 12px, black 12px, black 100%)"},children:[t.jsxs("div",{className:"text-token-text-secondary z-2 flex flex-row items-center gap-2 py-2 text-xs font-medium",children:[t.jsx(Gn,{className:"text-token-text-secondary size-4"}),n(Ce.readingMode)]}),t.jsx("div",{className:"text-token-text-primary z-1 mb-4 line-clamp-3 w-full px-4 text-start text-2xl font-semibold overflow-ellipsis lg:text-3xl",children:e})]}),t.jsx("div",{className:"inset-0 z-0 w-full overflow-visible px-4",children:t.jsx(Fn,{})})]})})}const eo=Me(()=>Ee(()=>import("./e3jwynezq3sbw7bs.js").then(e=>e._),__vite__mapDeps([7,1])),{loading:e=>Re(e)});function to({tabMetadata:e,signedScreenshotUrl:n,newTabTitle:r,isReaderMode:o,domain:s,title:l,tetherData:d,isKAUR1BR5:c,isActive:x,serverThreadId:f,isStreaming:m}){var b,j;const h=jt(n),y=o?s:(b=e==null?void 0:e.domain)!=null?b:r,w=o?s:(j=e==null?void 0:e.origin)!=null?j:"";return t.jsxs(He,{isActive:x,isKAUR1BR5:c,className:Z(c&&"p-0!"),children:[t.jsx(Ge,{isKAUR1BR5:c,children:c?t.jsx(no,{isReaderMode:o,windowBarDomain:y,windowBarFaviconUrl:w,tetherData:d,serverThreadId:f,showOpenTabButton:m}):t.jsx(so,{isReaderMode:o,windowBarDomain:y,windowBarFaviconUrl:w,tetherData:d})}),t.jsxs("div",{className:"bg-token-bg-primary dark:bg-token-bg-secondary relative aspect-[1024/697] w-full overflow-hidden rounded-b-lg",children:[h&&t.jsx("img",{src:h,alt:"",className:"absolute inset-0 h-full w-full object-cover object-bottom"},h),t.jsx(Be,{children:o&&t.jsx(ne.div,{className:"absolute inset-0 flex items-center justify-center overflow-hidden rounded-b-md bg-black/20 backdrop-blur-[2px] dark:bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.4},children:t.jsx(ne.div,{className:"flex h-full w-full px-8 pt-4 lg:px-16 lg:pt-8",initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0,transition:{y:{duration:.6}}},transition:{type:"spring",stiffness:400,damping:32},children:t.jsx(ms,{domain:s,title:l})})})})]})]})}function so({isReaderMode:e,windowBarDomain:n,windowBarFaviconUrl:r,tetherData:o}){var l;const{formatMessage:s}=je();return t.jsxs("div",{className:"bg-token-bg-primary dark:bg-token-bg-secondary relative flex items-center rounded-t-[4px] px-2 shadow-md",children:[t.jsxs("div",{className:"flex items-center gap-1 text-[10px]",children:[t.jsx(at,{className:"size-3",url:e?(l=o==null?void 0:o.url)!=null?l:"":r!=null?r:"",size:32}),t.jsx("span",{className:"max-w-16 truncate",children:e?o==null?void 0:o.domain:n||s(ps.newTab)})]}),t.jsx(Zn,{radius:4,className:"text-token-bg-primary dark:text-token-bg-secondary absolute start-[-4px] bottom-0"}),t.jsx(Jn,{radius:4,className:"text-token-bg-primary dark:text-token-bg-secondary absolute end-[-4px] bottom-0"})]})}function no({isReaderMode:e,windowBarDomain:n,windowBarFaviconUrl:r,tetherData:o,serverThreadId:s,showOpenTabButton:l}){var x;const{formatMessage:d}=je(),c=us();return t.jsxs("div",{className:"relative flex w-full items-center justify-between px-1.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5 text-sm",children:[t.jsx(at,{className:"size-5",url:e?(x=o==null?void 0:o.url)!=null?x:"":r!=null?r:"",size:32}),t.jsx("span",{className:"max-w-32 truncate",children:e?o==null?void 0:o.domain:n||d(ps.newTab)})]}),l&&!c&&t.jsxs(ss,{color:"ghost",className:"text-token-text-secondary rounded-lg font-normal",contentWrapperClassName:"gap-1",onClick:()=>{var f;try{const m=Is();return(f=m==null?void 0:m.tryOpenAgentViewer(s))!=null?f:!1}catch(m){As.error("Failed to open local agent viewer - error thrown")}},children:[t.jsx(Ie,{defaultMessage:"Open tab",id:"odyssey.browserWindow.openTab"}),t.jsx(eo,{className:"icon-sm"})]})]})}const ps=ts({newTab:{defaultMessage:"New tab",id:"odyssey.browserWindow.newTab"}}),oo=({text:e,cadence:n=.1,fadeDuration:r=.5,className:o="",numLines:s=4})=>{const l=i.useMemo(()=>e.trim().split(/\s+/),[e]),d=i.useRef(null),c=i.useRef([]),[x,f]=i.useState(-1),[,m]=i.useState([]),h=i.useRef([]),[y,w]=i.useState(1),[b,j]=i.useState(0),[E,$]=i.useState(!1),[L,a]=i.useState(0),oe=i.useRef(null),J=i.useRef(null),D=i.useRef(1),K=i.useRef(y);i.useEffect(()=>{K.current=y},[y]);const de=os();i.useEffect(()=>{f(-1),m([]),h.current=[],h.current[0]=1,w(1),j(0),$(!1),c.current=[],a(R=>R+1),oe.current=null,J.current=null,D.current=1},[e,de]),i.useEffect(()=>{if(l.length===0)return;let R,U;const fe=T=>{var _,A;if(!h.current[T]){const H=c.current[T];if(H){const F=H.offsetTop;oe.current==null?(oe.current=F,J.current=F,D.current=1):F>((_=J.current)!=null?_:0)&&(D.current+=1,J.current=F),h.current[T]=D.current,m([...h.current])}}f(T);const N=(A=h.current[T])!=null?A:D.current;N>K.current&&(N<=s?w(N):j(N-s)),T<l.length-1?R=window.setTimeout(()=>fe(T+1),n*1e3):U=window.setTimeout(()=>$(!0),(r+1)*1e3)};return fe(0),()=>{clearTimeout(R),clearTimeout(U)}},[l,n,r,s,de]);const[X,he]=i.useState(null);Es(()=>{if(d.current&&X==null){const R=parseFloat(getComputedStyle(d.current).lineHeight);he(R)}},[X]);const re=X?-b*X:0,z=b===0?0:Math.min(100,n*500),ae={lineHeight:"1.4em",height:"calc(1.4em * ".concat(Math.min(y,s),")"),transition:"height 0.25s cubic-bezier(0.4, 0, 0.2, 1)"};return t.jsx("div",{className:"cursor-chat-bubble text-token-text-primary border-[hsba(0,0%,5%,0.2) bg-token-bg-elevated-primary w-full overflow-hidden rounded-lg border p-2 text-xs shadow-[0px_20px_25.000001907348633px_-5px_rgba(0,0,0,0.10)] lg:text-sm",style:{opacity:E||e.length===0?0:1,transition:"opacity ".concat(r,"s ease-in-out")},children:t.jsx("div",{ref:d,className:"teleprompter ".concat(o),style:ae,children:t.jsx("div",{className:"teleprompter-inner",style:{transform:"translateY(".concat(re,"px)"),transition:"transform ".concat(z,"ms linear")},children:l.map((R,U)=>{var fe;return t.jsxs("span",{ref:T=>{c.current[U]=T},style:{opacity:U<=x&&((fe=h.current[U])!=null?fe:1/0)>b?1:0,transition:"opacity ".concat(r,"s"),animation:"none"},className:"teleprompter-word",children:[R,"Â "]},U)})},L)})})},ro=768,ao=1024;function hs(e,n){return{top:e/ro*100,left:n/ao*100}}function xs(e){try{return new URL(e)}catch(n){return null}}function gs(e){return e?e.replace(/^www\./,""):null}function Qt(e){const n=xs(e),r=gs(n==null?void 0:n.hostname);return{domain:r!=null?r:null,name:null}}function io(e){return e.startsWith("http://localhost:8451/")?e.replace(/^http:\/\/localhost:8451\//,""):e}function lo(e){const n=e.match(/([^\/]+\.pdf)(?:[?#].*)?$/i);return n?n[1]:null}function Xt(e,n){var x;let r=e!=null?e:"",o=n!=null?n:null;const s=/\.pdf(?:[?#].*)?$/i.test(e),l=e.startsWith("http://localhost:8451/");if(s||l){const f=io(e);r=f;const m=lo(f);m&&(o=m)}const d=xs(r),c=(x=gs(d==null?void 0:d.hostname))!=null?x:null;return{tetherUrl:r,tetherTitle:o,domain:c}}const co=Me(()=>Ee(()=>import("./b8xidkl0ars31gwj.js"),__vite__mapDeps([8,1])),{loading:e=>Re(e)}),uo=120,fo=1.2,mo="right",po=.2,ho=.75,Yt=.08,xo=100,go=80,yo=1.2,st=(e=0)=>new Promise(n=>setTimeout(n,e));function wo(e,n=120){const[r,o]=ut.useState(e),[s,l]=ut.useState(!1);return ut.useEffect(()=>{l(!0);const d=setTimeout(()=>{o(e),l(!1)},n);return()=>clearTimeout(d)},[e,n]),[r,s]}const bo=({top:e,left:n,params:r={},text:o,actions:s,isKAUR1BR5:l})=>{const{forearmLength:d=uo,speed:c=fo,handBias:x=mo,curveFactor:f=po,shortMoveSlowdown:m=.8,slowDistance:h=100,dragSlowdown:y=yo}=r,[w,b]=i.useState({x:n,y:e}),j=Pt(1),E=Pt(0),$=i.useRef(null),L=i.useRef(w),a=i.useRef({p0:w,p1:w,p2:w}),oe=(T,N,_,A)=>{const H=1-A;return{x:H*H*T.x+2*H*A*N.x+A*A*_.x,y:H*H*T.y+2*H*A*N.y+A*A*_.y}},J=i.useRef(1),D=i.useRef(!1),K=Lt(E,T=>{const{p0:N,p1:_,p2:A}=a.current;return"".concat(oe(N,_,A,T).x,"%")}),de=Lt(E,T=>{const{p0:N,p1:_,p2:A}=a.current;return"".concat(oe(N,_,A,T).y,"%")}),[X,he]=wo(o,150),re=he?"":X,{x:z,y:ae,refs:{setReference:R,setFloating:U},strategy:fe}=Ms({placement:"right-start",whileElementsMounted:(T,N,_)=>Ps(T,N,_,{animationFrame:!0}),middleware:[Rs({mainAxis:4,crossAxis:24}),Os({padding:8,crossAxis:!0})]});return i.useEffect(()=>{var Ae;const T=w,N=L.current;if(T.x===N.x&&T.y===N.y){(Ae=$.current)==null||Ae.call($),$.current=null;return}const _=T.x-N.x,A=T.y-N.y,H=Math.hypot(_,A),F={x:N.x+_/2,y:N.y+A/2},q=(()=>{const le={x:-A,y:_},ge=Math.hypot(le.x,le.y)||1;return{x:le.x/ge,y:le.y/ge}})(),Q=(_>=0?1:-1)*(x==="right"?1:-1),S=Math.min(d,H/1.5)*f*Q,ee={x:F.x+q.x*S,y:F.y+q.y*S};a.current={p0:N,p1:ee,p2:T};const ve=Math.max(go/1e3,H/(c*120))*J.current,_e=1+m*Math.max(0,1-H/h),Pe=ve*_e;E.stop(),E.set(0);const Le=dt(E,1,{duration:Pe,ease:D.current?"linear":[.42,0,.58,1],onComplete:()=>{var le;(le=$.current)==null||le.call($),$.current=null}});return L.current=T,()=>Le.stop()},[w,d,c,x,f,m,h,E]),i.useEffect(()=>{if(!s||s.length===0)return;const T=s.filter(q=>["click","move","drag"].includes(q.action));if(T.length===0)return;const N=(q,Q)=>{const{top:me,left:S}=hs(Q,q);return new Promise(ee=>{if(L.current.x===S&&L.current.y===me){st().then(ee);return}$.current=ee,b({x:S,y:me})})},_=async()=>{await dt(j,ho,{duration:Yt}).finished},A=async()=>{await dt(j,1,{duration:Yt}).finished},H=async()=>{await _(),await st(xo),await A()};let F=!1;return(async()=>{try{for(const q of T){if(D.current=!1,F)break;switch(q.action){case"click":{const Q=q;await N(Q.x,Q.y),await st(200),await H();break}case"move":{const Q=q;await N(Q.x,Q.y);break}case"drag":{const Q=q;if(Q.path.length===0)break;const[me,...S]=Q.path;await N(me[0],me[1]),await st(100),await _(),D.current=!0,J.current=y;for(let ee=0;ee<S.length;ee++){const[ve,_e]=S[ee];ee===S.length-1&&(J.current=1,D.current=!1),await N(ve,_e)}await A();break}default:break}}}catch(q){Fe.addError(q)}})(),()=>{F=!0}},[s,j,y]),t.jsx("div",{className:Z("absolute inset-0",l?"mt-2":"m-4 mb-12"),children:t.jsx("div",{className:Z("relative",l?"aspect-[1024/777]":"aspect-[1024/755]"),children:t.jsxs("div",{className:"absolute inset-0",children:[t.jsx(ne.div,{ref:R,style:{left:K,top:de,scale:j},className:"pointer-events-none absolute z-10 -translate-x-[30%] -translate-y-[55%]",children:t.jsx(co,{className:"size-6"})}),t.jsx("div",{ref:U,className:"pointer-events-none absolute z-9 flex w-[240px] items-center justify-center lg:w-[320px]",style:{position:fe,top:ae!=null?ae:0,left:z!=null?z:0},children:t.jsx(oo,{text:re})})]})})})},jo=Me(()=>Ee(()=>import("./j0yo6uv6652vva62.js").then(e=>e.yo),__vite__mapDeps([0,1,2,3,4])),{loading:e=>Re(e)}),vo=({searchQuery:e,searchResults:n})=>{const[o,s]=i.useState(""),[l,d]=i.useState(null),c=i.useRef(null);i.useEffect(()=>{let f=!1;const m=y=>new Promise(w=>setTimeout(w,y));return(async()=>{if(await m(1e3),f)return;s(""),d(null);const y=[...e],w=y.length?1e3/y.length:1e3;for(let b=1;b<=y.length;b++){if(f)return;s(e.slice(0,b)),await m(w)}if(!f&&(d(n),await m(3e3),!f&&c.current)){const b=Math.floor(Math.random()*90)+10,j=(c.current.scrollHeight-c.current.clientHeight)*(b/100);c.current.scrollBy({top:j,behavior:"smooth"})}})(),()=>{f=!0}},[e,n]);const x=je();return t.jsxs(He,{className:"flex flex-col p-10",children:[t.jsx("div",{className:"border-token-border-default border-b p-2",children:t.jsxs("div",{className:"relative",children:[t.jsx(jo,{className:"icon text-token-text-primary absolute start-2 top-1/2 mt-[1px] size-4 -translate-y-1/2"}),t.jsx("input",{type:"text",className:"text-token-text-primary text-s w-full border-none bg-transparent px-2 py-1 ps-7 outline-none focus:ring-0",value:o,placeholder:x.formatMessage(Zs.searchPlaceholder),readOnly:!0,tabIndex:-1})]})}),t.jsx("div",{ref:c,className:"flex flex-1 flex-col gap-4 overflow-auto px-4 py-4",children:t.jsx(Be,{initial:!1,children:l==null?void 0:l.map((f,m)=>{var h;return t.jsxs(ne.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{delay:m*.06,duration:.25},className:"mb-2 flex max-w-full flex-col",children:[t.jsxs("a",{className:"text-token-text-secondary flex max-w-full items-center gap-1 text-xs",href:f.rawUrl,target:"_blank",rel:"noopener noreferrer",children:[t.jsx("div",{className:"flex w-5 shrink-0 items-center justify-start",children:t.jsx(at,{className:"size-4",url:(h=f.rawUrl)!=null?h:"",size:128})}),t.jsx("div",{className:"flex min-w-0 flex-1 flex-row items-center gap-1",children:f.url})]}),t.jsx("span",{className:"text-token-text-secondary text-s mt-1 truncate",children:f.title})]},m)})})})]})},_o=Cn.define([{tag:qe.keyword,color:"#C280DF"},{tag:qe.string,color:"#A1C281"},{tag:qe.number,color:"#C99C6E"},{tag:qe.bool,color:"#DFC184"},{tag:qe.comment,color:"#5C6370",fontStyle:"italic"},{tag:qe.variableName,color:"#D27378"},{tag:qe.operator,color:"#73ABE5"},{tag:qe.invalid,color:"#FFFFFF"}]),ot="chatgpt-agent % ",bt="cm-input-line",ys="cm-input-prefix",ko=()=>i.useMemo(()=>wt.theme({"&":{color:"#B0B6C3",backgroundColor:"#292C33",fontSize:"10px",height:"100%",width:"100%"},".cm-content":{caretColor:"#528BFF"},".cm-cursor, .cm-dropCursor":{borderLeftColor:"#528BFF"},".cm-selected":{backgroundColor:"#3E4451"},".cm-gutters":{backgroundColor:"#21252B",display:"none"},".cm-editor, .cm-scroller":{height:"100%"},".cm-scroller":{overflow:"auto"},".cm-line":{whiteSpace:"pre"},[".".concat(bt," *")]:{color:"#B0B6C3 !important"},[".".concat(bt," .").concat(ys)]:{color:"#73ABE5 !important"},".cm-content, .cm-line":{fontWeight:600,textRendering:"optimizeLegibility",WebkitFontSmoothing:"antialiased"}},{dark:!0}),[]),To=fs.line({class:bt}),No=fs.mark({class:ys}),Co=An.fromClass(class{constructor(e){Ot(this,"decorations");this.decorations=this.build(e)}update(e){(e.docChanged||e.viewportChanged)&&(this.decorations=this.build(e.view))}build(e){const n=new En;for(const{from:r,to:o}of e.visibleRanges){let s=r;for(;s<=o;){const l=e.state.doc.lineAt(s);l.text.startsWith(ot)&&(n.add(l.from,l.from,To),n.add(l.from,l.from+ot.length,No)),s=l.to+1}}return n.finish()}},{decorations:e=>e.decorations});function So({title:e,code:n}){const r=i.useRef(null),o=i.useRef(null),{docInstant:s,docDelayed:l,needsDelay:d}=i.useMemo(()=>{const x=n.map(f=>f.type==="input"?"".concat(ot).concat(f.content):f.content).join("\n");return n.length>0&&n[n.length-1].type==="input"?{docInstant:x,docDelayed:"".concat(x,"\n"),needsDelay:!0}:{docInstant:"".concat(x,"\n").concat(ot),docDelayed:"",needsDelay:!1}},[n]),c=ko();return i.useEffect(()=>{!r.current||o.current||(o.current=new wt({state:In.create({doc:s,extensions:[Tn.define(Sn),Nn(_o),wt.editable.of(!1),c,Co]}),parent:r.current}))},[s,c]),i.useEffect(()=>{const x=o.current;if(x){if(x.dispatch({changes:{from:0,to:x.state.doc.length,insert:s}}),d){const f=setTimeout(()=>{x.dispatch({changes:{from:0,to:x.state.doc.length,insert:l}}),x.scrollDOM.scrollTop=x.scrollDOM.scrollHeight},500);return()=>clearTimeout(f)}requestAnimationFrame(()=>{x.scrollDOM.scrollTop=x.scrollDOM.scrollHeight})}},[s,l,d]),t.jsxs(He,{children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center text-center",children:e})}),t.jsx("div",{className:"flex flex-1 bg-[#282C34]",style:{minHeight:0},children:t.jsx("div",{ref:r,className:"h-full w-full flex-1",style:{minHeight:0}})})]})}const Io=({id:e,children:n,content:r,side:o="bottom",sideOffset:s=4,align:l="center",className:d,triggerClassName:c,dismissOnOutsideClick:x=!0,allowReopen:f=!1})=>{const m="only-once-tooltip-dismissed:".concat(e),[h,y]=i.useState(!1),w=i.useRef(!1);i.useEffect(()=>{if(!w.current){w.current=!0;try{localStorage.getItem(m)==="true"||y(!0)}catch(j){y(!0)}}},[m]);const b=j=>{if(j){if(!f)try{if(localStorage.getItem(m)==="true")return}catch(E){}y(!0);return}try{localStorage.setItem(m,"true")}catch(E){}y(!1)};return t.jsxs(Js,{open:h,onOpenChange:b,children:[t.jsx(Fs,{asChild:!0,className:c,children:t.jsx("span",{children:n})}),t.jsx(Gs,{children:t.jsxs(Ks,{side:o,sideOffset:s,align:l,onPointerDownOutside:x?void 0:j=>j.preventDefault(),updatePositionStrategy:"always",className:Z("animate-slideLeftAndFade z-30 rounded-xl border bg-blue-400 p-4 text-white shadow-sm",d),children:[r,t.jsx(en,{asChild:!0,children:t.jsx("div",{className:"relative top-[-6px] h-3 w-3 rotate-45 transform rounded-ee-sm bg-blue-400"})})]})})]})},Zt="shadow-[0_5px_8px_3px_rgba(0,0,0,0.05),_0_0.5px_1px_0px_rgba(0,0,0,0.09)] outline outline-[0.5px] outline-black/5";function Ao(){return t.jsx("div",{className:"flex items-center justify-center gap-1",children:[0,1,2].map(e=>t.jsx("div",{className:"bg-token-border-heavy animate-dot-fade h-[6px] w-[6px] rounded-full opacity-50",style:{animationDelay:"".concat(e*.2,"s")}},e))})}const ws=52,Eo={hidden:{opacity:0,scale:.8},visible:{opacity:1,scale:1,transition:{stiffness:260,damping:20}}},Mo={initial:()=>({x:0}),animate:e=>({x:e?ws:0,transition:{stiffness:260,damping:20}})},Ro={initial:{opacity:0,scale:.8,x:0},animate:{opacity:1,scale:1,x:-ws,transition:{stiffness:260,damping:20}},exit:{opacity:0,scale:.8,x:0}},Oo=({connector:e,action:n,connectorFetchResult:r,connectorSearchResults:o})=>{const s=je(),l=Ls(),d=i.useMemo(()=>n?xn({action:n,source:e!=null?e:void 0,intl:s}):null,[n,e,s]);let c=l?e==null?void 0:e.logo_url_dark:e==null?void 0:e.logo_url;return l&&!c&&(c=e==null?void 0:e.logo_url),t.jsxs(He,{className:"p-12",children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center gap-2 text-center",children:t.jsx(Ie,{id:"cua.cot.agent.connectors",defaultMessage:"Connectors"})})}),t.jsxs("div",{className:"flex w-full flex-1 flex-col items-center justify-center gap-4",children:[t.jsxs("div",{className:"relative h-16 w-32",children:[t.jsx(Be,{children:c&&t.jsx(ne.div,{className:"absolute inset-0 flex items-center justify-center",variants:Ro,initial:"initial",animate:"animate",exit:"exit",children:t.jsx("div",{className:Z("bg-token-bg-elevated-primary rounded-lg p-2",Zt),children:t.jsx("img",{src:c,alt:e==null?void 0:e.name,className:"h-8 w-8 select-none"})})})}),t.jsx(Be,{children:c&&t.jsx(ne.div,{className:"absolute inset-0 flex items-center justify-center",variants:Eo,initial:"hidden",animate:"visible",exit:"hidden",children:t.jsx(Ao,{})})}),t.jsx(ne.div,{className:"absolute inset-0 z-10 flex items-center justify-center",variants:Mo,custom:c,initial:"initial",animate:"animate",children:t.jsx("div",{className:Z("bg-token-bg-elevated-primary rounded-lg p-3",Zt),children:t.jsx(Mn,{className:"text-token-text-primary h-6 w-6",matchTextColor:!0})})})]}),t.jsx("div",{className:"relative z-10 h-6 w-full",children:t.jsx(Be,{mode:"sync",children:t.jsx(ne.div,{className:"text-token-text-secondary pointer-events-none absolute inset-0 flex items-center justify-center text-center text-sm font-medium",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.25},children:d},d)})}),e&&(r||o)&&t.jsx("div",{className:"flex w-full flex-col items-center justify-center px-8",children:t.jsx(Po,{connectorFetchResult:r,connectorSearchResults:o,action:n})})]})]})},Po=({connectorFetchResult:e,connectorSearchResults:n,action:r})=>{const o=[];let s=[];if(r==="n7jupd_cs"&&n)s=n.map(d=>({entries:[{url:d.url,title:d.title,snippet:"",attribution:d.title}]}));else if(r==="n7jupd_cf"&&e)s=[{entries:[{url:e==null?void 0:e.url,title:e==null?void 0:e.title,snippet:"",attribution:e==null?void 0:e.title}]}];else return null;const l={type:V.Search,queries:o,sources:s};return t.jsx(gn,{chunk:l,isExpanded:!0,isComplete:!0,useCloudDocIcons:!0,isSmall:!1,isVisualCoT:!0})},Lo="_frostedContainer_1rwq4_1",Do="_blurStack_1rwq4_8",Vo="_blur_1rwq4_8",$o="_layer0_1rwq4_42",Ho="_layer1_1rwq4_47",Wo="_layer2_1rwq4_52",zo="_layer3_1rwq4_57",qo="_layer4_1rwq4_62",Bo="_layer5_1rwq4_67",pe={frostedContainer:Lo,blurStack:Do,blur:Vo,layer0:$o,layer1:Ho,layer2:Wo,layer3:zo,layer4:qo,layer5:Bo};function Uo({file_id:e,title:n,clientThreadId:r}){const[o,s]=i.useState(!1),l=rs(r),{data:d}=Pn(!0,l,e,void 0,()=>{});return t.jsx("div",{className:"bg-token-bg-tertiary flex h-full w-full flex-col items-center justify-center",children:t.jsxs("div",{className:"".concat(pe.frostedContainer," relative flex h-full w-full flex-row items-center justify-center text-center text-sm"),children:[t.jsx("div",{className:"text-token-text-secondary absolute top-0 z-10 flex w-full flex-row items-center justify-center py-2 text-xs font-medium",children:n}),!o&&t.jsx("img",{src:d==null?void 0:d.download_url,alt:"",className:"h-full w-full object-cover",onError:()=>s(!0)}),t.jsxs("div",{className:pe.blurStack,children:[t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer0)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer1)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer2)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer3)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer4)}),t.jsx("div",{className:"".concat(pe.blur," ").concat(pe.layer5)})]})]})})}const Qo=({file_id:e,title:n,clientThreadId:r,prompt:o})=>{const{formatMessage:s}=je();return e?t.jsx(He,{children:t.jsx("div",{className:"flex min-h-0 w-full flex-1 flex-col items-center justify-center",children:t.jsx(Uo,{file_id:e,title:n,clientThreadId:r})})}):t.jsx(He,{children:t.jsxs("div",{className:"bg-token-bg-tertiary flex h-full flex-col items-center justify-center",children:[t.jsx("div",{className:"flex w-full flex-row items-center justify-center py-2 text-center text-xs",children:s(Ce.generatingImage)}),t.jsxs("div",{className:"flex min-h-0 w-full flex-1 flex-col items-center justify-center gap-4",children:[t.jsx(Rn,{children:t.jsx(On,{matchTextColor:!0})}),t.jsx("div",{className:"text-token-text-secondary line-clamp-5 px-12 text-center text-xs italic",children:o})]})]})})},Xo=({signedScreenshotUrl:e})=>{const{formatMessage:n}=je(),r=jt(e);return t.jsxs(He,{children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center text-center",children:n(Ce.imageViewer)})}),t.jsx("div",{className:"flex min-h-0 w-full flex-1 flex-col items-center justify-center",children:r&&t.jsx("img",{src:r,alt:"",className:"max-h-full object-contain"})})]})};function Yo({signedScreenshotUrl:e}){const{formatMessage:n}=je(),r=jt(e);return t.jsxs(He,{children:[t.jsx(Ge,{children:t.jsx("div",{className:"flex w-full flex-row items-center justify-center text-center",children:n(Ce.libreoffice)})}),r&&t.jsx("div",{className:"bg-primary relative aspect-[1024/768] w-full overflow-hidden rounded-b-lg",children:t.jsx("img",{src:r,alt:"",className:"absolute inset-0 h-full w-full object-cover object-bottom"},r)})]})}const Oe=e=>typeof e=="object"&&e!=null,Se=e=>typeof e=="number",vt=e=>typeof e=="string",Zo=e=>Oe(e)&&e.action==="drag"&&Array.isArray(e.path)&&e.path.every(n=>Se(n[0])&&Se(n[1])),Jo=e=>Oe(e)&&e.action==="move"&&Se(e.x)&&Se(e.y),Fo=e=>Oe(e)&&e.action==="scroll"&&Se(e.x)&&Se(e.y)&&Se(e.scroll_y)&&Se(e.scroll_x),Go=e=>Oe(e)&&e.action==="click"&&Se(e.x)&&Se(e.y)&&Se(e.button),Ko=e=>Oe(e)&&e.action==="type"&&vt(e.text),er=e=>Oe(e)&&e.action==="keypress"&&Array.isArray(e.keys)&&e.keys.every(vt),tr=e=>Oe(e)&&e.action==="wait",sr=e=>Fo(e)||Go(e)||Ko(e)||er(e)||tr(e)||Zo(e)||Jo(e),nr=e=>Oe(e)&&e.action==="search_with_snippets"&&Array.isArray(e.queries)&&e.queries.every(vt),or=e=>nr(e);function rr(e){const n=e.indexOf("{");if(n<0)return;let r;try{r=JSON.parse(e.slice(n))}catch(s){Fe.addError(s);return}if(!Oe(r)||!Array.isArray(r.actions))return;const o=r.actions.filter(sr);return o.length>0?{actions:o}:void 0}function Jt(e){let n;try{n=JSON.parse(e!=null?e:"{}")}catch(o){Fe.addError(o);return}if(!Oe(n)||!Array.isArray(n.actions))return;const r=n.actions.filter(or);return r.length>0?{actions:r}:void 0}const ar=Me(()=>Ee(()=>import("./2uk20wu2pu1737un.js").then(e=>e._),__vite__mapDeps([9,1])),{loading:e=>Re(e)}),ir=Me(()=>Ee(()=>import("./j7q6dd79tspx35h1.js").then(e=>e._),__vite__mapDeps([10,1])),{loading:e=>Re(e)}),lr=Me(()=>Ee(()=>import("./hkdu34erhu96s165.js").then(e=>e._),__vite__mapDeps([11,1])),{loading:e=>Re(e)}),cr=({value:e,max:n,isPlaying:r,onChange:o,onPlayPause:s,onRestart:l,onLive:d,isLive:c,isComplete:x,isKAUR1BR5:f})=>{const{formatMessage:m}=je(),h=us(),y=Ds();return h||y?null:t.jsxs("div",{className:Z("z-10 flex w-full items-center gap-2 px-4 py-0 pb-4 text-xs select-none",f?"absolute bottom-0 opacity-0 transition-opacity duration-300 group-hover:opacity-100":"relative"),children:[t.jsx("div",{className:Z("absolute start-0 w-full bg-gradient-to-t from-gray-950/90 to-gray-500/0",f?"-top-5 h-20":"top-0 h-16")}),x&&t.jsx("button",{className:"border-token-border-light hover:bg-token-surface-primary/20 relative z-10 rounded text-white",onClick:c?l:s,children:r?t.jsx(ir,{className:"size-4"}):c?t.jsx(lr,{className:"size-4"}):t.jsx(ar,{className:"size-4"})}),t.jsxs(tn,{className:"group relative flex flex-1 items-center",min:0,max:n,step:1,value:[e],onValueChange:([w])=>o(w),children:[t.jsx(sn,{className:"relative h-[4px] w-full grow cursor-pointer rounded-full bg-black/20",children:t.jsx(nn,{className:"absolute h-full rounded-full bg-white/90"})}),t.jsx(on,{className:"touch:h-3 touch:w-3 relative block h-1.5 w-1.5 scale-100 cursor-pointer rounded-full border bg-white shadow-md transition-transform group-hover:scale-200 before:pointer-events-auto before:absolute before:inset-[-12px] before:rounded-full before:bg-transparent before:content-[''] focus:outline-none"})]}),!x&&t.jsx("span",{className:Z("z-1 cursor-pointer font-medium text-white uppercase opacity-50",c&&"text-gray-500 opacity-100"),onClick:d,children:m(Ce.live)})]})},ur=Me(()=>Ee(()=>import("./gsas8pb1acnf7jnd.js").then(e=>e._),__vite__mapDeps([12,1])),{loading:e=>Re(e)}),Ft="file:///home/oai/redirect.html",dr=0,Gt=35,Kt=20;function pt(e,n){const{cursorTop:r,cursorLeft:o}=e;return r<n.top||r>n.top+n.height||o<n.left||o>n.left+n.width?(e.cursorTop=Math.random()*n.height+n.top,e.cursorLeft=Math.random()*n.width+n.left,!0):!1}const ht={image_viewer:{top:80,left:0,width:100,height:20},api_tool:{top:0,left:50,width:50,height:10}},fr=(e,n,r)=>{var x,f,m,h,y,w,b,j,E,$,L,a,oe,J,D,K,de,X,he,re,z,ae,R,U,fe,T,N,_,A,H,F,q,Q,me,S,ee,ve,_e,Pe,Le,Ae,le,ge,ye,Ze,Ue,Qe,Xe,ce,We,De,ze,C,W,ue,I,v,te,se,we,ke;let o=0;const{message:s,groupType:l}=n;let d=!1;const c=u=>{const g=e.openApps.indexOf(u);g!==-1?e.currentWindowIndex=g:(e.openApps.push(u),e.currentWindowIndex=e.openApps.length-1)};switch(l){case xe.StructuredThoughts:break;case xe.CodeInterpreter:if(c("terminal"),s.author.role==="tool"&&s.author.name==="container.exec"&&s.content.content_type==="text"){const u=s.content.parts.map(g=>({type:"output",content:g}));e.code.push(...u)}else if(s.author.role==="assistant"&&s.recipient==="python"&&s.content.content_type==="code"){const u=(x=s.content.text)!=null?x:"";e.code.push({type:"input",content:"python <<EOF\n".concat(u,"\nEOF\n")})}else if(s.author.role==="tool"&&s.author.name==="python"&&s.content.content_type==="execution_output"){const u=(f=s.content.text)!=null?f:"";e.code.push({type:"output",content:u})}else if(s.author.role==="assistant"&&s.recipient==="container.exec"&&s.content.content_type==="code")try{const u=JSON.parse(s.content.text).cmd;e.code.push({type:"input",content:u.join(" ")})}catch(u){Fe.addError(u)}o=2e3;break;case xe.n7jupd:if(s.content.content_type===$e.ComputerOutput){const u=(h=(m=s.metadata)==null?void 0:m.n7jupd_v)==null?void 0:h.title,g=(w=(y=s.metadata)==null?void 0:y.n7jupd_v)==null?void 0:w.application,k=ct(lt({},s.content.screenshot),{vmMetadata:(b=s.metadata)==null?void 0:b.n7jupd_v,messageId:s.id});g==="Browser"?(e.isReaderMode=!1,c("browser"),e.screenshots.push(k)):g!=null&&g.startsWith("LibreOffice")||g!=null&&g.startsWith("Select a Template")?(e.isReaderMode=!1,c("libreoffice"),e.libreOfficeScreenshots.push(k)):(e.isReaderMode=!1,c("browser"),e.screenshots.push(k)),e.tabMetadata=cs(k),e.computerApplication=g!=null?g:null,e.computerTitle=u!=null?u:null,o=2e3}if(s.content.content_type===$e.StructuredThoughts&&(e.thought=s.content.thoughts.map(u=>u.content).join(""),o=1e3),s.recipient!=="computer.switch_app"){if((j=s.recipient)!=null&&j.includes("computer")&&s.content.content_type===$e.Code){const u=s.content.text,g=rr(u);e.actions=(E=g==null?void 0:g.actions)!=null?E:[],o=1e3,g&&(g.actions.forEach(k=>{switch(k.action){case"click":{d=!0;const{top:O,left:M}=hs(k.y,k.x);e.cursorTop=O,e.cursorLeft=M,e.isCursorInInitialPosition=!1,o+=1e3;break}case"type":break;case"scroll":break;case"keypress":break;case"wait":break;case"move":break;case"drag":o+=1e3;break}}),o=Math.min(o,4e3))}}break;case xe.n7jupd_x:if(s.author.role==="assistant"&&s.content.content_type===$e.Code){const u=Jt(s.content.text),g=u==null?void 0:u.actions.find(k=>k.action==="search_with_snippets"&&k.queries.length);g&&(c("search"),e.searchResults=null,e.searchQuery=g.queries.join(" || "),o=1e3)}else if(s.author.name==="browser.search"){c("search");const u=(oe=(a=(L=($=s.metadata)==null?void 0:$.n7jupd_title)==null?void 0:L.match(/`(.*)`/))==null?void 0:a[1])!=null?oe:"",g=(D=(J=s.metadata)==null?void 0:J.n7jupd_titles)==null?void 0:D.map((k,O)=>{var ie,be,Te;const M=(Te=(be=(ie=s.metadata)==null?void 0:ie.n7jupd_urls)==null?void 0:be[O])!=null?Te:"",{domain:Y}=Qt(M);return{title:k,url:Y!=null?Y:void 0,name:void 0,rawUrl:M}});e.searchResults=g!=null?g:null,e.searchQuery=u,o=6e3}else if(s.author.name==="browser.open"&&s.content.content_type==="tether_browsing_display"){c("browser"),e.isReaderMode=!0;const u=(de=(K=s.metadata)==null?void 0:K.n7jupd_url)!=null?de:"",{tetherUrl:g,tetherTitle:k,domain:O}=Xt(u,(he=(X=s.metadata)==null?void 0:X.n7jupd_title)!=null?he:null);e.tetherData={summary:(re=s.content.summary)!=null?re:null,result:(z=s.content.result)!=null?z:null,domain:O,title:k,url:g},e.tetherData.title===Ft&&(e.isReaderMode=!1),o=6e3}else if(s.author.name==="browser.run"&&s.content.content_type==="tether_browsing_display"){const u=(fe=(U=(R=(ae=s.metadata)==null?void 0:ae.n7jupd_title)==null?void 0:R.match(/`(.*)`/))==null?void 0:U[1])!=null?fe:"",g=(N=(T=s.metadata)==null?void 0:T.n7jupd_titles)==null?void 0:N.map((k,O)=>{var ie,be,Te;const M=(Te=(be=(ie=s.metadata)==null?void 0:ie.n7jupd_urls)==null?void 0:be[O])!=null?Te:"",{domain:Y}=Qt(M);return{title:k,url:Y!=null?Y:void 0,name:void 0,rawUrl:M}});if(g!=null&&g.length)c("search"),e.searchResults=g,e.searchQuery=u,o=6e3;else{c("browser"),e.isReaderMode=!0;const k=(A=(_=s.metadata)==null?void 0:_.n7jupd_url)!=null?A:"",{tetherUrl:O,tetherTitle:M,domain:Y}=Xt(k,(F=(H=s.metadata)==null?void 0:H.n7jupd_title)!=null?F:null);e.tetherData={summary:(q=s.content.summary)!=null?q:null,result:(Q=s.content.result)!=null?Q:null,domain:Y,title:M,url:O},e.tetherData.title===Ft&&(e.isReaderMode=!1),o=6e3}}break;case xe.n7jupd_a:{const u=(me=s.metadata)==null?void 0:me.n7jupd_subtool,g=$t();(S=u==null?void 0:u.subtool)!=null&&S.includes("search")?e.apiAction="n7jupd_as":(ee=u==null?void 0:u.subtool)!=null&&ee.includes("api_doc")&&(e.apiAction="n7jupd_ag");const k=(_e=(ve=s.metadata)==null?void 0:ve.n7jupd_subtool)==null?void 0:_e.generic_api_func;let O=(Le=(Pe=k==null?void 0:k.match(ft))==null?void 0:Pe[0])!=null?Le:void 0;O||(O=(ye=(ge=(le=(Ae=s.metadata)==null?void 0:Ae.n7jupd_url)==null?void 0:le.match(ft))==null?void 0:ge[0])!=null?ye:void 0);const M=g==null?void 0:g.get(O!=null?O:"");if(!O||!M)e.apiAction="n7jupd_cf";else if((Ze=s.metadata)!=null&&Ze.connector_source&&s.content.content_type===$e.TetherBrowsingDisplay){(Ue=s.metadata)!=null&&Ue.display_url&&((Qe=s.metadata)!=null&&Qe.display_title)&&(e.apiAction="n7jupd_cf",e.connector=M,e.connectorFetchResult={url:(Xe=s.metadata)==null?void 0:Xe.display_url,title:(ce=s.metadata)==null?void 0:ce.display_title});const Y=Ht(s.content.result);Y.length&&(e.apiAction="n7jupd_cs",e.connector=M,e.connectorSearchResults=Y.map(([ie,be])=>({url:ie,title:be})))}c("api_tool"),pt(e,ht.api_tool),o=1e3,M&&(e.connector=M);break}case xe.n7jupd_native_api_tool:{const u=s.recipient;if(u!=null&&u.includes("list_resources")||u!=null&&u.includes("search_tools")?e.apiAction="n7jupd_as":(u!=null&&u.includes("read_resources")||u!=null&&u.includes("get_resource"))&&(e.apiAction="n7jupd_ag"),s.content.content_type!==$e.CitableCodeOutput)e.apiAction="n7jupd_cf";else{const g=$t();e.apiAction="n7jupd_cf";let k=(De=(We=s.content.metadata)==null?void 0:We.connector_id)!=null?De:void 0;k||(k=(C=(ze=s.content.output_str.match(ft))==null?void 0:ze[0])!=null?C:void 0);const O=g==null?void 0:g.get(k!=null?k:"");O&&(e.connector=O),(W=s.content.metadata)!=null&&W.display_url&&((ue=s.content.metadata)!=null&&ue.display_title)&&(e.connectorFetchResult={url:(I=s.content.metadata)==null?void 0:I.display_url,title:(v=s.content.metadata)==null?void 0:v.display_title});const M=Ht(s.content.output_str);M.length&&(e.apiAction="n7jupd_cs",e.connectorSearchResults=M.map(([Y,ie])=>({url:Y,title:ie})))}c("api_tool"),pt(e,ht.api_tool),o=1e3;break}case xe.Container:s.content.content_type===$e.MultimodalText&&(c("image_viewer"),pt(e,ht.image_viewer),s.content.parts.forEach(u=>{typeof u!="string"&&u.content_type===Dt.ImageAssetPointer&&e.imageViewerScreenshots.push(ct(lt({},u),{messageId:s.id}))}),o=3e3);break;case xe.t2uay3k:if(!r)break;if(s.author.name==="t2uay3k.sj1i4kz"&&s.content.content_type===$e.MultimodalText){const u=s.content.parts.at(0);if(typeof u=="string")break;(u==null?void 0:u.content_type)===Dt.ImageAssetPointer?(e.imageGenFileId=u.asset_pointer,o=2e3):Fe.addError("Error parsing image gen file id",{message:s}),e.imageGenTitle=(se=(te=s.metadata)==null?void 0:te.image_gen_title)!=null?se:null,o=2e3}break;case xe.Debug:{if(s.author.role==="assistant"&&s.content.content_type===$e.Code){const u=Jt(s.content.text),g=u==null?void 0:u.actions.find(k=>k.action==="search_with_snippets"&&k.queries.length);g&&(c("search"),e.searchResults=null,e.searchQuery=g.queries.join(" || "),o=Math.max(o,1e3))}if(!r)break;if(s.recipient==="imagegen.make_image"&&s.content.content_type==="code"){c("image_gen"),e.imageGenFileId=null,o=1e3,e.imageGenTitle=(ke=(we=s.metadata)==null?void 0:we.image_gen_title)!=null?ke:null;try{e.imageGenPrompt=JSON.parse(s.content.text).prompt}catch(u){Fe.addError("Error parsing image gen prompt",{e:u,text:s.content.text})}}break}}return!d&&(e.isCursorInInitialPosition||Math.random()<dr)&&e.openApps.length&&(e.isCursorInInitialPosition=!1,e.cursorTop=Math.random()*30+20,e.cursorLeft=Math.random()*60+20),o},mr=({messageGroups:e,isStreaming:n,isFinalAssistantTurn:r,isComplete:o,clientThreadId:s,enableVisualReaderMode:l=!1,isKAUR1BR5:d=!1})=>{var T,N,_,A,H,F,q,Q,me,S,ee,ve,_e,Pe,Le,Ae,le,ge,ye,Ze,Ue,Qe,Xe,ce,We,De,ze;const c=rs(s),x=rt(),f=as(x,"3639187874"),m=i.useMemo(()=>e.flatMap(W=>W.messages.map(ue=>({message:ue,groupType:W.type}))).map(W=>({message:W.message,messageType:Vs(W.message),groupType:W.groupType})),[e]),[h,y]=i.useState([]),[w,b]=i.useState(0),[j,E]=i.useState(n),[$,L]=i.useState(!0),[a,oe]=i.useState(null),J=rn(s),D=i.useRef(null),K=nt(a==null?void 0:a.screenshot,c),de=nt(a==null?void 0:a.libreOfficeScreenshots.at(-1),c),X=nt(a==null?void 0:a.imageViewerScreenshots.at(-1),c),he=i.useCallback((C,W)=>{var te,se,we,ke,u,g,k,O,M,Y,ie,be,Te,et,tt;const ue=[...C];let I=ue.length>0?ue[ue.length-1]:null,v;I?v={cursorTop:I.cursorTop,cursorLeft:I.cursorLeft,thought:I.thought,openApps:[...I.openApps],currentWindowIndex:I.currentWindowIndex,screenshots:I.screenshot?[I.screenshot]:[],libreOfficeScreenshots:(te=I.libreOfficeScreenshots)!=null?te:[],searchResults:(se=I.searchResults)!=null?se:null,searchQuery:(we=I.searchQuery)!=null?we:null,code:[...I.code],tabMetadata:(ke=I.tabMetadata)!=null?ke:null,isCursorInInitialPosition:!1,tetherData:(u=I.tetherData)!=null?u:null,lastVisualAppSwitch:(g=I.lastVisualAppSwitch)!=null?g:null,imageViewerScreenshots:(k=I.imageViewerScreenshots)!=null?k:[],connector:(O=I.connector)!=null?O:null,computerApplication:(M=I.computerApplication)!=null?M:null,computerTitle:(Y=I.computerTitle)!=null?Y:null,isReaderMode:(ie=I.isReaderMode)!=null?ie:!1,actions:null,imageGenTitle:(be=I.imageGenTitle)!=null?be:null,imageGenFileId:(Te=I.imageGenFileId)!=null?Te:null,imageGenPrompt:null}:v={cursorTop:Gt,cursorLeft:Kt,thought:"",openApps:[],currentWindowIndex:0,screenshots:[],searchResults:null,searchQuery:null,code:[],tabMetadata:null,isCursorInInitialPosition:!0,isReaderMode:!1,tetherData:null,libreOfficeScreenshots:[],lastVisualAppSwitch:null,imageViewerScreenshots:[],connector:null,computerApplication:null,computerTitle:null,actions:null,imageGenTitle:null,imageGenFileId:null,imageGenPrompt:null};for(let Je=ue.length;Je<=W;Je++){const Ye=fr(v,m[Je],f),Ke={cursorTop:v.cursorTop,cursorLeft:v.cursorLeft,thought:v.thought,openApps:[...v.openApps],currentWindowIndex:v.currentWindowIndex,screenshot:(tt=((et=v.screenshots)!=null?et:[]).at(-1))!=null?tt:null,searchResults:v.searchResults,searchQuery:v.searchQuery,code:[...v.code],tabMetadata:v.tabMetadata,isReaderMode:v.isReaderMode,tetherData:v.tetherData,libreOfficeScreenshots:[...v.libreOfficeScreenshots],lastVisualAppSwitch:v.lastVisualAppSwitch,imageViewerScreenshots:[...v.imageViewerScreenshots],connector:v.connector,apiAction:v.apiAction,connectorFetchResult:v.connectorFetchResult,connectorSearchResults:v.connectorSearchResults,delayMs:Ye,computerApplication:v.computerApplication,computerTitle:v.computerTitle,actions:v.actions,imageGenTitle:v.imageGenTitle,imageGenFileId:v.imageGenFileId,imageGenPrompt:v.imageGenPrompt};I&&(Ke.lastVisualAppSwitch=I.lastVisualAppSwitch),ue.push(Ke),I=Ke}return{newFrames:ue}},[m,f]);i.useEffect(()=>{if(h.length<m.length){const{newFrames:C}=he(h,m.length-1);y(C)}$&&b(m.length-1)},[m.length,he,h,$]);const re=i.useCallback(()=>{if(w>=h.length-1){o&&(E(!1),L(!0));return}const C=h[w];D.current&&clearTimeout(D.current),D.current=setTimeout(()=>{b(W=>W+1)},C.delayMs)},[w,h,o]);i.useEffect(()=>{if(!$)return j&&re(),()=>{D.current&&clearTimeout(D.current)}},[j,w,h.length,re,$]),i.useEffect(()=>{const C=h[w];C&&oe(C)},[w,h]);const{formatMessage:z}=je(),ae=(a==null?void 0:a.currentWindowIndex)===(a==null?void 0:a.openApps.findIndex(C=>C==="browser")),R={browser:t.jsx(to,{tabMetadata:(T=a==null?void 0:a.tabMetadata)!=null?T:null,signedScreenshotUrl:K,newTabTitle:z(Ce.newTab),isReaderMode:(N=a==null?void 0:a.isReaderMode)!=null?N:!1,url:(A=(_=a==null?void 0:a.tetherData)==null?void 0:_.url)!=null?A:"",domain:(F=(H=a==null?void 0:a.tetherData)==null?void 0:H.domain)!=null?F:"",title:(Q=(q=a==null?void 0:a.tetherData)==null?void 0:q.title)!=null?Q:"",tetherData:(me=a==null?void 0:a.tetherData)!=null?me:null,isKAUR1BR5:d,isActive:ae,serverThreadId:c!=null?c:"",isStreaming:n}),terminal:t.jsx(So,{title:z(Ce.terminal),code:(S=a==null?void 0:a.code)!=null?S:[]}),search:t.jsx(vo,{searchQuery:(ee=a==null?void 0:a.searchQuery)!=null?ee:"",searchResults:(ve=a==null?void 0:a.searchResults)!=null?ve:null}),libreoffice:t.jsx(Yo,{title:z(Ce.libreoffice),signedScreenshotUrl:de}),tether_browser:l?null:t.jsx(Kn,{url:(Pe=(_e=a==null?void 0:a.tetherData)==null?void 0:_e.url)!=null?Pe:"",domain:(Ae=(Le=a==null?void 0:a.tetherData)==null?void 0:Le.domain)!=null?Ae:"",title:(ge=(le=a==null?void 0:a.tetherData)==null?void 0:le.title)!=null?ge:""}),image_viewer:t.jsx(Xo,{signedScreenshotUrl:X}),api_tool:t.jsx(Oo,{connector:(ye=a==null?void 0:a.connector)!=null?ye:null,connectorFetchResult:a==null?void 0:a.connectorFetchResult,connectorSearchResults:a==null?void 0:a.connectorSearchResults,action:a==null?void 0:a.apiAction}),image_gen:t.jsx(Qo,{file_id:(Ze=a==null?void 0:a.imageGenFileId)!=null?Ze:"",title:(Ue=a==null?void 0:a.imageGenTitle)!=null?Ue:"",clientThreadId:s,prompt:(Qe=a==null?void 0:a.imageGenPrompt)!=null?Qe:""})},U=a==null?void 0:a.openApps.map(C=>R[C]),fe=n&&r&&J;return t.jsxs("div",{className:"group flex w-full flex-col gap-2",children:[t.jsx("div",{className:Z("border-token-border-default bg-token-surface-primary relative flex w-full flex-col items-center overflow-hidden rounded-2xl border",fe&&"outline-2 outline-offset-1 outline-orange-500"),children:t.jsxs("div",{className:"relative flex w-full flex-col overflow-hidden",children:[t.jsx("div",{className:"absolute start-0 end-0 top-0 bottom-0 dark:hue-rotate-180 dark:invert",children:t.jsx("video",{className:"h-full w-full object-cover",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:t.jsx("source",{src:"https://persistent.oaistatic.com/deep-research/d9a42348470e-bg.mp4",type:"video/mp4"})})}),t.jsx(bo,{top:(Xe=a==null?void 0:a.cursorTop)!=null?Xe:Gt,left:(ce=a==null?void 0:a.cursorLeft)!=null?ce:Kt,text:(We=a==null?void 0:a.thought)!=null?We:"",actions:(De=a==null?void 0:a.actions)!=null?De:[],isKAUR1BR5:d}),t.jsx("div",{className:"relative flex h-full w-full flex-row",style:{transform:"translateX(-".concat(((ze=a==null?void 0:a.currentWindowIndex)!=null?ze:0)*100,"%)"),transition:"transform 0.5s cubic-bezier(0.4,0,0.2,1)",width:"100%",paddingTop:d?"calc((714 / 1024 * 100%) + 38px)":"calc((697 / 1024 * 100%) + 38px)"},children:t.jsx("div",{className:"absolute inset-0 flex h-full flex-row",children:U})}),t.jsx(cr,{value:w,max:Math.max(h.length-1,0),isPlaying:j,onChange:C=>{E(!1),b(C),C===h.length-1?L(!0):L(!1)},onPlayPause:()=>E(C=>!C),onRestart:()=>{b(0),E(!0),L(!1)},onLive:()=>{b(h.length-1),E(!0),L(!0)},isLive:$,isComplete:o,isKAUR1BR5:d})]})}),fe&&t.jsxs("div",{className:"flex flex-row items-center justify-start gap-1",children:[t.jsx(Io,{id:"risky-domain-warning",side:"top",sideOffset:-8,allowReopen:!0,className:"max-w-sm",content:t.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[t.jsx("div",{className:"font-semibold",children:t.jsx(Ie,{id:"OZapq8",defaultMessage:"Watch while ChatGPT works with sensitive data"})}),t.jsx("div",{children:t.jsx(Ie,{id:"1orBxj",defaultMessage:"ChatGPT is working with {riskyDomain}, which contains sensitive data. If you notice anything bad happening, you can stop the task.",values:{riskyDomain:t.jsx("span",{className:"font-medium",children:J})}})})]}),children:t.jsxs("div",{className:"flex flex-row items-center gap-1 text-orange-500",children:[t.jsx(ur,{className:"size-4 cursor-pointer"}),t.jsx(Ie,{id:"51tzX5",defaultMessage:"Sensitive data Â· Something not right?"})]})}),t.jsx("button",{className:"text-token-text-secondary underline","aria-label":z(Ce.stopAgent),onClick:async()=>{await an(s,void 0,{clientInitiated:!0,reason:"watch_mode_stop",isLastTurnAgent:!0})},children:z(Ce.stopAgent)})]})]})},pr=({isAgentTurn:e,clientThreadId:n,children:r,messageGroups:o,isExpanded:s,visualMode:l,isStreaming:d,isComplete:c,isStopping:x,isFinalAssistantTurn:f,isKAUR1BR5:m,enableVisualReaderMode:h=!1})=>{if(!e)return r;if(!s&&!d||x)return null;const y=l==="visual-cot",w=l==="list-cot";return t.jsxs("div",{className:"flex flex-col",children:[y&&t.jsx(mr,{clientThreadId:n,messageGroups:o,isStreaming:d,isComplete:c,isFinalAssistantTurn:f,enableVisualReaderMode:h,isKAUR1BR5:m}),w&&t.jsx(hr,{children:r})]})},hr=({children:e})=>{const n=i.useRef(null),[r,o]=i.useState(!0);return i.useEffect(()=>{const s=n.current;if(!s)return;const l=()=>{const d=s.scrollHeight-s.scrollTop-s.clientHeight;o(d<=1)};return s.addEventListener("scroll",l,{passive:!0}),()=>s.removeEventListener("scroll",l)},[]),i.useEffect(()=>{const s=n.current;!s||!r||requestAnimationFrame(()=>{s.scrollTop=s.scrollHeight})},[e,r]),t.jsx("div",{ref:n,className:"border-token-border-light flex aspect-[614/493] flex-col overflow-auto rounded-lg border p-4",children:t.jsx("div",{className:"flex flex-col",children:e})})},es={duration:.3,ease:"easeInOut"},xt=.2,$r=({isStreaming:e,isFinalAssistantTurn:n,messageGroups:r,nextMessageGroup:o,prevMessageGroup:s,isAutoswitchOptOutEnabled:l,handleSkipClick:d,isAgentTurn:c,isGlauxTurn:x,isKAUR1BR5:f,taskType:m,latestError:h,wasInterrupted:y,lastAgentMetadataNode:w,conversation:b,turnIndex:j,currentGroupedMessageIndex:E})=>{const $=rt(),L=ds($,!!c),a=i.useMemo(()=>r.some(R=>R.type===xe.n7jupd_a||R.type===xe.n7jupd_native_api_tool),[r]),{platformConnectors:oe}=$s(a),[J,D]=i.useState(!1);Xn();const{chunks:K,isAgentVisualCoT:de,containsAuraComputerTool:X}=i.useMemo(()=>kn(r,x),[r,x]),he=o==null?void 0:o.messages.some(R=>ln(R)),{toggleThreadSidebar:re}=cn(),z=i.useCallback(()=>{re({type:"cot",turnIndex:j,reasoningGroupIndex:E})},[re,j,E]),ae=i.useCallback(()=>{var R,U;re({type:"retrievalResults",turnIndex:j,messageId:(U=(R=r[0])==null?void 0:R.messages[0])==null?void 0:U.id})},[re,j,r]);return h&&!he?t.jsx(vn,{errorState:h,nodeId:h.messageId,isFeedbackEnabled:!1,conversation:h.conversation,isUserTurn:!1}):t.jsx(un,{value:{platformConnectors:oe},children:t.jsx(gr,{conversation:b,isStreaming:e,isFinalAssistantTurn:n,chunks:K,isAutoswitchOptOutEnabled:l,isAgentTurn:c,containsAuraComputerTool:X,handleSkipClick:d,handleOpenCotSidebar:z,handleShowRetrievalResults:ae,nextMessageGroup:o,prevMessageGroup:s,messageGroups:r,isAgentVisualCoT:de,isKAUR1BR5:f,isGlauxTurn:x,taskType:m,wasInterrupted:y,lastAgentMetadataNode:w,isExpanded:!L&&J,setIsExpanded:D,turnIndex:j})})},xr=e=>{for(const{messages:n}of e)for(const{metadata:r}of n)if(r!=null&&r.skip_reasoning_title)return r.skip_reasoning_title},gr=({conversation:e,isStreaming:n,isFinalAssistantTurn:r,chunks:o,isAutoswitchOptOutEnabled:s,isAgentTurn:l,handleSkipClick:d,handleOpenCotSidebar:c,handleShowRetrievalResults:x,nextMessageGroup:f,prevMessageGroup:m,messageGroups:h=[],isAgentVisualCoT:y,containsAuraComputerTool:w=!1,isKAUR1BR5:b,isGlauxTurn:j,taskType:E,wasInterrupted:$,lastAgentMetadataNode:L,isExpanded:a,setIsExpanded:oe,turnIndex:J})=>{var Nt,Ct,St;const D=je(),K=rt(),de=((Nt=L==null?void 0:L.metadata)==null?void 0:Nt.agent_entrypoint)==="autoswitcher",X=l?de:s,he=X?xr(h):void 0,re=Hs(),z=Qn(o,n,re,de,b!=null?b:!1),ae=l?z!==Ne.Done:!1,[R,U]=Ws(()=>[Bs(K),Us(K)]),_=as(K,"1668913216")&&y&&!(R||U&&!w),A=i.useMemo(()=>{var P,B;let p="visual-cot";return L&&(p=(B=(P=L==null?void 0:L.metadata)==null?void 0:P.default_view)!=null?B:"visual-cot"),p},[L]),[H,F]=i.useState(A),[q,Q]=i.useState([]),me=i.useMemo(()=>Yn(o),[o]),S=!n,ee=i.useMemo(()=>l?o.filter(P=>P.type!==V.Recap&&P.type!==V.Thought).slice(-3).some(P=>P.type===V.ComputerOutput):!1,[o,l]),ve=i.useMemo(()=>l&&o.some(p=>p.type===V.Recap&&p.content.includes("Stopped")),[o,l]),_e=p=>{var P,B,G,Ve,It,At,Et,Mt;return(B=(P=p.metadata)==null?void 0:P.content_references)!=null&&B.length?((Ve=(G=p.metadata)==null?void 0:G.content_references)==null?void 0:Ve.length)>0:(At=(It=p.metadata)==null?void 0:It.n7jupd_crefs)!=null&&At.length?((Mt=(Et=p.metadata)==null?void 0:Et.n7jupd_crefs)==null?void 0:Mt.length)>0:!1},Pe=p=>{var P;return((P=p.metadata)==null?void 0:P.n7jupd_button_type)!==void 0},Le=i.useMemo(()=>l&&(f==null?void 0:f.messages.some(p=>_e(p))),[f,l]),Ae=i.useMemo(()=>l&&(f==null?void 0:f.messages.some(p=>Pe(p))),[f,l]),le=(ee||Ae)&&!ve&&S&&!Le&&!R&&!b,ge=((m==null?void 0:m.type)===xe.Text||(m==null?void 0:m.type)===xe.MultiText)&&(m==null?void 0:m.messages[0].author.role)===zs.Assistant,[ye,Ze]=i.useState(n?-1:o.length),Ue=ye===-1?void 0:o[ye],Qe=i.useRef(performance.now()),Xe=i.useRef(performance.now());i.useEffect(()=>{Qe.current=performance.now()},[ye]),i.useEffect(()=>{Xe.current=performance.now()},[Ue]);const ce=ds(K,!!l),We=ns(K,"349489989"),De=We.get("per_chunk_time_ms",4e3),ze=We.get("per_search_chunk_time_ms",500),C=i.useMemo(()=>{const p=[];for(const[P,B]of o.entries())if(B.type===V.Thought&&B.thought.chunks)for(const G of B.thought.chunks)p.push({chunk:B,text:G,timeoutMs:De,isStreamingAnimation:!0});else if(B.type===V.Search)for(const G of B.sources)p.push({chunk:B,text:G.domain,timeoutMs:ze,isStreamingAnimation:!1});else{const G=yn({chunk:B,intl:D,isLast:o.length-1===P,hasGlauxMessages:o.some(Ve=>Ve.type===V.Glaux)});p.push({chunk:B,text:G,timeoutMs:De,isStreamingAnimation:!0})}return p},[o,D,De,ze]),[W,ue]=i.useState(-1),I=i.useRef(C),v=i.useRef(null);i.useEffect(()=>{I.current=C,W>=C.length&&C.length>0&&ue(C.length-1)},[C,W]),i.useEffect(()=>{W==-1&&C.length>0&&ue(0)},[C.length,W]);const te=n?C[W]:null;i.useEffect(()=>{if(te)return v.current!=null&&(clearTimeout(v.current),v.current=null),v.current=setTimeout(()=>{const p=I.current;p.length!==0&&W<p.length-1&&ue(P=>P+1)},te.timeoutMs),()=>{v.current&&(clearTimeout(v.current),v.current=null)}},[te==null?void 0:te.text,W]);const se=o,we=qs(e.id,p=>p==null?void 0:p.interruptionInProgress),ke=i.useMemo(()=>{var P,B;let p=yt(se);if(S)return(p==null?void 0:p.type)===V.Recap?p:void 0;if(ce&&(p=(P=C[W])==null?void 0:P.chunk),(p==null?void 0:p.type)===V.Thought)return p.thought.summary!=null&&p.thought.summary.length>0?p:gt(se,G=>G.type===V.Thought&&G.thought.summary!=null&&G.thought.summary.length>0);if(!(j&&(p==null?void 0:p.type)===V.Recap&&((B=se[se.length-2])==null?void 0:B.type)!==V.Thought)){if((p==null?void 0:p.type)===V.CodeAnalysis&&l){const G=gt(se.slice(0,-1),Ve=>Ve.type===V.Thought?Ve.thought.summary&&Ve.thought.summary.length>0:Ve.type!==V.CodeAnalysis);if(G)return G}return p}},[se,S,ce,j,l,C,W]),u=[...se.entries()],g=a||_?u:u.slice(-1);yr(ye,S);const k=se.some(p=>p.type===V.Glaux),O=se.length>0&&(o[0].type!==V.Recap||o[0].type===V.Recap&&E||o[0].didFailReasoning||k),M=yt(se),Y=(M==null?void 0:M.type)===V.Browsing&&!a||(M==null?void 0:M.type)===V.N7jupdAPI&&!a,ie=dn(),be=(ie==null?void 0:ie.type)==="cot",Te=O&&(!S&&(l||ce)||a)&&!be&&!Y&&!ae&&(l?!we:!0),et=_n(q)+(q.length-1)*zt+2*mt,tt=S||_?"auto":a?et:"auto",Je=ke&&qt(D,ke,S,we,!0,z),Ye=i.useCallback((p,P)=>{oe(p),ce&&(c==null||c()),is.count(ls.COT_SUMMARIZER,p?"expand":"collapse",[{key:"is_streaming",value:String(n)},{key:"source",value:P}]),Vt.logEventWithStatsig(p?"CoT Expanded":"CoT Collapsed",p?"chatgpt_cot_expanded":"chatgpt_cot_collapsed",{is_streaming:String(n),source:P})},[oe,ce,n,c]),Ke=i.useCallback(()=>{Ye(!0,"chunk")},[Ye]),bs=i.useCallback((p,P)=>{Q(B=>{const G=[...B];return G[p]=P,G})},[]);i.useEffect(()=>{S||ye<0||Vt.logEventWithStatsig(a?"Streamed CoT Chunk Viewed":"Streamed CoT Chunk Ignored",a?"chatgpt_streamed_cot_chunk_viewed":"chatgpt_streamed_cot_chunk_ignored")},[ye,S,a,n]);const _t=S&&!O,js=n&&!O&&!X||l&&z===Ne.Thinking,kt=(O||X)&&(!l||z!==Ne.Thinking),vs=l&&!(l&&we)&&!_,Tt=t.jsxs(t.Fragment,{children:[!ge&&!U&&t.jsx(fn,{}),t.jsxs("div",{className:Z("relative my-1 min-h-6",ge&&"mt-3",ge&&kt&&"mt-6"),children:[js&&t.jsx(ne.div,{className:Z("loading-shimmer text-token-text-secondary absolute start-2 top-0 mx-[calc(--spacing(-2)-1px)] select-none",E===Wt.PRO_MODE&&"font-medium"),initial:n&&{translateX:-8,opacity:0},animate:{translateX:0,opacity:1},transition:{ease:"easeInOut",duration:xt},onClick:()=>{Ye(!a,"header")},role:"button",children:E===Wt.PRO_MODE?t.jsx(Ie,{id:"wOEgCa",defaultMessage:"Pro thinking"}):t.jsx(Ie,{id:"hgnsat",defaultMessage:"Thinking"})}),kt&&t.jsxs(ne.div,{className:Z("origin-top-start relative flex flex-col gap-2 overflow-x-clip",ae&&"mx-[calc(--spacing(-2)-1px)]",l&&"overflow-x-visible"),initial:n&&l&&{opacity:0,scale:.85},animate:{opacity:1,scale:1},transition:{ease:"easeOut",duration:xt},children:[ae&&!X?t.jsx(ne.div,{className:"loading-shimmer text-token-text-secondary absolute start-2 top-0 select-none",initial:n&&{translateX:-8,opacity:0},animate:{translateX:0,opacity:1},transition:{ease:"easeInOut",duration:xt},children:Je},Je):t.jsx(hn,{conversation:e,isAgentVisualCoT:y,isAgentTurn:l,latestHeadline:ke&&qt(D,ke,S,we,l,l?z:void 0,!ce),latestChunk:ke,counters:me,onToggleExpanded:()=>Ye(!a,"header"),showChunkIcon:vs,isExpanded:a,isComplete:S,onSkip:X?d:void 0,skipTitle:he,shouldDisplayVisualCoT:_,agentVisualMode:H,setAgentVisualMode:F,isStreaming:n,interruptionInProgress:we,isKAUR1BR5:b,wasInterrupted:$,isGlauxTurn:j,taskType:E}),j&&ce&&x&&t.jsx(mn,{className:"my-2",handleShowRetrievalResults:x,turnIndex:J,clientThreadId:e.id,responseComplete:!n}),t.jsxs("div",{className:Z(R?"max-w-[var(--thread-content-max-width,40rem)]":"max-w-[calc(0.8*var(--thread-content-max-width,40rem))]"),children:[t.jsx(pr,{clientThreadId:e.id,isAgentTurn:!!_,isFinalAssistantTurn:r,messageGroups:h,isExpanded:a,visualMode:H,isStreaming:n,isComplete:S,isStopping:!!we,isKAUR1BR5:!!b,children:ce&&!_?Te&&r&&t.jsx("div",{className:"relative flex h-full flex-col",style:{margin:"".concat(mt,"px 0")},children:t.jsx(wn,{text:(Ct=te==null?void 0:te.text)!=null?Ct:"",isStreamingAnimation:(St=te==null?void 0:te.isStreamingAnimation)!=null?St:!0,onClick:()=>Ye(!a,"chunk")})}):t.jsx(Be,{children:(Te||_)&&t.jsx(ne.div,{className:"relative z-0",initial:S?{opacity:0,height:_?"auto":0,overflowY:"hidden"}:!1,animate:{opacity:1,height:tt},exit:{height:_?"auto":0,opacity:0,pointerEvents:"none",overflowY:"hidden",filter:S?"blur(8px)":void 0,translateY:-jn},transition:es,children:t.jsx("div",{className:"relative flex h-full flex-col",style:{margin:"".concat(mt,"px 0")},children:t.jsx(Be,{children:g.map(([p,P],B)=>t.jsx(bn,{index:p,chunk:P,gap:zt,isLast:g.length-1===B,onClick:Ke,onAnimationComplete:()=>{},onMeasure:bs,isAnimationComplete:S,isExpanded:a||_,showBullet:a||_,isKAUR1BR5:b,hasGlauxMessages:k,disableAnimation:ce,isAgentTurn:l},p))})})})})}),le&&t.jsx(qn,{chunks:se,isExpanded:a,isFinalAssistantTurn:r,hidePowTombstone:!!_,isKAUR1BR5:!!b})]})]})]})]});return l?t.jsx(Be,{mode:"wait",children:!_t&&t.jsx(ne.div,{initial:!1,animate:{height:"auto",opacity:1,scale:1},exit:{height:0,opacity:0,scale:.9,filter:"blur(6px)"},transition:{height:es,opacity:{duration:0,ease:"linear"}},children:Tt},"cot-wrapper")}):_t?null:Tt};function yr(e,n){const r=i.useRef(null),o=pn(e),s=i.useCallback(()=>{if(r.current!=null){const l=performance.now()-r.current;is.hist(ls.COT_SUMMARIZER,"cot_chunk_display_time",void 0,l)}},[o]);i.useEffect(()=>{if(n){s();return}e!==-1&&(s(),r.current=performance.now())},[e,n,s])}export{$r as CoT,gr as CoTChunks};
//# sourceMappingURL=ijctvkapujvvau9j.js.map
