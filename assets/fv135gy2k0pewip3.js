const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ghewn7l2ynbm32fm.js","assets/i8clt0mfz495j7ii.js","assets/root-c4psboex.css"])))=>i.map(i=>d[i]);
var ee=Object.defineProperty,se=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var H=(s,a,t)=>a in s?ee(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,p=(s,a)=>{for(var t in a||(a={}))ae.call(a,t)&&H(s,t,a[t]);if(V)for(var t of V(a))ie.call(a,t)&&H(s,t,a[t]);return s},E=(s,a)=>se(s,te(a));import{e as B,u as T,r as w,j as e,M as R,_ as oe,a as ne}from"./i8clt0mfz495j7ii.js";import{d$ as re,U as le,B as ce,e0 as c,L as de,e1 as ue,e2 as xe,e3 as me,e4 as pe,e5 as fe,e6 as he,e7 as ge,e8 as P}from"./j0yo6uv6652vva62.js";import{a5 as D,u as $,e as Q,mX as ve,dN as je,mY as be,hY as z,$ as J,o as ke,L as we,R as ye,a4 as Ne,aW as We,aV as Ce}from"./ghewn7l2ynbm32fm.js";import{e as Se,u as Le}from"./kgnykbdth8mb50na.js";import"./g8i6bixylsxyemsr.js";function Ae({workspace:s,onOpen:a}){var r;const t=B(),b=T(),l=D(),f=$(),n=Q(),[k,h]=w.useState(!1),{data:g,isLoading:y}=re(s.id),v=Se(t,s,l!=null?l:void 0),d=w.useCallback(()=>{a==null||a(),h(!0);const{willRedirect:u}=ve(b,s.id,f,t,n);je.set(f,!1),u||be()},[a,b,s.id,f,t,n]);return e.jsxs("div",{className:"flex w-full cursor-default items-center border-t p-5 first:border-t-0",role:"listitem","data-testid":"existing-workspace-row","data-workspace-id":s.id,children:[e.jsxs("div",{className:"flex min-w-0 flex-1 items-center gap-3",children:[s.structure===z.PERSONAL?e.jsx(le,{user:l,size:"large"}):e.jsx(ce,{src:s.data.profilePictureUrl,size:"large"}),e.jsxs("div",{className:"flex-1 truncate",children:[e.jsx("div",{className:"text-token-text-primary truncate font-medium",title:v,children:v}),e.jsx("div",{className:"text-token-text-secondary truncate text-sm",children:s.structure===z.PERSONAL?e.jsx(R,p({},c.personalWorkspace)):y?e.jsx(de,{className:"inline-block h-4 w-16 align-middle"}):t.formatMessage(c.memberCount,{count:(r=g==null?void 0:g.total)!=null?r:0})})]})]}),e.jsx("div",{className:"shrink-0",children:e.jsx(J,{color:"secondary",onClick:u=>{u.preventDefault(),u.stopPropagation(),d()},visuallyDisabled:k||!s.canAccessWithCurrentSession,disabled:k||!s.canAccessWithCurrentSession,children:t.formatMessage(c.open)})})]})}const Ee=ke(()=>oe(()=>import("./ghewn7l2ynbm32fm.js").then(s=>s.vJ),__vite__mapDeps([0,1,2])),{loading:s=>we(s)});function Re(){return e.jsx("div",{className:"static w-full",role:"list","data-testid":"workspace-list",children:e.jsxs("div",{className:"static flex w-full flex-col rounded-2xl border py-1.5",children:[e.jsx(P,{},1),e.jsx(P,{},2)]})})}function Ve({onClose:s,mode:a="blocking",section:t="existing",source:b="unknown"}){var I,U;const{data:l,isFetching:f}=Le(),n=D(),k=(I=n==null?void 0:n.email)!=null?I:"",h=B(),g=$(),y=(n==null?void 0:n.email_domain_type)==="professional",v=t==="existing"||t==="both",d=(t==="discoverable"||t==="both")&&y,{data:r,isFetching:u}=ue(d),O=T(),[Y,N]=w.useState(null),X=Q(),{setHasSeenWorkspaceDiscoveryFirstLoginDontInvalidateCache:W}=xe(),_=ne({mutationFn:async i=>{await ye.safePost("/accounts/{account_id}/invites/request",{parameters:{path:{account_id:i}}})},onSuccess:(i,o)=>{O.setQueryData(["discoverable-workspaces"],m=>m!=null&&m.workspaces?E(p({},m),{workspaces:m.workspaces.map(A=>A.id===o?E(p({},A),{requested:!0}):A)}):m)},onError:(i,o)=>{N(null),X.danger(h.formatMessage(c.requestAccessError),{toastId:"request-access-".concat(o)})},onSettled:()=>{N(null)}}),G=d&&!!(r!=null&&r.has_more),j=v&&f||d&&u,x=[];if(v&&x.push(...(l!=null?l:[]).map(i=>({type:"existing",w:i}))),d){const i=(U=r==null?void 0:r.workspaces)!=null?U:[];x.push(...i.map(o=>({type:"discoverable",w:o})))}const C=x.filter(i=>i.type==="existing").length,S=x.filter(i=>i.type==="discoverable").length,{hasLoggedFullscreenView:q,logFullscreenViewedOnce:M,logExitEvent:L,logRequestButtonClicked:K,logRequestButtonHovered:Z}=me({source:b,existingCount:C,discoverableCount:S});if(w.useEffect(()=>{!q&&!j&&M()},[q,M,j]),a==="blocking"&&C===0&&!j)return null;const F=Ne(g,"2133596510").get("enabled",!1);return e.jsx(We,{children:e.jsx(Ce.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.4},"data-testid":"fullscreen-workspace-switcher",className:"bg-token-bg-primary absolute inset-0 start-0 top-0 z-50 h-full w-full",role:"dialog","aria-modal":"true","aria-label":h.formatMessage(c.title),children:e.jsxs("div",{className:"flex h-full max-h-full flex-col",children:[a==="dismissible"&&e.jsx("div",{className:"absolute end-4 top-4",children:e.jsx("button",{type:"button","aria-label":h.formatMessage(c.close),onClick:()=>{W(),L("close"),s()},className:"rounded-full p-2 hover:bg-transparent",children:e.jsx(Ee,{className:"icon"})})}),e.jsx("div",{className:"flex flex-1 items-start justify-center px-6 pt-[15vh] pb-12",children:e.jsxs("div",{className:"flex w-[440px] flex-col items-center",children:[j?e.jsxs(e.Fragment,{children:[e.jsx(pe,{showCollaborationSubtitle:F}),e.jsx(Re,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{existingCount:C,discoverableCount:S,accountEmail:k,showCollaborationSubtitle:F}),x.length>0&&e.jsx("div",{className:"static w-full",role:"list","data-testid":"workspace-list",children:e.jsx("div",{className:"static flex w-full flex-col rounded-2xl border py-1.5",children:x.map(i=>i.type==="existing"?e.jsx(Ae,{workspace:i.w,onOpen:()=>{W(),L("open_workspace")}},i.w.id):e.jsx(he,{workspace:i.w,isLoading:_.isPending&&Y===i.w.id,onHoverRequest:o=>{Z(o)},onRequestAccess:o=>{N(o.id),K(o),_.mutate(o.id)}},i.w.id))})})]}),t==="discoverable"&&S===0&&!j&&e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex w-full flex-col rounded-2xl border py-20",children:e.jsx("div",{className:"text-token-text-secondary text-center text-sm",children:e.jsx(R,p({},c.noWorkspacesToJoin))})})}),a==="dismissible"&&e.jsx("div",{className:"mt-4 w-full",children:e.jsx(J,{fullWidth:!0,onClick:()=>{W(),L("close"),s()},children:e.jsx(R,p({},c.done))})}),e.jsx(ge,{showHiddenWorkspacesNote:G})]})})]})})})}export{Ve as default};
//# sourceMappingURL=fv135gy2k0pewip3.js.map
