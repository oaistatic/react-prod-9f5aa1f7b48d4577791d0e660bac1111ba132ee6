const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ghewn7l2ynbm32fm.js","assets/i8clt0mfz495j7ii.js","assets/root-c4psboex.css","assets/jyroje0qaxw6h3z1.js","assets/od3rnm4927scb9m9.js","assets/ie0tjf0jnzpbpt35.js","assets/k6dbkwjaexelrlgh.js","assets/gdq1l97elemowxcc.js","assets/kiv50zw1ij6k8vyj.js","assets/cb0ba83bmi83mjz2.js","assets/j0yo6uv6652vva62.js","assets/conversation-small-lq38g8zw.css","assets/ce3hgmw4iyyhicud.js","assets/o564tkn3ln8nzryq.js","assets/ns51nblw8ziscsgd.js","assets/mqebxepg7t6q2tie.js","assets/dxyrjy681bkwlnj8.js","assets/6ji8ehbh56ghw0zw.js","assets/f76gy0b8ieo4s693.js","assets/k1t8elp5z7nmkg2d.js","assets/kau2ug0899cbkpxh.js","assets/o9vew0btr2k0i59c.js","assets/comments-plugin-tah3dlup.css","assets/codemirror-g1j9yafs.css","assets/f5qlxxpahyz6p72m.js","assets/jdfzk1zd468oela3.js","assets/kticz4kb6d3g30cz.js","assets/go502v54gisfd23y.js","assets/l2r1du6tfxyv7jaj.js","assets/ln88gzx578175chd.js","assets/inhyojyded8f1i4q.js","assets/mstl8wgfzorpgdoe.js","assets/pc7u7c6vz2ia5xux.js","assets/kfdkis1zwf4ccfgg.js","assets/ol9d5wxhynx9q2is.js","assets/mbmcx8v24u1ao1ke.js","assets/jh95iaetowvobxaf.js","assets/deakbbf27g8e7ba0.js","assets/omoqxnq6po1pmb00.js","assets/kl7c6054usfnqmd4.js","assets/k97n0y6ba9c9h39c.js","assets/hu1kfuw35sk0pi95.js","assets/oeq18d1jdvuy1qmx.js","assets/nrnf80lbyqanffwr.js","assets/kz85ppopzltkr0hm.js","assets/ozby1o16tp40naiq.js","assets/gy1lpvuoewmzh42c.js","assets/hxdh3tr5l8kut4ed.js","assets/hu1bt0oauegdhua6.js","assets/iakvhqfu6nmvphq6.js","assets/lb3e2s17svct1mam.js","assets/nnzgss862gapaux3.js","assets/nfccle6oyncifphl.js","assets/h1em0bjkpkjv8ykw.js","assets/mjbhy8c4bs0n8qw2.js","assets/mjq17q47489shd3e.js","assets/jyyjaseddjwyjwou.js","assets/l0icc3zt92jpknxy.js","assets/i03gut32e8jn5ajq.js","assets/lep2wptoy14cfe2w.js","assets/cxbsld3botts7bfn.js","assets/da0eqg5j39u1e96s.js","assets/bbipyj9bituayr8q.js","assets/prosemirror-egdr15sq.css","assets/e4uyedc9wylrl0pu.js","assets/fwyctp3zfyh6emd2.js","assets/c8sj5q0wb2w4qlno.js","assets/gvo1fqf7h2313x3d.js","assets/ieykhlrsk25lij4e.js","assets/e26n6uhwwtwdmiki.js","assets/mzyl3pd4zxnxoe9i.js"])))=>i.map(i=>d[i]);
var Q=Object.defineProperty;var R=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var k=(e,n,t)=>n in e?Q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,I=(e,n)=>{for(var t in n||(n={}))V.call(n,t)&&k(e,t,n[t]);if(R)for(var t of R(n))ee.call(n,t)&&k(e,t,n[t]);return e};import{j as l,r as g,_,e as U,f as ne,c as te,l as oe,a as se}from"./i8clt0mfz495j7ii.js";import{Z as ae,C as W}from"./ce3hgmw4iyyhicud.js";import{aV as le,d as h,o as y,L as T,ed as $,aW as ie,l$ as J,e as q,la as re,u as X,bR as Y,J as ce,R as ue,P as j}from"./ghewn7l2ynbm32fm.js";import{d6 as fe,u3 as de,fd as s,f9 as pe,fc as v,fa as me,uA as be,n4 as M,n5 as Ee,ae as Ce,uB as z}from"./j0yo6uv6652vva62.js";import{b as P}from"./mstl8wgfzorpgdoe.js";import{_ as xe,a as _e,b as ge,c as he,u as ye,B as Te,d as De}from"./pc7u7c6vz2ia5xux.js";import{u as Oe}from"./jh95iaetowvobxaf.js";import{T as ve}from"./dxyrjy681bkwlnj8.js";import{u as Le}from"./mqebxepg7t6q2tie.js";import{d as Ie}from"./deakbbf27g8e7ba0.js";import{s as K}from"./omoqxnq6po1pmb00.js";import{d as w}from"./kl7c6054usfnqmd4.js";import{g as we}from"./k97n0y6ba9c9h39c.js";import{r as Ae}from"./hu1kfuw35sk0pi95.js";function Se({className:e,zIndexKey:n,onClick:t}){return l.jsx(le.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:h("absolute inset-0",e,ae[n]),onClick:t})}function Ne({zIndexKey:e,onClick:n}){return l.jsx(Se,{zIndexKey:e,onClick:n,className:"bg-gray-50/50 dark:bg-black/50"})}function Re(e){var n,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];e&&typeof e!="function"?console.error('react-scroll-to-bottom: First argument passed to "useObserveScrollPosition" must be a function.'):xe(t)||console.error('react-scroll-to-bottom: Second argument passed to "useObserveScrollPosition" must be an array if specified.');var o=_e(),a=o.observeScrollPosition;g.useEffect(function(){return e&&a(e)},ge(n=[]).call(n,he(t),[!e,a]))}function ke(){var e=ye(),n=e.scrollToTop;return n}const je=y(()=>_(()=>import("./ghewn7l2ynbm32fm.js").then(e=>e.vJ),__vite__mapDeps([0,1,2])),{loading:e=>T(e)}),Me=y(()=>_(()=>import("./jyroje0qaxw6h3z1.js").then(e=>e._),__vite__mapDeps([3,1])),{loading:e=>T(e)}),Pe=y(()=>_(()=>import("./od3rnm4927scb9m9.js").then(e=>e._),__vite__mapDeps([4,1])),{loading:e=>T(e)}),Fe=({onScroll:e})=>(Re(({scrollTop:n})=>{e==null||e(n)}),null),Be=({shouldScrollToTop:e})=>{const n=ke();return g.useEffect(()=>{e===!0&&n({behavior:"smooth"})},[e,n]),null},He=()=>{const e=Oe();g.useEffect(()=>{e({behavior:"smooth"})},[e]);const[n]=De();return n?null:l.jsx("button",{onClick:()=>e({behavior:"smooth"}),className:"border-token-border-default bg-token-main-surface-primary text-token-text-secondary absolute end-1/2 bottom-5 z-10 flex h-8 w-8 translate-x-1/2 cursor-pointer items-center justify-center rounded-full border bg-clip-padding",children:l.jsx(Pe,{className:"icon text-token-text-primary"})})};function Ge({children:e,onScroll:n,shouldScrollToTop:t,scrollToBottomMode:o="top",isLoading:a=!1,header:r,height:i="auto",overlay:u,hideChildren:d=!1,disableScroll:b=!1,ref:p,onCopy:E}){const c=l.jsx("div",{onCopy:E,className:h(d?"hidden":"block",i==="auto"?"h-auto":"h-full"),children:e});return l.jsxs("section",{ref:p,className:h("relative flex min-h-0 flex-auto grow flex-col",b&&"overflow-hidden"),children:[l.jsx(ie,{children:a&&l.jsx(Ne,{zIndexKey:"textdocDiffLoadingOverlay"})}),!b&&l.jsxs(Te,{followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:"flex flex-col",className:"h-full",mode:o,children:[r,c,u&&l.jsx("div",{className:"pointer-events-none w-full flex-1",children:u}),o==="bottom"&&l.jsx(He,{}),l.jsx(Fe,{onScroll:n}),l.jsx(Be,{shouldScrollToTop:t})]}),b&&l.jsxs(l.Fragment,{children:[r,c,u&&l.jsx("div",{className:"pointer-events-none h-full w-full",children:u})]})]})}function Ue({className:e,children:n}){return l.jsx("header",{className:h(e,"touch:px-2.5 h-header-height flex flex-none items-center justify-between gap-1 px-2"),children:n})}function We({className:e,children:n,size:t="lg",bold:o}){return l.jsx("h2",{className:h(e,"text-token-text-primary truncate",o?"font-bold":"font-normal",t==="lg"&&"text-lg",t==="base"&&"text-base"),children:n})}const $e=({onClick:e})=>{const t=$()?Me:je;return l.jsx(fe,{icon:t,onClick:e})},F=e=>{const{r:n,g:t,b:o}=P.toRGBA(P.parse(e));return(n*299+t*587+o*114)/1e3<125},L=({children:e,isPreviewingCode:n=!1,transitionBackground:t=!1,previewBackgroundColor:o=null})=>{const a=n&&o&&F(o),r=n&&o&&!F(o);return l.jsx("section",{className:h("popover flex h-full w-full flex-col",t&&"transition-colors",a&&"dark",r&&"light",n?"bg-[rgba(249,249,249,1)] dark:bg-[rgba(33,33,33,1)]":"bg-transparent"),style:{backgroundColor:n&&o?o:void 0},children:e})};L.Title=We;L.CloseButton=$e;L.Header=Ue;L.Content=Ge;const Je=y(()=>_(()=>import("./ie0tjf0jnzpbpt35.js"),__vite__mapDeps([5,1,6,7,0,2,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41])).then(e=>e.CodeComposer),{loading:()=>l.jsx("div",{className:W.code,children:l.jsx("div",{className:"h-full w-full px-4",children:l.jsx(J,{lines:20})})})}),vn=e=>l.jsx(Je,I({},e)),Ln=(e=[])=>e.filter(({status:n})=>n!==de.DISMISSED);var qe=(e=>(e.ALL_HIDDEN="all_hidden",e.COMMENTS_READONLY="comments_readonly",e.ENABLED="enabled",e))(qe||{});const B=775,Xe=580,Ye=36,ze=18,In=24,wn=16,Ke=({numLines:e=20})=>{const[{width:n},t]=Le(),o=$(),a=n>=B+ve?B:Xe,r=o?ze:Ye;return l.jsx("div",{className:h(W.document,"mt-4"),ref:t,style:{margin:"0 ".concat(r,"px")},children:l.jsx("div",{style:{width:a},children:l.jsx(J,{lines:e})})})},Ze=y(()=>_(()=>import("./oeq18d1jdvuy1qmx.js"),__vite__mapDeps([42,1,43,0,2,20,7,19,13,10,11,14,12,15,21,18,9,16,17,22,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,24,25,26,27,28,29,64,31,32,33,34,35,36,37,38,39,40,41])).then(e=>e.DocumentComposer),{loading:({value:e,width:n=window.innerWidth})=>l.jsx(Ke,{numLines:Math.ceil(e.length/(n/8))})}),An=e=>l.jsx(Ze,I({},e));var O=(e=>(e.ADDED="added",e.REMOVED="removed",e.UNCHANGED="unchanged",e))(O||{});function N(e){if(e==="")return 0;const n=e.split("\n").length;return e.endsWith("\n")?n-1:n}function Qe(e,n){return Ie(e,n,{newlineIsToken:!0}).map(o=>{var a;return{count:(a=o.count)!=null?a:N(o.value),value:o.value,type:o.added?"added":o.removed?"removed":"unchanged"}})}function Ve(e){let n="";for(const{type:t,value:o}of e)(t==="added"||t==="unchanged")&&(n+=o);return n}function en(e,n){const t=N(n),o=on(e,t);return{changes:Qe(o,n),numLinesDiffed:t}}function nn(e){const n=[...e],t=[],o=[];for(;n.length>0;){const a=n[n.length-1];if(a.type===O.REMOVED)n.pop(),a.type===O.REMOVED&&t.unshift(a);else if(a.type===O.ADDED)n.pop(),o.unshift(a);else break}return{prunedChanges:[...n,...o],prunedRemovedChanges:t}}function tn(e,n){const{changes:t,numLinesDiffed:o}=en(e,n),{prunedChanges:a,prunedRemovedChanges:r}=nn(t),i=Ve(a),u=r.map(b=>b.value).join("\n"),d=Z(e,o,"start");return{content:i+u+d,numLinesDiffed:N(i)}}function on(e,n){if(n<=0)return"";let t=0,o=e.length;for(let a=0;a<e.length;a++)if(e[a]==="\n"&&(t++,t===n)){o=a+1;break}return e.substring(0,o)}function Z(e,n,t="start"){if(n<=0)return e;if(t==="start"){let i=0;for(let u=0;u<e.length;u++)if(e[u]==="\n"&&(i++,i===n))return e.substring(u+1);return""}let o=0,a=-1;const r=e.endsWith("\n")?n+1:n;for(let i=e.length-1;i>=0;i--)if(e[i]==="\n"&&(o++,o===r)){a=i;break}return a===-1?"":e.substring(0,a+1)}function Sn(e,n){var u,d;const t=(u=e==null?void 0:e.type)!=null?u:s.LOADING,o=(d=e==null?void 0:e.content)!=null?d:"",a=pe(e);if(!v(t)||n==null||!a||!me(e))return{content:o,currentlyStreamingLineIndex:null};const r=Z(o,1,"end");if(r==="")return{content:n.content,currentlyStreamingLineIndex:0};const i=tn(n.content,r);return{content:i.content,currentlyStreamingLineIndex:i.numLinesDiffed}}const sn=y(()=>_(()=>import("./fwyctp3zfyh6emd2.js").then(e=>e._),__vite__mapDeps([65,1])),{loading:e=>T(e)}),an=y(()=>_(()=>import("./c8sj5q0wb2w4qlno.js").then(e=>e._),__vite__mapDeps([66,1])),{loading:e=>T(e)});function ln(e){"use forget";const n=te.c(8),{textdocVersion:t,clientThreadId:o}=e,a=X();let r;n[0]!==t?(r=p=>t&&(p==null?void 0:p.lastCanvasAssistantMessageById[t.textdocId]),n[0]=t,n[1]=r):r=n[1];const i=be(r),u=t==null?void 0:t.type,d=t!=null;let b;return n[2]!==o||n[3]!==a||n[4]!==d||n[5]!==i||n[6]!==u?(b=p=>{if(!p.selectedText)return;const E=Y(o);d&&E!=null&&i!=null&&z(a,{type:"copy",source:p.source,location:"canvas",selectedText:p.selectedText,messageId:i,serverThreadId:E,contentType:u!=null&&v(u)?"code":"text",productLogOnly:p.productLogOnly})},n[2]=o,n[3]=a,n[4]=d,n[5]=i,n[6]=u,n[7]=b):b=n[7],b}function Nn({textdocVersion:e,clientThreadId:n}){var p;const t=U(),o=q(),[a,r]=g.useState(!1),i=re(),u=ln({textdocVersion:e,clientThreadId:n}),d=g.useRef((p=e==null?void 0:e.content)!=null?p:"");return g.useEffect(()=>{var E;d.current=(E=e==null?void 0:e.content)!=null?E:""},[e]),{handleCopy:E=>{a||(i(async()=>{const c=await K(d.current);u({source:"mouse",selectedText:c}),M.logButtonClick(Ee.COPY,{contentLength:c.length,textdocType:e==null?void 0:e.type});let f={"text/plain":c};if((e==null?void 0:e.type)===s.DOCUMENT)try{const{markdownToClipboardContent:m}=await _(async()=>{const{markdownToClipboardContent:C}=await import("./gvo1fqf7h2313x3d.js").then(x=>x.j);return{markdownToClipboardContent:C}},__vite__mapDeps([67,10,1,0,2,11,50,51,52,48,53,54,46,47,68,58,69,55,45,70,59]));f=m(c,[])}catch(m){M.logError("Error copying rich text",m)}Ce(f,o,E)},0),r(!0),i(()=>r(!1),2e3))},Icon:a?an:sn,copyLabel:t.formatMessage(rn.copy)}}const rn=ne({copy:{id:"rbIYfo",defaultMessage:"Copy"}}),H={[s.CODE_BASH]:{filenameExtension:"sh",blobType:"text/x-shellscript"},[s.CODE_ZSH]:{filenameExtension:"zsh",blobType:"text/x-shellscript"},[s.CODE_JAVASCRIPT]:{filenameExtension:"js",blobType:"application/javascript"},[s.CODE_TYPESCRIPT]:{filenameExtension:"ts",blobType:"application/typescript"},[s.CODE_HTML]:{filenameExtension:"html",blobType:"text/html"},[s.CODE_CSS]:{filenameExtension:"css",blobType:"text/css"},[s.CODE_PYTHON]:{filenameExtension:"py",blobType:"text/x-python"},[s.CODE_JSON]:{filenameExtension:"json",blobType:"application/json"},[s.CODE_SQL]:{filenameExtension:"sql",blobType:"application/sql"},[s.CODE_GO]:{filenameExtension:"go",blobType:"text/x-go"},[s.CODE_YAML]:{filenameExtension:"yaml",blobType:"application/x-yaml"},[s.CODE_JAVA]:{filenameExtension:"java",blobType:"text/x-java-source"},[s.CODE_RUST]:{filenameExtension:"rs",blobType:"text/rust"},[s.CODE_CPP]:{filenameExtension:"cpp",blobType:"text/x-c++src"},[s.CODE_SWIFT]:{filenameExtension:"swift",blobType:"text/swift"},[s.CODE_PHP]:{filenameExtension:"php",blobType:"application/x-httpd-php"},[s.CODE_XML]:{filenameExtension:"xml",blobType:"application/xml"},[s.CODE_RUBY]:{filenameExtension:"rb",blobType:"text/x-ruby"},[s.CODE_HASKELL]:{filenameExtension:"hs",blobType:"text/x-haskell"},[s.CODE_KOTLIN]:{filenameExtension:"kt",blobType:"text/x-kotlin"},[s.CODE_CSHARP]:{filenameExtension:"cs",blobType:"text/x-csharp"},[s.CODE_C]:{filenameExtension:"c",blobType:"text/x-csrc"},[s.CODE_OBJECTIVEC]:{filenameExtension:"m",blobType:"text/x-objectivec"},[s.CODE_R]:{filenameExtension:"r",blobType:"text/plain"},[s.CODE_LUA]:{filenameExtension:"lua",blobType:"text/x-lua"},[s.CODE_DART]:{filenameExtension:"dart",blobType:"text/x-dart"},[s.CODE_SCALA]:{filenameExtension:"scala",blobType:"text/x-scala"},[s.CODE_PERL]:{filenameExtension:"pl",blobType:"text/x-perl"},[s.CODE_COMMONLISP]:{filenameExtension:"lisp",blobType:"text/x-common-lisp"},[s.CODE_CLOJURE]:{filenameExtension:"clj",blobType:"text/x-clojure"},[s.CODE_OCAML]:{filenameExtension:"ml",blobType:"text/x-ocaml"},[s.CODE_POWERSHELL]:{filenameExtension:"ps1",blobType:"text/x-powershell"},[s.CODE_VERILOG]:{filenameExtension:"v",blobType:"text/x-verilog"},[s.CODE_DOCKERFILE]:{filenameExtension:"Dockerfile",blobType:"text/x-dockerfile"},[s.CODE_VUE]:{filenameExtension:"vue",blobType:"text/x-vue"},[s.CODE_REACT]:{filenameExtension:"jsx",blobType:"application/javascript"},[s.CODE_OTHER]:{filenameExtension:"txt",blobType:"text/plain"},[s.DOCUMENT]:{filenameExtension:"md",blobType:"text/markdown"},[s.LOADING]:{filenameExtension:"txt",blobType:"text/plain"}};var A,G;function cn(){if(G)return A;G=1;var e=Ae(),n=e(function(t,o,a){return t+(a?"_":"")+o.toLowerCase()});return A=n,A}var un=cn();const S=oe(un);function Rn({textdocVersion:e,clientThreadId:n}){const t=U(),o=q(),a=X(),r=g.useCallback((c,f)=>{var x;const m=(x=e==null?void 0:e.messageId)!=null?x:void 0,C=n!=null?Y(n):void 0;!C||!m||z(a,{source:"mouse",type:"download",selectedText:c,location:"canvas",contentType:f,messageId:m,serverThreadId:C,productLogOnly:!0})},[n,a,e]),i=t.formatMessage({id:"canvas.downloadFileError",defaultMessage:"Failed to download file. Please try again later."}),{mutate:u,isPending:d}=se({mutationFn:async({textdocId:c,exportType:f})=>{const m=await ue.safePost("/export_doc/canvas",{requestBody:{textdoc_id:c,export_type:f},skipJsonTransform:!0});if(!m.ok)throw new Error("Failed to download file");return m},onSuccess:async(c,{exportType:f})=>{var D;if(!e)return;const m=await c.blob(),C=c.headers.get("Content-Disposition"),x=(D=we(C))!=null?D:"".concat(S(e.title),".").concat(f);w(m,x)},onError:c=>{o.danger(i,{toastId:"textdoc_download_button",loggingTitle:i,loggingDescription:"Failed to download file"}),ce.addError(c)}}),b=async c=>{if(e&&e.type!==s.LOADING&&e.type===s.DOCUMENT){let f;switch(c){case"md":f="chatgpt_canvas_md_download";break;case"pdf":f="chatgpt_canvas_pdf_download";break;case"docx":f="chatgpt_canvas_docx_download";break}if(j.logEventWithStatsig("ChatGPT Canvas Download",f),r(e.content,v(e.type)?"code":"text"),c==="pdf"||c==="docx")u({textdocId:e.textdocId,exportType:c});else if(c==="md"){const{filenameExtension:m,blobType:C}=H[e.type],x=await K(e.content),D=new Blob([x],{type:C});w(D,"".concat(S(e.title),".").concat(m))}}},p=()=>{if(!e)return;const{filenameExtension:c,blobType:f}=H[e.type];if(e.type===s.LOADING)return;j.logEventWithStatsig("ChatGPT Canvas Download","chatgpt_canvas_code_download",{blobType:f});const m=new Blob([e.content],{type:f});w(m,"".concat(S(e.title),".").concat(c)),r(e.content,v(e.type)?"code":"text")},E=t.formatMessage({id:"canvas.download-button",defaultMessage:"Download"});return{handleFileDownload:b,handleBlobDownload:p,isLoading:d,downloadCopyLabel:E,isDocument:(e==null?void 0:e.type)===s.DOCUMENT}}export{vn as A,qe as C,Ke as D,Ne as L,In as M,Se as O,wn as S,An as a,L as b,Rn as c,B as d,Xe as e,Ln as f,Sn as g,Ye as h,ze as i,ln as j,Nn as u};
//# sourceMappingURL=lo4w8zafp8iqjpvk.js.map
