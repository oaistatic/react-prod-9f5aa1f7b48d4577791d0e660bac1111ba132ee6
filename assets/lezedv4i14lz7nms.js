const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j0yo6uv6652vva62.js","assets/i8clt0mfz495j7ii.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/3j20em1lilnrpdcm.js","assets/ooz2slmm8agf6bjp.js","assets/ewkru1hsxkjpuxt5.js","assets/rsi9kppw43ykrsgk.js","assets/j4nmkdkymh0gf9lt.js","assets/fqz8sozslskhjbvs.js","assets/kaxn2bizrxslkpa3.js","assets/fzicjahgxjd3df3v.js","assets/mtr4hl2nrm0y29d3.js","assets/iqoo5whnx14dvo9x.js"])))=>i.map(i=>d[i]);
var Vt=Object.defineProperty,qt=Object.defineProperties;var Gt=Object.getOwnPropertyDescriptors;var xt=Object.getOwnPropertySymbols;var Wt=Object.prototype.hasOwnProperty,Qt=Object.prototype.propertyIsEnumerable;var ht=(s,e,r)=>e in s?Vt(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,ue=(s,e)=>{for(var r in e||(e={}))Wt.call(e,r)&&ht(s,r,e[r]);if(xt)for(var r of xt(e))Qt.call(e,r)&&ht(s,r,e[r]);return s},ke=(s,e)=>qt(s,Gt(e));import{j as t,M as m,l as jt,_ as B,e as Z,r as R,b as Kt,k as Oe,h as ze,f as Yt,c as Ue,F as et,ap as tt,L as yt,u as Xt,o as Jt,A as Zt}from"./i8clt0mfz495j7ii.js";import{b as wt,j as Nt,k as st,r as We,l as es,e as at,t as Mt,S as Ct,A as _t,m as qe,n as gt,o as ts,q as ss,g as as,h as rs,i as ns}from"./lc139kj9junmhgwh.js";import{oz as rt,hr as nt,aU as it,$ as de,tx as is,cD as os,gr as ls,cx as St,o as U,L as V,B as At,a5 as ot,ty as cs,eo as De,e4 as Y,cG as Rt,cF as Ze,fU as ds,b0 as Qe,d as Be,e as Et,u as lt,z as ct,hK as It,a$ as ms,i0 as us,hM as fs,mM as xs}from"./ghewn7l2ynbm32fm.js";import{d$ as hs,bL as gs,b8 as pt,i0 as ps,mi as vs,q as bs,t as ks,x as Fe,o as Lt,uO as js,uP as ys,ts as ws}from"./j0yo6uv6652vva62.js";import{i as Ns,W as Ms}from"./pn83wqr6w775mq4b.js";import{T as N}from"./zm1ki9l766pgg0bx.js";import{l as Cs,y as _s,W as Ss}from"./g5lgy1otfli5p2x7.js";import{b as As}from"./fb2095ktsebx1zzy.js";import"./mpzbsmypy64alaao.js";import"./fvjpw0lui4wq7vv3.js";import"./kgnykbdth8mb50na.js";import"./g8i6bixylsxyemsr.js";import"./olrcssu7duieo6m7.js";import"./mewip4u74thselsp.js";import"./chs4g5r39qlnqw6r.js";import"./nzsqhqpna1ee8hwf.js";import"./ivhm4b1s5w1b1cuw.js";import"./ieykhlrsk25lij4e.js";import"./i03gut32e8jn5ajq.js";import"./h1em0bjkpkjv8ykw.js";import"./e26n6uhwwtwdmiki.js";import"./mjq17q47489shd3e.js";import"./hxdh3tr5l8kut4ed.js";import"./hu1bt0oauegdhua6.js";import"./eyao241335injypy.js";import"./ktw3b87sujui39wx.js";import"./nrrhfi0a0bbsg9w2.js";import"./hht3m8p9e0s4tqnx.js";function Rs(){const{openGithubModal:s}=rt(it.GITHUB_CONNECTOR,"github","/aardvark",nt.CODEX);return t.jsxs("div",{className:"border-token-border-light/60 bg-token-main-surface-secondary/50 mx-auto mt-6 w-full max-w-[640px] rounded-lg border px-5 py-6 text-center shadow-sm backdrop-blur-[2px]",children:[t.jsx("p",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:t.jsx(m,{id:"aardvark.home.connectGithub.title",defaultMessage:"Connect GitHub to start scanning repositories with Aardvark."})}),t.jsx("div",{className:"mt-4 flex items-center justify-center",children:t.jsx(de,{as:"button",size:"small",color:"secondary",onClick:s,children:t.jsx(m,{id:"aardvark.whamRepos.connectGithub",defaultMessage:"Connect GitHub"})})})]})}var Xe,vt;function Es(){if(vt)return Xe;vt=1;var s=is(),e=os(),r=ls(),u=St();function n(){var x=arguments.length;if(!x)return[];for(var h=Array(x-1),f=arguments[0],b=x;b--;)h[b-1]=arguments[b];return s(u(f)?r(f):[f],e(h,1))}return Xe=n,Xe}var Is=Es();const Ft=jt(Is),Ls=U(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yA),__vite__mapDeps([0,1,2,3,4])),{loading:s=>V(s)});function Fs({values:s,onChangeValues:e}){var S;const r=Z(),u=At(),n=ot(),x=(n==null?void 0:n.email)||"",h=u==null?void 0:u.getWorkspaceId(),[f,b]=R.useState(""),{data:d,isFetching:p}=hs(h!=null?h:void 0,0,f,100),k=R.useMemo(()=>{var E,O,I;const v=[];for(const M of(E=d==null?void 0:d.items)!=null?E:[])v.push({id:M.id,label:(O=M.name)!=null?O:"",email:(I=M.email)!=null?I:""});return v},[d]),o=!!s&&s.size>0,i=!o,a=o,l=o&&s.size===1?Array.from(s)[0]:null,c=l&&x&&l.toLowerCase()===x.toLowerCase(),g=o?c?r.formatMessage({id:"aardvark.filter.assignee.me",defaultMessage:"Assigned to me"}):r.formatMessage({id:"aardvark.filter.assignee.count",defaultMessage:"{count} assignees"},{count:(S=s==null?void 0:s.size)!=null?S:0}):r.formatMessage({id:"aardvark.filter.assignee.all",defaultMessage:"All assignees"}),j=(x||"").toLowerCase(),_=v=>f?"".concat(v.label," ").concat(v.email).toLowerCase().includes(f.toLowerCase()):!0,C=j?{email:x,label:"Assigned to me"}:void 0,y=wt(cs(k),v=>(v.email||"").toLowerCase()!==j&&_({label:v.label,email:v.email})).map(v=>({email:v.email,label:v.label})),w=Ft(C&&_(C)?[C]:[],y);return t.jsxs(De,{triggerButton:t.jsxs("button",{type:"button",className:"border-token-border-light inline-flex h-7 items-center gap-1 rounded-md border px-2 text-xs transition-colors "+(a?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:[t.jsx("span",{children:g}),t.jsx(Ls,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]}),children:[t.jsx("div",{className:"p-2.5",children:t.jsx(Y.InputItem,{autoFocus:!0,holdFocus:!0,value:f,onChange:v=>b(v.target.value),placeholder:r.formatMessage({id:"aardvark.filter.assignee.search",defaultMessage:"Search assignees"}),"aria-label":r.formatMessage({id:"aardvark.filter.assignee.search",defaultMessage:"Search assignees"})})}),!p&&t.jsx(t.Fragment,{children:t.jsx(Y.MultiSelectCheckboxItem,{checked:i,onCheckedChange:()=>e(new Set),children:r.formatMessage({id:"aardvark.filter.assignee.all",defaultMessage:"All assignees"})})}),p?t.jsxs(t.Fragment,{children:[t.jsx(Y.Shimmer,{}),t.jsx(Y.Shimmer,{size:"short"})]}):w.map(v=>t.jsxs(Y.MultiSelectCheckboxItem,{checked:!!(s!=null&&s.has(v.email||"")),onCheckedChange:()=>{const E=new Set(s!=null?s:[]),O=v.email||"";E.has(O)?E.delete(O):E.add(O),e(E)},children:[v.label,v.email?t.jsx("span",{className:"text-token-text-tertiary ms-2 text-[11px]",children:v.email}):null]},v.email))]})}function Os(s,e,r=50,u=!0){const n=String(e!=null?e:"").trim(),x=Math.max(1,Math.min(r,500));return Kt({queryKey:["aardvark","authors",s||null,n||null,x],queryFn:async()=>{var k,o;const h=new Nt(Rt,{fetchFn:(i,a)=>globalThis.fetch.call(globalThis,i,a)}),f={limit:x};s&&(f.repo=Array.from(s).join(",")),n&&(f.q=n);const b=await h.get("/aardvark/scan-findings/list-authors",{headers:Ze(),query:f}),d=(o=b==null?void 0:b.data)!=null?o:await((k=b==null?void 0:b.json)==null?void 0:k.call(b).catch(()=>null));return{items:Array.isArray(d==null?void 0:d.items)?d.items:[]}},staleTime:3e4,refetchOnWindowFocus:!0,enabled:u})}const Ps=U(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yA),__vite__mapDeps([0,1,2,3,4])),{loading:s=>V(s)});function Ts({values:s,selectedRepos:e,onChangeValues:r}){var y;const u=Z(),n=ot(),x=(n==null?void 0:n.email)||"",[h,f]=R.useState(""),b=gs(h,300),{data:d,isFetching:p}=Os(e,b,100,!0),k=R.useMemo(()=>{var w;return((w=d==null?void 0:d.items)!=null?w:[]).map(S=>({email:S.email,label:S.name||S.email}))},[d]),o=!!s&&s.size>0,i=!o,a=o,l=o?u.formatMessage({id:"aardvark.filter.authors.count",defaultMessage:"{count} authors"},{count:(y=s==null?void 0:s.size)!=null?y:0}):u.formatMessage({id:"aardvark.filter.authors.all",defaultMessage:"All authors"}),c=(x||"").toLowerCase(),g=w=>h?"".concat(w.label," ").concat(w.email).toLowerCase().includes(h.toLowerCase()):!0,j=c?{email:x,label:"Authored by me"}:void 0,_=wt(ds(k,w=>(w.email||"").toLowerCase()),w=>(w.email||"").toLowerCase()!==c&&g(w)),C=Ft(j?[j]:[],_);return t.jsxs(De,{triggerButton:t.jsxs("button",{type:"button",className:"border-token-border-light inline-flex h-7 items-center gap-1 rounded-md border px-2 text-xs transition-colors "+(a?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:[t.jsx("span",{children:l}),t.jsx(Ps,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]}),children:[t.jsx("div",{className:"p-2.5",children:t.jsx(Y.InputItem,{autoFocus:!0,holdFocus:!0,value:h,onChange:w=>f(w.target.value),placeholder:u.formatMessage({id:"aardvark.filter.authors.search",defaultMessage:"Search authors"}),"aria-label":u.formatMessage({id:"aardvark.filter.authors.search",defaultMessage:"Search authors"})})}),p?t.jsxs(t.Fragment,{children:[t.jsx(Y.Shimmer,{}),t.jsx(Y.Shimmer,{size:"short"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Y.MultiSelectCheckboxItem,{checked:i,onCheckedChange:()=>r(new Set),children:u.formatMessage({id:"aardvark.filter.authors.all",defaultMessage:"All authors"})}),C.map(w=>t.jsxs(Y.MultiSelectCheckboxItem,{checked:!!(s!=null&&s.has(w.email)),onCheckedChange:()=>{const S=new Set(s!=null?s:[]);S.has(w.email)?S.delete(w.email):S.add(w.email),r(S)},children:[w.label,w.email?t.jsx("span",{className:"text-token-text-tertiary ms-2 text-[11px]",children:w.email}):null]},w.email))]})]})}function $e(s,e){const u=new URLSearchParams(s).get(e);return!u||u.trim()===""?[]:u.split(",").map(n=>n.trim()).filter(Boolean)}function Ds(s){const e=Oe(),r=ze(),u=At(),n=ot(),x=n==null?void 0:n.email,h=u==null?void 0:u.getWorkspaceId(),{isLoading:f,scanMap:b}=st(h),d=R.useMemo(()=>{var a,l;const o=new Set;for(const c of b.values()){const j=String((a=c.repo_url)!=null?a:"").trim();j&&o.add(j)}if(o.size===0)for(const c of s){const g=String((l=c.repo_url)!=null?l:"").trim();g&&o.add(g)}const i=Array.from(o).map(c=>({label:We(c)||c,value:c}));return i.sort((c,g)=>c.label.localeCompare(g.label)),i},[b,s]);return R.useEffect(()=>{var a;const o=new URLSearchParams(e.search);if(!e.search||e.search===""||e.search==="?"){if(f)return;o.has("recommended")||o.set("recommended","true");const c=Ns([],d.map(g=>g.value));!o.has("repo")&&c.length>0&&o.set("repo",c.join(",")),o.set("sort",(a=o.get("sort"))!=null?a:"sev_desc"),r({search:"?".concat(o.toString())},{replace:!0})}},[e.search,r,x,d,f]),R.useEffect(()=>{var _,C;if(f||d.length===0)return;const o=new URLSearchParams(e.search);if(!(o.get("recommended")==="true"))return;const a=(_=d[0])==null?void 0:_.value;if(!a)return;const l=(C=o.get("repo"))!=null?C:"",c=l.split(",").map(y=>y.trim()).filter(Boolean);let g=c.length>0?c[0]:a;d.some(y=>y.value===g)||(g=a),(c.length!==1||c[0]!==g||l!==g)&&(o.set("repo",g),r({search:"?".concat(o.toString())},{replace:!0}))},[e.search,r,d,f]),{filters:R.useMemo(()=>{const o=new Set($e(e.search,"status")),i=new Set($e(e.search,"criticality")),a=$e(e.search,"repo"),l=$e(e.search,"assignee"),c=new URLSearchParams(e.search).get("validated"),g=c==="true"?"validated":c==="false"?"unvalidated":"all",j=new URLSearchParams(e.search).get("recommended")==="true",_=new Set(Array.from(o)),C=new Set(Array.from(i)),y=new Set(a),w=y.size===1?Array.from(y)[0]:"all",S=new Set(l),v=$e(e.search,"author"),E=new Set(v);return{selectedCriticalities:C,securityOnly:!1,privacyOnly:!1,selectedStatuses:_,selectedRepo:w,selectedRepos:y,recommendedOnly:j,existsInHeadOnly:!1,validationFilter:g,selectedAssignees:S,selectedAuthors:E}},[e.search]),onChangeFilters:o=>{const i=new URLSearchParams(e.search),a=o;a.recommendedOnly?i.set("recommended","true"):i.delete("recommended"),a.selectedRepos&&a.selectedRepos.size>0?i.set("repo",Array.from(a.selectedRepos).join(",")):i.delete("repo"),a.selectedCriticalities&&a.selectedCriticalities.size>0?i.set("criticality",Array.from(a.selectedCriticalities).join(",")):i.delete("criticality"),a.selectedStatuses&&a.selectedStatuses.size>0?i.set("status",Array.from(a.selectedStatuses).join(",")):i.delete("status"),a.validationFilter==="validated"?i.set("validated","true"):a.validationFilter==="unvalidated"?i.set("validated","false"):i.delete("validated"),a.selectedAssignees&&a.selectedAssignees.size>0?i.set("assignee",Array.from(a.selectedAssignees).join(",")):i.delete("assignee"),a.selectedAuthors&&a.selectedAuthors.size>0?i.set("author",Array.from(a.selectedAuthors).join(",")):i.delete("author"),r({search:"?".concat(i.toString())},{replace:!0})},repoOptions:d,repoOptionsLoading:f}}const Ot=R.createContext(null);function Pt({findings:s,children:e}){const{filters:r,onChangeFilters:u,repoOptions:n,repoOptionsLoading:x}=Ds(s),h=R.useMemo(()=>{var b,d;const f=new Map;for(const p of s){const k=p.commit_analysis,o=k!=null?k:{},i=String((b=o.author_email)!=null?b:"").trim();if(!i)continue;const a=String((d=o.author)!=null?d:"").trim();f.has(i)||f.set(i,a)}return Array.from(f.entries()).map(([p,k])=>({email:p,label:k||p})).sort((p,k)=>p.label.localeCompare(k.label))},[s]);return t.jsx(Ot.Provider,{value:{filters:r,onChangeFilters:u,repoOptions:n,repoOptionsLoading:x,authorOptions:h},children:e})}function Ke(){const s=R.useContext(Ot);if(!s)throw new Error("useAardvarkFiltersContext must be used within AardvarkFiltersProvider");return s}const Ge=U(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yA),__vite__mapDeps([0,1,2,3,4])),{loading:s=>V(s)}),zs=Yt({all:{id:"aardvark.filter.validation.all",defaultMessage:"All validation states"},validated:{id:"aardvark.filter.validation.validated",defaultMessage:"Validated only"},unvalidated:{id:"aardvark.filter.validation.unvalidated",defaultMessage:"Unvalidated only"}}),Hs=["all","validated","unvalidated"];function $s(){var p,k,o,i;const s=Z(),{filters:e,onChangeFilters:r}=Ke(),u=a=>{const l=new Set(e.selectedCriticalities);l.has(a)?l.delete(a):l.add(a),r(ke(ue({},e),{selectedCriticalities:l}))},n=a=>{const l=new Set(e.selectedStatuses);l.has(a)?l.delete(a):l.add(a),r(ke(ue({},e),{selectedStatuses:l}))},[x,h]=R.useState(!0),f=R.useMemo(()=>{var l,c,g,j,_,C;let a=0;return a+=(c=(l=e.selectedAuthors)==null?void 0:l.size)!=null?c:0,a+=(j=(g=e.selectedStatuses)==null?void 0:g.size)!=null?j:0,a+=(C=(_=e.selectedCriticalities)==null?void 0:_.size)!=null?C:0,a+=e.existsInHeadOnly?1:0,a+=e.validationFilter!=="all"?1:0,a},[e]),b=R.useMemo(()=>e.validationFilter==="validated"?s.formatMessage({id:"aardvark.filter.validation.validated",defaultMessage:"Validated only"}):e.validationFilter==="unvalidated"?s.formatMessage({id:"aardvark.filter.validation.unvalidated",defaultMessage:"Unvalidated only"}):s.formatMessage({id:"aardvark.filter.validation.all",defaultMessage:"All validation states"}),[e.validationFilter,s]),d="border-token-border-light inline-flex h-7 items-center gap-1 rounded-md border px-2 text-xs transition-colors "+(e.validationFilter!=="all"?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"text-token-text-secondary hover:bg-token-main-surface-secondary");return t.jsxs("div",{className:"bg-token-bg-primary flex w-full flex-wrap justify-between rounded-lg py-2 text-sm",children:[t.jsx("div",{className:"flex items-center gap-2"}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("button",{className:"border-token-border-light h-7 rounded-md border px-2 text-xs transition-colors "+(f>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),onClick:()=>h(a=>!a),children:f>0?s.formatMessage({id:"aardvark.filter.filtersCount",defaultMessage:"Filters {count}"},{count:f}):s.formatMessage({id:"aardvark.filter.filters",defaultMessage:"Filters"})})}),x&&t.jsxs("div",{className:"mt-2 flex w-full flex-wrap items-center justify-end gap-2",children:[t.jsx(Ts,{values:e.selectedAuthors,selectedRepos:e.selectedRepos,onChangeValues:a=>r(ke(ue({},e),{selectedAuthors:a}))}),t.jsx(Fs,{values:e.selectedAssignees,onChangeValues:a=>r(ke(ue({},e),{selectedAssignees:a}))}),t.jsxs(De,{triggerButton:t.jsxs("button",{type:"button",className:"border-token-border-light inline-flex h-7 items-center gap-1 rounded-md border px-2 text-xs transition-colors "+(e.selectedStatuses&&e.selectedStatuses.size>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:[t.jsx("span",{children:e.selectedStatuses&&e.selectedStatuses.size===0?s.formatMessage({id:"aardvark.filter.allStatuses",defaultMessage:"All statuses"}):s.formatMessage({id:"aardvark.filter.status.count",defaultMessage:"{count} statuses"},{count:(k=(p=e.selectedStatuses)==null?void 0:p.size)!=null?k:0})}),t.jsx(Ge,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]}),children:[t.jsx(Y.MultiSelectCheckboxItem,{checked:e.selectedStatuses&&e.selectedStatuses.size===0,onCheckedChange:()=>r(ke(ue({},e),{selectedStatuses:new Set})),children:s.formatMessage({id:"aardvark.filter.allStatuses",defaultMessage:"All statuses"})}),["new","triaged","in_progress","fixed","wontfix","duplicate"].map(a=>{var l;return t.jsx(Y.MultiSelectCheckboxItem,{checked:(l=e.selectedStatuses)==null?void 0:l.has(a),onCheckedChange:()=>n(a),children:s.formatMessage(es[a])},a)})]}),t.jsxs(De,{triggerButton:t.jsxs("button",{type:"button",className:"border-token-border-light inline-flex h-7 items-center gap-1 rounded-md border px-2 text-xs transition-colors "+(e.selectedCriticalities&&e.selectedCriticalities.size>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:[t.jsx("span",{children:e.selectedCriticalities&&e.selectedCriticalities.size===0?s.formatMessage({id:"aardvark.filter.allCriticalities",defaultMessage:"All criticalities"}):s.formatMessage({id:"aardvark.filter.criticality.count",defaultMessage:"{count} criticalities"},{count:(i=(o=e.selectedCriticalities)==null?void 0:o.size)!=null?i:0})}),t.jsx(Ge,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]}),children:[t.jsx(Y.MultiSelectCheckboxItem,{checked:e.selectedCriticalities&&e.selectedCriticalities.size===0,className:"px-2! py-1!",onCheckedChange:()=>r(ke(ue({},e),{selectedCriticalities:new Set})),children:s.formatMessage({id:"aardvark.filter.allCriticalities",defaultMessage:"All criticalities"})}),["critical","high","medium","low"].map(a=>{var l;return t.jsx(Y.MultiSelectCheckboxItem,{className:"px-2! py-1!",checked:(l=e.selectedCriticalities)==null?void 0:l.has(a),onCheckedChange:()=>u(a),children:t.jsx(at,{level:a})},a)})]}),t.jsx(De,{triggerButton:t.jsxs("button",{type:"button",className:d,"aria-label":s.formatMessage({id:"aardvark.filter.validation.aria",defaultMessage:"Filter findings by validation state"}),children:[t.jsx("span",{children:b}),t.jsx(Ge,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]}),children:Hs.map(a=>t.jsx(Y.MultiSelectCheckboxItem,{className:"px-2! py-2!",checked:e.validationFilter===a,onCheckedChange:l=>{l&&r(ke(ue({},e),{validationFilter:a}))},children:s.formatMessage(zs[a])},a))})]})]})}function Bs(){var k;const s=Z(),{filters:e,onChangeFilters:r,repoOptions:u,repoOptionsLoading:n}=Ke(),[x,h]=R.useState(""),b=(k=R.useMemo(()=>{var o;return Array.from((o=e.selectedRepos)!=null?o:[])},[e.selectedRepos])[0])!=null?k:"",d=R.useMemo(()=>{var i;if(!b)return"";const o=u.find(a=>a.value===b);return(i=o==null?void 0:o.label)!=null?i:b},[b,u]),p=R.useMemo(()=>{var o,i,a,l,c;if(e.recommendedOnly){if(d)return d;const g=(o=u[0])==null?void 0:o.label;return g&&g.trim().length>0?g:s.formatMessage({id:"aardvark.filter.recommended.selectRepo",defaultMessage:"Choose a repository"})}return e.selectedRepos&&e.selectedRepos.size>0?e.selectedRepos.size===1?d||s.formatMessage({id:"aardvark.filter.repo.count",defaultMessage:"{count} repos"},{count:(a=(i=e.selectedRepos)==null?void 0:i.size)!=null?a:0}):s.formatMessage({id:"aardvark.filter.repo.count",defaultMessage:"{count} repos"},{count:(c=(l=e.selectedRepos)==null?void 0:l.size)!=null?c:0}):s.formatMessage({id:"aardvark.filter.allRepos.label",defaultMessage:"All repos"})},[e.recommendedOnly,e.selectedRepos,s,d,u]);return u.length===0?t.jsxs("div",{className:"mt-4 flex w-full flex-col items-center gap-3 text-sm",children:[e.recommendedOnly?t.jsx("span",{className:"text-token-text-tertiary text-xs",children:t.jsx(m,{id:"aardvark.filter.recommended.repoReminder",defaultMessage:"Recommended view shows findings from one repository at a time."})}):null,t.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[t.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:t.jsx(m,{id:"aardvark.filter.recommended.repoLabel",defaultMessage:"Repositories:"})}),t.jsx("span",{className:"border-token-border-light text-token-text-tertiary inline-flex h-8 items-center gap-2 rounded-lg border px-3 text-sm",children:n?t.jsxs(t.Fragment,{children:[t.jsx(Qe,{className:"text-token-text-tertiary h-4 w-4"}),t.jsx(m,{id:"aardvark.filter.repos.loading",defaultMessage:"Loading repositories..."})]}):t.jsx(m,{id:"aardvark.filter.repos.empty",defaultMessage:"No repositories available"})})]})]}):t.jsxs("div",{className:"mt-4 flex w-full flex-col items-center gap-3 text-sm",children:[e.recommendedOnly?t.jsx("span",{className:"text-token-text-tertiary text-xs",children:t.jsx(m,{id:"aardvark.filter.recommended.repoReminder",defaultMessage:"Recommended view shows findings from one repository at a time."})}):null,t.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[t.jsx("span",{className:"text-token-text-secondary text-sm font-medium",children:t.jsx(m,{id:"aardvark.filter.recommended.repoLabel",defaultMessage:"Repositories:"})}),t.jsxs(De,{triggerButton:t.jsxs("button",{type:"button",className:"border-token-border-light inline-flex h-8 items-center gap-2 rounded-lg border px-3 text-sm transition-colors "+(e.selectedRepos&&e.selectedRepos.size>0?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:[t.jsx("span",{children:p}),t.jsx(Ge,{className:"icon-sm text-token-text-tertiary","aria-hidden":!0})]}),children:[t.jsx("div",{className:"p-2.5",children:t.jsx(Y.InputItem,{autoFocus:!0,holdFocus:!0,value:x,onChange:o=>h(o.target.value),placeholder:s.formatMessage({id:"aardvark.filter.repos.search",defaultMessage:"Search repos"}),"aria-label":s.formatMessage({id:"aardvark.filter.repos.search",defaultMessage:"Search repos"})})}),e.recommendedOnly?null:t.jsx(Y.MultiSelectCheckboxItem,{checked:!(e.selectedRepos&&e.selectedRepos.size>0),onCheckedChange:()=>r(ke(ue({},e),{selectedRepos:new Set,selectedRepo:"all"})),children:s.formatMessage({id:"aardvark.filter.allRepos",defaultMessage:"All repos"})}),u.filter(o=>x?"".concat(o.label," ").concat(o.value).toLowerCase().includes(x.toLowerCase()):!0).map(o=>{var i;return t.jsx(Y.MultiSelectCheckboxItem,{checked:!!((i=e.selectedRepos)!=null&&i.has(o.value)),onCheckedChange:()=>{var l,c;const a=new Set(e.selectedRepos);if(a.has(o.value)?a.delete(o.value):(e.recommendedOnly&&a.clear(),a.add(o.value)),e.recommendedOnly){if(a.size===0){const g=(c=(l=u[0])==null?void 0:l.value)!=null?c:"";g&&a.add(g)}else if(a.size>1){const[g]=Array.from(a);a.clear(),g&&a.add(g)}}r(ke(ue({},e),{selectedRepos:a,selectedRepo:a.size===1?Array.from(a)[0]:"all"}))},children:o.label},o.value)})]})]})]})}const Us=U(()=>B(()=>import("./3j20em1lilnrpdcm.js").then(s=>s._),__vite__mapDeps([5,1])),{loading:s=>V(s)}),Vs=U(()=>B(()=>import("./ooz2slmm8agf6bjp.js").then(s=>s._),__vite__mapDeps([6,1])),{loading:s=>V(s)}),Tt=U(()=>B(()=>import("./ewkru1hsxkjpuxt5.js").then(s=>s._),__vite__mapDeps([7,1])),{loading:s=>V(s)}),Dt=U(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yA),__vite__mapDeps([0,1,2,3,4])),{loading:s=>V(s)}),zt=U(()=>B(()=>import("./rsi9kppw43ykrsgk.js").then(s=>s._),__vite__mapDeps([8,1])),{loading:s=>V(s)});function qs({findings:s,isLoading:e,showCodexActions:r=!1,showGithubIssue:u=!1,total:n,loadError:x=!1}){var O;const h=Oe(),f=ze(),[b,d]=R.useState(1),p=s,k=R.useMemo(()=>new URLSearchParams(h.search),[h.search]),o=((O=k.get("limit"))!=null?O:"").toLowerCase(),a=Number(new Set(["10","20","50","100"]).has(o)?o:"50"),l=typeof n=="number"?n:p.length,c=k.get("cursor"),g=c&&Number.isFinite(Number(c))&&Number(c)>=0?Number(c):0,j=Math.max(1,Math.ceil(l/a)),_=Math.min(Math.max(1,Math.floor(g/a)+1),j),C=p,y=9+(u?1:0)+(r?1:0),w=k.get("recommended")==="true";R.useEffect(()=>{const I=k.get("cursor"),M=I?Number(I):0,z=Number.isFinite(M)&&M>=0?Math.floor(M/a)+1:1,H=Math.min(Math.max(1,z),j);H!==b&&d(H)},[h.search,j,b,k,a]);const S=R.useMemo(()=>{var H;const I=new URLSearchParams(h.search),M=["repo","status","criticality","assignee","author","validated"],z={};for(const $ of M)z[$]=(H=I.get($))!=null?H:"";return JSON.stringify(z)},[h.search]),v=R.useRef(S);R.useEffect(()=>{if(v.current!==S){const I=new URLSearchParams(h.search);I.set("cursor","0"),I.toString()!==k.toString()&&f({search:"?".concat(I.toString())},{replace:!0})}v.current=S},[S,f,h.search,k]);const E=w?t.jsx(Qs,{findings:C,isLoading:e,loadError:x,start:g,totalCount:l,showCodexActions:r,showGithubIssue:u}):t.jsx(Gs,{rows:C,isLoading:e,loadError:x,columnCount:y,start:g,showGithubIssue:u,showCodexActions:r,pageSize:a,safePage:_,pageCount:j,totalCount:l,setPage:d,navigate:f,location:h});return t.jsx("section",{className:"mt-8",children:t.jsx(Pt,{findings:s,children:t.jsxs("div",{className:"mx-auto w-full",children:[t.jsxs("div",{className:"mb-4 flex flex-col gap-3",children:[t.jsx("h2",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:t.jsx(m,{id:"aardvark.home.findings",defaultMessage:"Manage findings"})}),t.jsx("div",{role:"note",className:"border-token-border-light/60 bg-token-bg-tertiary/50 flex flex-col gap-2 rounded-lg border px-3 py-2.5 shadow-sm backdrop-blur-[2px]",children:t.jsx("div",{className:"text-token-text-secondary flex items-start gap-3 text-sm leading-6",children:t.jsxs("div",{className:"flex items-center gap-x-2",children:[t.jsx(Vs,{className:"text-token-icon-tertiary h-4 w-4","aria-hidden":!0}),t.jsx("p",{className:"m-0",children:t.jsx("span",{className:"text-token-text-primary font-semibold",children:t.jsx(m,{id:"aardvark.findings.configured.notice",defaultMessage:"Only showing findings from repositories you can access and have connected. View all {link}.",values:{link:t.jsx("a",{href:"#configurescans-connected-repos",className:"underline underline-offset-2",onClick:I=>{var M;I.preventDefault(),f({search:h.search,hash:"#configurescans-connected-repos"},{replace:!1});try{(M=document.getElementById("connected-repos"))==null||M.scrollIntoView({behavior:"smooth",block:"start"})}catch(z){}},children:t.jsx(m,{id:"aardvark.findings.configured.link",defaultMessage:"connected repos"})})}})})})]})})}),t.jsx("div",{className:"mt-3 flex w-full flex-wrap items-center justify-center gap-3",children:t.jsx(Ws,{})}),t.jsx(Bs,{})]}),t.jsxs("div",{className:Be("mx-auto w-full",w?"max-w-7xl px-6":""),children:[w?null:t.jsx($s,{}),E]})]})})})}function Gs({rows:s,isLoading:e,loadError:r,columnCount:u,start:n,showGithubIssue:x,showCodexActions:h,pageSize:f,safePage:b,pageCount:d,totalCount:p,setPage:k,navigate:o,location:i}){const a=Z();return t.jsxs(t.Fragment,{children:[t.jsxs(N.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[t.jsxs(N.Header,{children:[t.jsx(N.HeaderCell,{className:"w-10 pe-2 text-end text-sm",children:t.jsx(m,{id:"aardvark.findings.number",defaultMessage:"#"})}),t.jsx(N.HeaderCell,{className:"ps-2 text-sm",children:t.jsx(m,{id:"aardvark.table.repoHeader",defaultMessage:"Repository"})}),t.jsx(N.HeaderCell,{className:"text-sm",children:t.jsx(ea,{})}),t.jsx(N.HeaderCell,{className:"text-sm",children:t.jsx(m,{id:"aardvark.table.vulnerability",defaultMessage:"Vulnerability"})}),t.jsx(N.HeaderCell,{className:"w-16 text-center text-sm",children:t.jsx("span",{className:"inline-flex items-center justify-center gap-1",children:t.jsx(m,{id:"aardvark.table.validated",defaultMessage:"Validated"})})}),t.jsx(N.HeaderCell,{className:"text-sm",children:t.jsx(m,{id:"aardvark.table.statusHeader",defaultMessage:"Status"})}),t.jsx(N.HeaderCell,{className:"text-sm",children:t.jsx(m,{id:"aardvark.table.assigneeHeader",defaultMessage:"Assignee"})}),t.jsx(N.HeaderCell,{className:"text-sm",children:t.jsx(ta,{})}),x?t.jsx(N.HeaderCell,{className:"text-sm",children:t.jsx(m,{id:"aardvark.table.githubIssue",defaultMessage:"GitHub Issue"})}):null,h?t.jsx(N.HeaderCell,{className:"text-sm",children:t.jsx(m,{id:"aardvark.table.actions",defaultMessage:"Actions"})}):null,t.jsx(N.HeaderCell,{className:"text-sm"})]}),t.jsx(N.Body,{children:e?t.jsx(N.Row,{children:t.jsx(N.Cell,{colSpan:u,divClassName:"h-64",children:t.jsx("div",{className:"flex h-full w-full items-center justify-center",children:t.jsx(Qe,{className:"text-token-text-tertiary h-6 w-6"})})})}):r?t.jsx(N.Row,{children:t.jsx(N.Cell,{colSpan:u,divClassName:"py-6",children:t.jsx(Ht,{message:t.jsx(m,{id:"aardvark.table.errorFindings",defaultMessage:"Error loading findings"})})})}):s.length===0?t.jsx(N.Row,{children:t.jsx(N.Cell,{colSpan:u,divClassName:"flex h-14 items-center",children:t.jsx(m,{id:"aardvark.table.emptyFindings",defaultMessage:"No findings"})})}):s.map((l,c)=>{var g,j,_,C,y,w,S,v,E,O;return t.jsxs(N.Row,{className:"group/row hover:bg-token-bg-tertiary min-h-14 cursor-pointer px-2 text-sm",onClick:()=>{o("/aardvark/findings/".concat(encodeURIComponent(l.hid)).concat(i.search||""))},children:[t.jsx(N.Cell,{divClassName:"flex h-14 items-center justify-end pe-2 text-token-text-tertiary tabular-nums",children:n+c+1}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center ps-2",children:We((g=l.repo_url)!=null?g:"")||a.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"})}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center",children:t.jsx(at,{level:l.criticality})}),t.jsx(N.Cell,{divClassName:"flex items-center max-w-100 pt-3 pb-3",children:t.jsx("span",{className:"text-start",title:(_=(j=l.commit_analysis)==null?void 0:j.description)!=null?_:"",children:Mt((S=(w=(C=l.commit_analysis)==null?void 0:C.title)!=null?w:(y=l.commit_analysis)==null?void 0:y.description)!=null?S:"",140)})}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center justify-center",children:(v=l.commit_analysis)!=null&&v.validated?t.jsxs(t.Fragment,{children:[t.jsx(zt,{className:"icon-sm","aria-hidden":!0}),t.jsx("span",{className:"sr-only",children:t.jsx(m,{id:"aardvark.findings.validated.sr",defaultMessage:"Validated finding"})})]}):t.jsx("span",{className:"text-token-text-tertiary text-sm",children:t.jsx(m,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center",children:t.jsx("div",{onClick:I=>I.stopPropagation(),children:t.jsx(Ct,{finding:l})})}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center",children:t.jsx("div",{onClick:I=>I.stopPropagation(),children:t.jsx(_t,{finding:l})})}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center",children:qe(l)?t.jsxs(t.Fragment,{children:[t.jsx(et,{value:new Date((E=qe(l))!=null?E:""),year:"numeric",month:"long",day:"numeric"}),t.jsx("span",{className:"text-token-text-tertiary ms-2",children:t.jsx(tt,{value:new Date((O=qe(l))!=null?O:""),hour:"numeric",minute:"2-digit"})})]}):t.jsx(m,{id:"aardvark.placeholder.missing",defaultMessage:"—"})}),x?t.jsx(N.Cell,{divClassName:"flex h-14 items-center",children:l.github_issue_id!=null?t.jsx("span",{className:"text-token-text-secondary",children:t.jsx(m,{id:"aardvark.github.issue.number",defaultMessage:"#{id}",values:{id:l.github_issue_id}})}):t.jsx("span",{children:t.jsx(m,{id:"aardvark.placeholder.missing",defaultMessage:"—"})})}):null,h?t.jsx(N.Cell,{divClassName:"flex h-14 items-center",children:t.jsx(de,{as:"button",size:"small",color:"secondary",onClick:I=>I.stopPropagation(),children:t.jsx(m,{id:"aardvark.codex.fix",defaultMessage:"Fix with Codex"})})}):null,t.jsx(N.Cell,{divClassName:"flex h-14 items-center",children:t.jsxs(yt,{to:"/aardvark/findings/".concat(encodeURIComponent(l.hid)).concat(i.search||""),onClick:I=>I.stopPropagation(),className:"text-token-text-accent inline-flex items-center gap-1 hover:underline",children:[t.jsx(m,{id:"aardvark.table.viewButton",defaultMessage:"View"}),t.jsx(Tt,{className:"icon-sm","aria-hidden":!0})]})})]},"".concat(l.hid,"-").concat(c))})})]}),t.jsxs("div",{className:"border-token-border-light bg-token-bg-primary mt-3 flex items-center justify-between border-t px-3 py-2 ".concat(e?"animate-pulse blur-[1px]":""),children:[t.jsx("div",{className:"text-token-text-tertiary text-xs",children:t.jsx(m,{id:"aardvark.findings.range",defaultMessage:"{from}-{to} of {total} results",values:{from:s.length===0?0:n+1,to:s.length===0?0:Math.min(n+s.length,p),total:p}})}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("label",{className:"text-token-text-tertiary text-xs",htmlFor:"rows-per-page",children:t.jsx(m,{id:"aardvark.pagination.rowsPerPage",defaultMessage:"Rows per page"})}),t.jsx(pt,{triggerId:"rows-per-page",triggerClassName:"min-w-[84px]",contentClassName:"!min-w-[84px]",value:String(f),onValueChange:l=>{k(1);const c=new URLSearchParams(i.search);c.set("limit",l),c.set("cursor","0"),o({search:"?".concat(c.toString())},{replace:!0})},options:[{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}]}),t.jsxs(t.Fragment,{children:[t.jsx("label",{className:"text-token-text-tertiary text-xs",htmlFor:"page-select",children:t.jsx(m,{id:"aardvark.pagination.page",defaultMessage:"Page"})}),t.jsx(pt,{triggerId:"page-select",triggerClassName:"min-w-[72px]",contentClassName:"!min-w-[72px]",value:String(b),onValueChange:l=>{const c=Math.min(Math.max(1,Number(l)),d);k(c);const g=new URLSearchParams(i.search);g.set("cursor",String((c-1)*f)),o({search:"?".concat(g.toString())},{replace:!0})},options:Array.from({length:d},(l,c)=>({label:String(c+1),value:String(c+1)}))}),t.jsx("span",{className:"text-token-text-tertiary text-xs",children:t.jsx(m,{id:"aardvark.pagination.of",defaultMessage:"of {count}",values:{count:d}})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(de,{as:"button",size:"small",color:"secondary",disabled:e||b<=1,onClick:()=>{const l=Math.max(1,b-1);k(l);const c=new URLSearchParams(i.search);c.set("cursor",String((l-1)*f)),o({search:"?".concat(c.toString())},{replace:!0})},children:t.jsx(m,{id:"aardvark.pagination.prev",defaultMessage:"Previous"})}),t.jsx(de,{as:"button",size:"small",color:"secondary",disabled:e||b>=d,onClick:()=>{const l=Math.min(d,b+1);k(l);const c=new URLSearchParams(i.search);c.set("cursor",String((l-1)*f)),o({search:"?".concat(c.toString())},{replace:!0})},children:t.jsx(m,{id:"aardvark.pagination.next",defaultMessage:"Next"})})]})]})]})]})}function Ws(){"use forget";const s=Ue.c(25),{filters:e,onChangeFilters:r,repoOptions:u}=Ke();let n;s[0]!==e||s[1]!==r||s[2]!==u?(n=C=>{var w,S;if(C===e.recommendedOnly)return;let y=new Set(e.selectedRepos);if(C){const v=(S=(w=u[0])==null?void 0:w.value)!=null?S:"";if(y.size===0)v&&(y=new Set([v]));else if(y.size>1){const[E]=Array.from(y),O=E&&E.trim().length>0?E:v;y=O&&O.trim().length>0?new Set([O]):new Set}else{const[E]=Array.from(y);E&&!u.some(O=>O.value===E)&&v&&(y=new Set([v]))}}else y=new Set;r(ke(ue({},e),{recommendedOnly:C,selectedRepos:y,selectedRepo:y.size===1?Array.from(y)[0]:"all"}))},s[0]=e,s[1]=r,s[2]=u,s[3]=n):n=s[3];const x=n,h=e.recommendedOnly?"bg-token-main-surface-secondary text-token-text-primary shadow-sm":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-tertiary";let f;s[4]!==h?(f=Be("inline-flex min-w-[9.5rem] items-center justify-center rounded-lg px-5 py-2 text-sm font-medium transition-colors focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-token-outline-primary",h),s[4]=h,s[5]=f):f=s[5];const b=f,d=e.recommendedOnly?"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-tertiary":"bg-token-main-surface-secondary text-token-text-primary shadow-sm";let p;s[6]!==d?(p=Be("inline-flex min-w-[9.5rem] items-center justify-center rounded-lg px-5 py-2 text-sm font-medium transition-colors focus-visible:outline focus-visible-outline-2 focus-visible-outline-offset-2 focus-visible-outline-token-outline-primary",d),s[6]=d,s[7]=p):p=s[7];const k=p;let o;s[8]!==x?(o=()=>x(!0),s[8]=x,s[9]=o):o=s[9];let i;s[10]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsx(m,{id:"aardvark.filter.recommended",defaultMessage:"Recommended findings"}),s[10]=i):i=s[10];let a;s[11]!==e.recommendedOnly||s[12]!==b||s[13]!==o?(a=t.jsx("button",{type:"button","aria-pressed":e.recommendedOnly,className:b,onClick:o,children:i}),s[11]=e.recommendedOnly,s[12]=b,s[13]=o,s[14]=a):a=s[14];const l=!e.recommendedOnly;let c;s[15]!==x?(c=()=>x(!1),s[15]=x,s[16]=c):c=s[16];let g;s[17]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx(m,{id:"aardvark.filter.allFindings",defaultMessage:"All findings"}),s[17]=g):g=s[17];let j;s[18]!==k||s[19]!==l||s[20]!==c?(j=t.jsx("button",{type:"button","aria-pressed":l,className:k,onClick:c,children:g}),s[18]=k,s[19]=l,s[20]=c,s[21]=j):j=s[21];let _;return s[22]!==j||s[23]!==a?(_=t.jsxs("div",{className:"border-token-border-light bg-token-bg-primary inline-flex items-center gap-1 rounded-lg border px-1 py-1 shadow-sm",children:[a,j]}),s[22]=j,s[23]=a,s[24]=_):_=s[24],_}function Qs(s){"use forget";var se,X,ae;const e=Ue.c(42),{findings:r,isLoading:u,loadError:n,start:x,totalCount:h,showCodexActions:f,showGithubIssue:b}=s,d=Z(),{filters:p,repoOptions:k,repoOptionsLoading:o}=Ke();let i=null;if(e[0]!==r||e[1]!==i){for(const L of r){const T=L.ranking_end_time,P=typeof T=="number"?T:typeof T=="string"?Number(T):null;P==null||!Number.isFinite(P)||(i==null||P>i)&&(i=P)}e[0]=r,e[1]=i,e[2]=i}else i=e[2];const a=i;let l;e:{if(a==null){l=null;break e}const L=a*1e3;if(!Number.isFinite(L)){l=null;break e}let T,P;if(e[3]!==L?(T=new Date(L),P=Number.isNaN(T.getTime()),e[3]=L,e[4]=T,e[5]=P):(T=e[4],P=e[5]),P){l=null;break e}l=T}const c=l;let g;if(e[6]!==p.selectedRepos||e[7]!==k){e:{const[L]=Array.from((se=p.selectedRepos)!=null?se:[]);if(!L){g="";break e}const T=k.find(P=>P.value===L);g=(ae=(X=T==null?void 0:T.label)!=null?X:We(L))!=null?ae:L}e[6]=p.selectedRepos,e[7]=k,e[8]=g}else g=e[8];const j=g;let _;e[9]!==r?(_=r.slice(0,10),e[9]=r,e[10]=_):_=e[10];const C=_;let y;e[11]!==d?(y=d.formatMessage({id:"aardvark.recommended.heading.targetAll",defaultMessage:"all repositories"}),e[11]=d,e[12]=y):y=e[12];const S=j||y,v=C.length,E=typeof h=="number"?h:null;if(o||u||h==null&&r.length===0&&!n){let L;return e[13]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx("div",{className:"border-token-border-light bg-token-bg-primary flex min-h-[240px] items-center justify-center rounded-2xl border",children:t.jsx(Qe,{className:"text-token-text-tertiary h-6 w-6"})}),e[13]=L):L=e[13],L}if(n){let L;return e[14]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx("div",{className:"mx-auto max-w-5xl px-3",children:t.jsx(Ht,{message:t.jsx(m,{id:"aardvark.recommended.error",defaultMessage:"Error loading recommended findings"})})}),e[14]=L):L=e[14],L}if(C.length===0){let L;return e[15]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx("div",{className:"border-token-border-light bg-token-bg-primary text-token-text-secondary flex min-h-[160px] items-center justify-center rounded-2xl border px-4 py-6 text-center text-sm leading-6",children:t.jsx(m,{id:"aardvark.recommended.empty",defaultMessage:"No recommended findings right now"})}),e[15]=L):L=e[15],L}let I;e[16]!==S?(I=t.jsx("div",{className:"space-y-2",children:t.jsx("h3",{className:"text-token-text-primary text-xl leading-7 font-semibold",children:t.jsx(m,{id:"aardvark.recommended.heading.top",defaultMessage:"Aardvark Top {count} for {repo}",values:{count:10,repo:S}})})}),e[16]=S,e[17]=I):I=e[17];let M;e[18]!==c?(M=c?t.jsx("div",{className:"text-token-text-tertiary text-xs sm:text-sm",children:t.jsx(m,{id:"aardvark.recommended.updated",defaultMessage:"Updated {date} at {time}",values:{date:t.jsx(et,{value:c,year:"numeric",month:"long",day:"numeric"}),time:t.jsx(tt,{value:c,hour:"numeric",minute:"2-digit"})}})}):null,e[18]=c,e[19]=M):M=e[19];let z;e[20]!==I||e[21]!==M?(z=t.jsxs("header",{className:"flex flex-col gap-3 lg:flex-row lg:items-start lg:justify-between",children:[I,M]}),e[20]=I,e[21]=M,e[22]=z):z=e[22];let H;if(e[23]!==f||e[24]!==b||e[25]!==x||e[26]!==C){let L;e[28]!==f||e[29]!==b||e[30]!==x?(L=(T,P)=>t.jsx(Ks,{finding:T,index:P,baseIndex:x,showCodexActions:f,showGithubIssue:b},"".concat(T.hid,"-").concat(P)),e[28]=f,e[29]=b,e[30]=x,e[31]=L):L=e[31],H=C.map(L),e[23]=f,e[24]=b,e[25]=x,e[26]=C,e[27]=H}else H=e[27];let $;e[32]!==H?($=t.jsx("ol",{className:"flex flex-col gap-4",children:H}),e[32]=H,e[33]=$):$=e[33];let q;e[34]!==j||e[35]!==E||e[36]!==v?(q=t.jsx("div",{className:"text-token-text-tertiary text-xs",children:E!=null?j?t.jsx(m,{id:"aardvark.recommended.range.forRepo",defaultMessage:"Showing top {count} findings for {repo}",values:{count:v,repo:j}}):t.jsx(m,{id:"aardvark.recommended.range",defaultMessage:"Showing top {count} recommended findings",values:{count:v}}):j?t.jsx(m,{id:"aardvark.recommended.range.forRepo.noTotal",defaultMessage:"Showing top {count} findings for {repo}",values:{count:v,repo:j}}):t.jsx(m,{id:"aardvark.recommended.range.noTotal",defaultMessage:"Showing top {count} recommended findings",values:{count:v}})}),e[34]=j,e[35]=E,e[36]=v,e[37]=q):q=e[37];let W;return e[38]!==q||e[39]!==z||e[40]!==$?(W=t.jsxs("div",{className:"flex flex-col gap-5",children:[z,$,q]}),e[38]=q,e[39]=z,e[40]=$,e[41]=W):W=e[41],W}function Ks(s){"use forget";var ge,re,je,ye,Ae,we,me,Re,Se,pe;const e=Ue.c(111),{finding:r,index:u,baseIndex:n,showCodexActions:x,showGithubIssue:h}=s,f=Z(),b=ze(),d=Oe();let p;e[0]!==r.repo_url||e[1]!==f?(p=We((ge=r.repo_url)!=null?ge:"")||f.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"}),e[0]=r.repo_url,e[1]=f,e[2]=p):p=e[2];const k=p;let o,i,a,l,c,g,j,_,C,y,w,S,v,E,O,I,M,z,H;if(e[3]!==n||e[4]!==r||e[5]!==u||e[6]!==f||e[7]!==d.search||e[8]!==b||e[9]!==k){const ve=(Ae=(ye=(re=r.commit_analysis)==null?void 0:re.title)!=null?ye:(je=r.commit_analysis)==null?void 0:je.description)!=null?Ae:f.formatMessage({id:"aardvark.recommended.missingTitle",defaultMessage:"Untitled finding"}),Ee=(me=(we=r.commit_analysis)==null?void 0:we.description)!=null?me:"",F=typeof r.ranking_reason=="string"?r.ranking_reason:void 0;let ne;e[29]!==Ee||e[30]!==F?(ne=F&&F.trim().length>0?F:Ee,e[29]=Ee,e[30]=F,e[31]=ne):ne=e[31];const A=ne,K=qe(r),te=n+u+1;let ie;e[32]!==r.hid||e[33]!==d.search||e[34]!==b?(ie=()=>{b("/aardvark/findings/".concat(encodeURIComponent(r.hid)).concat(d.search||""))},e[32]=r.hid,e[33]=d.search,e[34]=b,e[35]=ie):ie=e[35];const be=ie;let Ne;e[36]!==be?(Ne=Te=>{(Te.key==="Enter"||Te.key===" ")&&(Te.preventDefault(),be())},e[36]=be,e[37]=Ne):Ne=e[37];const Pe=Ne;g="button",j=0,_=f.formatMessage({id:"aardvark.recommended.card.ariaLabel",defaultMessage:"View details for {title}"},{title:ve}),C=be,y=Pe,S="border-token-border-light/70 bg-token-main-surface-secondary/40 hover:border-token-border-strong hover:bg-token-main-surface-tertiary focus-visible:border-token-border-strong focus-visible:ring-token-border-strong dark:bg-token-main-surface-secondary/70 group/card flex cursor-pointer flex-col gap-4 rounded-2xl border px-4 py-4 shadow-md transition-all hover:-translate-y-0.5 focus-visible:ring-2 focus-visible:outline-none",c="flex flex-col gap-4 lg:flex-row lg:items-start",a="flex flex-1 gap-4",e[38]!==te?(l=t.jsx("div",{className:"bg-token-main-surface-secondary text-token-text-primary border-token-border-light flex h-9 w-9 shrink-0 items-center justify-center rounded-full border text-sm font-semibold",children:te}),e[38]=te,e[39]=l):l=e[39],z="min-w-0 flex-1 space-y-3";let Me;e[40]!==r.criticality?(Me=t.jsx(at,{level:r.criticality}),e[40]=r.criticality,e[41]=Me):Me=e[41];let Ce;e[42]!==((Re=r.commit_analysis)==null?void 0:Re.validated)?(Ce=(Se=r.commit_analysis)!=null&&Se.validated?t.jsxs("span",{className:"bg-token-main-surface-secondary text-token-text-primary inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-medium",children:[t.jsx(zt,{className:"h-3 w-3","aria-hidden":!0}),t.jsx(m,{id:"aardvark.recommended.validated",defaultMessage:"Validated"})]}):null,e[42]=(pe=r.commit_analysis)==null?void 0:pe.validated,e[43]=Ce):Ce=e[43],e[44]!==Me||e[45]!==Ce?(H=t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[Me,Ce]}),e[44]=Me,e[45]=Ce,e[46]=H):H=e[46],e[47]!==ve?(o=t.jsx("p",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:ve}),e[47]=ve,e[48]=o):o=e[48],e[49]!==A?(i=A?t.jsx("p",{className:"text-token-text-secondary text-sm leading-6",children:Mt(A,260)}):null,e[49]=A,e[50]=i):i=e[50],I="mt-1 flex flex-wrap gap-x-6 gap-y-2 text-xs";let Ie;e[51]===Symbol.for("react.memo_cache_sentinel")?(Ie=t.jsx("dt",{className:"text-token-text-tertiary",children:t.jsx(m,{id:"aardvark.recommended.meta.repo",defaultMessage:"Repository:"})}),e[51]=Ie):Ie=e[51],e[52]!==k?(M=t.jsxs("div",{className:"flex gap-1",children:[Ie,t.jsx("dd",{className:"text-token-text-primary",children:k})]}),e[52]=k,e[53]=M):M=e[53],E="flex gap-1",e[54]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx("dt",{className:"text-token-text-tertiary",children:t.jsx(m,{id:"aardvark.recommended.meta.detected",defaultMessage:"Detected:"})}),e[54]=O):O=e[54],w="text-token-text-primary",v=K?t.jsxs(t.Fragment,{children:[t.jsx(et,{value:new Date(K),year:"numeric",month:"long",day:"numeric"}),t.jsx("span",{className:"ms-1",children:t.jsx(tt,{value:new Date(K),hour:"numeric",minute:"2-digit"})})]}):t.jsx(m,{id:"aardvark.placeholder.missing",defaultMessage:"—"}),e[3]=n,e[4]=r,e[5]=u,e[6]=f,e[7]=d.search,e[8]=b,e[9]=k,e[10]=o,e[11]=i,e[12]=a,e[13]=l,e[14]=c,e[15]=g,e[16]=j,e[17]=_,e[18]=C,e[19]=y,e[20]=w,e[21]=S,e[22]=v,e[23]=E,e[24]=O,e[25]=I,e[26]=M,e[27]=z,e[28]=H}else o=e[10],i=e[11],a=e[12],l=e[13],c=e[14],g=e[15],j=e[16],_=e[17],C=e[18],y=e[19],w=e[20],S=e[21],v=e[22],E=e[23],O=e[24],I=e[25],M=e[26],z=e[27],H=e[28];let $;e[55]!==w||e[56]!==v?($=t.jsx("dd",{className:w,children:v}),e[55]=w,e[56]=v,e[57]=$):$=e[57];let q;e[58]!==$||e[59]!==E||e[60]!==O?(q=t.jsxs("div",{className:E,children:[O,$]}),e[58]=$,e[59]=E,e[60]=O,e[61]=q):q=e[61];let W;e[62]!==q||e[63]!==I||e[64]!==M?(W=t.jsxs("dl",{className:I,children:[M,q]}),e[62]=q,e[63]=I,e[64]=M,e[65]=W):W=e[65];let se;e[66]!==o||e[67]!==i||e[68]!==W||e[69]!==z||e[70]!==H?(se=t.jsxs("div",{className:z,children:[H,o,i,W]}),e[66]=o,e[67]=i,e[68]=W,e[69]=z,e[70]=H,e[71]=se):se=e[71];let X;e[72]!==a||e[73]!==l||e[74]!==se?(X=t.jsxs("div",{className:a,children:[l,se]}),e[72]=a,e[73]=l,e[74]=se,e[75]=X):X=e[75];let ae;e[76]!==r?(ae=t.jsx("div",{onClick:Zs,children:t.jsx(Ct,{finding:r})}),e[76]=r,e[77]=ae):ae=e[77];let L;e[78]!==r?(L=t.jsx("div",{onClick:Js,children:t.jsx(_t,{finding:r})}),e[78]=r,e[79]=L):L=e[79];let T;e[80]!==ae||e[81]!==L?(T=t.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:justify-end",children:[ae,L]}),e[80]=ae,e[81]=L,e[82]=T):T=e[82];let P;e[83]!==r.github_issue_id||e[84]!==h?(P=h&&r.github_issue_id!=null?t.jsx("span",{className:"text-token-text-secondary text-xs",children:t.jsx(m,{id:"aardvark.github.issue.number",defaultMessage:"#{id}",values:{id:r.github_issue_id}})}):null,e[83]=r.github_issue_id,e[84]=h,e[85]=P):P=e[85];let ee;e[86]!==x?(ee=x?t.jsx(de,{as:"button",size:"small",color:"secondary",onClick:Xs,children:t.jsx(m,{id:"aardvark.codex.fix",defaultMessage:"Fix with Codex"})}):null,e[86]=x,e[87]=ee):ee=e[87];const fe="/aardvark/findings/".concat(encodeURIComponent(r.hid)).concat(d.search||"");let xe,oe;e[88]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx(m,{id:"aardvark.table.viewButton",defaultMessage:"View"}),oe=t.jsx(Tt,{className:"icon-sm","aria-hidden":!0}),e[88]=xe,e[89]=oe):(xe=e[88],oe=e[89]);let Q;e[90]!==fe?(Q=t.jsxs(yt,{to:fe,onClick:Ys,className:"text-token-text-accent inline-flex items-center gap-1 text-sm font-medium hover:underline",children:[xe,oe]}),e[90]=fe,e[91]=Q):Q=e[91];let he;e[92]!==P||e[93]!==ee||e[94]!==Q?(he=t.jsxs("div",{className:"flex flex-wrap items-center gap-2 lg:justify-end",children:[P,ee,Q]}),e[92]=P,e[93]=ee,e[94]=Q,e[95]=he):he=e[95];let le;e[96]!==T||e[97]!==he?(le=t.jsxs("div",{className:"flex w-full flex-col gap-3 lg:max-w-[260px] lg:items-end",children:[T,he]}),e[96]=T,e[97]=he,e[98]=le):le=e[98];let J;e[99]!==c||e[100]!==X||e[101]!==le?(J=t.jsxs("div",{className:c,children:[X,le]}),e[99]=c,e[100]=X,e[101]=le,e[102]=J):J=e[102];let ce;return e[103]!==g||e[104]!==j||e[105]!==_||e[106]!==C||e[107]!==y||e[108]!==S||e[109]!==J?(ce=t.jsx("li",{children:t.jsx("article",{role:g,tabIndex:j,"aria-label":_,onClick:C,onKeyDown:y,className:S,children:J})}),e[103]=g,e[104]=j,e[105]=_,e[106]=C,e[107]=y,e[108]=S,e[109]=J,e[110]=ce):ce=e[110],ce}function Ys(s){return s.stopPropagation()}function Xs(s){return s.stopPropagation()}function Js(s){return s.stopPropagation()}function Zs(s){return s.stopPropagation()}function Ht(s){"use forget";const e=Ue.c(3),{message:r}=s;let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx(Us,{className:"icon text-token-text-warning","aria-hidden":!0}),e[0]=u):u=e[0];let n;return e[1]!==r?(n=t.jsxs("div",{className:"border-token-border-light bg-token-bg-primary mx-auto flex items-center gap-3 rounded-2xl border px-4 py-3 text-sm shadow-sm",children:[u,t.jsx("div",{className:"text-token-text-secondary",children:r})]}),e[1]=r,e[2]=n):n=e[2],n}function ea(){var d,p,k,o;const s=ze(),e=Oe(),n=((d=new URLSearchParams(e.search).get("sort"))!=null?d:"").split(",").map(i=>i.trim()).filter(Boolean),x=(p=n.find(i=>i.startsWith("sev_")))!=null?p:"sev_desc",h=x==="sev_asc",f=(o=(k=n[0])==null?void 0:k.startsWith("sev_"))!=null?o:!0,b=()=>{const i=new URLSearchParams(e.search);if(f){const a=x==="sev_desc"?"sev_asc":"sev_desc";i.set("sort","".concat(a,",date_desc"))}else i.set("sort","sev_desc,date_desc");s({search:"?".concat(i.toString())},{replace:!0})};return t.jsxs("button",{className:"inline-flex items-center gap-1 hover:underline",onClick:b,children:[t.jsx(m,{id:"aardvark.table.criticality",defaultMessage:"Criticality"}),f?t.jsx(Dt,{className:Be("icon-sm text-token-text-tertiary transition-transform",h&&"rotate-180"),"aria-hidden":!0}):null]})}function ta(){var d,p,k,o;const s=ze(),e=Oe(),n=((d=new URLSearchParams(e.search).get("sort"))!=null?d:"date_desc").split(",").map(i=>i.trim()).filter(Boolean),x=(p=n.find(i=>i.startsWith("date_")))!=null?p:"date_desc",h=x==="date_asc",f=(o=(k=n[0])==null?void 0:k.startsWith("date_"))!=null?o:!0,b=()=>{const i=new URLSearchParams(e.search);if(f){const a=x==="date_desc"?"date_asc":"date_desc";i.set("sort","".concat(a,",sev_desc"))}else i.set("sort","date_desc,sev_desc");s({search:"?".concat(i.toString())},{replace:!0})};return t.jsxs("button",{className:"inline-flex items-center gap-1 hover:underline",onClick:b,children:[t.jsx(m,{id:"aardvark.table.detectedAt",defaultMessage:"Detected at"}),f?t.jsx(Dt,{className:Be("icon-sm text-token-text-tertiary transition-transform",h&&"rotate-180"),"aria-hidden":!0}):null]})}const bt=14;function $t(s){return s===void 0||typeof s=="number"&&Number.isFinite(s)&&s>=0&&s<=90}function sa({value:s,onChange:e,isSaving:r}){const u=Z(),n=$t(s);return t.jsxs("div",{className:"grid w-full grid-cols-[1fr,auto] grid-rows-[auto,auto] gap-x-4 gap-y-1 ".concat(r?"pointer-events-none opacity-60":""),children:[t.jsx("label",{className:"col-start-1 row-start-1 justify-self-start text-start text-sm font-medium",children:t.jsx(m,{id:"aardvark.whamRepos.lookbackDays",defaultMessage:"Lookback window"})}),t.jsx("div",{className:"text-token-text-tertiary col-start-1 row-start-2 justify-self-start text-start text-[11px]",children:t.jsx(m,{id:"aardvark.whamRepos.lookbackDays.help",defaultMessage:"How far back to scan existing commits when first enabled."})}),t.jsxs("div",{className:"col-start-2 row-span-2 flex flex-col items-end gap-2 self-center justify-self-end",children:[t.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:u.formatMessage({id:"aardvark.whamRepos.preset.1w",defaultMessage:"1w"}),value:7},{label:u.formatMessage({id:"aardvark.whamRepos.preset.2w",defaultMessage:"2w"}),value:14},{label:u.formatMessage({id:"aardvark.whamRepos.preset.1m",defaultMessage:"1m"}),value:30},{label:u.formatMessage({id:"aardvark.whamRepos.preset.3m",defaultMessage:"3m"}),value:90},{label:u.formatMessage({id:"aardvark.whamRepos.preset.indefinite",defaultMessage:"Indefinite"}),value:void 0}].map(x=>{var h;return t.jsx("button",{type:"button",onClick:()=>e(x.value),className:"border-token-border-light rounded-md border px-2 py-1 text-xs "+(s===x.value?"bg-token-main-surface-secondary text-token-text-primary":"bg-token-bg-primary text-token-text-secondary hover:bg-token-main-surface-secondary"),children:x.label},String((h=x.value)!=null?h:"indefinite"))})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"number",value:s!=null?s:"",placeholder:s===void 0?u.formatMessage({id:"aardvark.whamRepos.preset.placeholder.indefinite",defaultMessage:"Indefinite"}):void 0,onChange:x=>{const h=x.target.value;if(h===""||h==="indefinite"){e(void 0);return}const f=parseInt(h,10);Number.isFinite(f)&&e(f)},"aria-invalid":!n,"aria-describedby":n?void 0:"lookback-error",className:"border-token-border-light bg-token-main-surface-secondary text-token-text-primary w-24 rounded-md border px-2 py-1 text-end text-xs focus:ring-1 focus:outline-none "+(n?"focus:ring-token-border-light":"border-red-500 focus:ring-red-500"),"aria-label":u.formatMessage({id:"aardvark.whamRepos.lookbackDays.input",defaultMessage:"Lookback days"})}),s!==void 0&&t.jsx("span",{className:"text-token-text-tertiary text-xs",children:t.jsx(m,{id:"aardvark.whamRepos.lookbackDays.suffix",defaultMessage:"days"})})]}),n?null:t.jsx("div",{id:"lookback-error",className:"self-end text-[11px] text-red-500",children:t.jsx(m,{id:"aardvark.whamRepos.lookbackDays.error",defaultMessage:"Enter a value between 0 and 90."})})]})]})}function aa(s){"use no forget";var I;const{open:e,onOpenChange:r,repoName:u,repoId:n,repoFullName:x}=s,h=Z(),f=Et(),b=lt(),d=ct(b),p=(I=d==null?void 0:d.authUserId)!=null?I:"",k=d==null?void 0:d.getWorkspaceId(),{environmentId:o,setEnvironmentId:i}=Cs(),{scanMap:a,configIdByRepo:l,configVersionById:c}=st(k),g=Xt(),[j,_]=R.useState(!1),[C,y]=R.useState(!1),[w,S]=R.useState(bt),v=R.useMemo(()=>a.get(n),[a,n]);R.useEffect(()=>{var z,H;if(!e)return;if(_(((z=v==null?void 0:v.state)!=null?z:"disabled")==="enabled"),i((H=v==null?void 0:v.environment_id)!=null?H:null),!v){S(bt);return}const M=v.lookback_days;S(M==null?void 0:M)},[e,v,i]);const E=()=>{r(!1)},O=async()=>{var M,z,H,$,q,W,se,X,ae,L,T,P,ee,fe,xe,oe,Q,he,le,J,ce,ge,re,je,ye,Ae,we,me,Re,Se;y(!0);try{const pe=l.get(n),ve=new Nt(Rt,{fetchFn:(A,K)=>globalThis.fetch.call(globalThis,A,K)});if(!pe){const A=await ve.post("/aardvark/scan_configurations",{headers:Ze(),body:{environment_id:o||"env-default",repo_id:n,repo_url:"https://github.com/".concat(x),state:j?"enabled":"disabled",owner_id:p,lookback_days:w!=null?w:null}}),K=(z=A==null?void 0:A.status)!=null?z:(M=A==null?void 0:A.response)==null?void 0:M.status;if(!((H=A==null?void 0:A.ok)!=null?H:typeof K=="number"&&K>=200&&K<300)){if(K===403){let Pe="You are not authorized to configure scans.";throw new Error(Pe)}const be=(ae=(X=(se=await(($=A==null?void 0:A.json)==null?void 0:$.call(A).catch(()=>null)))!=null?se:await((W=(q=A==null?void 0:A.response)==null?void 0:q.json)==null?void 0:W.call(q).catch(()=>null)))!=null?X:A==null?void 0:A.data)!=null?ae:null,Ne=((L=be==null?void 0:be.error)==null?void 0:L.message)||"Request failed (".concat(K!=null?K:"unknown",")");throw new Error(Ne)}const ie=(xe=(P=A==null?void 0:A.data)!=null?P:await((T=A==null?void 0:A.json)==null?void 0:T.call(A).catch(()=>null)))!=null?xe:await((fe=(ee=A==null?void 0:A.response)==null?void 0:ee.json)==null?void 0:fe.call(ee).catch(()=>null));ie&&gt(k,ie,g),r(!1),requestAnimationFrame(()=>f.successNeutral(h.formatMessage({id:"aardvark.toast.settingsSaved",defaultMessage:"Scan settings saved"})));return}const Ee=c.get(pe),F=await ve.patch("/aardvark/scan_configurations/{config_id}",{headers:Ze({isAuthOptional:!0}),path:{config_id:pe},body:{version:Ee,state:j?"enabled":"disabled",owner_id:j?p:void 0,environment_id:o,lookback_days:w!=null?w:null}});{const A=(Q=F==null?void 0:F.status)!=null?Q:(oe=F==null?void 0:F.response)==null?void 0:oe.status;if(!((he=F==null?void 0:F.ok)!=null?he:typeof A=="number"&&A>=200&&A<300)){const te=(je=(re=(ge=await((le=F==null?void 0:F.json)==null?void 0:le.call(F).catch(()=>null)))!=null?ge:await((ce=(J=F==null?void 0:F.response)==null?void 0:J.json)==null?void 0:ce.call(J).catch(()=>null)))!=null?re:F==null?void 0:F.data)!=null?je:null,ie=((ye=te==null?void 0:te.error)==null?void 0:ye.message)||"Request failed (".concat(A!=null?A:"unknown",")");throw new Error(ie)}}const ne=(Se=(we=F==null?void 0:F.data)!=null?we:await((Ae=F==null?void 0:F.json)==null?void 0:Ae.call(F).catch(()=>null)))!=null?Se:await((Re=(me=F==null?void 0:F.response)==null?void 0:me.json)==null?void 0:Re.call(me).catch(()=>null));ne&&gt(k,ne,g),r(!1),requestAnimationFrame(()=>f.successNeutral(h.formatMessage({id:"aardvark.toast.settingsSaved",defaultMessage:"Scan settings saved"})))}catch(pe){const ve=pe instanceof Error?pe.message:"Unknown error";f.danger(h.formatMessage({id:"aardvark.toast.settingsSaveFailed",defaultMessage:"Failed to save scan settings: {error}"},{error:ve}))}finally{y(!1)}};return t.jsxs(ps,{open:e,onOpenChange:r,children:[t.jsx(vs,{asChild:!0,children:t.jsx(de,{as:"button",color:"secondary",size:"small",children:t.jsx(m,{id:"aardvark.whamRepos.configureButton",defaultMessage:"Configure"})})}),t.jsx(bs,{children:t.jsxs(ks,{side:"bottom",align:"end",sideOffset:8,className:"border-token-border-light bg-token-bg-primary z-10 w-[520px] rounded-lg border p-4 shadow-xl",children:[t.jsx("div",{className:"text-token-text-primary mb-3 text-lg leading-6 font-semibold",children:t.jsx(m,{id:"aardvark.whamRepos.scanSettingsInlineTitle",defaultMessage:"Scan settings for {repo}",values:{repo:u}})}),t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("div",{className:"text-sm font-medium",children:t.jsx(m,{id:"aardvark.whamRepos.enabledToggle",defaultMessage:"Enabled"})}),t.jsx(It,{checked:j,onCheckedChange:M=>_(M),"aria-hidden":!0,disabled:C})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("label",{className:"text-sm font-medium",children:t.jsx(m,{id:"aardvark.whamRepos.environment",defaultMessage:"Codex environment"})}),t.jsx("div",{className:C?"pointer-events-none opacity-60":"",children:t.jsx(Ms,{showBranchSelector:!1,filters:{repos:[n]},allowRepositorySelection:!1})})]}),t.jsx(sa,{value:w,onChange:S,isSaving:C}),t.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.jsx(de,{color:"secondary",onClick:E,children:t.jsx(m,{id:"aardvark.whamRepos.cancel",defaultMessage:"Cancel"})}),t.jsx(de,{color:"primary",disabled:C||j&&(!o||!$t(w)),onClick:()=>void O(),children:C?t.jsx(m,{id:"aardvark.whamRepos.saving",defaultMessage:"Saving..."}):t.jsx(m,{id:"aardvark.whamRepos.save",defaultMessage:"Save"})})]})]})]})})]})}const ra=U(()=>B(()=>import("./j4nmkdkymh0gf9lt.js").then(s=>s._),__vite__mapDeps([9,1])),{loading:s=>V(s)});function na({hasGithubConnection:s,openGithubModal:e}){const r=Z();return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h2",{id:"connected-repos",className:"text-token-text-primary text-lg leading-6 font-semibold",children:t.jsx(m,{id:"aardvark.whamRepos.connectedSectionTitle",defaultMessage:"Your connected repositories"})}),t.jsx("a",{href:"#configurescans-connected-repos",className:"text-token-text-tertiary opacity-60 hover:opacity-100","aria-label":r.formatMessage({id:"aardvark.whamRepos.connectedLinkAria",defaultMessage:"Deep link to connected repositories"}),children:t.jsx(ra,{className:"icon-sm"})})]}),t.jsx("p",{className:"text-token-text-secondary mt-2 mb-6 text-sm leading-6",children:t.jsx(m,{id:"aardvark.whamRepos.connectedSectionDescription",defaultMessage:"These are repositories from your GitHub organizations that you’ve connected. You can configure scans for them here. Missing a repo? {link}",values:{link:t.jsx("a",{href:"#configurescans-connected-repos",className:"underline underline-offset-2",onClick:u=>{u.preventDefault(),s?window.open("https://github.com/apps/chatgpt-codex-connector/installations/select_target","_blank"):e()},children:t.jsx(m,{id:"aardvark.whamRepos.configureAccess",defaultMessage:"Configure repository access."})})}})})]})}const ia=U(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yo),__vite__mapDeps([0,1,2,3,4])),{loading:s=>V(s)}),oa=U(()=>B(()=>import("./fqz8sozslskhjbvs.js").then(s=>s._),__vite__mapDeps([10,1])),{loading:s=>V(s)}),Bt=100;function la(s){"use forget";var be,Ne,Pe,Me,Ce,Ie,Te,dt,mt;const e=Ue.c(86),{scanMap:r}=s,u=Z(),{data:n,isLoading:x}=_s();let h;e[0]!==(n==null?void 0:n.memberships)?(h=(be=n==null?void 0:n.memberships)!=null?be:[],e[0]=n==null?void 0:n.memberships,e[1]=h):h=e[1];let f;e[2]!==(n==null?void 0:n.other)?(f=(Ne=n==null?void 0:n.other)!=null?Ne:[],e[2]=n==null?void 0:n.other,e[3]=f):f=e[3];let b;e[4]!==h||e[5]!==f?(b=[...h,...f],e[4]=h,e[5]=f,e[6]=b):b=e[6];const d=b,[p,k]=R.useState(null);let o,i;e[7]!==d||e[8]!==p?(o=()=>{if(d.length===0){k(null);return}(p==null||!d.some(D=>D.id===p))&&k(d[0].id)},i=[d,p],e[7]=d,e[8]=p,e[9]=o,e[10]=i):(o=e[9],i=e[10]),R.useEffect(o,i);const[a,l]=R.useState(""),{openGithubModal:c}=rt(it.GITHUB_CONNECTOR,"github","/aardvark",nt.CODEX);let g;e[11]!==p?(g=["aardvark","wham","repositories",p],e[11]=p,e[12]=g):g=e[12];const j=!!p;let _;e[13]!==p?(_=D=>{const{pageParam:G}=D;return Ss.getRepositoriesByInstallationId(p!=null?p:0,G,Bt)},e[13]=p,e[14]=_):_=e[14];let C;e[15]!==g||e[16]!==j||e[17]!==_?(C={queryKey:g,enabled:j,initialPageParam:1,queryFn:_,getNextPageParam:ha,refetchOnWindowFocus:!0},e[15]=g,e[16]=j,e[17]=_,e[18]=C):C=e[18];const{data:y,isLoading:w,fetchNextPage:S,hasNextPage:v,isFetchingNextPage:E}=Jt(C);let O;e[19]!==(y==null?void 0:y.pages)?(O=(Pe=y==null?void 0:y.pages.flatMap(xa))!=null?Pe:[],e[19]=y==null?void 0:y.pages,e[20]=O):O=e[20];const I=O,M=x||w,z=(Ce=(Me=n==null?void 0:n.memberships)==null?void 0:Me.length)!=null?Ce:0,H=(Te=(Ie=n==null?void 0:n.other)==null?void 0:Ie.length)!=null?Te:0,$=z+H>0,q=lt(),W=ct(q),se=(dt=W==null?void 0:W.authUserId)!=null?dt:"";let X;e[21]!==a?(X=D=>D.name.toLowerCase().includes(a.trim().toLowerCase()),e[21]=a,e[22]=X):X=e[22];const ae=I.filter(X);let L,T;e[23]!==S||e[24]!==v||e[25]!==E||e[26]!==a?(L=()=>{a.trim()!==""&&v&&!E&&S()},T=[a,v,E,S],e[23]=S,e[24]=v,e[25]=E,e[26]=a,e[27]=L,e[28]=T):(L=e[27],T=e[28]),R.useEffect(L,T);const[P,ee]=R.useState(!1);let fe;e[29]!==r||e[30]!==P?(fe=D=>{var _e;if(!P)return!0;const G=r.get(D.id);return((_e=G==null?void 0:G.state)!=null?_e:"disabled")==="enabled"},e[29]=r,e[30]=P,e[31]=fe):fe=e[31];const xe=ae.filter(fe);let oe;if(e[32]!==xe||e[33]!==r){oe=[...xe];let D;e[35]!==r?(D=(G,_e)=>{var Le,Ve;const He=((Le=r.get(G.id))==null?void 0:Le.state)==="enabled",Ye=((Ve=r.get(_e.id))==null?void 0:Ve.state)==="enabled";return He===Ye?G.name.localeCompare(_e.name):He?-1:1},e[35]=r,e[36]=D):D=e[36],oe.sort(D),e[32]=xe,e[33]=r,e[34]=oe}else oe=e[34];const Q=oe,[he,le]=R.useState(1),J=Math.max(1,Math.ceil(Q.length/5)),ce=Math.min(he,J),ge=(ce-1)*5,re=Math.min(ge+5,Q.length);let je,ye;e[37]!==re||e[38]!==S||e[39]!==v||e[40]!==E||e[41]!==I.length?(je=()=>{re>=I.length&&v&&!E&&S()},ye=[re,I.length,v,E,S],e[37]=re,e[38]=S,e[39]=v,e[40]=E,e[41]=I.length,e[42]=je,e[43]=ye):(je=e[42],ye=e[43]),R.useEffect(je,ye);const Ae=Q.slice(ge,re);let we;e[44]===Symbol.for("react.memo_cache_sentinel")?(we=()=>{le(1)},e[44]=we):we=e[44];let me;e[45]!==a||e[46]!==p||e[47]!==P?(me=[a,p,P],e[45]=a,e[46]=p,e[47]=P,e[48]=me):me=e[48],R.useEffect(we,me);const[Re,Se]=R.useState(null),pe=D=>Se(D),ve=()=>Se(null),Ee="flex flex-col gap-3";let F;e[49]!==d.length||e[50]!==n||e[51]!==M||e[52]!==c?(F=!M&&(n==null||d.length===0)?t.jsxs("div",{className:"border-token-border-light/60 bg-token-main-surface-secondary/50 mx-auto mt-3 w-full max-w-[640px] rounded-lg border px-5 py-5 text-center shadow-sm backdrop-blur-[2px]",children:[t.jsx("p",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:t.jsx(m,{id:"aardvark.whamRepos.emptyConnectedTitle",defaultMessage:"No connected repositories yet"})}),t.jsx("p",{className:"text-token-text-secondary mt-2 text-sm leading-6",children:t.jsx(m,{id:"aardvark.whamRepos.emptyConnectedSubtitle",defaultMessage:"Connect GitHub to start scanning."})}),t.jsx("div",{className:"mt-4 flex items-center justify-center",children:t.jsx(de,{as:"button",size:"small",color:"secondary",onClick:c,children:t.jsx(m,{id:"aardvark.whamRepos.connectGithub",defaultMessage:"Connect GitHub"})})})]}):null,e[49]=d.length,e[50]=n,e[51]=M,e[52]=c,e[53]=F):F=e[53];let ne;e[54]!==d.length||e[55]!==$||e[56]!==n||e[57]!==M||e[58]!==c?(ne=(!n||d.length===0)&&!M?null:t.jsx(na,{hasGithubConnection:$,openGithubModal:c}),e[54]=d.length,e[55]=$,e[56]=n,e[57]=M,e[58]=c,e[59]=ne):ne=e[59];let A;e[60]!==d||e[61]!==n||e[62]!==u||e[63]!==M||e[64]!==a||e[65]!==p||e[66]!==ee||e[67]!==P?(A=(!n||d.length===0)&&!M?null:t.jsxs("div",{className:"flex flex-row items-end gap-3",children:[t.jsxs("div",{className:"flex w-60 flex-col gap-2",children:[t.jsx("p",{className:"text-token-text-primary text-sm leading-6 font-medium",children:t.jsx(m,{id:"aardvark.whamRepos.githubOrg",defaultMessage:"GitHub organization"})}),t.jsxs(Fe.Root,{value:(mt=p==null?void 0:p.toString())!=null?mt:"",onValueChange:D=>k(parseInt(D)),disabled:d.length===0,children:[t.jsx(Fe.Trigger,{className:"border-token-border-heavy bg-token-bg-primary w-60 rounded-md border",children:t.jsxs("div",{className:"flex w-full items-center justify-between",children:[t.jsx("div",{className:"truncate",children:t.jsx(Fe.Value,{placeholder:u.formatMessage({id:"aardvark.whamRepos.selectOrg",defaultMessage:"Select organization"})})}),t.jsx(Fe.Icon,{})]})}),t.jsx(Fe.Portal,{children:t.jsx(Fe.Content,{align:"start",className:"rounded-lg",children:d.map(fa)})})]})]}),t.jsx("div",{className:"flex-1",children:t.jsx(Lt,{color:"search",iconPosition:"left",icon:ia,className:"text-token-text-tertiary flex h-9 w-full items-center rounded-md!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-repos",type:"text",value:a,onChange:D=>l(D.target.value),placeholder:u.formatMessage({id:"aardvark.whamRepos.searchPlaceholder",defaultMessage:"Search repositories"}),ariaLabel:u.formatMessage({id:"aardvark.whamRepos.searchAria",defaultMessage:"Search repositories"})})}),t.jsxs("div",{className:"flex h-9 items-center gap-2 self-end whitespace-nowrap",children:[t.jsx(It,{checked:P,onCheckedChange:D=>ee(D),"aria-label":u.formatMessage({id:"aardvark.whamRepos.toggleShowEnabled",defaultMessage:"Enabled only"})}),t.jsx("span",{className:"text-xs",children:t.jsx(m,{id:"aardvark.whamRepos.showEnabled",defaultMessage:"Enabled only"})})]})]}),e[60]=d,e[61]=n,e[62]=u,e[63]=M,e[64]=a,e[65]=p,e[66]=ee,e[67]=P,e[68]=A):A=e[68];const K=(!n||d.length===0)&&!M?null:t.jsxs(N.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[t.jsxs(N.Header,{children:[t.jsx(N.HeaderCell,{className:"ps-2 text-sm",children:t.jsx(m,{id:"aardvark.whamRepos.repository",defaultMessage:"Repository"})}),t.jsx(N.HeaderCell,{className:"ps-2 text-sm",children:t.jsx(m,{id:"aardvark.whamRepos.scanning",defaultMessage:"Scanning"})}),t.jsx(N.HeaderCell,{className:"ps-2 text-sm",children:t.jsx(m,{id:"aardvark.whamRepos.settingsHeader",defaultMessage:"Settings"})})]}),t.jsxs(N.Body,{children:[M&&t.jsx(t.Fragment,{children:Array.from({length:5}).map(ua)}),!M&&Q.length===0&&t.jsx(N.Row,{children:t.jsx(N.Cell,{colSpan:4,divClassName:"flex h-14 items-center",children:t.jsx(m,{id:"aardvark.whamRepos.empty",defaultMessage:"No repositories"})})}),Ae.map(D=>{var ft;const G=r.get(D.id),_e=(G==null?void 0:G.state)==="enabled",He=(ft=G==null?void 0:G.owner)==null?void 0:ft.email,Ye=He||u.formatMessage({id:"aardvark.placeholder.missing",defaultMessage:"—"}),Le=!!G,Ve=!!(G!=null&&G.owner_id)&&G.owner_id===se,ut="https://github.com/"+D.repository_full_name;return t.jsx(t.Fragment,{children:t.jsxs(N.Row,{className:"group/row hover:bg-token-bg-tertiary h-14 px-2 text-sm",children:[t.jsxs(N.Cell,{divClassName:"flex h-14 items-center group-hover/row:underline ps-2",children:[t.jsx("button",{className:"text-start underline-offset-2 hover:underline",onClick:()=>window.open(ut,"_blank"),children:D.name}),t.jsx("a",{href:ut,target:"_blank",rel:"noopener noreferrer",className:"ms-2 opacity-0 group-hover/row:opacity-100",onClick:ma,children:t.jsx(oa,{className:"icon-sm"})})]}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center justify-start gap-3 ps-2",children:t.jsx("span",{className:"rounded-md px-2 py-0.5 text-xs ".concat(Le&&_e?"bg-green-500/10 text-green-600":Le&&!_e?"bg-token-text-status-error/15 text-token-text-status-error":"bg-token-bg-tertiary text-token-text-tertiary"),children:Le?_e?t.jsx(m,{id:"aardvark.repos.status.enabled",defaultMessage:"Enabled"}):t.jsx(m,{id:"aardvark.status.disabled",defaultMessage:"Disabled"}):t.jsx(m,{id:"aardvark.status.unconfigured",defaultMessage:"Unconfigured"})})}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center ps-2",children:!Le||Ve?t.jsx(aa,{open:Re===D.id,onOpenChange:Ut=>Ut?pe(D.id):ve(),repoName:D.name,repoId:D.id,repoFullName:D.repository_full_name}):t.jsx("div",{className:"flex flex-col",children:t.jsx("span",{children:t.jsx(m,{id:"aardvark.whamRepos.ownedBy",defaultMessage:"Owned by {email}",values:{email:Ye}})})})})]},D.id)})})]})]});let te;e[69]!==d.length||e[70]!==re||e[71]!==Q.length||e[72]!==v||e[73]!==n||e[74]!==M||e[75]!==J||e[76]!==ce||e[77]!==P||e[78]!==ge?(te=(!n||d.length===0)&&!M?null:t.jsxs("div",{className:"border-token-border-light bg-token-bg-primary flex items-center justify-between border-t px-3 py-2 ".concat(M?"animate-pulse blur-[1px]":""),children:[t.jsxs("div",{className:"text-token-text-tertiary text-xs",children:[t.jsx(m,{id:"aardvark.whamRepos.range",defaultMessage:"{from}-{to} of {total} repositories",values:{from:Q.length===0?0:ge+1,to:re,total:Q.length}}),P&&t.jsx("span",{className:"text-token-text-secondary ms-2",children:t.jsx(m,{id:"aardvark.whamRepos.filteredEnabled",defaultMessage:"Showing enabled only"})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(de,{as:"button",size:"small",color:"secondary",disabled:M||ce<=1,onClick:()=>le(da),children:t.jsx(m,{id:"aardvark.pagination.prev",defaultMessage:"Previous"})}),t.jsx(de,{as:"button",size:"small",color:"secondary",disabled:M||ce>=J&&!v,onClick:()=>le(ca),children:t.jsx(m,{id:"aardvark.pagination.next",defaultMessage:"Next"})})]})]}),e[69]=d.length,e[70]=re,e[71]=Q.length,e[72]=v,e[73]=n,e[74]=M,e[75]=J,e[76]=ce,e[77]=P,e[78]=ge,e[79]=te):te=e[79];let ie;return e[80]!==F||e[81]!==ne||e[82]!==A||e[83]!==K||e[84]!==te?(ie=t.jsxs("div",{className:Ee,children:[F,ne,A,K,te]}),e[80]=F,e[81]=ne,e[82]=A,e[83]=K,e[84]=te,e[85]=ie):ie=e[85],ie}function ca(s){return s+1}function da(s){return Math.max(1,s-1)}function ma(s){return s.stopPropagation()}function ua(s,e){return t.jsx(N.Row,{children:t.jsx(N.Cell,{colSpan:4,divClassName:"p-2",children:t.jsx("div",{className:"bg-token-bg-primary border-token-border-light h-6 w-full animate-pulse rounded-md border blur-[1px]"})})},"skeleton-".concat(e))}function fa(s){return t.jsx(Fe.Item,{value:s.id.toString(),children:s.account_login},s.id)}function xa(s){var e;return(e=s.repositories)!=null?e:[]}function ha(s,e){var u;if(!(((u=s==null?void 0:s.repositories)!=null?u:[]).length<Bt))return e.length+1}const ga=U(()=>B(()=>import("./j4nmkdkymh0gf9lt.js").then(s=>s._),__vite__mapDeps([9,1])),{loading:s=>V(s)});function pa(){const s=Z();return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h2",{id:"configured-repos",className:"text-token-text-primary text-lg leading-6 font-semibold",children:t.jsx(m,{id:"aardvark.whamRepos.configuredSectionTitle",defaultMessage:"All configured repositories"})}),t.jsx("a",{href:"#configurescans-configured-repos",className:"text-token-text-tertiary opacity-60 hover:opacity-100","aria-label":s.formatMessage({id:"aardvark.whamRepos.configuredLinkAria",defaultMessage:"Deep link to configured repositories"}),children:t.jsx(ga,{className:"icon-sm"})})]}),t.jsx("p",{className:"text-token-text-secondary mt-2 mb-6 text-sm leading-6",children:t.jsx(m,{id:"aardvark.whamRepos.configuredSectionDescription",defaultMessage:"This is the full list of repositories in the workspace with scan configurations, created by you or other workspace members. You may not see findings for repos you haven’t connected."})})]})}var Je,kt;function va(){if(kt)return Je;kt=1;var s=js(),e=St();function r(u,n,x,h){return u==null?[]:(e(n)||(n=n==null?[]:[n]),x=h?void 0:x,e(x)||(x=x==null?[]:[x]),s(u,n,x))}return Je=r,Je}var ba=va();const ka=jt(ba),ja=U(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yo),__vite__mapDeps([0,1,2,3,4])),{loading:s=>V(s)}),ya=U(()=>B(()=>import("./fqz8sozslskhjbvs.js").then(s=>s._),__vite__mapDeps([10,1])),{loading:s=>V(s)});function wa({scanConfigurations:s}){const e=Z(),r=5,[u,n]=R.useState(1),[x,h]=R.useState(""),f=R.useMemo(()=>{const i=x.trim().toLowerCase(),a=s.filter(l=>{var C,y;const c=l.repo_url.replace("https://github.com/",""),g=c.split("/"),j=(C=g.pop())!=null?C:c,_=(y=g[0])!=null?y:"";return i?j.toLowerCase().includes(i)||_.toLowerCase().includes(i):!0});return ka(a,[l=>{var c;return((c=l.state)!=null?c:"disabled")==="enabled"?0:1},l=>{var g;return((g=l.repo_url.replace("https://github.com/","").split("/")[0])!=null?g:"").toLowerCase()},l=>{var _;const c=l.repo_url.replace("https://github.com/","");return((_=c.split("/").pop())!=null?_:c).toLowerCase()}],["asc","asc","asc"])},[s,x]),b=Math.max(1,Math.ceil(f.length/r)),d=Math.min(u,b),p=(d-1)*r,k=Math.min(p+r,f.length),o=f.slice(p,k);return R.useEffect(()=>{n(1)},[s.length,x]),t.jsxs(t.Fragment,{children:[t.jsx(pa,{}),t.jsx("div",{className:"mb-3 flex justify-end",children:t.jsx("div",{className:"w-64",children:t.jsx(Lt,{color:"search",iconPosition:"left",icon:ja,className:"text-token-text-tertiary flex h-9 w-full items-center rounded-md!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-configured-repos",type:"text",value:x,onChange:i=>h(i.target.value),placeholder:e.formatMessage({id:"aardvark.whamRepos.searchPlaceholder",defaultMessage:"Search repositories"}),ariaLabel:e.formatMessage({id:"aardvark.whamRepos.searchAria",defaultMessage:"Search repositories"})})})}),t.jsxs(N.Root,{className:"overflow-x-auto overflow-y-clip",disableScroll:!0,children:[t.jsxs(N.Header,{children:[t.jsx(N.HeaderCell,{className:"ps-2 text-sm",children:t.jsx(m,{id:"aardvark.whamRepos.organizationHeader",defaultMessage:"Organization"})}),t.jsx(N.HeaderCell,{className:"ps-2 text-sm",children:t.jsx(m,{id:"aardvark.whamRepos.repository",defaultMessage:"Repository"})}),t.jsx(N.HeaderCell,{className:"ps-2 text-sm",children:t.jsx(m,{id:"aardvark.whamRepos.scanning",defaultMessage:"Scanning"})}),t.jsx(N.HeaderCell,{className:"ps-2 text-sm",children:t.jsx(m,{id:"aardvark.whamRepos.ownerHeader",defaultMessage:"Owner"})})]}),t.jsx(N.Body,{children:o.length===0?t.jsx(N.Row,{children:t.jsx(N.Cell,{colSpan:4,divClassName:"flex h-14 items-center",children:t.jsx(m,{id:"aardvark.whamRepos.empty",defaultMessage:"No repositories"})})}):t.jsx(t.Fragment,{children:o.map(i=>{var _,C,y,w;const a=i.repo_url.replace("https://github.com/",""),l=(_=a.split("/").pop())!=null?_:a,c=(C=a.split("/")[0])!=null?C:a,g=(w=(y=i.owner)==null?void 0:y.email)!=null?w:e.formatMessage({id:"aardvark.placeholder.missing",defaultMessage:"—"}),j=i.state==="enabled";return t.jsxs(N.Row,{className:"h-14 px-2 text-sm",children:[t.jsx(N.Cell,{divClassName:"flex h-14 items-center ps-2",children:c}),t.jsxs(N.Cell,{divClassName:"flex h-14 items-center ps-2",children:[t.jsx("button",{className:"text-start underline-offset-2 hover:underline",onClick:()=>window.open(i.repo_url,"_blank"),children:l}),t.jsx("a",{href:i.repo_url,target:"_blank",rel:"noopener noreferrer",className:"ms-2",onClick:S=>S.stopPropagation(),children:t.jsx(ya,{className:"icon-sm"})})]}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center ps-2",children:t.jsx("span",{className:"rounded-md px-2 py-0.5 text-xs ".concat(j?"bg-green-500/10 text-green-600":"bg-token-text-status-error/15 text-token-text-status-error"),children:j?t.jsx(m,{id:"aardvark.repos.status.enabled",defaultMessage:"Enabled"}):t.jsx(m,{id:"aardvark.repos.status.disabled",defaultMessage:"Disabled"})})}),t.jsx(N.Cell,{divClassName:"flex h-14 items-center ps-2",children:g})]},"other-".concat(i.repo_id))})})})]}),t.jsxs("div",{className:"border-token-border-light bg-token-bg-primary mt-2 flex items-center justify-between border-t px-3 py-2",children:[t.jsx("div",{className:"text-token-text-tertiary text-xs",children:t.jsx(m,{id:"aardvark.whamRepos.configuredRange",defaultMessage:"{from}-{to} of {total} repositories",values:{from:f.length===0?0:p+1,to:k,total:f.length}})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(de,{as:"button",size:"small",color:"secondary",disabled:d<=1,onClick:()=>n(i=>Math.max(1,i-1)),children:t.jsx(m,{id:"aardvark.pagination.prev",defaultMessage:"Previous"})}),t.jsx(de,{as:"button",size:"small",color:"secondary",disabled:d>=b,onClick:()=>n(i=>i+1),children:t.jsx(m,{id:"aardvark.pagination.next",defaultMessage:"Next"})})]})]})]})}const Na=U(()=>B(()=>import("./kaxn2bizrxslkpa3.js").then(s=>s._),__vite__mapDeps([11,1])),{loading:s=>V(s)});function Ma(){const s=Z(),e=Oe(),[r,u]=R.useState(!1);return ms(()=>{const x=(e.hash||"").replace(/^#/,"").toLowerCase();(x==="configurescans-connected-repos"||x==="configurescans-configured-repos")&&u(!0)},[e.hash]),R.useEffect(()=>{const x=(e.hash||"").replace(/^#/,"").toLowerCase();let h=!1,f="configure-scans";if(x==="configurescans-connected-repos"?(h=!0,f="connected-repos"):x==="configurescans-configured-repos"&&(h=!0,f="configured-repos"),h){u(!0);try{let b=0;const d=()=>{const p=document.getElementById(f)||document.getElementById("configure-scans");p?p.scrollIntoView({behavior:"smooth",block:"start"}):b<10&&(b+=1,setTimeout(d,50))};requestAnimationFrame(d)}catch(b){}}},[e.hash]),t.jsxs("section",{id:"configure-scans",className:"mt-8",children:[t.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[t.jsx("h2",{className:"text-token-text-primary text-lg leading-6 font-semibold",children:t.jsx(m,{id:"aardvark.home.repository",defaultMessage:"Configure scans"})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs leading-5",children:t.jsx(m,{id:"aardvark.home.showRepos.message",defaultMessage:"Expand scan configuration"})}),t.jsx(us,{label:"",ariaLabel:s.formatMessage({id:"aardvark.home.showRepos.toggle",defaultMessage:"Expand scan configuration"}),enabled:r,onChange:n=>u(n)})]})]}),r?t.jsx(Ca,{}):null]})}function Ca(){const s=lt(),e=ct(s),r=e==null?void 0:e.getWorkspaceId(),{scanMap:u}=st(r),n=Array.from(u.values());return t.jsxs("div",{children:[t.jsx("div",{className:"border-token-border-light/60 bg-token-main-surface-secondary/50 mb-5 rounded-lg border px-3 py-2.5 shadow-sm backdrop-blur-[2px]",role:"note",children:t.jsxs("div",{className:"text-token-text-secondary flex items-start gap-2 text-sm leading-6",children:[t.jsx(Na,{className:"text-token-icon-tertiary h-4 w-4","aria-hidden":!0}),t.jsxs("p",{className:"m-0",children:[t.jsx("span",{className:"text-token-text-primary font-semibold",children:t.jsx(m,{id:"aardvark.home.configureScans.disclaimer.title",defaultMessage:"Workspace visibility:"})}),t.jsx("span",{className:"text-token-text-secondary ms-1",children:t.jsx(m,{id:"aardvark.home.configureScans.disclaimer",defaultMessage:"Scan configurations are visible to all workspace members. However, findings are only visible to workspace members with access to the repository."})})]})]})}),t.jsx(la,{scanMap:u}),n.length>0?t.jsx("div",{className:"mt-6",children:t.jsx(wa,{scanConfigurations:n})}):null]})}function _a(){var w,S;const r=Oe(),u=ze(),n=Et(),x=Z(),h=ys(),f=new URLSearchParams(r.search),b=((w=f.get("limit"))!=null?w:"").toLowerCase(),d=(S=f.get("cursor"))!=null?S:"0",p=Number.isFinite(Number(b))?Math.max(50,Number(b)):50,k=Number.isFinite(Number(d))?Math.max(0,Number(d)):0,{data:o,isLoading:i,isError:a,error:l}=ts(r.search,h,{limit:p,cursor:k}),c=R.useMemo(()=>{var v;return h?(v=o==null?void 0:o.items)!=null?v:[]:[]},[o,h]),g=o==null?void 0:o.total,{isConnected:j,isLoading:_,error:C}=rt(it.GITHUB_CONNECTOR,"github","/codex",nt.CODEX);R.useEffect(()=>{C&&n.danger("GitHub connection error",{id:"github_connection_error",duration:6,error:C})},[C,n]),R.useEffect(()=>{l&&h&&n.danger(x.formatMessage({id:"aardvark.toast.findings.loadError",defaultMessage:"Unable to load findings"}),{id:"aardvark_findings_error",duration:6,error:l})},[l,n,x,h]),R.useEffect(()=>{var z;const v=new URLSearchParams(r.search),E=v.get("finding");if(!E)return;const O=ss(E,c),I=(z=O==null?void 0:O.hid)!=null?z:E;v.delete("finding");const M=v.toString();u("/aardvark/findings/".concat(encodeURIComponent(I)).concat(M?"?".concat(M):""),{replace:!0})},[r.search,c,u]);const y=()=>j?t.jsxs(t.Fragment,{children:[t.jsx(Ma,{}),h&&t.jsx(Pt,{findings:c,children:t.jsx(qs,{findings:c,showCodexActions:!1,showGithubIssue:!1,isLoading:i,loadError:!!a,total:g})})]}):_?t.jsx("div",{className:"flex h-40 items-center justify-center",children:t.jsx(Qe,{className:"text-token-text-tertiary h-6 w-6"})}):t.jsx(Rs,{});return t.jsx("div",{className:"w-full px-4 pb-6",children:y()})}U(()=>B(()=>import("./fzicjahgxjd3df3v.js").then(s=>s._),__vite__mapDeps([12,1])),{loading:s=>V(s)});U(()=>B(()=>import("./mtr4hl2nrm0y29d3.js").then(s=>s._),__vite__mapDeps([13,1])),{loading:s=>V(s)});U(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yy),__vite__mapDeps([0,1,2,3,4])),{loading:s=>V(s)});U(()=>B(()=>import("./ewkru1hsxkjpuxt5.js").then(s=>s._),__vite__mapDeps([7,1])),{loading:s=>V(s)});U(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yA),__vite__mapDeps([0,1,2,3,4])),{loading:s=>V(s)});U(()=>B(()=>import("./iqoo5whnx14dvo9x.js").then(s=>s._),__vite__mapDeps([14,1])),{loading:s=>V(s)});function Sa(){const s=ws(),e=fs();return s?t.jsx(Aa,ue({},e)):null}function Aa(s){return t.jsx(t.Fragment,{children:t.jsxs(As,{mobileHeaderRightContent:null,children:[t.jsx(as,{}),t.jsx(rs,{children:t.jsx(ns,{})}),t.jsx(Ra,{})]})})}const Ra=()=>{const s=Z();return t.jsxs(xs,{children:[t.jsx("div",{className:"no-scrollbar h-full w-full overflow-y-auto",children:t.jsx("div",{className:"z-0 mx-auto flex w-[90%] max-w-[1600px] flex-col",children:t.jsx(_a,{})})}),t.jsx("a",{href:"https://forms.gle/arrj4MzLN1YqdR8S6",target:"_blank",rel:"noopener noreferrer","aria-label":s.formatMessage({id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),title:s.formatMessage({id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),"data-testid":"aardvark-feedback-fab",className:"border-token-border-light bg-token-main-surface-primary shadow-long hover:bg-token-main-surface-secondary fixed end-4 bottom-4 z-50 flex h-10 items-center justify-center rounded-full border px-4 text-sm font-medium focus:outline-hidden",children:t.jsx(m,{id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"})})]})},ir=Zt(function(){return t.jsx(Sa,{})});export{ir as default};
//# sourceMappingURL=lezedv4i14lz7nms.js.map
