const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j0yo6uv6652vva62.js","assets/i8clt0mfz495j7ii.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/c27txntxdwx2375m.js"])))=>i.map(i=>d[i]);
var Z=Object.freeze,Y=Object.defineProperty,ke=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var q=(e,t,o)=>t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,m=(e,t)=>{for(var o in t||(t={}))J.call(t,o)&&q(e,o,t[o]);if(D)for(var o of D(t))Q.call(t,o)&&q(e,o,t[o]);return e},b=(e,t)=>ke(e,Pe(t));var y=(e,t)=>{var o={};for(var r in e)J.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&D)for(var r of D(e))t.indexOf(r)<0&&Q.call(e,r)&&(o[r]=e[r]);return o};var U=(e,t)=>Z(Y(e,"raw",{value:Z(t||e.slice())}));import{r as l,j as s,e as se,_ as ne}from"./i8clt0mfz495j7ii.js";import{oV as ie,R as Ie,I as Ae,i0 as Le,mi as Me,q as De,t as Ge,n4 as G,n5 as Oe,aF as Be,bq as Ve}from"./j0yo6uv6652vva62.js";import{S as ze,C as le,e as O,d as Fe}from"./6ji8ehbh56ghw0zw.js";import{T as ce,Z as B}from"./ce3hgmw4iyyhicud.js";import{Q as V,X as ue,Z as Ke,V as Ue,_ as He,Y as de,U as Xe,d as v,F as pe,dd as We,u as $e,a as Ze,aV as P,o as fe,L as me,aW as qe,kV as Ye,dv as Je,a$ as Qe}from"./ghewn7l2ynbm32fm.js";import{u as he}from"./mqebxepg7t6q2tie.js";import{u as et,i as xe,a as tt}from"./jdfzk1zd468oela3.js";import{i as ot}from"./l2r1du6tfxyv7jaj.js";import{E as H,b as rt}from"./dxyrjy681bkwlnj8.js";var at="Separator",ee="horizontal",st=["horizontal","vertical"],be=l.forwardRef((e,t)=>{const u=e,{decorative:o,orientation:r=ee}=u,a=y(u,["decorative","orientation"]),n=nt(r)?r:ee,p=o?{role:"none"}:{"aria-orientation":n==="vertical"?n:void 0,role:"separator"};return s.jsx(V.div,b(m(m({"data-orientation":n},p),a),{ref:t}))});be.displayName=at;function nt(e){return st.includes(e)}var it=be,X="Toolbar",[lt]=Ue(X,[ue,ie]),W=ue(),Te=ie(),[ct,ge]=lt(X),ve=l.forwardRef((e,t)=>{const d=e,{__scopeToolbar:o,orientation:r="horizontal",dir:a,loop:n=!0}=d,i=y(d,["__scopeToolbar","orientation","dir","loop"]),p=W(o),u=Ke(a);return s.jsx(ct,{scope:o,orientation:r,dir:u,children:s.jsx(He,b(m({asChild:!0},p),{orientation:r,dir:u,loop:n,children:s.jsx(V.div,b(m({role:"toolbar","aria-orientation":r,dir:u},i),{ref:t}))}))})});ve.displayName=X;var Ee="ToolbarSeparator",ye=l.forwardRef((e,t)=>{const n=e,{__scopeToolbar:o}=n,r=y(n,["__scopeToolbar"]),a=ge(Ee,o);return s.jsx(it,b(m({orientation:a.orientation==="horizontal"?"vertical":"horizontal"},r),{ref:t}))});ye.displayName=Ee;var ut="ToolbarButton",z=l.forwardRef((e,t)=>{const n=e,{__scopeToolbar:o}=n,r=y(n,["__scopeToolbar"]),a=W(o);return s.jsx(de,b(m({asChild:!0},a),{focusable:!e.disabled,children:s.jsx(V.button,b(m({type:"button"},r),{ref:t}))}))});z.displayName=ut;var dt="ToolbarLink",pt=l.forwardRef((e,t)=>{const n=e,{__scopeToolbar:o}=n,r=y(n,["__scopeToolbar"]),a=W(o);return s.jsx(de,b(m({asChild:!0},a),{focusable:!0,children:s.jsx(V.a,b(m({},r),{ref:t,onKeyDown:Xe(e.onKeyDown,i=>{i.key===" "&&i.currentTarget.click()})}))}))});pt.displayName=dt;var _e="ToolbarToggleGroup",ft=l.forwardRef((e,t)=>{const i=e,{__scopeToolbar:o}=i,r=y(i,["__scopeToolbar"]),a=ge(_e,o),n=Te(o);return s.jsx(Ie,b(m(m({"data-orientation":a.orientation,dir:a.dir},n),r),{ref:t,rovingFocus:!1}))});ft.displayName=_e;var mt="ToolbarToggleItem",ht=l.forwardRef((e,t)=>{const i=e,{__scopeToolbar:o}=i,r=y(i,["__scopeToolbar"]),a=Te(o),n={__scopeToolbar:e.__scopeToolbar};return s.jsx(z,b(m({asChild:!0},n),{children:s.jsx(Ae,b(m(m({},a),r),{ref:t}))}))});ht.displayName=mt;var xt=ve,bt=ye,Tt=(e=>(e.CODE="code",e.WRITING="writing",e))(Tt||{});const j=({children:e,toolbarType:t})=>s.jsx(xt,{className:v("bg-token-main-surface-primary m-0 flex h-9 w-fit min-w-0 shrink items-center overflow-hidden rounded-xl px-1 dark:bg-[#353535]",ce,t==="code"?"py-0":"py-1"),children:e}),Se=({icon:e,hideLabel:t,label:o,subLabel:r,iconClassName:a,labelClassName:n})=>s.jsxs(s.Fragment,{children:[e&&s.jsx(e,{className:v("icon-sm",{"text-token-text-tertiary me-0.5":!t,"text-token-text-primary":t},a)}),!t&&s.jsx("span",{className:v("text-token-text-primary truncate text-sm",n),children:o}),r]});var re;const Ce=pe(z)(re||(re=U(["flex h-full items-center rounded-lg gap-1 px-2 hover:bg-black/5 dark:hover:bg-token-interactive-bg-secondary-hover disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent"]))),gt=({label:e,subLabel:t,icon:o,isDisabled:r=!1,isActive:a=!1,hideLabel:n=!1,onClick:i,onMouseDown:p,iconClassName:u,labelClassName:d})=>s.jsx(Ce,{onClick:i,"aria-label":n?e:void 0,onMouseDown:p,disabled:r,"aria-pressed":a||void 0,"data-state":a?"on":void 0,className:v({"bg-token-interactive-bg-secondary-selected":a}),children:s.jsx(Se,{icon:o,hideLabel:n,label:e,subLabel:t,iconClassName:u,labelClassName:d})}),vt=({icon:e,hideLabel:t,label:o,children:r,align:a="end"})=>s.jsxs(Le,{children:[s.jsx(Me,{asChild:!0,children:s.jsx(Ce,{"aria-label":t?o:void 0,children:s.jsx(Se,{icon:e,hideLabel:t,label:o})})}),s.jsx(De,{children:s.jsx(Ge,{align:a,className:v(B.toolbar,"popover"),sideOffset:8,children:r})})]});var ae;j.Separator=pe(bt)(ae||(ae=U(["mx-1 p-0 list-none h-3 w-[1px] bg-token-border-default"])));j.Action=gt;j.Button=z;j.Popover=vt;function Ne(e){const t=e();if(t==null)return;const{from:o,to:r,sourceFrom:a,sourceTo:n}=t;if(o==null||r==null||a==null||n==null){G.logError("Missing selection range on targeted edit",t);return}const i=ze.ASK;G.logButtonClick(Oe.TOOLBAR_ASK_CHATGPT,{action:i,sourceFrom:a,sourceTo:n}),le.startCommentingOn({type:O.SELECTION,from:o,to:r,sourceRange:{start:a,end:n},action:i})}function Et(e,t,o){l.useEffect(()=>{if(o)return;const r=a=>{(a.metaKey||a.ctrlKey)&&a.key.toLowerCase()==="k"&&(a.preventDefault(),Ne(t))};return e==null||e.addEventListener("keydown",r),()=>e==null?void 0:e.removeEventListener("keydown",r)},[e,t,o])}var we=(e=>(e.ABOVE="above",e.BELOW="below",e))(we||{});function te(e,t){return We(e.coordsAtPos(t))}const yt=fe(()=>ne(()=>import("./j0yo6uv6652vva62.js").then(e=>e.yn),__vite__mapDeps([0,1,2,3,4])),{loading:e=>me(e)}),oe=360,_t=250,je=44,St=.5,Ct=[.5,.9,1],Nt=[1,.75,.2],wt=({onClose:e,onSubmit:t,opensOverDocument:o=!1,opensFromGutter:r=!1,gutterHasComments:a=!1},n)=>{const i=$e(),p=se(),u=l.useRef(null),d=l.useRef(!1),[T,g]=l.useState(""),[h,R]=l.useState(!0),N=()=>{document.hasFocus()&&(g(""),e==null||e(d.current))},k=(f,x=T)=>{d.current=!0,t==null||t(f,x),g("")},F=Ze(()=>o?Ve(i).width<oe+100?_t:oe:H),E={};r&&(E.top=-12),o&&r?E.right=0:E.left=0;let _="";r&&!o?_="8px 50%":r&&o?_="calc(100% + 8px) 50%":o&&(_="center left");let w=0;r&&!o&&a&&(w=rt);const I=f=>{const{metaKey:x,shiftKey:L,key:S}=f;S==="Enter"&&!f.nativeEvent.isComposing&&T&&!(L||x)?(k(f),f.preventDefault()):S==="Escape"&&(g(""),e==null||e(!1))},A=p.formatMessage({id:"VvfbvY",defaultMessage:"Edit or explain..."});return s.jsx(P.div,{ref:Be(u,n),className:v("absolute flex items-center",B.commentComposer),style:b(m({},E),{minHeight:je}),transition:{type:"spring",bounce:.18,duration:.48},initial:{translateX:0},animate:{translateX:w},exit:{translateX:0},children:s.jsx(P.div,{className:v("no-scrollbar border-token-border-default relative z-10 flex items-center overflow-x-hidden border",ce,{"rounded-full":h,"rounded-2xl":!h}),initial:{width:o?H:24,scale:o?void 0:St},animate:{width:F,scale:o?void 0:Ct},exit:{filter:"blur(16px)",scale:o?void 0:Nt,width:o?H:24,opacity:o?0:[1,1,0]},transition:{type:"spring",bounce:o?.14:0,duration:.28,scale:{type:"tween",duration:.2},opacity:{type:"tween",times:[0,.95,1]}},style:{transformOrigin:_},children:s.jsxs(P.div,{className:"bg-token-main-surface-primary relative z-0 flex w-full items-center px-4 py-2.5",children:[s.jsx(P.div,{className:"absolute inset-0 z-[-1] bg-gray-50/75 backdrop-blur-3xl backdrop-saturate-25 dark:bg-gray-700/75",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.2}}),s.jsx(ot,{"aria-placeholder":A,value:T,className:"text-token-text-primary placeholder:text-token-text-secondary w-full resize-none border-0 bg-transparent px-1 py-0 pe-2 outline-0 focus:ring-0 focus-visible:ring-0",autoFocus:!0,maxRows:4,onBlur:N,onHeightChange:(f,{rowHeight:x})=>{R(Math.floor(f/x)<=1)},onChange:({target:{value:f}})=>g(f),onKeyDown:I}),!T&&s.jsx("span",{"aria-hidden":!0,className:"text-token-text-secondary absolute inline-block ps-1 text-nowrap",children:A}),s.jsx(P.button,{className:v("-me-1.5 h-6 w-6 rounded-full bg-black text-center dark:bg-white",{"self-end":!h}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.1},onMouseDown:f=>k(f),children:s.jsx(yt,{className:"h-6 w-6 text-white dark:text-black"})})]})})})},jt=l.forwardRef(wt),Kt=(e,t)=>{if((t==null?void 0:t.type)!==O.SELECTION)return null;try{const{from:o,to:r}=t,{top:a}=e.dom.getBoundingClientRect(),{bottom:n,top:i}=te(e,o),{bottom:p}=te(e,r),u=xe(e)?-30:-24;let d=n-a+u;const T=i-a;return d=p-a+8,{composerTop:d,loadingTop:T}}catch(o){return G.logError("Invalid position in SelectionCommentComposer",o),null}},Rt=({toolbarPosition:e,composerRect:t,view:o})=>{const{width:r}=t;let{height:a}=t;if(a||(a=je),o==null||e==null)return null;const{right:n,left:i}=o.dom.getBoundingClientRect(),{left:p,top:u,aboveOrBelow:d,toolbarSize:T}=e,g=u-(d===we.ABOVE&&a!==0?a-T.height:0),h=tt(o)?12:0;return{left:Math.min(p,n-i-r-h),composerTop:g,aboveOrBelow:d}},kt=({toolbarPosition:e,commentingOn:t,isWaitingForCommentResponse:o=!1,onAddComment:r})=>{const a=et()(),[n,i]=he(),p=Rt({view:a,toolbarPosition:e,composerRect:n});if(a==null||p==null)return null;const{left:u,composerTop:d}=p,T=(g,h)=>{if((t==null?void 0:t.type)!==O.SELECTION)return;const{action:R,sourceRange:N}=t;r==null||r(g,h,R,N,t.type)};return s.jsx(qe,{children:(t==null?void 0:t.type)===O.SELECTION&&!o&&s.jsx("div",{className:v("absolute",B.commentComposer),style:{left:u,top:d},children:s.jsx(jt,{opensOverDocument:!0,onClose:g=>{var h;g||(le.cancelCommentingOn(),a&&xe(a)&&!a.state.selection.empty&&a.dispatch(a.state.tr.setSelection(new Ye(a.state.selection.$from))),(h=document.getSelection())==null||h.removeAllRanges())},onSubmit:T,ref:i})},"composer")})},Pt=fe(()=>ne(()=>import("./c27txntxdwx2375m.js").then(e=>e._),__vite__mapDeps([5,1])),{loading:e=>me(e)}),It=({isSendDisabled:e=!1,getSelectionRange:t})=>{const o=se(),r=()=>{Ne(t)};return s.jsx(j.Action,{isDisabled:e,label:o.formatMessage({id:"wOaJUU",defaultMessage:"Ask ChatGPT"}),onClick:r,icon:Pt})},Ut=({getEditorDom:e,getToolbarPosition:t,getSelectionRange:o,toolbarType:r,children:a,onAddComment:n,isWaitingForCommentResponse:i=!1,isSendDisabled:p=!1,showAskChatGPT:u=!0,fixToolbarPositionOnInteraction:d=!1,savedSelection:T=!1,toolbarContentRef:g,setIsToolbarOpen:h,forceClose:R=!1})=>{const[{height:N,width:k},F]=he(),[E,_]=l.useState(!0),[w,I]=l.useState(!1),[A,f]=l.useState(!0),x=e(),L=Fe(({commentingOn:c})=>c),[S,Re]=l.useState(null);Et(x,o,p);const M=l.useCallback(()=>{const c=e(),C=document.getSelection();return!C||C.type!=="Range"||C.isCollapsed||!(c!=null&&c.contains(C.anchorNode))},[e]);l.useEffect(()=>{const c=Je(()=>{I(!0)},200,{leading:!0}),C=()=>{c.cancel(),I(!1)};return x==null||x.addEventListener("pointerdown",c,{passive:!0}),document.addEventListener("pointerup",C,{passive:!0}),()=>{x==null||x.removeEventListener("pointerdown",c),document.removeEventListener("pointerup",C)}},[x]),l.useEffect(()=>{if(w){f(!1);return}const c=setTimeout(()=>f(!0),100);return()=>{clearTimeout(c)}},[w]),l.useEffect(()=>{const c=()=>{_(M())};return document.addEventListener("selectionchange",c,{passive:!0}),()=>{document.removeEventListener("selectionchange",c)}},[M]),Qe(()=>{if(E||M())return _(!0);try{const c=t({width:k,height:N});c!=null&&!d&&Re(c)}catch(c){G.logError("Invalid position in getToolbarPosition",c)}},[N,k,E,M,t,d]);const $=s.jsxs(j,{toolbarType:r,children:[u&&s.jsx(It,{isSendDisabled:p,getSelectionRange:o}),a]}),K=!R&&(!E||T)&&!L&&S!=null&&A;return l.useEffect(()=>{h==null||h(K)},[K,h]),s.jsxs(s.Fragment,{children:[s.jsx("div",{"aria-hidden":"true",className:"pointer-events-none invisible fixed start-0 top-0 h-0 overflow-clip",children:s.jsx("div",{ref:F,children:$})}),K&&s.jsx("div",{style:{top:S.top,left:S.left},className:v("absolute",B.toolbar,w?"pointer-events-none":"pointer-events-auto"),ref:g,children:$}),s.jsx(kt,{toolbarPosition:S,commentingOn:L,isWaitingForCommentResponse:i,onAddComment:n})]})};export{we as A,jt as C,Ut as T,Tt as a,j as b,te as c,Kt as g};
//# sourceMappingURL=go502v54gisfd23y.js.map
