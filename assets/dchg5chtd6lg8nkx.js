const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jgvrewhnjcf398o6.js","assets/i8clt0mfz495j7ii.js","assets/bci083mws0hai8bl.js","assets/gsyp9a9fup59ufmh.js","assets/ceivmd4pm4umbvdn.js","assets/ooz2slmm8agf6bjp.js","assets/nju52ppu7cxhyzrm.js","assets/d3bvq1y1gdwhf87e.js","assets/j0yo6uv6652vva62.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/kgnykbdth8mb50na.js","assets/g8i6bixylsxyemsr.js","assets/zm1ki9l766pgg0bx.js","assets/bw334685wo6mbjqy.js","assets/mpvcaagn7eiaugto.js","assets/nair9w8wdntqga9z.js","assets/jduj14fc8ad91v8d.js","assets/k11vc5v60fqtwe47.js","assets/fb2095ktsebx1zzy.js","assets/eyao241335injypy.js","assets/ktw3b87sujui39wx.js","assets/nrrhfi0a0bbsg9w2.js","assets/hht3m8p9e0s4tqnx.js","assets/fvjpw0lui4wq7vv3.js","assets/mpzbsmypy64alaao.js","assets/olrcssu7duieo6m7.js","assets/3vr3npo27kg7k1gc.js","assets/3j20em1lilnrpdcm.js"])))=>i.map(i=>d[i]);
var Ee=Object.defineProperty,Se=Object.defineProperties;var qe=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var Me=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var je=(s,t,a)=>t in s?Ee(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,x=(s,t)=>{for(var a in t||(t={}))Me.call(t,a)&&je(s,a,t[a]);if(J)for(var a of J(t))ve.call(t,a)&&je(s,a,t[a]);return s},C=(s,t)=>Se(s,qe(t));var $=(s,t)=>{var a={};for(var n in s)Me.call(s,n)&&t.indexOf(n)<0&&(a[n]=s[n]);if(s!=null&&J)for(var n of J(s))t.indexOf(n)<0&&ve.call(s,n)&&(a[n]=s[n]);return a};import{b as te,e as M,u as Q,a as T,f as k,_ as b,j as e,h as Re,r as j,M as p,m as Te,A as Ve}from"./i8clt0mfz495j7ii.js";import{e as V,R as P,o as _,L as I,t3 as K,d as le,B as ce,qL as Ce,aR as Le,b0 as X,i4 as be,m as B,am as Be,a5 as Oe,u as ae,dj as Pe,t4 as Fe,C as He,M as _e,qE as We,e4 as f,T as Ie,$ as ee,dv as de,h as $e,S as Ge,eo as ze,bE as Qe}from"./ghewn7l2ynbm32fm.js";import{U as Ue,b8 as Ke,d$ as Je,kl as ye,kk as me,bd as ue,aP as Ye,ev as Ze,b3 as Xe,b2 as es,hZ as ss}from"./j0yo6uv6652vva62.js";import{k as ne,j as re,l as ie,m as ts}from"./kgnykbdth8mb50na.js";import{T as d}from"./zm1ki9l766pgg0bx.js";import{m as we}from"./bw334685wo6mbjqy.js";import{G as as}from"./mpvcaagn7eiaugto.js";import{i as ns,R as rs}from"./nair9w8wdntqga9z.js";import{T as is,a as os}from"./jduj14fc8ad91v8d.js";import{a as ls,c as cs}from"./k11vc5v60fqtwe47.js";import{u as ds}from"./3vr3npo27kg7k1gc.js";const H=25;function ms(s,t,a){return te({queryKey:["workspace",s,"invites",t,a],queryFn:async()=>await P.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{offset:t,limit:H,query:a}}})})}function Ae(s,t,a){return te({queryKey:["workspace",s,"invites","requests",t,a],queryFn:()=>P.safeGet("/accounts/{account_id}/invites",{parameters:{path:{account_id:s},query:{include_pending:!1,include_requests:!0,offset:t,limit:H,query:a}}})})}function ke(s){const t=M(),a=V(),n=Q();return T({mutationFn:({inviteId:r,role:i,acceptRequest:o})=>P.safePatch("/accounts/{account_id}/invites/{invite_id}",{parameters:{path:{account_id:s,invite_id:r}},requestBody:{role:i,accept_request:o}}).catch(c=>{throw a.danger(t.formatMessage(A.updateInviteError,{error:c.message}),{loggingTitle:A.updateInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to update invite from workspace"}),c}),onSuccess:(r,i)=>{if(i.acceptRequest)n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},o=>{var l;if(!o)return o;const c=o.items.filter(m=>m.id!==i.inviteId),u=Math.max(0,((l=o.total)!=null?l:0)-1);return C(x({},o),{items:c,total:u})});else if(i.role){const o=i.role;n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},c=>{if(!c)return c;const u=c.items.map(l=>l.id===i.inviteId?C(x({},l),{role:o}):l);return C(x({},c),{items:u})})}}})}function De(s){const t=M(),a=V(),n=Q();return T({mutationFn:({email:r})=>P.safeDelete("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_address:r}}).catch(i=>{throw a.danger(t.formatMessage(A.deleteInviteError,{email:r,error:i.message}),{loggingTitle:A.deleteInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to remove user from workspace"}),i}),onSuccess:(r,{email:i})=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},o=>{var l;if(!o)return o;const c=o.items.filter(m=>m.email_address!==i),u=Math.max(0,((l=o.total)!=null?l:0)-1);return C(x({},o),{items:c,total:u})})}})}function us(s){const t=M(),a=V(),n=Q();return T({mutationFn:()=>P.safePost("/accounts/{account_id}/invites/accept_all_requests",{parameters:{path:{account_id:s}}}).catch(r=>{throw a.danger(t.formatMessage(A.acceptAllInviteRequestsError,{error:r.message}),{loggingTitle:A.acceptAllInviteRequestsError.defaultMessage,toastId:"invite",loggingDescription:"Unable to accept all invite requests"}),r}),onSuccess:()=>{n.setQueriesData({queryKey:["workspace",s,"invites","requests"]},r=>r&&C(x({},r),{items:[],total:0}))}})}function gs(s){const t=M(),a=V(),n=Q();return T({mutationFn:({role:r,email:i})=>P.safePost("/accounts/{account_id}/invites",{parameters:{path:{account_id:s}},requestBody:{email_addresses:[i],role:r,resend_emails:!0}}).then(({account_invites:o,errored_emails:c})=>{if(c.length>0)throw new Error(c[0].error);o.length>0&&a.success(t.formatMessage(A.resendInviteSuccess,{email:i}))}).catch(o=>{a.danger(t.formatMessage(A.resendInviteError,{email:i,error:o.message}),{loggingTitle:A.resendInviteError.defaultMessage,toastId:"invite",loggingDescription:"Unable to resend invite to user"})}),onSuccess:()=>{n.invalidateQueries({queryKey:["workspace",s,"invites"]}),n.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}const A=k({updateInviteError:{id:"WorkspaceInvites.updateInviteError",defaultMessage:"Unable to add new user to workspace: {error}"},deleteInviteError:{id:"WorkspaceInvites.deleteInviteError",defaultMessage:"Unable to remove user ({email}) from workspace: {error}"},acceptAllInviteRequestsError:{id:"WorkspaceInvites.acceptAllInviteRequestsError",defaultMessage:"Unable to accept all requests: {error}"},resendInviteSuccess:{id:"WorkspaceInvites.resendInviteSuccess",defaultMessage:"Sent a new invite to {email}"},resendInviteError:{id:"WorkspaceInvites.resendInviteError",defaultMessage:"Unable to resend invite to ({email}) from workspace: {error}"}}),xs=_(()=>b(()=>import("./jgvrewhnjcf398o6.js").then(s=>s._),__vite__mapDeps([0,1])),{loading:s=>I(s)}),ge=({userName:s,isScimManaged:t,dotted:a=!1})=>e.jsxs("div",{className:"relative me-3",children:[e.jsx(Ue,{user:{name:s,picture:null},size:"default",dotted:a}),t&&e.jsx("div",{className:"bg-token-bg-tertiary absolute -end-1 -bottom-1 rounded-full border-2 border-white p-0.25",children:e.jsx(xs,{width:10,height:10})})]}),y=k({name:{id:"UserManager.name",defaultMessage:"Name"},email:{id:"UserManager.email",defaultMessage:"Email"},accountType:{id:"UserManager.accountType",defaultMessage:"Account type"},dateAdded:{id:"UserManager.dateAdded",defaultMessage:"Date added"},role:{id:"UserManager.role",defaultMessage:"Role"},missingName:{id:"UserManager.missingName",defaultMessage:"No name provided"},youSpecifier:{id:"UserManager.youSpecifier",defaultMessage:"(You)"},removeMemberModalTitle:{id:"UserManager.removeMemberModalTitle",defaultMessage:"Remove member"},removeMemberModalConfirm:{id:"UserManager.removeMemberModalConfirm",defaultMessage:"Delete"},removeMemberModalCancel:{id:"UserManager.removeMemberModalCancel",defaultMessage:"Cancel"},dateJoined:{id:"UserManager.dateJoined",defaultMessage:"Joined workspace on {dateAdded}"},logoutMember:{id:"UserManager.logoutMember",defaultMessage:"Log out member"},logoutMemberModalTitle:{id:"UserManager.logoutMemberModalTitle",defaultMessage:"Log out member confirmation"},logoutMemberModalConfirm:{id:"SdeSUj",defaultMessage:"Confirm log out"},inviteMemberButton:{id:"UserManager.inviteMemberButton",defaultMessage:"Invite member"},noResults:{id:"UserManager.noResults",defaultMessage:"No results"},leaveWorkspace:{id:"adminPage.leaveWorkspace",defaultMessage:"Leave workspace"}}),hs=n=>{var r=n,{children:s,ref:t}=r,a=$(r,["children","ref"]);return e.jsx(K.Root,C(x({license:"commercial",sheetRole:"dialog"},a),{ref:t,children:s}))},ps=i=>{var o=i,{children:s,ref:t,className:a,contentPlacement:n="left"}=o,r=$(o,["children","ref","className","contentPlacement"]);return e.jsx(K.View,C(x({className:le("z-1",a),contentPlacement:n,swipeOvershoot:!1,nativeEdgeSwipePrevention:!0},r),{ref:t,children:s}))},fs=n=>{var r=n,{className:s,ref:t}=r,a=$(r,["className","ref"]);return e.jsx(K.Backdrop,C(x({className:s},a),{ref:t}))},js=r=>{var i=r,{children:s,ref:t,className:a}=i,n=$(i,["children","ref","className"]);return e.jsx(K.Content,C(x({className:le("bg-token-bg-primary box-border shadow-lg",a)},n),{ref:t,children:s}))},Ms=K.Portal,G={Root:hs,Portal:Ms,View:ps,Backdrop:fs,Content:js},vs=({workspaceId:s,userId:t})=>te({queryKey:[s,t,"user-roles"],queryFn:async()=>(await P.safeGet("/rbac/workspace/{workspace_id}/principals/{principal_id}/roles",{parameters:{query:{account_id:s},path:{workspace_id:s,principal_id:t}}})).roles}),bs=({workspaceId:s,userId:t,enabled:a})=>te({enabled:a,queryKey:[s,t,"user-groups"],queryFn:async()=>(await P.safeGet("/accounts/{account_id}/users/{account_user_id}/groups",{parameters:{path:{account_id:s,account_user_id:t}}})).items}),_s=_(()=>b(()=>import("./bci083mws0hai8bl.js").then(s=>s._),__vite__mapDeps([2,1])),{loading:s=>I(s)}),ys=_(()=>b(()=>import("./gsyp9a9fup59ufmh.js").then(s=>s._),__vite__mapDeps([3,1])),{loading:s=>I(s)}),Ns=({workspaceId:s,user:t,onClose:a})=>{var h;const n=M(),r=ce(),i=Re(),o=Ce(),c=r==null?void 0:r.isEnterprisey(),{data:u}=vs({workspaceId:s,userId:t.id}),l=j.useMemo(()=>u==null?void 0:u.filter(g=>!g.predefined_role),[u]),{data:m}=bs({workspaceId:s,userId:t.account_user_id,enabled:c});return e.jsx(G.Root,{presented:!0,defaultPresented:!0,onPresentedChange:a,children:e.jsx(G.Portal,{children:e.jsxs(G.View,{contentPlacement:"right",children:[e.jsx(G.Backdrop,{}),e.jsxs(G.Content,{style:{maxWidth:500},children:[e.jsxs("h1",{className:"flex items-center justify-between p-4",children:[e.jsx("div",{}),e.jsx(Le,{onClick:a,iconSize:"lg",autoFocus:!0})]}),e.jsxs("div",{className:"flex flex-col gap-3 px-10 pt-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 text-center",children:[e.jsx(Ue,{user:{name:(h=t.name)!=null?h:"",picture:null},size:"large"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-heading-3",children:t.name}),e.jsx("div",{children:t.email})]})]}),e.jsx("hr",{className:"my-2.5"}),c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(Y.groups)}),m==null&&e.jsx(X,{}),(m==null?void 0:m.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(Y.noGroups)}),m==null?void 0:m.map(g=>e.jsx(be,{className:"mx-0",as:"button",onClick:()=>i("/admin/groups/".concat(g.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:e.jsx(as,{group:g})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:g.name}),ns(g)&&e.jsx(rs,{})]})]})})},g.id))]}),e.jsx("hr",{className:"my-2.5"})]}),o&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"text-caption-regular",children:n.formatMessage(Y.customRoles)}),l==null&&e.jsx(X,{}),(l==null?void 0:l.length)===0&&e.jsx("div",{className:"text-token-text-tertiary text-sm italic",children:n.formatMessage(Y.noCustomRoles)}),l==null?void 0:l.map(g=>e.jsx(be,{className:"mx-0",as:"button",onClick:()=>i("/admin/permissions/roles/".concat(g.id)),children:e.jsx("div",{className:"flex items-center justify-between gap-2 text-start",children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx("div",{children:g.predefined_role?e.jsx(ys,{className:"icon"}):e.jsx(_s,{className:"icon"})}),e.jsxs("div",{children:[e.jsx("div",{children:g.name}),e.jsx("div",{className:"text-token-text-tertiary text-sm",children:g.description})]})]})})},g.id))]})]})]})]})})})},Y=k({customRoles:{id:"tt2Vcr",defaultMessage:"Custom roles"},noCustomRoles:{id:"esz0bm",defaultMessage:"No custom roles assigned"},groups:{id:"zWtMsq",defaultMessage:"Groups"},noGroups:{id:"VRtXNY",defaultMessage:"No groups assigned"}});function xe({currentRole:s,onUpdateUserRole:t,disabled:a=!1}){const n=ne();return e.jsx(Ke,{disabled:a,defaultValue:s,onValueChange:r=>{t(r)},triggerClassName:"text-base",options:[{label:n[B.STANDARD],value:B.STANDARD},{label:n[B.ADMIN],value:B.ADMIN},{label:n[B.OWNER],value:B.OWNER}]})}const Rs=_(()=>b(()=>import("./ceivmd4pm4umbvdn.js").then(s=>s._),__vite__mapDeps([4,1])),{loading:s=>I(s)}),Cs=_(()=>b(()=>import("./ooz2slmm8agf6bjp.js").then(s=>s._),__vite__mapDeps([5,1])),{loading:s=>I(s)}),Ps=_(()=>b(()=>import("./nju52ppu7cxhyzrm.js").then(s=>s._),__vite__mapDeps([6,1])),{loading:s=>I(s)}),Is=_(()=>b(()=>import("./d3bvq1y1gdwhf87e.js"),__vite__mapDeps([7,1,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28])).then(s=>s.ConfirmLogoutModal)),z=Be(()=>({confirmModalUserData:null})),se={openModalForUser:s=>{z.setState({confirmModalUserData:s})},closeModal:()=>{z.setState({confirmModalUserData:null})}};function Us({workspaceId:s,filterInputValue:t}){var pe;const[a,n]=j.useState(0),r=Oe(),[i,o]=j.useState(),c=Ce(),u=r==null?void 0:r.id,l=re(s),m=ie(s),h=l||m,g=Ds(),w=Ss(s),U=Es(s),{data:E}=Je(s,a*ye,t);j.useEffect(()=>{n(0)},[t]);const D=j.useCallback(v=>{se.openModalForUser(v)},[]),L=j.useCallback(()=>{var R;const v=(R=z.getState().confirmModalUserData)==null?void 0:R.id;v!==void 0&&w.mutate({userId:v}),se.closeModal(),o(void 0)},[w]),S=j.useCallback((v,R)=>{g.mutate({userId:v,value:R,workspaceId:s})},[g,s]);if(E===void 0)return e.jsx(he,{});const N=E.items,W=Math.ceil(((pe=E.total)!=null?pe:0)/ye);return a>=W&&W!==0&&n(Math.max(W-1,0)),e.jsxs(e.Fragment,{children:[e.jsxs(d.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),h&&e.jsx("col",{className:"w-16"})]}),e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{children:e.jsx(p,x({},y.name))}),e.jsx(d.HeaderCell,{children:e.jsx("span",{className:l?"ps-3":"",children:e.jsx(p,x({},y.accountType))})}),e.jsx(d.HeaderCell,{children:e.jsx(p,x({},y.dateAdded))}),h&&e.jsx(d.HeaderCell,{className:"w-16"})]}),e.jsxs(d.Body,{children:[N.map(v=>e.jsx(As,{isCurrentUser:u!==void 0&&v.id===u,user:v,currentUserHasAdminRights:h,isCurrentUserOwner:l,onRemoveUserClick:()=>{var R,fe;return D({id:v.id,name:(R=v.name)!=null?R:"",email:(fe=v.email)!=null?fe:"",created_time:v.created_time})},onUpdateUserRole:S,onLogoutUser:async R=>{await U.mutateAsync({userId:R})},onClick:c?R=>o(R):void 0},v.id)),N.length===0&&e.jsx(d.Row,{className:"[&>td]:py-2",children:e.jsx(d.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(p,x({},y.noResults))})})})]})]}),e.jsx("div",{className:"relative mt-4 mb-8 min-h-[20px]",children:W>1&&e.jsx("div",{className:"absolute start-1/2 top-1/2 flex -translate-x-1/2 -translate-y-1/2 justify-center",children:e.jsx(me,{currentPage:a,onChangeIndex:n,length:W})})}),i&&e.jsx(Ns,{workspaceId:s,user:i,onClose:()=>o(void 0)}),e.jsx(ws,{onDeleteConfirm:L})]})}function ws({onDeleteConfirm:s}){var r;const t=M(),a=z(i=>i.confirmModalUserData!==null),n=z(i=>i.confirmModalUserData===null?{}:{userId:i.confirmModalUserData.id,email:i.confirmModalUserData.email,name:i.confirmModalUserData.name,dateAdded:Fe(i.confirmModalUserData.created_time)});return e.jsx(He,{testId:"modal-remove-member",isOpen:a,title:t.formatMessage(y.removeMemberModalTitle),onClose:()=>se.closeModal(),type:"success",primaryButton:e.jsx(_e.Button,{title:t.formatMessage(y.removeMemberModalConfirm),color:"danger",onClick:s}),secondaryButton:e.jsx(_e.Button,{title:t.formatMessage(y.removeMemberModalCancel),color:"secondary",onClick:()=>se.closeModal()}),children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[(r=n.name)!=null?r:n.email,e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(p,C(x({},y.dateJoined),{values:{dateAdded:t.formatDate(n.dateAdded,{year:"numeric",month:"long",day:"numeric"})}}))})]})})}function As({user:s,currentUserHasAdminRights:t,isCurrentUserOwner:a,isCurrentUser:n,onRemoveUserClick:r,onUpdateUserRole:i,onLogoutUser:o,onClick:c}){var w;const l=ne()[s.role],m=M(),h=(w=s.name)!=null?w:m.formatMessage(y.missingName),g=ae();return e.jsxs(d.Row,{className:le("[&>td]:py-2"),onClick:c?()=>c==null?void 0:c(s):void 0,children:[e.jsxs(d.Cell,{children:[e.jsx("div",{className:"relative pe-3",children:e.jsx(ge,{userName:h,isScimManaged:s.is_scim_managed})}),e.jsxs("div",{children:[e.jsxs("div",{children:[h,n&&e.jsx("span",{className:"ms-1",children:e.jsx(p,x({},y.youSpecifier))})]}),e.jsx("div",{className:"text-body-small-regular text-token-text-secondary",children:s.email})]})]}),e.jsx(d.Cell,{children:a?e.jsx(xe,{currentRole:s.role,onUpdateUserRole:U=>{i(s.id,U)},disabled:n}):l}),e.jsx(d.Cell,{children:m.formatDate(s.created_time,{month:"short",day:"numeric",year:"numeric"})}),t&&e.jsx(d.Cell,{children:e.jsx(ks,{userId:s.id,onRemoveUserClick:r,onLogoutUserClick:()=>{Pe(g,Is,{onConfirm:()=>o(s.id)})},isCurrentUser:n,isScimManaged:s.is_scim_managed})})]})}function ks({isCurrentUser:s,onRemoveUserClick:t,onLogoutUserClick:a,userId:n,isScimManaged:r}){const i=ae(),o=M(),c=We(i),u=e.jsx(f.Item,{onClick:r?void 0:l=>{l.stopPropagation(),t(n)},color:"danger",icon:e.jsx(Rs,{}),disabled:r,children:e.jsx(p,x({},y.removeMemberModalTitle))});return s?null:e.jsxs(f.Root,{children:[e.jsx(f.Trigger,{className:"-my-2",children:e.jsx(Ps,{className:"icon-sm"})}),e.jsx(f.Portal,{children:e.jsxs(f.Content,{size:"small",children:[c&&e.jsx(f.Item,{onClick:l=>{l.stopPropagation(),a(n)},icon:e.jsx(Cs,{}),children:e.jsx(p,x({},y.logoutMember))}),r?e.jsx(Ie,{label:o.formatMessage(we.managedViaSCIMTooltip),className:"flex",side:"right",children:u}):u]})})]})}function Ds(){const s=V();return T({mutationFn:({userId:t,workspaceId:a,value:n})=>P.safePatch("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:a,user_id:t}},requestBody:{role:n}}).catch(r=>{s.danger("Unable to update user (".concat(t,") role: ").concat(r.message),{toastId:"user_manager_table"})})})}function Es(s){const t=V();return T({mutationFn:({userId:a})=>P.safePost("/accounts/{account_id}/users/{user_id}/logout_all",{parameters:{path:{account_id:s,user_id:a}}}),onError:(a,n)=>{t.danger("Unable to logout user (".concat(n.userId,") from workspace"),{toastId:"user_manager_table"})},onSuccess:()=>{t.success("User logged out of all sessions",{id:"user_logout_success"})}})}function Ss(s){const t=Q(),a=V();return T({mutationFn:({userId:n})=>P.safeDelete("/accounts/{account_id}/users/{user_id}",{parameters:{path:{account_id:s,user_id:n}}}).catch(r=>{a.danger("Unable to remove user (".concat(n,") from workspace: ").concat(r.message),{toastId:"user_manager_table"})}),onSuccess:()=>{t.invalidateQueries({queryKey:["workspace",s]})}})}function he(){return e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsx(X,{})})}const qs=_(()=>b(()=>import("./nju52ppu7cxhyzrm.js").then(s=>s._),__vite__mapDeps([6,1])),{loading:s=>I(s)});function Ts({workspaceId:s,filterInputValue:t}){var h;const[a,n]=j.useState(0),{data:r}=Ae(s,a*H,t),i=re(s),o=ie(s),c=M(),u=i||o;if(r===void 0)return e.jsx(he,{});const l=r.items,m=Math.ceil(((h=r.total)!=null?h:0)/H);return a>=m&&m!==0&&n(Math.max(m-1,0)),e.jsxs("div",{children:[e.jsxs(d.Root,{fixed:!0,size:"normal",children:[e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(p,x({},O.email))}),e.jsx(d.HeaderCell,{className:"bg-token-main-surface-primary w-36",children:e.jsx("span",{className:u?"ps-3":"",children:e.jsx(p,x({},O.role))})}),u&&e.jsx(d.HeaderCell,{className:"bg-token-main-surface-primary w-40",children:c.formatMessage(O.actions)})]}),e.jsxs(d.Body,{children:[l.map(g=>e.jsx(Vs,{workspaceId:s,invite:g,isCurrentUserOwner:i,currentUserHasAdminRights:u},g.id)),l.length===0&&e.jsx(d.Row,{children:e.jsx(d.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(p,x({},O.noResults))})})})]})]}),m>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(me,{currentPage:a,onChangeIndex:n,length:m})})]})}function Vs({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n}){var u;const r=ne(),i=ke(s),o=De(s),c=M();return e.jsxs(d.Row,{className:"[&>td]:py-2",disabled:i.isPending||o.isPending||o.isPending,children:[e.jsx(d.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(ge,{userName:(u=t.email_address)!=null?u:"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(d.Cell,{children:a?e.jsx(xe,{currentRole:t.role,onUpdateUserRole:l=>{i.mutate({inviteId:t.id,role:l})}}):r[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(d.Cell,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ee,{color:"secondary",onClick:()=>i.mutate({inviteId:t.id,acceptRequest:!0}),children:c.formatMessage(O.accept)}),e.jsxs(f.Root,{children:[e.jsx(f.Trigger,{disabled:t.is_scim_managed,children:e.jsx(qs,{className:"icon-sm"})}),e.jsx(f.Portal,{children:e.jsx(f.Content,{children:e.jsx(f.Item,{color:"danger",onClick:()=>{var l;return o.mutate({email:(l=t.email_address)!=null?l:""})},children:c.formatMessage(O.reject)})})})]})]})})})]})}const O=k({email:{id:"RequestInviteManager.email",defaultMessage:"Email"},role:{id:"RequestInviteManager.role",defaultMessage:"Account Type"},actions:{id:"RequestInviteManager.actions",defaultMessage:"Actions"},accept:{id:"RequestInviteManager.accept",defaultMessage:"Accept"},reject:{id:"RequestInviteManager.reject",defaultMessage:"Reject"},noResults:{id:"RequestInviteManager.noResults",defaultMessage:"No results"}}),Ls=({workspaceId:s})=>{var D,L,S;const t=M(),a=ae(),n=re(s),r=ie(s),i=n||r,o=us(s),[c,u]=j.useState(""),[l,m]=j.useState(""),h=j.useMemo(()=>de(N=>m(N),300,{leading:!1,trailing:!0}),[]),{data:g}=Ae(s,0,l),w=(D=$e(a,"3677330697"))!=null?D:!1,U=(L=g==null?void 0:g.total)!=null?L:0,E=U?t.formatMessage(oe.acceptAllWithCount,{count:U}):t.formatMessage(oe.acceptAll);return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(ue,{value:c,onChange:N=>{u(N.target.value),h(N.target.value)},placeholder:t.formatMessage(oe.searchRequestPlaceholder),inputClassName:"rounded-full! text-sm"})}),i&&w&&e.jsx(ee,{loading:o.isPending,disabled:((S=g==null?void 0:g.total)!=null?S:0)===0,onClick:()=>o.mutate(),children:E})]}),e.jsx(Ts,{workspaceId:s,filterInputValue:l})]})},oe=k({pendingRequests:{id:"admin.workspace.members.pendingRequests",defaultMessage:"Pending Requests"},searchRequestPlaceholder:{id:"admin.workspace.members.searchRequestPlaceholder",defaultMessage:"Search for requests"},acceptAll:{id:"admin.workspace.members.acceptAll",defaultMessage:"Accept all"},acceptAllWithCount:{id:"admin.workspace.members.acceptAllWithCount",defaultMessage:"Accept all ({count})"}}),Ne=_(()=>b(()=>import("./nju52ppu7cxhyzrm.js").then(s=>s._),__vite__mapDeps([6,1])),{loading:s=>I(s)});function Bs({workspaceId:s,filterInputValue:t}){var m;const[a,n]=j.useState(0),r=re(s),i=ie(s),o=r||i,{data:c}=ms(s,a*H,t);if(c===void 0)return e.jsx(he,{});const u=c.items,l=Math.ceil(((m=c.total)!=null?m:0)/H);return a>=l&&l!==0&&n(Math.max(l-1,0)),e.jsxs("div",{children:[e.jsxs(d.Root,{fixed:!0,size:"normal",children:[e.jsxs("colgroup",{children:[e.jsx("col",{className:"w-[60%]"}),e.jsx("col",{className:"w-[20%]"}),e.jsx("col",{className:"w-[20%]"}),o&&e.jsx("col",{className:"w-16"})]}),e.jsxs(d.Header,{children:[e.jsx(d.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(p,x({},F.email))}),e.jsx(d.HeaderCell,{className:"bg-token-bg-primary",children:e.jsx(p,x({},F.invitedDate))}),e.jsx(d.HeaderCell,{className:"bg-token-bg-primary w-28",children:e.jsx("span",{className:o?"ps-3":"",children:e.jsx(p,x({},F.role))})}),o&&e.jsx(d.HeaderCell,{className:"bg-token-bg-primary w-16"})]}),e.jsxs(d.Body,{children:[u.map(h=>e.jsx(Os,{workspaceId:s,invite:h,isCurrentUserOwner:r,currentUserHasAdminRights:o},h.id)),u.length===0&&e.jsx(d.Row,{children:e.jsx(d.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(p,x({},F.noResults))})})})]})]}),l>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(me,{currentPage:a,onChangeIndex:n,length:l})})]})}function Os({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n}){var l;const r=M(),i=ne(),o=ke(s),c=De(s),u=gs(s);return e.jsxs(d.Row,{className:"[&>td]:py-2",disabled:o.isPending||c.isPending||c.isSuccess||u.isPending,children:[e.jsx(d.Cell,{children:e.jsxs("span",{className:"flex grow",children:[e.jsx(ge,{userName:(l=t.email_address)!=null?l:"",isScimManaged:t.is_scim_managed,dotted:!0}),e.jsx("span",{children:t.email_address})]})}),e.jsx(d.Cell,{children:r.formatDate(t.created_time,{month:"short",day:"numeric",year:"numeric"})}),e.jsx(d.Cell,{children:a?e.jsx(xe,{currentRole:t.role,onUpdateUserRole:m=>{o.mutate({inviteId:t.id,role:m})}}):i[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(d.Cell,{children:e.jsx(Fs,{onDeleteUser:()=>{var m;c.mutate({email:(m=t.email_address)!=null?m:""})},onResendInvite:()=>{var m,h;u.mutate({email:(m=t.email_address)!=null?m:"",role:(h=t.role)!=null?h:""})},disabled:t.is_scim_managed})})})]})}function Fs({onDeleteUser:s,onResendInvite:t,disabled:a}){const n=M();return e.jsx(e.Fragment,{children:a?e.jsx(f.Root,{children:e.jsx(f.Trigger,{disabled:!0,children:e.jsx(Ie,{label:n.formatMessage(we.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(Ne,{className:"icon-sm"})})})}):e.jsxs(f.Root,{children:[e.jsx(f.Trigger,{children:e.jsx(Ne,{className:"icon-sm"})}),e.jsx(f.Portal,{children:e.jsxs(f.Content,{children:[e.jsx(f.Item,{onClick:t,children:e.jsx(p,x({},F.resendInvite))}),e.jsx(f.Item,{onClick:s,children:e.jsx(p,x({},F.revokeInvite))})]})})]})})}const F=k({email:{id:"InviteManager.email",defaultMessage:"Email"},role:{id:"InviteManager.role",defaultMessage:"Account Type"},invitedDate:{id:"InviteManager.invitedDate",defaultMessage:"Date invited"},resendInvite:{id:"InviteManager.resendInvite",defaultMessage:"Resend invite"},revokeInvite:{id:"InviteManager.revokeInvite",defaultMessage:"Revoke invite"},noResults:{id:"InviteManager.noResults",defaultMessage:"No results"}}),Hs=({workspaceId:s})=>{const t=M(),[a,n]=j.useState(""),[r,i]=j.useState(""),o=j.useMemo(()=>de(c=>i(c),300,{leading:!1,trailing:!0}),[]);return e.jsxs("div",{className:"mt-6",children:[e.jsx(ue,{value:a,onChange:c=>{n(c.target.value),o(c.target.value)},placeholder:t.formatMessage(Ws.searchInvitesPlaceholder),className:"mb-4.5",inputClassName:"rounded-full! text-sm"}),e.jsx(Bs,{workspaceId:s,filterInputValue:r})]})},Ws=k({searchInvitesPlaceholder:{id:"admin.workspace.members.searchInvitesPlaceholder",defaultMessage:"Search for invites"}}),$s=_(()=>b(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yq),__vite__mapDeps([8,1,9,10,11])),{loading:s=>I(s)}),Gs=_(()=>b(()=>import("./nju52ppu7cxhyzrm.js").then(s=>s._),__vite__mapDeps([6,1])),{loading:s=>I(s)}),zs=_(()=>b(()=>import("./j0yo6uv6652vva62.js").then(s=>s.z8),__vite__mapDeps([8,1,9,10,11])).then(s=>s.AdminInviteModal));function Qs({workspaceId:s}){const t=M(),a=ce(),[n,r]=j.useState(""),[i,o]=j.useState(""),c=j.useMemo(()=>de(g=>o(g),300,{leading:!1,trailing:!0}),[]),u=ae();if(!a)return null;const l=a==null?void 0:a.isSelfServeBusiness(),m=a.isAdminOfAccount(),h=a.isOwnerOfAccount();return e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"mb-4.5 flex items-center justify-between",children:[e.jsx(ue,{value:n,onChange:g=>{r(g.target.value),c(g.target.value)},placeholder:t.formatMessage(Z.searchMembersPlaceholder),inputClassName:"rounded-full! text-sm"}),e.jsxs("div",{className:"flex items-center gap-2",children:[(m||h||l)&&e.jsx(ee,{onClick:()=>{Ge.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"workspace-admin-click",text:"InviteMember",step:"OpenModal"}),Pe(u,zs,{workspace:a})},icon:$s,children:e.jsx(p,x({},Z.inviteMemberButton))}),l?e.jsx(ze,{triggerButton:e.jsx(ee,{color:"secondary",icon:Gs}),children:e.jsx(f.Item,{onClick:()=>{a&&Ye.setLeaveWorkspaceData(a)},children:e.jsx(p,x({},Z.leaveWorkspace))})}):null]})]}),e.jsx(Us,{workspaceId:s,filterInputValue:i}),e.jsx("p",{className:"text-token-text-secondary mt-4 text-sm",children:e.jsx(p,x({},Z.memberListUpdateDelayNote))})]})}const Z=k({inviteMemberButton:{id:"InviteManager.inviteMemberButton",defaultMessage:"Invite member"},leaveWorkspace:{id:"WorkspaceMembers.leaveWorkspace",defaultMessage:"Leave workspace"},searchMembersPlaceholder:{id:"WorkspaceMembers.searchMembersPlaceholder",defaultMessage:"Filter by name"},memberListUpdateDelayNote:{id:"adminPage.memberListUpdateDelayNote",defaultMessage:"Note: Although new workspace members can access ChatGPT immediately, it may take up to 24 hours to show them in this list."}}),Ks=_(()=>b(()=>import("./3j20em1lilnrpdcm.js").then(s=>s._),__vite__mapDeps([29,1])),{loading:s=>I(s)}),Js=s=>s==="members"||s==="invites"||s==="requests";function Ys({currentWorkspaceId:s}){var S;const t=M(),a=ce(),{count:n}=Ze(s),r=ts(a),i=j.useMemo(()=>[{key:"members",label:t.formatMessage(q.allMembers),children:e.jsx(Qs,{workspaceId:s})},{key:"invites",label:t.formatMessage(q.pendingInvites),children:e.jsx(Hs,{workspaceId:s})},{key:"requests",label:t.formatMessage(q.pendingRequests),children:e.jsx(Ls,{workspaceId:s})}],[s,t]),o=Re(),[c]=Te(),u=c.get("tab"),[l,m]=j.useState(u&&Js(u)?u:i[0].key),h=a!=null?Xe(a.data.role):void 0,g=a!=null?es(a.data.role):void 0,w=a==null?void 0:a.isEnterprisey(),{data:U,isLoading:E}=Qe(s);let D=!1;g||h||!w?D=!0:D=!!((S=U==null?void 0:U.permissions)!=null&&S.includes("chatgpt.workspace.member.role.view"));const L=N=>{m(N),o({pathname:window.location.pathname,search:new URLSearchParams({tab:N}).toString()})};return a?E?e.jsx("div",{className:"mt-6 flex min-h-[40vh] items-center justify-center",children:e.jsx(X,{})}):D?e.jsxs(e.Fragment,{children:[e.jsx(ss,{children:e.jsx("title",{children:t.formatMessage(q.adminBrowserPageTitle)})}),e.jsx(ls,{title:t.formatMessage(q.adminPageTitle),subtitle:e.jsx(p,x({values:{totalMembers:n,planName:r}},q.totalMembers)),tabsHeader:e.jsx(is,{items:i,activeTab:l,onTabChange:L})}),e.jsx(cs,{children:e.jsx(os,{items:i,activeTab:l})})]}):e.jsx("div",{className:"m-6",children:e.jsxs("div",{className:"border-token-border-medium bg-token-main-surface-secondary text-token-text-primary flex items-center gap-3 rounded-md border px-4 py-3",children:[e.jsx(Ks,{className:"icon-sm interactive-label-warning-secondary shrink-0"}),e.jsx(p,x({},q.membersPagePermissionDenied))]})}):null}const q=k({adminBrowserPageTitle:{id:"adminPage.adminBrowserPageTitle",defaultMessage:"ChatGPT - Admin | Members"},adminPageTitle:{id:"adminPage.adminPageTitle.0",defaultMessage:"Members"},workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},totalMembers:{id:"adminPage.totalMembers",defaultMessage:"{planName} Â· {totalMembers} {totalMembers, plural, one {member} other {members}}"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},allMembers:{id:"adminPage.allMembers",defaultMessage:"Users"},pendingInvites:{id:"adminPage.pendingInvites",defaultMessage:"Pending invites"},pendingRequests:{id:"adminPage.pendingRequests",defaultMessage:"Pending requests"},membersPagePermissionDenied:{id:"adminPage.membersPagePermissionDenied",defaultMessage:"You don't have permission to view this members list. Please contact your workspace admin for access or update the workspace settings."}}),dt=Ve(function(){const t=ds();return e.jsx(Ys,x({},t))});export{dt as a,y as m};
//# sourceMappingURL=dchg5chtd6lg8nkx.js.map
