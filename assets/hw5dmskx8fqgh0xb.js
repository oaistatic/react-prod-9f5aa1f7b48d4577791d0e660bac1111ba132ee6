const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/e6eptpe9toj61kmv.js","assets/i8clt0mfz495j7ii.js"])))=>i.map(i=>d[i]);
var j=Object.freeze,S=Object.defineProperty,I=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var A=(t,s,e)=>s in t?S(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,g=(t,s)=>{for(var e in s||(s={}))U.call(s,e)&&A(t,e,s[e]);if(_)for(var e of _(s))q.call(s,e)&&A(t,e,s[e]);return t},v=(t,s)=>I(t,C(s));var h=(t,s)=>j(S(t,"raw",{value:j(s||t.slice())}));import{e as E,r as F,j as a,f as J,M as y,u as G,a as b,_ as O}from"./i8clt0mfz495j7ii.js";import{nG as Q,n as w,C as V,b0 as B,m0 as K,m1 as T,d as R,m3 as $,F as N,o as H,$ as W,eU as D,L as X,R as Y}from"./ghewn7l2ynbm32fm.js";const Z=H(()=>O(()=>import("./e6eptpe9toj61kmv.js").then(t=>t._),__vite__mapDeps([0,1])),{loading:t=>X(t)});function ee(t){const s=G();return b({mutationFn:async({actionId:e,domain:x,settings:l})=>D.upsertUserActionSettings(e,x,l),onSuccess:()=>{s.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:t}]})}})}function te(t){const s=G();return b({mutationFn:async({pluginId:e})=>{await Y.safeDelete("/aip/p/{id}/user-settings",{parameters:{path:{id:e}}})},onSuccess:()=>{s.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:t}]})}})}const ce=({gizmo:t,onClose:s})=>{const{data:e,isLoading:x}=Q(t.gizmo.id,!0),l=E(),[d,m]=F.useState("actions"),r=e!=null&&e.settings.some(i=>i.oauth_status!=null&&t.tools.some(o=>{var n;return o.type===w.JIT_PLUGIN&&((n=o.metadata)==null?void 0:n.action_id)===i.action_id}));return d==="connected_accounts"&&!r&&m("actions"),a.jsx(V,{testId:"modal-gizmo-privacy-settings",title:l.formatMessage(c.title),isOpen:!0,onClose:s,type:"success",size:"custom",className:"min-h-[50vh] max-w-3xl overflow-y-auto scroll-smooth",noPadding:!0,showCloseButton:!0,children:x?a.jsx(B,{}):a.jsxs(K,{className:"flex flex-row gap-6 p-4",orientation:"vertical",defaultValue:d,onValueChange:i=>{m(i)},children:[r&&a.jsxs(T,{className:R("flex max-w-[200px] min-w-[180px] shrink-0 flex-col gap-2"),children:[a.jsx(z,{value:"actions",message:c.actions}),r&&a.jsx(z,{value:"connected_accounts",message:c.connectedAccounts})]}),a.jsxs("div",{className:"flex-1 text-sm",children:[d==="actions"&&a.jsxs(P,{children:[a.jsx(y,v(g({},c.allowedActionsDesc),{values:{gizmoName:t.gizmo.display.name}})),e==null?void 0:e.settings.map((i,o)=>{var u;const n=(u=t.tools)==null?void 0:u.find(p=>{var f;return p.type===w.JIT_PLUGIN&&((f=p.metadata)==null?void 0:f.action_id)===i.action_id});return n&&a.jsx(ae,{gizmoId:t.gizmo.id,actionSettings:i,actionTool:n},o)})]}),d==="connected_accounts"&&a.jsxs(P,{children:[a.jsx(y,v(g({},c.connectedAccountsDesc),{values:{gizmoName:t.gizmo.display.name}})),a.jsx("div",{children:e==null?void 0:e.settings.map((i,o)=>{var u;const n=(u=t.tools)==null?void 0:u.find(p=>{var f;return p.type===w.JIT_PLUGIN&&((f=p.metadata)==null?void 0:f.action_id)===i.action_id});return n&&i.oauth_status&&a.jsx(se,{gizmoId:t.gizmo.id,actionSettings:i,actionTool:n},o)})})]})]})]})})};function z({value:t,message:s}){return a.jsx($,{className:"text-token-text-primary radix-state-active:bg-white dark:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:text-token-text-primary flex rounded-md px-2 py-1.5 text-sm",value:t,children:a.jsx("div",{className:"truncate",children:a.jsx(y,g({},s))})})}function ae({gizmoId:t,actionSettings:s,actionTool:e}){var m,r,i;const x=ee(t),l=(m=s.action_settings)==null?void 0:m.all,d=o=>{var n,u;(n=e.metadata)!=null&&n.action_id&&((u=e.metadata)!=null&&u.domain)&&x.mutateAsync({actionId:e.metadata.action_id,domain:e.metadata.domain,settings:{all:o}})};return a.jsx("div",{children:a.jsxs(L,{className:"border-b border-black/10 dark:border-white/10",children:[a.jsxs("div",{className:"flex flex-row space-x-4",children:[a.jsx("div",{className:"font-semibold",children:(r=e.metadata)==null?void 0:r.domain}),a.jsxs("a",{href:(i=e.metadata)==null?void 0:i.privacy_policy_url,target:"_blank",rel:"noreferrer",className:"text-token-text-tertiary hover:text-token-text-secondary flex items-center gap-1 hover:cursor-pointer",children:[a.jsx(y,g({},c.privacyPolicyLink)),a.jsx(Z,{className:"icon"})]})]}),a.jsxs("select",{value:l?"always_allow":"unset",onChange:o=>d(o.target.value),className:"bg-token-main-surface-primary rounded-sm border-none text-sm",children:[a.jsx("option",{value:"always_allow",children:a.jsx(y,g({},c.alwaysAllowDropdown))}),a.jsx("option",{value:"unset",children:a.jsx(y,g({},c.askDropdown))})]})]})})}function se({gizmoId:t,actionSettings:s,actionTool:e}){var d;const x=te(t),l=s.oauth_status==="valid";return a.jsxs(L,{children:[a.jsx("div",{className:"font-semibold",children:(d=e==null?void 0:e.metadata)==null?void 0:d.domain}),a.jsx(W,{color:"secondary",size:"small",onClick:()=>{var m,r,i,o,n;(m=e.metadata)!=null&&m.action_id&&((r=e.metadata)!=null&&r.domain)&&(l?x.mutateAsync({pluginId:(i=e.metadata)==null?void 0:i.action_id}):D.doOAuthRedirect(t,(o=e.metadata)==null?void 0:o.action_id,(n=e.metadata)==null?void 0:n.domain,window.location.href))},children:a.jsx(y,g({},l?c.logout:c.login))})]})}var M;const P=N.div(M||(M=h(["flex flex-col gap-6"])));var k;const L=N.div(k||(k=h(["flex flex-row justify-between py-3 items-center"]))),c=J({title:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.title"},actions:{defaultMessage:"Actions",id:"GizmoPrivacySettings.actions"},connectedAccounts:{defaultMessage:"Connected accounts",id:"GizmoPrivacySettings.connectedAccounts"},connectedAccountsDesc:{defaultMessage:"Manage which 3rd party accounts can be accessed by {gizmoName}.",id:"GizmoPrivacySettings.connectedAccountsDesc"},allowedActionsTitle:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.allowedActionsTitle"},allowedActionsDesc:{defaultMessage:"Select which 3rd party actions are allowed in conversations with {gizmoName}.",id:"GizmoPrivacySettings.allowedActionsDesc"},privacyPolicyLink:{defaultMessage:"Privacy policy",id:"GizmoPrivacySettings.privacyPolicyLink"},alwaysAllowDropdown:{defaultMessage:"Always allow",id:"GizmoPrivacySettings.alwaysAllowDropdown"},askDropdown:{defaultMessage:"Ask",id:"GizmoPrivacySettings.askDropdown"},login:{defaultMessage:"Log in",id:"GizmoPrivacySettings.login"},logout:{defaultMessage:"Log out",id:"GizmoPrivacySettings.logout"}});export{ce as default};
//# sourceMappingURL=hw5dmskx8fqgh0xb.js.map
