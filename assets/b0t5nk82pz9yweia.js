const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/gsas8pb1acnf7jnd.js","assets/i8clt0mfz495j7ii.js","assets/nlen9u31md3gmt0q.js","assets/tgmagak4qrebhl4h.js","assets/b7nodduwb2cg7ocy.js","assets/mkqbxg29rgkoa3dk.js","assets/blk6dinhf69rm0e1.js","assets/kag562m27rmlspt4.js","assets/dw6rumxxn7eubhsq.js"])))=>i.map(i=>d[i]);
var Ze=Object.defineProperty,Je=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var Re=Object.getOwnPropertySymbols;var tt=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable;var ke=t=>{throw TypeError(t)};var ce=(t,e,s)=>e in t?Ze(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,R=(t,e)=>{for(var s in e||(e={}))tt.call(e,s)&&ce(t,s,e[s]);if(Re)for(var s of Re(e))st.call(e,s)&&ce(t,s,e[s]);return t},ee=(t,e)=>Je(t,et(e));var T=(t,e,s)=>ce(t,typeof e!="symbol"?e+"":e,s),Ee=(t,e,s)=>e.has(t)||ke("Cannot "+s);var C=(t,e,s)=>(Ee(t,e,"read from private field"),s?s.call(t):e.get(t)),E=(t,e,s)=>e.has(t)?ke("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),V=(t,e,s,n)=>(Ee(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s);import{r as v,R as nt,c as y,j as m,M as pe,v as U,_ as F,e as H,Q as ot,f as it}from"./i8clt0mfz495j7ii.js";import{gM as at,cX as K,gL as A,s7 as ze,hR as ve,mA as rt,s8 as ct,nM as ae,gK as ye,wu as lt,vd as dt,mD as ut,wv as Ve,ww as Ne,o8 as ft,dK as mt,vb as gt,n as ht,wx as pt,wy as le,wz as te,w8 as vt,wA as bt,s2 as _t,sa as Mt,s5 as de,wB as St,wC as xt,wD as Ct,wE as yt}from"./j0yo6uv6652vva62.js";import{u as It,bN as be,kP as Tt,a as Ie,b7 as wt,as as qe,ff as Te,bO as N,bQ as Y,mO as At,J as Rt,dM as kt,t$ as Ge,hQ as we,o as O,L,u0 as Ae,k_ as Et,e1 as Vt,u1 as We,an as Nt,nY as _e,u2 as Me,kK as Ft,nZ as Se,co as ue,cn as Ot,dw as Lt,bT as se,bY as ne,du as Fe,bM as Oe,ce as Le,de as $t,bR as Dt,df as Pt,dv as Ut,iA as jt,u3 as Bt,u4 as He,n_ as zt,d as Z,b0 as xe,jH as qt,kv as $e,js as Gt,kS as Wt}from"./ghewn7l2ynbm32fm.js";import{A as Ht}from"./ejbyq0lrsu2qu7eg.js";import{a as Qt,C as Qe,W as Kt,V as Yt}from"./okk8l59g9pi0np0z.js";import{C as re}from"./bxgk09qvxvkate6l.js";import{d as De,e as W,h as Xt,m as Pe,t as Ue,r as fe,a as Ke,b as je,i as Be,c as Zt,u as Jt}from"./db2vbext8urnm82g.js";import{D as es,g as ts}from"./efcqr1k3spvze0uw.js";import{c as ss,i as ns,u as os,g as is,f as as,A as rs,b as cs}from"./h8pr5f6a9kp0y6hm.js";import{s as Ye,u as ls,B as ds,G as us,h as fs}from"./eosy1ymy279c5qnc.js";import"./i1vfxlpgdgslxqwx.js";import"./mzyl3pd4zxnxoe9i.js";import"./gy1lpvuoewmzh42c.js";import"./i03gut32e8jn5ajq.js";import"./h1em0bjkpkjv8ykw.js";import"./nfccle6oyncifphl.js";import"./hu1bt0oauegdhua6.js";import"./iiok29s29bpdre61.js";const ms=({clientThreadId:t})=>{"use no forget";const e=It(),s=be(e,t),n=Tt(),o=Ie(()=>kt(s).id),{setValue:i}=at(wt.VoiceName),a=qe(e),r=Te(t),c=r!=null?r:t;return v.useEffect(()=>{const l=sessionStorage.getItem("selectedVoiceName");if(l&&a){i(l);try{sessionStorage.removeItem("selectedVoiceName");const d={voice:l,conversation_id:void 0,eventSource:"login_page",voice_mode:"advanced",clientThreadId:At(),gizmo_id:N.getGizmoId(Y(c)),requested_default_model:o!=null?o:void 0,skipCacheReason:"login-direct-to-voice-mode"};K({type:"START",args:d})}catch(d){Rt.addError("Failed to start voice mode after voice picker: ".concat(d),{protocol:n})}}},[c,a,o,n,i]),null};function gs(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[n,o]of t)if(!Object.is(o,e.get(n)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!1;for(const n of s)if(!Object.prototype.hasOwnProperty.call(e,n)||!Object.is(t[n],e[n]))return!1;return!0}const{useRef:hs}=nt;function Xe(t){const e=hs();return s=>{const n=t(s);return gs(e.current,n)?e.current:e.current=n}}function ps(t){return t===ss.LOST}const vs=t=>{"use forget";const e=y.c(13),{clientThreadId:s}=t,n=Te(s),o=A(bs),{voiceName:i}=ze(),[a,r]=v.useState(!1),{connectionState:c,voiceConnectionQuality:l,hasConnectedOnce:d}=A(Xe(_s)),u=Ge();let f;e[0]!==s||e[1]!==n||e[2]!==o||e[3]!==i?(f=async()=>{r(!0),await ve(async()=>{const w={conversation_id:n,eventSource:"lost_connection_hint_message",voice_mode:o,voice:i,clientThreadId:s,gizmo_id:N.getGizmoId(Y(s)),skipCacheReason:"lost-connection-retry",forceDisconnect:!0};await K({type:"STOP",reason:es.Failed}),await K({type:"START",args:w})},Ms,()=>{r(!1)})},e[0]=s,e[1]=n,e[2]=o,e[3]=i,e[4]=f):f=e[4];const g=f;let h;e[5]===Symbol.for("react.memo_cache_sentinel")?(h=m.jsx(pe,{id:"QaPbww",defaultMessage:"Lost connection."}),e[5]=h):h=e[5];let p;e[6]===Symbol.for("react.memo_cache_sentinel")?(p=m.jsx("strong",{children:m.jsx(pe,{id:"oyHr3m",defaultMessage:"Retry"})}),e[6]=p):p=e[6];let S;e[7]!==g?(S=m.jsxs("div",{className:"inline-flex items-center",children:[h,m.jsx("button",{onClick:g,className:"ms-1",children:p})]}),e[7]=g,e[8]=S):S=e[8];const b=S;let _;e:{if(!d||a||u){_=!1;break e}else if(c!==re.Connected){_=!0;break e}else if(ps(l)){_=!0;break e}_=!1}const x=_;let M,I;return e[9]!==x||e[10]!==b?(M=()=>{x?De.set({id:U(),hintMessage:b,modalMessage:null}):De.set(W())},I=[x,b],e[9]=x,e[10]=b,e[11]=M,e[12]=I):(M=e[11],I=e[12]),v.useEffect(M,I),null};function bs(t){return t.voiceMode}function _s(t){return{connectionState:t.server.connectionState,voiceConnectionQuality:t.server.voiceConnectionQuality,hasConnectedOnce:t.hasConnectedOnce}}function Ms(t){const e=t instanceof Error?t.message:String(t);we.voiceMode.error({error:e,eventSource:"lost_connection_hint_message"})}const Ss=O(()=>F(()=>import("./gsas8pb1acnf7jnd.js").then(t=>t._),__vite__mapDeps([0,1])),{loading:t=>L(t)}),xs=()=>{"use forget";const t=y.c(10),e=H(),{type:s,granted:n}=Ae();let o;t[0]===Symbol.for("react.memo_cache_sentinel")?(o=Et()&&Vt,t[0]=o):o=t[0];const i=o,a=s==="requested"&&!n;let r;t[1]!==e?(r=e.formatMessage(me.hint),t[1]=e,t[2]=r):r=t[2];const c=r;let l;t[3]!==c?(l=i?m.jsxs("a",{href:"ms-settings:privacy-microphone",className:Xt,children:[c,m.jsx(Ss,{className:"icon-sm ms-1"})]}):c,t[3]=c,t[4]=l):l=t[4];const d=l;let u,f;return t[5]!==d||t[6]!==e||t[7]!==a?(u=()=>{a?Pe.set({id:U(),hintMessage:d,modalMessage:{title:e.formatMessage(me.title),description_markdown:e.formatMessage(me.description_markdown),buttons:[]}}):Pe.set(W())},f=[a,e,d],t[5]=d,t[6]=e,t[7]=a,t[8]=u,t[9]=f):(u=t[8],f=t[9]),v.useEffect(u,f),null},me={hint:{id:"micMessages.hint",defaultMessage:"Enable microphone access in Settings",description:"Hint to the user to manually enable microphone access for voice mode"},title:{id:"micMessages.title",defaultMessage:"Microphone access required",description:"Title for modal that informs the user that microphone access is required for voice mode"},description_markdown:{id:"micMessages.description_markdown",defaultMessage:"To use voice mode, you'll need to enable your microphone and try again.",description:"Description for modal that informs the user that microphone access is required for voice mode"}},Cs=O(()=>F(()=>import("./nlen9u31md3gmt0q.js").then(t=>t._),__vite__mapDeps([2,1])),{loading:t=>L(t)}),ys=()=>{"use forget";const t=y.c(8),e=A(Is);let s;if(e){let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a=m.jsx(Cs,{className:"icon-sm me-1"}),t[0]=a):a=t[0];let r;t[1]!==e.text?(r=m.jsxs("div",{className:"flex items-center",children:[a,e.text]}),t[1]=e.text,t[2]=r):r=t[2],s=r}else s=null;const n=s;let o;t[3]!==n?(o=()=>{n?Ue.set({id:U(),hintMessage:n,modalMessage:null}):Ue.set(W())},t[3]=n,t[4]=o):o=t[4];let i;return t[5]!==n||t[6]!==e?(i=[e,n],t[5]=n,t[6]=e,t[7]=i):i=t[7],v.useEffect(o,i),null};function Is(t){return t.server.toolUpdate}const Ts=()=>{"use forget";var l;const t=y.c(8),e=A(ws);let s;t[0]!==(e==null?void 0:e.rate_limit_message)?(s=(l=e==null?void 0:e.rate_limit_message)!=null?l:{},t[0]=e==null?void 0:e.rate_limit_message,t[1]=s):s=t[1];const{reaching_limit_disclosure:n,exceed_limit_message:o}=s;let i,a;t[2]!==n?(i=()=>{if(n){const d=fe().hintMessage;if(n.hint===d)return;fe.set({id:U(),hintMessage:n.hint,modalMessage:{title:n.title,description_markdown:n.message_markdown,buttons:n.buttons}})}else fe.set(W())},a=[n],t[2]=n,t[3]=i,t[4]=a):(i=t[3],a=t[4]),v.useEffect(i,a);let r,c;return t[5]!==o?(r=()=>{if(o){Ke.set({id:U(),hintMessage:o.title,modalMessage:{title:o.title,description_markdown:o.description_markdown,buttons:o.buttons}});const d=o.buttons.some(As),u=o.buttons.some(Rs);we.rateLimitReached.success({upgrade_to_plus:d,upgrade_to_pro:u})}},c=[o],t[5]=o,t[6]=r,t[7]=c):(r=t[6],c=t[7]),v.useEffect(r,c),null};function ws(t){return t.server.usage}function As(t){return t.action==="upgrade_to_plus"}function Rs(t){return t.action==="upgrade_to_pro"}const ks=()=>{"use forget";const t=y.c(9),e=rt();let s;t[0]!==(e==null?void 0:e.default_voice_mode)||t[1]!==(e==null?void 0:e.modes)?(s=e==null?void 0:e.modes.find(d=>d.mode===(e==null?void 0:e.default_voice_mode)),t[0]=e==null?void 0:e.default_voice_mode,t[1]=e==null?void 0:e.modes,t[2]=s):s=t[2];const n=s,o=n==null?void 0:n.disclosure_message,i=n==null?void 0:n.info_message;let a,r;t[3]!==o?(a=()=>{o?je.set({id:U(),hintMessage:o.hint,modalMessage:{title:o.title,description_markdown:o.message_markdown,buttons:o.buttons}}):je.set(W())},r=[o],t[3]=o,t[4]=a,t[5]=r):(a=t[4],r=t[5]),v.useEffect(a,r);let c,l;return t[6]!==i?(c=()=>{i?Be.set({id:U(),hintMessage:i.title,modalMessage:{title:i.title,description_markdown:i.message_markdown,buttons:i.buttons}}):Be.set(W())},l=[i],t[6]=i,t[7]=c,t[8]=l):(c=t[7],l=t[8]),v.useEffect(c,l),null},Es=t=>{"use forget";const e=y.c(9),{clientThreadId:s}=t;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=[],e[0]=n):n=e[0],v.useEffect(Ns,n);let o;e[1]!==s?(o=m.jsx(vs,{clientThreadId:s}),e[1]=s,e[2]=o):o=e[2];let i,a,r,c;e[3]===Symbol.for("react.memo_cache_sentinel")?(i=m.jsx(xs,{}),a=m.jsx(ys,{}),r=m.jsx(Ts,{}),c=m.jsx(ks,{}),e[3]=i,e[4]=a,e[5]=r,e[6]=c):(i=e[3],a=e[4],r=e[5],c=e[6]);let l;return e[7]!==o?(l=m.jsxs(m.Fragment,{children:[o,i,a,r,c]}),e[7]=o,e[8]=l):l=e[8],l};function Vs(){Zt()}function Ns(){return Vs}const Fs=()=>{"use forget";const t=y.c(11),{permissionsRequested:e,requestMicrophonePermissions:s,userDeclinedMicrophonePermissions:n,microphoneAvailable:o,microphoneLabel:i}=ct(),{active:a,forceMuted:r}=A(Xe(Os));let c,l;t[0]!==a||t[1]!==r||t[2]!==o||t[3]!==i||t[4]!==e||t[5]!==n?(c=()=>{e&&We.set({type:"requested",granted:o,active:a,forceMuted:r,label:!n&&i?i:""})},l=[n,o,i,e,a,r],t[0]=a,t[1]=r,t[2]=o,t[3]=i,t[4]=e,t[5]=n,t[6]=c,t[7]=l):(c=t[6],l=t[7]),v.useEffect(c,l);let d,u;return t[8]!==s?(d=()=>(s(),Ls),u=[s],t[8]=s,t[9]=d,t[10]=u):(d=t[9],u=t[10]),v.useEffect(d,u),null};function Os(t){var e,s;return{active:!!((e=t.dev.room)!=null&&e.localParticipant.isMicrophoneEnabled),forceMuted:!!((s=t.dev.room)!=null&&s.localParticipant.isMicrophoneForceMuted)}}function Ls(){We.set({type:"unrequested",granted:!1,active:!1,forceMuted:!1,label:""})}const $s="/assets/hangup_0db-gkj9zamd.ogg";let B=null;function Ds(){try{B?(B.pause(),B.currentTime=0):(B=new Audio($s),B.volume=1),B.play()}catch(t){ae.debug("Failed to play hangup sound",t)}}function Ps(){const t=ye(),{room:e}=ns();return async s=>{e&&await lt({room:e,voiceStore:t,event:{type:ut.RelayMessage,payload:{type:dt.RelayMessage,message:s}}})}}function Us({clientThreadId:t,parentMessageId:e,prependMessages:s,promptMessage:n,appendMessages:o,intl:i}){const a=t.startsWith("WEB:"),r=new Bs({ctx:Nt(),clientThreadId:t,isHistoryAndTrainingDisabled:!1,isFirstCompletionInThread:a,queryClient:new ot,isSnorlaxEnabledForGizmo:!1,intl:i});r.startOrContinueConversation({parentMessageId:e,prependMessages:s,promptMessage:n,appendMessages:o}),_e.set(r),Me.set(!1)}function js(){Ft(()=>{const t=_e();t==null||t.endCompletion(),_e.set(null),Se.set(null)})}class Bs{constructor({ctx:e,clientThreadId:s,isHistoryAndTrainingDisabled:n,isFirstCompletionInThread:o,queryClient:i,isSnorlaxEnabledForGizmo:a,intl:r}){T(this,"messageIdsReceived",[]);T(this,"fullChatMessageStreaming",!1);T(this,"ctx");T(this,"clientThreadId");T(this,"isHistoryAndTrainingDisabled");T(this,"isFirstCompletionInThread");T(this,"queryClient");T(this,"isSnorlaxEnabledForGizmo");T(this,"intl");T(this,"messagesToUpdate",{});T(this,"allIncompleteMessageIds",new Set);T(this,"responseThreadId");T(this,"treatCompletionAsAsync",!1);T(this,"placeholderNodeId");T(this,"debouncedUpdateExistingMessages",Ut(()=>{const e=Object.values(this.messagesToUpdate);e.length!==0&&(se(this.clientThreadId,s=>{ne.updateTree(s,n=>{for(const o of e)n.updateNodeMessage(o.id,o),o.status!=="in_progress"&&(n.updateNodeMetadata(o.id,{completionSampleFinishTime:Date.now()}),this.allIncompleteMessageIds.delete(o.id))})}),this.messagesToUpdate={})},50,{leading:!0,maxWait:50}));this.ctx=e,this.clientThreadId=s,this.isHistoryAndTrainingDisabled=n,this.isFirstCompletionInThread=o,this.queryClient=i,this.isSnorlaxEnabledForGizmo=a,this.intl=r}handleMessage({message:e,conversationId:s}){this.messageIdsReceived.includes(e.id)||this.messageIdsReceived.push(e.id);const n=this.messageIdsReceived.indexOf(e.id);if(n!==-1&&e.metadata){const o=this.messageIdsReceived[n-1];e.metadata.parent_id=o}if(e.author.role===ue.User&&e.content.content_type===Ot.MultimodalText&&e.content.parts.length===0&&(e.content.parts=[{content_type:Lt.AudioTranscription,text:this.intl.formatMessage({id:"voice-completion-request.transcribing",defaultMessage:"Transcribing…"}),direction:"in"}]),N.getTree(Y(s)).containsNodeOrMessageId(e.id)){this.messagesToUpdate[e.id]=e,this.debouncedUpdateExistingMessages();return}this.debouncedUpdateExistingMessages.flush(),se(this.clientThreadId,o=>{ne.updateTree(o,(i,a)=>{var d;const r={requestId:e.id};e.status!=="in_progress"?r.completionSampleFinishTime=Date.now():this.allIncompleteMessageIds.add(e.id);const c=ee(R({},e),{clientMetadata:r}),l=(d=e.metadata)==null?void 0:d.parent_id;if(l){if(this.placeholderNodeId&&i.getParent(this.placeholderNodeId).id===i.getNodeByIdOrMessageId(l).id)if(Fe(c)){i.prependNode(this.placeholderNodeId,c);return}else i.deleteNode(this.placeholderNodeId),this.placeholderNodeId=void 0;return i.addMessageNode(l,c)}else{const u=i.findFirst(f=>!Fe(f.message));if(u)i.prependNode(u.id,c);else return i.addMessageNode(a,c)}})})}beginAssistantResponse(){Ve.set(be(this.ctx,this.clientThreadId),!0),Ne(this.clientThreadId,{source:Le.CLIENT,value:Oe.STREAMING}),Me.set(!0)}addOptimisticUserMessages({parentMessageId:e,promptMessage:s}){this.beginAssistantResponse(),this.messageIdsReceived.push(s.id),se(this.clientThreadId,n=>{ne.updateTree(n,(o,i)=>(e&&(i=N.getNode(n,e).id),s&&(r=>{o.containsNodeOrMessageId(r.id)||(r.clientMetadata=ee(R({},r.clientMetadata),{isOptimistic:!0}),i=o.addMessageNode(i,r))})(s),i))})}startOrContinueConversation({parentMessageId:e,prependMessages:s,promptMessage:n,appendMessages:o}){se(this.clientThreadId,i=>{ne.updateTree(i,(a,r)=>{if(e&&(r=N.getNode(i,e).id),s)for(const c of s)r=a.addMessageNode(r,c);if(n&&(r=a.addMessageNode(r,n)),o)for(const c of o)r=a.addMessageNode(r,c);return r})})}endAssistantResponse(){Ve.set(be(this.ctx,this.clientThreadId),!1),Ne(this.clientThreadId,{source:Le.CLIENT,value:Oe.UNREAD}),Me.set(!1)}handleConversationUpdate(e){if(this.responseThreadId===void 0){const s=e;this.responseThreadId=s;const n=$t(this.clientThreadId),o=Dt(this.clientThreadId)!==s;if(ae.debug("Init new thread",{isNewClientThread:n,responseHasServerThreadId:o}),n&&o&&Pt(this.ctx,this.clientThreadId,s),this.isFirstCompletionInThread){const i=Y(this.clientThreadId);!this.isHistoryAndTrainingDisabled&&ft(i==null?void 0:i.mode)&&qe(this.ctx)&&(mt(this.queryClient,N.getGizmoId(i)),i!=null&&i.disableConversationNavigation||gt(ht,this.queryClient,s,this.isSnorlaxEnabledForGizmo))}}}handleResponse(e){const s=e.message.author,n=e.message.status;(s.role===ue.Assistant||s.role===ue.Tool)&&(n==="in_progress"&&!this.fullChatMessageStreaming?(this.fullChatMessageStreaming=!0,this.beginAssistantResponse()):n!=="in_progress"&&this.fullChatMessageStreaming&&(this.fullChatMessageStreaming=!1,this.endAssistantResponse())),this.responseThreadId===void 0&&e.conversationId&&this.handleConversationUpdate(e.conversationId),this.handleMessage({message:e.message,conversationId:this.clientThreadId})}endCompletion(){this.fullChatMessageStreaming&&this.endAssistantResponse()}}const zs=t=>{"use forget";const e=y.c(20),{clientThreadId:s}=t,n=pt(),o=ye(),i=H(),a=A(qs);let r;e[0]!==s?(r={conversationId:s},e[0]=s,e[1]=r):r=e[1];const c=Qt(r),l=jt(),d=A(Gs),u=Ps(),f=Bt();let g,h;e[2]!==s||e[3]!==i||e[4]!==n||e[5]!==o?(g=()=>{if((n==null?void 0:n.command.type)==="START"){const x=n.command.oldConversationId;if(x&&x===s||!le(n.id))return;Ye.set(n.command.args),o.setState(M=>(M.isVoiceModeActive=!0,M.conversationId=s,M)),He.set(!0),Us({clientThreadId:s,intl:i}),te(n.id)}},h=[s,i,n,o],e[2]=s,e[3]=i,e[4]=n,e[5]=o,e[6]=g,e[7]=h):(g=e[6],h=e[7]),v.useEffect(g,h);let p,S;e[8]!==c||e[9]!==l||e[10]!==n?(p=()=>{if((n==null?void 0:n.command.type)==="STOP"&&le(n.id)){if(!l)return te(n.id);zt.set(!0);const x=n.command.reason;ve(async()=>{await c(x)},Ws,()=>{js(),Ds(),vt(),te(n.id)})}},S=[c,l,n],e[8]=c,e[9]=l,e[10]=n,e[11]=p,e[12]=S):(p=e[11],S=e[12]),v.useEffect(p,S);let b,_;return e[13]!==a||e[14]!==n||e[15]!==u||e[16]!==d||e[17]!==f?(b=()=>{if((n==null?void 0:n.command.type)==="RELAY"&&a===re.Connected&&d&&f&&le(n.id)){const{id:x,command:M}=n,{message:I,parentMessageId:w}=M;ve(async()=>{f.addOptimisticUserMessages({parentMessageId:w,promptMessage:I}),await u(I)},Hs,()=>{te(x)})}},_=[a,n,u,d,f],e[13]=a,e[14]=n,e[15]=u,e[16]=d,e[17]=f,e[18]=b,e[19]=_):(b=e[18],_=e[19]),v.useEffect(b,_),null};function qs(t){return t.server.connectionState}function Gs(t){return t.server.relayReady}function Ws(t){ae.error("Error exiting voice state",t)}function Hs(t){ae.error("Error relaying message",t)}const Qs=t=>{"use forget";const e=y.c(9),{clientThreadId:s}=t,{startVoiceMode:n}=os(),o=Te(s),i=v.useRef(!1),{granted:a}=Ae(),r=ls(),{voiceName:c}=ze(),l=bt(s);let d,u;return e[0]!==s||e[1]!==a||e[2]!==l||e[3]!==o||e[4]!==n||e[5]!==r||e[6]!==c?(d=()=>{var f;if(!i.current&&a){i.current=!0;const g=Y(s);let h;r!==void 0?(h=r,Ye.set(void 0)):(h=is({serverThreadId:o,parentMessageId:(f=N.getCurrentNode(g))==null?void 0:f.id,isAdvancedMode:!0,eventSource:"integrated_ux_composer_speech_button",clientThreadId:s,gizmoId:N.getGizmoId(g)}),we.voiceSessionStarted.click({voice:c}),h.requested_default_model=l!=null?l:void 0),n(h)}},u=[s,a,l,o,n,r,c],e[0]=s,e[1]=a,e[2]=l,e[3]=o,e[4]=n,e[5]=r,e[6]=c,e[7]=d,e[8]=u):(d=e[7],u=e[8]),v.useEffect(d,u),null};var z,X,k,q,G,D,P,oe;const ie=class ie{constructor(e,s){E(this,z);E(this,X);E(this,k);E(this,q,[]);E(this,G,{});E(this,D);E(this,P);V(this,k,e);const n=e.getUniformBlockIndex(s,C(ie,oe)),o=e.getActiveUniformBlockParameter(s,n,e.UNIFORM_BLOCK_DATA_SIZE);V(this,D,e.createBuffer()),e.bindBuffer(e.UNIFORM_BUFFER,C(this,D)),e.bufferData(e.UNIFORM_BUFFER,o,e.DYNAMIC_DRAW);const i=0;e.bindBufferBase(e.UNIFORM_BUFFER,i,C(this,D)),e.uniformBlockBinding(s,n,i);const a=e.getActiveUniformBlockParameter(s,n,e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES);V(this,q,[]),V(this,G,{});for(let r=0;r<a.length;r++){const c=a[r];if(c==null)continue;const l=e.getActiveUniform(s,c);if(!l)throw new Error("No uniformInfo for index "+c);let d=l.name;d=d.replace(/\[0\]$/,"");const u=e.getActiveUniforms(s,[c],e.UNIFORM_OFFSET),f=Array.isArray(u)&&u.length>0?u[0]:0;C(this,q).push(d),C(this,G)[d]=f}V(this,P,new ArrayBuffer(o)),V(this,z,new Float32Array(C(this,P))),V(this,X,new Int32Array(C(this,P)))}setVariablesAndRender(e){for(const s of C(this,q)){const[,n]=s.split("."),i=C(this,G)[s]/4,a=e[n];typeof a=="number"?C(this,z)[i]=a:typeof a=="boolean"?C(this,X)[i]=a?1:0:Array.isArray(a)&&C(this,z).set(a,i)}C(this,k).bindBuffer(C(this,k).UNIFORM_BUFFER,C(this,D)),C(this,k).bufferSubData(C(this,k).UNIFORM_BUFFER,0,C(this,P)),C(this,k).drawArrays(C(this,k).TRIANGLE_STRIP,0,6)}};z=new WeakMap,X=new WeakMap,k=new WeakMap,q=new WeakMap,G=new WeakMap,D=new WeakMap,P=new WeakMap,oe=new WeakMap,E(ie,oe,"BlorbUniformsObject");let Ce=ie;var Ks="#version 300 es\n#define E (2.71828182846)\n#define pi (3.14159265358979323844)\n\nprecision highp float;\n\nstruct ColoredSDF {\n  float distance;\n  vec4 color;\n};\n\nstruct SDFArgs {\n  vec2 st;\n  float amount;\n  float duration;\n  float time;\n  float mainRadius;\n};\n\n/* ----------------------- Utilities actually used ----------------------- */\n\nfloat scaled(float edge0, float edge1, float x) {\n  return clamp((x - edge0) / (edge1 - edge0), float(0), float(1));\n}\n\nfloat spring(float t, float d) {\n  return 1.0 - exp(-E * 2.0 * t) * cos((1.0 - d) * 115.0 * t);\n}\n\nfloat bounce(float t, float d) {\n  return -sin(pi * (1.0 - d) * t) * (1.0 - t) * exp(-E * 2.0 * t) * t * 10.0;\n}\n\nfloat opSmoothUnion(float d1, float d2, float k) {\n  if (k <= 0.0) k = 0.000001;\n  float h = clamp(0.5 + 0.5 * (d2 - d1) / k, 0.0, 1.0);\n  return mix(d2, d1, h) - k * h * (1.0 - h);\n}\n\nfloat sdRoundedBox(vec2 p, vec2 b, vec4 r) {\n  r.xy = p.x > 0.0 ? r.xy : r.zw;\n  r.x = p.y > 0.0 ? r.x : r.y;\n  vec2 q = abs(p) - b + r.x;\n  return min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - r.x;\n}\n\n/* --------------------------- Active states ----------------------------- */\n\nColoredSDF applyIdleState(\n  ColoredSDF sdf,\n  SDFArgs args,\n  bool isWhiteForeground\n) {\n  float midRadius = 0.12;\n  float maxRadius = 0.3;\n  float t1 = 1.0;\n  float gamma = 3.0;\n  float omega = pi / 2.0;\n\n  float k = exp(-gamma) * omega;\n\n  float radius;\n  if (args.time <= t1) {\n    float t_prime = args.time / t1;\n    float springValue = 1.0 - exp(-gamma * t_prime) * cos(omega * t_prime);\n    radius = midRadius * springValue;\n  } else {\n    float adjustedTime = args.time - t1;\n    radius =\n      midRadius + (maxRadius - midRadius) * (1.0 - exp(-k * adjustedTime));\n  }\n\n  float distance = length(args.st) - radius;\n  sdf.distance = mix(sdf.distance, distance, args.amount);\n\n  \n  float alpha = sin(pi / 0.7 * args.time) * 0.3 + 0.7;\n  vec4 color = vec4(isWhiteForeground ? vec3(1.0) : vec3(0.0), alpha);\n  sdf.color = mix(sdf.color, color, args.amount);\n\n  return sdf;\n}\n\nColoredSDF applySpeakState(\n  ColoredSDF sdf,\n  SDFArgs args,\n  vec4 avgMag,\n  float silenceAmount,\n  float silenceDuration\n) {\n  float d = 1000.0;\n  const int barCount = 4;\n\n  float totalSpan = args.mainRadius * 1.9;\n  float slotWidth = totalSpan / float(barCount);\n  float gapRatio = clamp(0.35, 0.0, 0.9);\n  float baseBarHalfWidth = slotWidth * (1.0 - gapRatio) * 0.5;\n\n  for (int i = 0; i < barCount; i++) {\n    float f = (float(i) + 0.5) / float(barCount);\n\n    float w = baseBarHalfWidth;\n    float h = w;\n\n    float wave = sin(f * pi * 0.8 + args.time) * 0.5 + 0.5;\n    float entryAnimation = spring(\n      scaled(0.1 + wave * 0.4, 1.0 + wave * 0.4, args.duration),\n      0.98\n    );\n\n    vec2 pos = vec2(f - 0.5, 0.0) * totalSpan;\n    pos.y = 0.25 * (1.0 - entryAnimation);\n\n    \n    if (silenceAmount > 0.0) {\n      float bounceStagger = f / 5.0;\n      float bounceDelay = 0.6;\n      float bounceTimer = scaled(\n        bounceDelay,\n        bounceDelay + 1.0,\n        fract((silenceDuration + bounceStagger) / 2.0) * 2.0\n      );\n      pos.y +=\n        bounce(bounceTimer, 6.0) *\n        w *\n        0.25 *\n        silenceAmount *\n        pow(entryAnimation, 4.0) *\n        pow(args.amount, 4.0);\n    }\n\n    \n    h += avgMag[i] * (0.1 + (1.0 - abs(f - 0.5) * 2.0) * 0.1);\n\n    float dd = sdRoundedBox(args.st - pos, vec2(w, h), vec4(w));\n    d = opSmoothUnion(d, dd, 0.2 * (1.0 - args.amount));\n  }\n\n  sdf.distance = mix(sdf.distance, d, args.amount);\n  sdf.color.a = 1.0;\n  return sdf;\n}\n\n/* ------------------------------ I/O & UBO ------------------------------ */\n\nin vec2 out_uv;\nout vec4 fragColor;\n\nlayout(std140) uniform BlorbUniformsObject {\n  float time;\n  float speakTimestamp;\n  vec4 avgMag;\n  vec2 viewport;\n  float screenScaleFactor;\n  float silenceAmount;\n  float silenceTimestamp;\n  bool isWhiteForeground;\n} ubo; \n\n/* -------------------------------- main --------------------------------- */\n\nvoid main() {\n  vec2 st = out_uv - 0.5;\n  float viewRatio = ubo.viewport.y / ubo.viewport.x;\n  st.y *= viewRatio;\n\n  ColoredSDF sdf;\n  sdf.distance = 1000.0;\n  sdf.color = vec4(1.0);\n\n  SDFArgs args;\n  args.st = st;\n  args.time = ubo.time;\n  args.mainRadius = 0.49;\n  args.amount = 1.0;\n  args.duration = ubo.time - ubo.speakTimestamp;\n\n  \n  SDFArgs idleArgs = args;\n  idleArgs.amount = 1.0;\n  sdf = applyIdleState(sdf, idleArgs, ubo.isWhiteForeground);\n\n  float silenceDuration = ubo.time - ubo.silenceTimestamp;\n  sdf = applySpeakState(\n    sdf,\n    args,\n    ubo.avgMag,\n    ubo.silenceAmount,\n    silenceDuration\n  );\n\n  float clampingTolerance = 0.0075 / max(ubo.screenScaleFactor, 0.0001);\n  float clampedShape = smoothstep(clampingTolerance, 0.0, sdf.distance);\n  float alpha = sdf.color.a * clampedShape;\n  fragColor = vec4(sdf.color.rgb * alpha, alpha);\n}",Ys="#version 300 es\n\nout vec4 out_position;\nout vec2 out_uv;\n\nconst vec4 blitFullscreenTrianglePositions[6] = vec4[](\n  vec4(-1.0, -1.0, 0.0, 1.0),\n  vec4(3.0, -1.0, 0.0, 1.0),\n  vec4(-1.0, 3.0, 0.0, 1.0),\n  vec4(-1.0, -1.0, 0.0, 1.0),\n  vec4(3.0, -1.0, 0.0, 1.0),\n  vec4(-1.0, 3.0, 0.0, 1.0)\n);\n\nvoid main() {\n  out_position = blitFullscreenTrianglePositions[gl_VertexID];\n  out_uv = out_position.xy * 0.5 + 0.5;\n  out_uv.y = 1.0 - out_uv.y;\n  gl_Position = out_position;\n}";const Xs=[300,300];function Zs({className:t,staticConfig:e,onDynamicConfigSetterReady:s}){"use no forget";const n=v.useRef(performance.now()/1e3),o=v.useRef({viewport:Xs,time:n.current}).current,i=v.useRef(void 0),a=v.useRef(ee(R(R({},o),e),{speakTimestamp:0,avgMag:[0,0,0,0],silenceAmount:0,silenceTimestamp:0})),r=v.useCallback(l=>{a.current=R(R(R({},o),e),l),i.current=l},[o,e]);v.useEffect(()=>{i.current&&(a.current=R(R(R({},o),e),i.current))},[e,o]),v.useEffect(()=>{s(r)},[s,r]);const c=l=>{o.viewport=[l.width,l.height]};return v.useEffect(()=>{const l=setInterval(()=>{o.time=performance.now()/1e3},ds);return()=>clearInterval(l)},[o]),m.jsx(us,{className:Z("flex items-center justify-center",t),variablesRef:a,onViewportUpdate:c,onGlAvailable:void 0,onCanvasSizeUpdate:void 0,scale:1,GLUniformsSetter:Ce,vert:Ys,frag:Ks})}const Js=1.4,en={bands:4,loPass:0,hiPass:400},tn=t=>{"use forget";const e=y.c(12),{className:s}=t,[n,o]=v.useState(void 0),{getTracks:i}=as();let a;e[0]!==i?(a=i([rs.Microphone]).find(sn),e[0]=i,e[1]=a):a=e[1];const r=a,c=fs(r==null?void 0:r.track,en);let l;e[2]!==c?(l=c.map(nn),e[2]=c,e[3]=l):l=e[3];const d=l;let u,f;e[4]!==d||e[5]!==n?(u=()=>{n&&n({speakTimestamp:0,avgMag:d,silenceAmount:0,silenceTimestamp:0})},f=[d,n],e[4]=d,e[5]=n,e[6]=u,e[7]=f):(u=e[6],f=e[7]),v.useEffect(u,f);let g;e[8]===Symbol.for("react.memo_cache_sentinel")?(g={screenScaleFactor:window.devicePixelRatio,isWhiteForeground:!0},e[8]=g):g=e[8];const h=g;let p;e[9]===Symbol.for("react.memo_cache_sentinel")?(p=_=>{o(()=>_)},e[9]=p):p=e[9];const S=p;let b;return e[10]!==s?(b=m.jsx(Zs,{className:s,staticConfig:h,onDynamicConfigSetterReady:S}),e[10]=s,e[11]=b):b=e[11],b};function sn(t){return t.origin==="local"}function nn(t){return t*Js}const on=O(()=>F(()=>import("./tgmagak4qrebhl4h.js").then(t=>t._),__vite__mapDeps([3,1])),{loading:t=>L(t)}),Q={buttonLayout:"rounded-full overflow-hidden h-9 px-3",buttonContents:"flex flex-row items-center justify-center gap-2",buttonColors:"hover:opacity-80 font-semibold transition-colors transition-width duration-500 ease-in-out",loadingColor:"bg-token-icon-primary text-token-text-inverted px-0",loadedColor:"bg-token-bg-accent-static text-token-text-inverted-static"},an=t=>{"use forget";const e=y.c(7),{className:s,Icon:n}=t;let o;e[0]!==s?(o=Z(s,"relative"),e[0]=s,e[1]=o):o=e[1];let i;e[2]!==n?(i=m.jsx(n,{className:"absolute start-1/2 top-1/2 h-5 w-5 -translate-x-1/2 -translate-y-1/2"}),e[2]=n,e[3]=i):i=e[3];let a;return e[4]!==o||e[5]!==i?(a=m.jsx("div",{className:o,children:i}),e[4]=o,e[5]=i,e[6]=a):a=e[6],a},rn=t=>{"use forget";const e=y.c(21),{onClick:s}=t,n=A(cn),o=H(),i=Ge(),a=Ie(ln),r=(a==null?void 0:a.id)!=null,[c,l]=v.useState(!1);let d,u;i?(d=xe,u=$.endingVoiceSessionLabel):n&&!r?(d=c?on:xe,u=c?$.cancelLoadingAriaLabel:$.startingVoiceAriaLabel):(d=tn,u=$.endVoiceAriaLabel);let f;e[0]!==d?(f=m.jsx(an,{Icon:d,className:"h-3 w-3"}),e[0]=d,e[1]=f):f=e[1];let g;e[2]!==u||e[3]!==f?(g=[f,u],e[2]=u,e[3]=f,e[4]=g):g=e[4];const[h,p]=g;let S;i?S=$.endingVoiceSessionLabel:n&&!r?S=$.cancelLoadingButtonLabel:S=$.endVoiceButtonLabel;const b=S;let _,x;e[5]===Symbol.for("react.memo_cache_sentinel")?(_=()=>l(!0),x=()=>l(!1),e[5]=_,e[6]=x):(_=e[5],x=e[6]);let M;e[7]!==p||e[8]!==o?(M=o.formatMessage(p),e[7]=p,e[8]=o,e[9]=M):M=e[9];const I=n||i?Q.loadingColor:Q.loadedColor;let w;e[10]!==I?(w=Z(Q.buttonLayout,Q.buttonContents,Q.buttonColors,I),e[10]=I,e[11]=w):w=e[11];let j;e[12]!==b?(j=m.jsx(pe,R({},b)),e[12]=b,e[13]=j):j=e[13];let J;return e[14]!==h||e[15]!==i||e[16]!==s||e[17]!==M||e[18]!==w||e[19]!==j?(J=m.jsxs("button",{onMouseOver:_,onMouseOut:x,"aria-label":M,type:"button",className:w,onClick:s,disabled:i,children:[h,j]}),e[14]=h,e[15]=i,e[16]=s,e[17]=M,e[18]=w,e[19]=j,e[20]=J):J=e[20],J},$={endVoiceButtonLabel:{id:"integratedux.endVoiceMode",defaultMessage:"End",description:"Button label for ending voice mode"},cancelLoadingButtonLabel:{id:"integratedux.cancelLoading",defaultMessage:"Cancel",description:"Button label to cancel loading of voice mode"},endVoiceAriaLabel:{id:"integratedux.endVoiceAriaLabel",defaultMessage:"End voice mode",description:"Screen reader text that tells user that the button ends voice mode"},cancelLoadingAriaLabel:{id:"integratedux.cancelLoading",defaultMessage:"Cancel loading",description:"Screen reader text that tells user that the button cancels loading"},startingVoiceAriaLabel:{id:"integratedux.startingVoiceMode",defaultMessage:"Starting voice mode",description:"Screen reader text that tells users a loading state is in progress"},endingVoiceSessionLabel:{id:"integratedux.endingVoiceSession",defaultMessage:"Ending…",description:"Button label text telling the user that the process of ending the voice session is in progress"}};function cn(t){return t.server.connectionState!==re.Connected}function ln(){return Ke()}const dn={ON:{colorClass:"bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10",sizeClass:"max-h-9 max-w-9",iconColorClass:"text-token-main-surface-primary-inverse"},OFF:{colorClass:"bg-red-500/10 hover:bg-red-500/15 active:bg-red-500/20 dark:bg-red-500/10 dark:hover:bg-red-500/15 dark:active:bg-red-500/20",sizeClass:"max-h-9 max-w-9",iconColorClass:"text-danger"}},un={ON:{colorClass:"bg-gray-900 hover:bg-gray-800 active:bg-gray-700",sizeClass:"max-h-9 max-w-9",iconColorClass:"text-token-main-surface-primary"},OFF:{colorClass:"bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10",sizeClass:"max-h-9 max-w-9",iconColorClass:"text-token-main-surface-primary-inverse"}},fn=O(()=>F(()=>import("./b7nodduwb2cg7ocy.js").then(t=>t._),__vite__mapDeps([4,1])),{loading:t=>L(t)}),mn=O(()=>F(()=>import("./mkqbxg29rgkoa3dk.js").then(t=>t._),__vite__mapDeps([5,1])),{loading:t=>L(t)}),gn=t=>{"use forget";const e=y.c(15),{disabled:s,onClick:n,microphoneLabel:o,microphoneActive:i,microphoneForceMuted:a}=t,r=H(),c=i?mn:fn,{colorClass:l,sizeClass:d,iconColorClass:u}=dn[i?"ON":"OFF"];let f;e[0]!==r||e[1]!==i||e[2]!==a?(f=a?r.formatMessage(ge.microphoneMuted):i?r.formatMessage(ge.microphoneOff):r.formatMessage(ge.microphoneOn),e[0]=r,e[1]=i,e[2]=a,e[3]=f):f=e[3];const g=f;let h;e[4]!==l||e[5]!==d?(h=Z(l,d),e[4]=l,e[5]=d,e[6]=h):h=e[6];let p;return e[7]!==c||e[8]!==s||e[9]!==u||e[10]!==o||e[11]!==n||e[12]!==g||e[13]!==h?(p=m.jsx(Qe,{"aria-label":g,onClick:n,icon:c,iconSize:"icon-md",disabled:s,className:h,iconColor:u,tooltipPrimaryLabel:g,tooltipSecondaryLabel:o}),e[7]=c,e[8]=s,e[9]=u,e[10]=o,e[11]=n,e[12]=g,e[13]=h,e[14]=p):p=e[14],p},ge={microphoneMuted:{id:"integrated-ux.mute-button.microphone-muted",defaultMessage:"Microphone muted in system settings / hardware switch",description:"Tooltip label shown when the user's microphone is hardware disabled into a muted state, and the toggle will not work"},microphoneOff:{id:"integrated-ux.mute-button.microphone-off",defaultMessage:"Turn off microphone",description:"Tooltip shown when the microphone is on. Clicking the button for this tooltip mutes the microphone."},microphoneOn:{id:"integrated-ux.mute-button.microphone-on",defaultMessage:"Turn on microphone",description:"Tooltip shown when the microphone is off. Clicking this button for this tooltip unmutes the microphone."}},hn=()=>{"use forget";const t=y.c(6),{isMuting:e,toggleMute:s}=_t(),{disconnectPending:n}=cs(),{forceMuted:o,active:i,label:a,granted:r}=Ae(),c=e||n||o||!r,l=r&&i;let d;return t[0]!==o||t[1]!==a||t[2]!==c||t[3]!==l||t[4]!==s?(d=m.jsx(gn,{disabled:c,onClick:s,microphoneActive:l,microphoneForceMuted:o,microphoneLabel:a}),t[0]=o,t[1]=a,t[2]=c,t[3]=l,t[4]=s,t[5]=d):d=t[5],d},pn=O(()=>F(()=>import("./blk6dinhf69rm0e1.js").then(t=>t._),__vite__mapDeps([6,1])),{loading:t=>L(t)}),vn=O(()=>F(()=>import("./kag562m27rmlspt4.js").then(t=>t._),__vite__mapDeps([7,1])),{loading:t=>L(t)}),bn=t=>{"use forget";const e=y.c(14),{waiting:s,started:n,onClick:o}=t,i=H();let a;e[0]!==i||e[1]!==n||e[2]!==s?(a=s?i.formatMessage(he.screensharePending):n?i.formatMessage(he.screenshareOn):i.formatMessage(he.screenshareOff),e[0]=i,e[1]=n,e[2]=s,e[3]=a):a=e[3];const r=a,{colorClass:c,sizeClass:l,iconColorClass:d}=un[n?"ON":"OFF"],u=s?xe:n?vn:pn;let f;e[4]!==c||e[5]!==l?(f=Z(c,l),e[4]=c,e[5]=l,e[6]=f):f=e[6];let g;return e[7]!==u||e[8]!==d||e[9]!==o||e[10]!==r||e[11]!==f||e[12]!==s?(g=m.jsx(Qe,{"aria-label":r,onClick:o,disabled:s,icon:u,iconSize:"icon-md",className:f,iconColor:d}),e[7]=u,e[8]=d,e[9]=o,e[10]=r,e[11]=f,e[12]=s,e[13]=g):g=e[13],g},he={screenshareOff:{id:"integrated-ux.screenshare-button.screenshare-off",defaultMessage:"Activate screenshare",description:"Tooltip shown when the screenshare is off. Clicking the button for this tooltip activates the screenshare."},screenshareOn:{id:"integrated-ux.screenshare-button.screenshare-on",defaultMessage:"Turn off screenshare",description:"Tooltip shown when the screenshare is on. Clicking this button for this tooltip deactivates the screenshare."},screensharePending:{id:"integrated-ux.screenshare-button.pending",defaultMessage:"Pending screenshare activation",description:"Tooltip shown when the screenshare is pending"}},_n=()=>{"use forget";const t=y.c(7),{screenshareTrackState:e,toggleScreenShare:s}=Mt();let n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=[de.Starting,de.Stopping],t[0]=n):n=t[0];const o=n.includes(e),i=e===de.Started;let a;t[1]!==s?(a=()=>s("ControlButton"),t[1]=s,t[2]=a):a=t[2];let r;return t[3]!==i||t[4]!==a||t[5]!==o?(r=m.jsx(bn,{waiting:o,started:i,onClick:a}),t[3]=i,t[4]=a,t[5]=o,t[6]=r):r=t[6],r},Mn=t=>{"use forget";const e=y.c(15),{onComposerSubmit:s}=t,n=Jt(),o=qt();let i;e[0]!==o?(i=()=>Wt(o),e[0]=o,e[1]=i):i=e[1];const a=!Ie(i),r=$e(Gt.hasUploadInProgress),c=$e(Sn),l=a||r||c,d=A(xn);let u;e[2]!==d||e[3]!==n?(u=async()=>{const S=await ts({connectionState:d,isLimitExceeded:n});K({type:"STOP",reason:S})},e[2]=d,e[3]=n,e[4]=u):u=e[4];const f=u;let g;e[5]!==l?(g=!l&&m.jsxs(m.Fragment,{children:[m.jsx(Kt,{capability:"screenshare",children:m.jsx(_n,{})}),m.jsx(hn,{})]}),e[5]=l,e[6]=g):g=e[6];let h;e[7]!==o||e[8]!==l||e[9]!==f||e[10]!==s?(h=l?m.jsx(St,{onSubmit:s,composerController:o,isStreaming:!1,isDisabled:!1,showSpinner:!1}):m.jsx(rn,{onClick:f}),e[7]=o,e[8]=l,e[9]=f,e[10]=s,e[11]=h):h=e[11];let p;return e[12]!==g||e[13]!==h?(p=m.jsxs("div",{className:"flex flex-row gap-2",children:[g,h]}),e[12]=g,e[13]=h,e[14]=p):p=e[14],p};function Sn(t){return t.files.length>0}function xn(t){return t.server.connectionState}const Cn=O(()=>F(()=>import("./dw6rumxxn7eubhsq.js").then(t=>t._),__vite__mapDeps([8,1])),{loading:t=>L(t)}),yn=()=>{"use forget";const t=y.c(10),e=xt(),s=H();let n;t[0]!==s?(n=s.formatMessage(In.startVoiceMode),t[0]=s,t[1]=n):n=t[1];const o=n,i=ye();let a;t[2]!==e||t[3]!==i?(a=()=>{e?Ct(i):K({type:"START"})},t[2]=e,t[3]=i,t[4]=a):a=t[4];let r,c;t[5]===Symbol.for("react.memo_cache_sentinel")?(r={viewTransitionName:"var(--vt-composer-speech-button)"},c=m.jsx(Cn,{className:"h-5 w-5"}),t[5]=r,t[6]=c):(r=t[5],c=t[6]);let l;return t[7]!==o||t[8]!==a?(l=m.jsx("div",{className:"relative",children:m.jsx("button",{type:"button",onClick:a,"aria-label":o,className:"flex h-9 w-9 items-center justify-center rounded-full bg-black text-white transition-colors hover:opacity-70 focus-visible:outline-black focus-visible:outline-none disabled:text-[#f4f4f4] disabled:opacity-30 dark:bg-white dark:text-black dark:focus-visible:outline-white",style:r,children:c})}),t[7]=o,t[8]=a,t[9]=l):l=t[9],l},In=it({startVoiceMode:{id:"integratedux.startVoiceMode",defaultMessage:"Start voice mode"}}),Tn=t=>{"use forget";const e=y.c(33),{clientThreadId:s,isFocused:n,onComposerSubmit:o}=t,i=n===void 0?!1:n,a=A(wn),r=A(An),c=A(Rn),l=A(kn);let d,u;e[0]!==a?(d=()=>{He.set(a)},u=[a],e[0]=a,e[1]=d,e[2]=u):(d=e[1],u=e[2]),v.useEffect(d,u);let f,g;e[3]!==r||e[4]!==c||e[5]!==a?(f=()=>{a&&!r?Se.set(re.Connecting):Se.set(c)},g=[r,c,a],e[3]=r,e[4]=c,e[5]=a,e[6]=f,e[7]=g):(f=e[6],g=e[7]),v.useEffect(f,g);let h,p;e[8]!==s?(h=m.jsx(zs,{clientThreadId:s}),p=m.jsx(Qs,{clientThreadId:s}),e[8]=s,e[9]=h,e[10]=p):(h=e[9],p=e[10]);let S;e[11]===Symbol.for("react.memo_cache_sentinel")?(S=m.jsx(Fs,{}),e[11]=S):S=e[11];let b;e[12]!==s?(b=m.jsx(Es,{clientThreadId:s}),e[12]=s,e[13]=b):b=e[13];let _;e[14]!==s||e[15]!==i||e[16]!==o?(_=m.jsx(Mn,{clientThreadId:s,composerIsFocused:i,onComposerSubmit:o}),e[14]=s,e[15]=i,e[16]=o,e[17]=_):_=e[17];let x;e[18]!==s||e[19]!==_||e[20]!==h||e[21]!==p||e[22]!==b?(x=m.jsxs(Yt,{conversationId:s,executors:h,children:[p,S,b,_]}),e[18]=s,e[19]=_,e[20]=h,e[21]=p,e[22]=b,e[23]=x):x=e[23];let M;e[24]!==a?(M=!a&&m.jsx(yn,{}),e[24]=a,e[25]=M):M=e[25];let I;e[26]!==s||e[27]!==l?(I=l&&m.jsx(Ht,{conversationId:s}),e[26]=s,e[27]=l,e[28]=I):I=e[28];let w;return e[29]!==x||e[30]!==M||e[31]!==I?(w=m.jsxs(m.Fragment,{children:[x,M,I]}),e[29]=x,e[30]=M,e[31]=I,e[32]=w):w=e[32],w};function wn(t){return t.isVoiceModeActive}function An(t){return t.hasConnectedOnce}function Rn(t){return t.server.remoteState}function kn(t){return t.showNuxFullPage}const Xn=t=>{"use forget";const e=y.c(9),{clientThreadId:s,isFocused:n,onComposerSubmit:o}=t,i=En;let a;e[0]!==s?(a=m.jsx(ms,{clientThreadId:s}),e[0]=s,e[1]=a):a=e[1];let r;e[2]!==s||e[3]!==n||e[4]!==o?(r=m.jsx(Tn,{clientThreadId:s,isFocused:n,onComposerSubmit:o}),e[2]=s,e[3]=n,e[4]=o,e[5]=r):r=e[5];let c;return e[6]!==a||e[7]!==r?(c=m.jsx("div",{onMouseDown:i,onClick:i,children:m.jsxs(yt,{children:[a,r]})}),e[6]=a,e[7]=r,e[8]=c):c=e[8],c};function En(t){t.preventDefault(),t.stopPropagation()}export{Xn as IntegratedUXComposerContainer};
//# sourceMappingURL=b0t5nk82pz9yweia.js.map
