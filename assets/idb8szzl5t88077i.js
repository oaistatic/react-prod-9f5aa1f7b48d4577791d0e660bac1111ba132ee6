const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/oz2w8uv2a0ics46w.js","assets/i8clt0mfz495j7ii.js","assets/j0yo6uv6652vva62.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/jg3zl654e52ggg1k.js","assets/ng8nvh8e06ustinx.js","assets/ge82cdcgribxoqzz.js"])))=>i.map(i=>d[i]);
var ve=Object.defineProperty,_e=Object.defineProperties;var je=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var re=(s,e,r)=>e in s?ve(s,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[e]=r,L=(s,e)=>{for(var r in e||(e={}))ie.call(e,r)&&re(s,r,e[r]);if(z)for(var r of z(e))ne.call(e,r)&&re(s,r,e[r]);return s},W=(s,e)=>_e(s,je(e));var oe=(s,e)=>{var r={};for(var i in s)ie.call(s,i)&&e.indexOf(i)<0&&(r[i]=s[i]);if(s!=null&&z)for(var i of z(s))e.indexOf(i)<0&&ne.call(s,i)&&(r[i]=s[i]);return r};import{j as t,_ as B,e as E,l as ye,c as I,M as A,r as Z,f as ke,R as $,k as be,h as Ne,A as Me}from"./i8clt0mfz495j7ii.js";import{c as we,r as Se,s as le,f as ee,A as Pe,S as Ae,a as K,F as X,P as Ce,b as ue,d as Ee,p as fe,e as Te,u as De,g as Fe,h as Re,i as Le}from"./lc139kj9junmhgwh.js";import{ad as Ie,ae as te,tr as Ve,ts as $e}from"./j0yo6uv6652vva62.js";import{o as G,L as O,e as xe,d as Q,R as Be,J as ce,b0 as Ge,$ as Oe,hM as He,mM as qe}from"./ghewn7l2ynbm32fm.js";import{A as Ue,p as ze,C as We}from"./jo0yr7ku7v9ac6ge.js";import{P as Je,D as Ke}from"./abaiei0at0999ntu.js";import{V as Qe}from"./g5lgy1otfli5p2x7.js";import{g as Y}from"./eflwd0j5c3pxruh8.js";import{r as Ye}from"./l3jkxavl2du23cqn.js";import{M as se}from"./mzyl3pd4zxnxoe9i.js";import{r as de}from"./mjbhy8c4bs0n8qw2.js";import{b as Xe}from"./fb2095ktsebx1zzy.js";import"./mpzbsmypy64alaao.js";import"./fvjpw0lui4wq7vv3.js";import"./kgnykbdth8mb50na.js";import"./g8i6bixylsxyemsr.js";import"./olrcssu7duieo6m7.js";import"./mewip4u74thselsp.js";import"./kq8d654gegx6snmr.js";import"./zul7780usssm7kro.js";import"./i84uy1p9ly5pjwpt.js";import"./o6tyvbjf9zh9qku3.js";import"./lptwpbjabrvjmhsj.js";import"./gf67njbmurwfkel2.js";import"./dntm9op0tz5bndrs.js";import"./fzrn137102spawew.js";import"./l2r1du6tfxyv7jaj.js";import"./ln88gzx578175chd.js";import"./c80gqv0732s10rnu.js";import"./fr2n5yqcoayleu1k.js";import"./ghnvrdqxofgwprfv.js";import"./g69peh4qbpo7a7d7.js";import"./cgpsp6f7jvechnd8.js";import"./ieykhlrsk25lij4e.js";import"./i03gut32e8jn5ajq.js";import"./h1em0bjkpkjv8ykw.js";import"./e26n6uhwwtwdmiki.js";import"./mjq17q47489shd3e.js";import"./hxdh3tr5l8kut4ed.js";import"./hu1bt0oauegdhua6.js";import"./gy1lpvuoewmzh42c.js";import"./nfccle6oyncifphl.js";import"./eyao241335injypy.js";import"./ktw3b87sujui39wx.js";import"./nrrhfi0a0bbsg9w2.js";import"./hht3m8p9e0s4tqnx.js";function T({title:s,children:e,className:r=""}){return t.jsx("div",{className:"border-token-border-light bg-token-main-surface-primary ring-token-border-light/60 overflow-hidden rounded-lg border p-4 shadow ring-1 shadow-black/20 md:p-5 dark:shadow-black/60 dark:ring-white/10 ".concat(r),children:t.jsxs("section",{children:[s&&t.jsx("div",{className:"text-title-small mb-5 font-semibold tracking-wide",children:s}),t.jsx("div",{className:"grid grid-cols-1 gap-3",children:e})]})})}function C({label:s,children:e}){return t.jsxs("div",{className:"grid grid-cols-2 items-start gap-1 text-sm md:grid-cols-[auto,1fr] md:gap-2",children:[t.jsx("div",{className:"text-token-text-tertiary md:w-44",children:s}),t.jsx("div",{className:"w-full min-w-0 overflow-hidden break-words hyphens-auto",children:e})]})}const Ze=G(()=>B(()=>import("./oz2w8uv2a0ics46w.js").then(s=>s._),__vite__mapDeps([0,1])),{loading:s=>O(s)});function me(s){if(s==null)return"";const e=String(s).trim();return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1).trim():e}function et({finding:s}){var c,x,g,f;const e=E(),r=xe(),i=s,l=(x=(c=i.commit_analysis)==null?void 0:c.commit_hash)!=null?x:"",n=we(i.repo_url,l);return t.jsxs(T,{title:e.formatMessage({id:"aardvark.findings.metadataTitle",defaultMessage:"Metadata"}),children:[t.jsxs("div",{className:"grid grid-cols-1 items-stretch gap-3 text-sm",children:[t.jsx(C,{label:e.formatMessage({id:"aardvark.table.repo",defaultMessage:"Repository"}),children:i.repo_url?t.jsx("a",{href:i.repo_url,target:"_blank",rel:"noopener noreferrer",className:"text-token-text-accent hover:underline",children:Se(i.repo_url)}):t.jsx("span",{className:"text-token-text-tertiary",children:e.formatMessage({id:"aardvark.findings.repo.na",defaultMessage:"N/A"})})}),t.jsx(C,{label:e.formatMessage({id:"aardvark.findings.commit",defaultMessage:"Commit"}),children:n?t.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-token-text-accent font-mono text-xs hover:underline",children:le(l)}):t.jsx("code",{className:"bg-token-bg-elevated-secondary rounded px-1 py-0.5 text-[10px]",children:le(l)})}),t.jsx(C,{label:e.formatMessage({id:"aardvark.findings.author",defaultMessage:"Author"}),children:t.jsxs("div",{className:"flex min-w-0 flex-col",children:[(()=>{var a;const o=me((a=i.commit_analysis)==null?void 0:a.author);return o?t.jsx("span",{className:"truncate",children:o}):t.jsx("span",{className:"text-token-text-tertiary",children:e.formatMessage({id:"aardvark.placeholder.missing",defaultMessage:"—"})})})(),(()=>{var a;const o=me((a=i.commit_analysis)==null?void 0:a.author_email);return o?t.jsx("span",{className:"text-token-text-tertiary font-mono text-xs break-all",children:o}):null})()]})}),t.jsx(C,{label:e.formatMessage({id:"aardvark.findings.authoredAt",defaultMessage:"Authored at"}),children:ee((f=(g=i.commit_analysis)==null?void 0:g.author_date)!=null?f:null)}),t.jsx(C,{label:e.formatMessage({id:"aardvark.findings.createdAt",defaultMessage:"Detected at"}),children:ee(i.created_at)}),t.jsx(C,{label:e.formatMessage({id:"aardvark.table.assignee",defaultMessage:"Assignee"}),children:t.jsx("div",{className:"min-w-[200px]",children:t.jsx(Pe,{finding:i})})}),t.jsx(C,{label:e.formatMessage({id:"aardvark.table.status",defaultMessage:"Status"}),children:t.jsx("div",{className:"min-w-[200px]",children:t.jsx(Ae,{finding:i})})}),(()=>{var h,p,u;const o=(h=i==null?void 0:i.commit_analysis)!=null?h:{},a=String((p=o.security_related)!=null?p:"no").toLowerCase()==="yes",m=String((u=o.privacy_related)!=null?u:"no").toLowerCase()==="yes",d=o.validated===!0||String(o.validated).toLowerCase()==="true";return!a&&!m&&!d?null:t.jsx(C,{label:e.formatMessage({id:"aardvark.findings.signals",defaultMessage:"Signals"}),children:t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a&&t.jsx(K,{variant:"critical",children:e.formatMessage(X.security)}),m&&t.jsx(K,{variant:"warning",children:e.formatMessage(X.privacy)}),d&&t.jsx(K,{variant:"success",children:e.formatMessage(X.validated)})]})})})(),i.resolution_reason?t.jsx(C,{label:e.formatMessage({id:"aardvark.findings.resolutionReason",defaultMessage:"Resolution notes"}),children:t.jsxs("div",{className:"text-sm whitespace-pre-wrap",children:[i.resolution_reason,i.resolution_set_by_email?t.jsx("div",{className:"text-token-text-tertiary mt-1 text-xs",children:e.formatMessage({id:"aardvark.findings.resolutionSetBy",defaultMessage:"Set by {email}"},{email:i.resolution_set_by_email})}):null]})}):null]}),t.jsxs("div",{className:"mt-3 grid grid-cols-1 items-stretch gap-3 p-1 sm:grid-cols-2",children:[n&&t.jsx(tt,{commitUrlStr:n}),t.jsx(Ie,{className:"border-token-border-light hover:bg-token-bg-elevated-secondary inline-flex h-9 w-full items-center justify-center rounded border px-3 text-center text-sm",iconClassName:"icon-sm",buttonText:e.formatMessage({id:"aardvark.actions.share",defaultMessage:"Share link"}),onCopy:o=>{const a=typeof window<"u"&&window.location?"".concat(window.location.origin).concat(window.location.pathname):"";te(a,r,o),r.successNeutral(e.formatMessage({id:"aardvark.toast.linkCopied",defaultMessage:"Link copied"}),{duration:2})}})]})]})}function tt({commitUrlStr:s}){const e=E();return t.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"border-token-border-light hover:bg-token-bg-elevated-secondary inline-flex h-9 w-full items-center justify-center rounded border px-3 text-center text-sm",children:[t.jsx(Ze,{className:"icon-sm me-1","aria-hidden":!0}),e.formatMessage({id:"aardvark.actions.openGithub",defaultMessage:"Open in GitHub"})]})}var st=Ye();const at=ye(st),rt={pending:"muted",running:"warning",failed:"danger",success:"success",unknown:"muted"},it=s=>s.status=="created"?"pending":s.status=="patch_generation_running"?"running":s.status=="patch_generation_failed"?"failed":s.patch_generation_success?"success":"unknown",nt=s=>s.status=="created"?"pending":s.status=="awaiting_validation"?"running":s.status=="failed_validation"?"failed":s.status=="validated"?"success":"unknown";function pe(s){"use forget";const e=I.c(9),{task:r,mode:i}=s,l=E();let n;e[0]!==i||e[1]!==r?(n=i=="generation"?it(r):nt(r),e[0]=i,e[1]=r,e[2]=n):n=e[2];const c=n,x=rt[c];let g;e[3]!==l||e[4]!==c?(g=l.formatMessage(Ce[c]),e[3]=l,e[4]=c,e[5]=g):g=e[5];const f=g;let o;return e[6]!==f||e[7]!==x?(o=t.jsx(K,{variant:x,children:f}),e[6]=f,e[7]=x,e[8]=o):o=e[8],o}function ot(s){"use forget";var D,V;const e=I.c(34),{latestTask:r,turn:i,formatStepTime:l}=s,n=r==null?void 0:r.patch_generation_submitted_at,c=(V=(D=i==null?void 0:i.latest_event)==null?void 0:D.created)!=null?V:null;let x;if(e[0]!==i){const b=i&&Array.isArray(i.output_items)?ue(Y(i,"output_items",[]),mt):[],N=at(b,ct);x=i?W(L({},i),{output_items:[...N]}):null,e[0]=i,e[1]=x}else x=e[1];const g=x;let f;e[2]!==l||e[3]!==n?(f=n?l(n):null,e[2]=l,e[3]=n,e[4]=f):f=e[4];const o=f;let a;e[5]!==l||e[6]!==c?(a=c?l(c):null,e[5]=l,e[6]=c,e[7]=a):a=e[7];const m=a;let d;if(e[8]!==m||e[9]!==o){if(d=[],o){let b;e[11]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx(A,{id:"aardvark.proposedPatch.patchGeneration.startedLabel",defaultMessage:"Started"}),e[11]=b):b=e[11];let N;e[12]!==o?(N={key:"started",label:b,value:o},e[12]=o,e[13]=N):N=e[13],d.push(N)}if(m){let b;e[14]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx(A,{id:"aardvark.proposedPatch.patchGeneration.finishedLabel",defaultMessage:"Completed"}),e[14]=b):b=e[14];let N;e[15]!==m?(N={key:"finished",label:b,value:m},e[15]=m,e[16]=N):N=e[16],d.push(N)}e[8]=m,e[9]=o,e[10]=d}else d=e[10];let h;e[17]!==i?(h=i?Qe(i):"",e[17]=i,e[18]=h):h=e[18];const p=h;let u,_;e[19]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx("div",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide uppercase",children:t.jsx(A,{id:"aardvark.proposedPatch.patchGeneration.title",defaultMessage:"Patch generation"})}),_=Q("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[19]=u,e[20]=_):(u=e[19],_=e[20]);let v;e[21]!==d?(v=d.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:d.map(lt)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(A,{id:"aardvark.proposedPatch.patchGeneration.noTiming",defaultMessage:"Timing details will appear once generation starts."})}),e[21]=d,e[22]=v):v=e[22];let w;e[23]!==r?(w=r&&t.jsx("div",{className:"sm:ms-4 sm:flex sm:min-w-[120px] sm:justify-end",children:t.jsx(pe,{task:r,mode:"generation"})}),e[23]=r,e[24]=w):w=e[24];let j;e[25]!==v||e[26]!==w?(j=t.jsxs("div",{className:_,children:[v,w]}),e[25]=v,e[26]=w,e[27]=j):j=e[27];let y;e[28]!==p||e[29]!==g?(y=g&&t.jsx(Ue,{assistantTurn:g,outputText:p,className:"text-token-text-secondary text-sm leading-6"}),e[28]=p,e[29]=g,e[30]=y):y=e[30];let R;return e[31]!==y||e[32]!==j?(R=t.jsxs(t.Fragment,{children:[u,j,y]}),e[31]=y,e[32]=j,e[33]=R):R=e[33],R}function lt(s){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:s.label}),t.jsx("span",{className:"text-token-text-secondary",children:s.value})]},s.key)}function ct(s){return W(L({},s),{content:ue(Y(s,"content",[]),dt)})}function dt(s){return Y(s,"content_type")==="text"}function mt(s){return Y(s,"type")==="message"}function ut(s){"use forget";var w;const e=I.c(29),{latestTask:r,formatStepTime:i}=s,l=r==null?void 0:r.fix_checker_started_at,n=r==null?void 0:r.fix_checker_finished_at,c=(w=r==null?void 0:r.fix_checker_rubric)!=null?w:"";let x;e[0]!==i||e[1]!==l?(x=l?i(l):null,e[0]=i,e[1]=l,e[2]=x):x=e[2];const g=x;let f;e[3]!==i||e[4]!==n?(f=n?i(n):null,e[3]=i,e[4]=n,e[5]=f):f=e[5];const o=f;let a;if(e[6]!==o||e[7]!==g){if(a=[],g){let j;e[9]===Symbol.for("react.memo_cache_sentinel")?(j=t.jsx(A,{id:"aardvark.proposedPatch.patchValidation.startedLabel",defaultMessage:"Started"}),e[9]=j):j=e[9];let y;e[10]!==g?(y={key:"started",label:j,value:g},e[10]=g,e[11]=y):y=e[11],a.push(y)}if(o){let j;e[12]===Symbol.for("react.memo_cache_sentinel")?(j=t.jsx(A,{id:"aardvark.proposedPatch.patchValidation.finishedLabel",defaultMessage:"Completed"}),e[12]=j):j=e[12];let y;e[13]!==o?(y={key:"finished",label:j,value:o},e[13]=o,e[14]=y):y=e[14],a.push(y)}e[6]=o,e[7]=g,e[8]=a}else a=e[8];let m,d;e[15]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("div",{className:"text-token-text-tertiary mt-4 text-xs font-semibold tracking-wide uppercase",children:t.jsx("span",{children:t.jsx(A,{id:"aardvark.proposedPatch.patchValidation.title",defaultMessage:"Patch validation"})})}),d=Q("mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"),e[15]=m,e[16]=d):(m=e[15],d=e[16]);let h;e[17]!==a?(h=a.length>0?t.jsx("div",{className:"text-token-text-secondary flex flex-wrap items-center gap-x-6 text-sm leading-6",children:a.map(ft)}):t.jsx("p",{className:"text-token-text-tertiary text-sm leading-6",children:t.jsx(A,{id:"aardvark.proposedPatch.patchValidation.noTiming",defaultMessage:"Validation timeline will populate once checks begin."})}),e[17]=a,e[18]=h):h=e[18];let p;e[19]!==r?(p=t.jsx(pe,{task:r,mode:"validation"}),e[19]=r,e[20]=p):p=e[20];let u;e[21]!==h||e[22]!==p?(u=t.jsxs("div",{className:d,children:[h,p]}),e[21]=h,e[22]=p,e[23]=u):u=e[23];let _;e[24]!==c?(_=c&&t.jsx("div",{className:"prose prose-sm text-token-text-secondary mb-4 max-w-none",children:t.jsx(se,{children:c})}),e[24]=c,e[25]=_):_=e[25];let v;return e[26]!==u||e[27]!==_?(v=t.jsxs(t.Fragment,{children:[m,u,_]}),e[26]=u,e[27]=_,e[28]=v):v=e[28],v}function ft(s){return t.jsxs("div",{className:"flex items-baseline gap-2 text-sm leading-6",children:[t.jsx("span",{className:"text-token-text-tertiary text-xs font-semibold tracking-wide",children:s.label}),t.jsx("span",{className:"text-token-text-secondary",children:s.value})]},s.key)}function xt(s){return typeof s!="object"||s==null||!("role"in s)||!("output_items"in s)?!1:s.role==="assistant"&&Array.isArray(s.output_items)}function pt(s){"use forget";const e=I.c(53),{proposed_patch:r,findingId:i,refetchFinding:l}=s,n=E(),c=xe(),[x,g]=Z.useState(!1),[f,o]=Z.useState(!1);if(!r)return null;const a=r.latest_task;if(!a){let p;e[0]!==n?(p=n.formatMessage({id:"aardvark.proposedPatch.timelineTitle",defaultMessage:"Proposed patch"}),e[0]=n,e[1]=p):p=e[1];let u;e[2]!==n?(u=n.formatMessage({id:"aardvark.proposedPatch.noTaskAvailable",defaultMessage:"A proposed patch has not been generated yet."}),e[2]=n,e[3]=u):u=e[3];let _;e[4]!==u?(_=t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary mt-4 rounded border border-dashed border-slate-300 px-3 py-3 text-center text-sm leading-6",children:u}),e[4]=u,e[5]=_):_=e[5];let v;return e[6]!==p||e[7]!==_?(v=t.jsx(T,{title:p,children:_}),e[6]=p,e[7]=_,e[8]=v):v=e[8],v}const m=a.codex_task_turn,d=xt(m==null?void 0:m.turn)?m.turn:null;let h;if(e[9]!==d||e[10]!==i||e[11]!==n||e[12]!==f||e[13]!==a||e[14]!==r.id||e[15]!==l||e[16]!==c||e[17]!==x){const p=d?ze({assistantTurn:d}):[],u=p.map(vt).join("\n\n"),_=async()=>{try{await te(u,c),c.successNeutral(n.formatMessage(J.copyPatchSuccess),{duration:5,hasCloseButton:!0})}catch(k){}};let v;e[19]!==u||e[20]!==n||e[21]!==c?(v=async()=>{try{await te("git apply - <<PATCH\n"+u+"\nPATCH",c),c.successNeutral(n.formatMessage(J.copyApplySuccess),{duration:5,hasCloseButton:!0})}catch(k){}},e[19]=u,e[20]=n,e[21]=c,e[22]=v):v=e[22];const w=v;let j;e[23]!==i||e[24]!==n||e[25]!==f||e[26]!==a.codex_task_id||e[27]!==a.codex_task_turn_id||e[28]!==l||e[29]!==c?(j=async k=>{if(!(a!=null&&a.codex_task_id)||!(a!=null&&a.codex_task_turn_id)||!i||f)return;o(!0);const M={parameters:{path:{id:i}},requestBody:{}};k!==void 0&&(M.requestBody.mode=k);try{if(await Be.safePost("/aardvark/scan-findings/{id}/pr",M),l)try{await l()}catch(P){const S=P;let F;S instanceof Error?F=S.message:F=String(S),ce.addError("aardvark.proposedPatch.refetchFindingError",{findingId:i,message:F})}c.successNeutral(n.formatMessage(J.createPrSuccess),{duration:3,hasCloseButton:!0})}catch(P){const S=P;ce.addError("aardvark.proposedPatch.createPrError",{findingId:i,taskId:a.codex_task_id,taskTurnId:a.codex_task_turn_id,mode:k!=null?k:null,message:S instanceof Error?S.message:String(S)}),c.danger(n.formatMessage(J.createPrError),{duration:3,hasCloseButton:!0}),o(!1);return}o(!1)},e[23]=i,e[24]=n,e[25]=f,e[26]=a.codex_task_id,e[27]=a.codex_task_turn_id,e[28]=l,e[29]=c,e[30]=j):j=e[30];const y=j,R=!!(a!=null&&a.codex_task_id)&&!!(a!=null&&a.codex_task_turn_id)&&!!i;let D;e[31]===Symbol.for("react.memo_cache_sentinel")?(D=function(M){return M?typeof M=="string"?ee(M):Ee(M):null},e[31]=D):D=e[31];const V=D;let b;e[32]!==n?(b=n.formatMessage({id:"aardvark.proposedPatch.timelineTitle",defaultMessage:"Proposed patch"}),e[32]=n,e[33]=b):b=e[33];let N;e[34]!==d||e[35]!==a?(N=t.jsx(ot,{latestTask:a,turn:d,formatStepTime:V}),e[34]=d,e[35]=a,e[36]=N):N=e[36];let H;e[37]!==a?(H=t.jsx(ut,{latestTask:a,formatStepTime:V}),e[37]=a,e[38]=H):H=e[38];let q;if(p.length>0){let k;e[39]!==x?(k=t.jsx(Ke,{unifiedDiff:x,setUnifiedDiff:g,showFullDiff:!1,setShowFullDiff:ht}),e[39]=x,e[40]=k):k=e[40];const M=t.jsxs("div",{className:"flex w-full flex-wrap items-center justify-between gap-3",children:[k,t.jsx(Je,{copyApplyToClipboard:w,copyPatchToClipboard:_,createPr:y,navigateToCreatingPrPage:gt,updateBranch:void 0,canCreatePr:R,isCreatingPr:f,permissions:"write",assistantTurn:d,showOnlyViewPr:!1})]});let P;e[41]!==M?(P=t.jsx("div",{className:"mb-2 flex w-full flex-col gap-2",children:M}),e[41]=M,e[42]=P):P=e[42];let S;e[43]!==r.id||e[44]!==x?(S=(ge,he)=>{var ae;return t.jsx(We,{diff:ge,viewType:x?"unified":"split",stickyHeader:!1},"".concat((ae=r==null?void 0:r.id)!=null?ae:"diff","-canonical-").concat(he))},e[43]=r.id,e[44]=x,e[45]=S):S=e[45];const F=t.jsx("div",{className:"flex flex-col gap-4",children:p.map(S)});let U;e[46]!==P||e[47]!==F?(U=t.jsxs(t.Fragment,{children:[P,F]}),e[46]=P,e[47]=F,e[48]=U):U=e[48],q=U}else if((a==null?void 0:a.status)==="patch_generation_running")q=null;else{let k;e[49]!==n?(k=n.formatMessage({id:"aardvark.proposedPatch.noDiffsInHead",defaultMessage:"No diffs—this usually means the issue no longer exists in HEAD."}),e[49]=n,e[50]=k):k=e[50];let M;e[51]!==k?(M=t.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary mt-4 rounded border border-dashed border-slate-300 px-3 py-3 text-center text-sm leading-6",children:k}),e[51]=k,e[52]=M):M=e[52],q=M}h=t.jsxs(T,{title:b,children:[N,H,q]}),e[9]=d,e[10]=i,e[11]=n,e[12]=f,e[13]=a,e[14]=r.id,e[15]=l,e[16]=c,e[17]=x,e[18]=h}else h=e[18];return h}function gt(){}function ht(){}function vt(s){var e;return(e=s.hunksText)!=null?e:""}const J=ke({createPrSuccess:{id:"aardvark.proposedPatch.createPrSuccess",defaultMessage:"Pull request created"},createPrError:{id:"aardvark.proposedPatch.createPrErrorToast",defaultMessage:"Failed to create pull request"},copyPatchSuccess:{id:"aardvark.proposedPatch.copyPatchSuccess",defaultMessage:"Patch copied"},copyApplySuccess:{id:"aardvark.proposedPatch.copyApplySuccess",defaultMessage:"Command copied"}}),_t=G(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yA),__vite__mapDeps([2,1,3,4,5])),{loading:s=>O(s)});function jt({content:s,start:e,className:r=""}){const i=$.useMemo(()=>s.trimEnd().split("\n"),[s]),l=typeof e=="number"?e:1;return t.jsx("div",{className:"bg-token-bg-elevated-secondary overflow-auto rounded ".concat(r),style:{maxHeight:400},children:t.jsx("table",{className:"w-full border-separate border-spacing-0",children:t.jsx("tbody",{children:i.map((n,c)=>t.jsxs("tr",{className:"align-top",children:[t.jsx("td",{className:"text-token-text-tertiary py-0.5 ps-3 pe-3 text-end align-top text-[11px] whitespace-nowrap select-none",children:l+c}),t.jsx("td",{className:"py-0.5 pe-3 font-mono text-sm whitespace-pre",children:n===""?" ":n})]},c))})})})}function yt({finding:s}){var x,g,f,o;const e=E();let r=(g=(x=s.commit_analysis)==null?void 0:x.relevant_lines)!=null?g:[],i=Array.isArray(r)&&r.length>0;const l=(f=s.commit_analysis)==null?void 0:f.proposed_patch,n=typeof l=="string"&&l.trim().length>0;if(!i){const a=fe(l);r=(o=a==null?void 0:a.relevant_lines)!=null?o:[],i=Array.isArray(r)&&r.length>0}if(!i){if(n)return t.jsx(T,{title:e.formatMessage({id:"aardvark.findings.detailsTitle",defaultMessage:"Details"}),children:t.jsx("div",{className:"p-2",children:l})});if(!n)return t.jsx(T,{title:e.formatMessage({id:"aardvark.findings.evidence",defaultMessage:"Evidence"}),children:t.jsx("div",{className:"text-token-text-tertiary text-sm",children:e.formatMessage({id:"aardvark.findings.noEvidence",defaultMessage:"No evidence available."})})})}const c=(()=>{var m,d,h,p;const a=new Map;for(const u of r){const _=u.path||(u==null?void 0:u.file_path)||"(unknown)",v=(m=u.start_line_number)!=null?m:0,w=(h=(d=u.end_line_number)!=null?d:u.start_line_number)!=null?h:0,j="".concat(_,"|").concat(v,"-").concat(w),y=(p=a.get(j))!=null?p:[];y.push(u),a.set(j,y)}return Array.from(a.entries()).sort((u,_)=>u[0].localeCompare(_[0]))})();return t.jsx(T,{title:e.formatMessage({id:"aardvark.findings.relevantLinesTitle",defaultMessage:"Relevant lines"}),children:t.jsx("div",{className:"space-y-3",children:c.map(([a,m])=>{const[d,h]=a.split("|");return t.jsxs("details",{open:!0,className:"group ring-token-border-light bg-token-main-surface-primary rounded-lg ring-1",children:[t.jsxs("summary",{className:"flex cursor-pointer items-center justify-between rounded-lg px-3 py-2 text-sm font-medium select-none",children:[t.jsxs("span",{className:"flex min-w-0 items-center gap-2",children:[t.jsx(_t,{className:"icon-sm text-token-text-tertiary transition-transform group-open:rotate-180","aria-hidden":!0}),t.jsx("span",{className:"truncate",children:d})]}),t.jsx("span",{className:"text-token-text-tertiary ms-2 text-xs whitespace-nowrap",children:e.formatMessage({id:"aardvark.findings.lineRange",defaultMessage:"L{range}"},{range:h==null?void 0:h.replace("-","–")})})]}),t.jsx("div",{children:m.map((p,u)=>t.jsxs("div",{className:"space-y-2",children:[p.comment&&t.jsx("p",{className:"text-token-text-secondary mb-0 bg-yellow-50/60 px-3 py-3 text-sm dark:bg-yellow-900/30",children:p.comment}),p.content&&t.jsx(jt,{content:p.content,start:p.start_line_number,className:"mb-0"})]},"".concat(a,"-").concat(u)))})]},a)})})})}const kt=G(()=>B(()=>import("./jg3zl654e52ggg1k.js").then(s=>s._),__vite__mapDeps([6,1])),{loading:s=>O(s)});function bt({finding:s}){var c,x,g,f,o;const e=E(),r=s,i=$.useMemo(()=>{var a;return fe((a=r.commit_analysis)==null?void 0:a.proposed_patch)},[(c=r.commit_analysis)==null?void 0:c.proposed_patch]),l=$.useMemo(()=>{var a,m,d;return(d=(m=i==null?void 0:i.cvss_score)!=null?m:(a=r.commit_analysis)==null?void 0:a.cvss_score)!=null?d:null},[i,r.commit_analysis]),n=$.useMemo(()=>{var a,m,d;return(d=(m=i==null?void 0:i.criticality_cvss_reason)!=null?m:(a=r.commit_analysis)==null?void 0:a.criticality_cvss_score_reason)!=null?d:null},[i,r.commit_analysis]);return t.jsxs(T,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[((x=r.commit_analysis)==null?void 0:x.title)||e.formatMessage({id:"aardvark.findings.vulnerability",defaultMessage:"Vulnerability"}),t.jsx(Te,{level:r.criticality})]}),children:[t.jsx("div",{children:((g=r.commit_analysis)==null?void 0:g.bugs_found_or_fixed)&&t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:(f=r.commit_analysis)==null?void 0:f.bugs_found_or_fixed})}),l!=null&&t.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[t.jsx("div",{className:"text-token-text-secondary flex items-center gap-1",children:t.jsx("div",{className:"font-semibold",children:e.formatMessage({id:"aardvark.findings.cvssLabel",defaultMessage:"CVSS"})})}),t.jsxs("span",{className:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold text-yellow-500 ring-amber-500/20",style:{backgroundColor:"rgba(245, 158, 11, 0.12)"},title:e.formatMessage({id:"aardvark.findings.cvssScore",defaultMessage:"CVSS score"}),children:[t.jsx(kt,{className:"me-1 h-[14px] w-[14px]","aria-hidden":!0}),l]})]}),n&&t.jsx("div",{className:"text-token-text-tertiary text-sm leading-6",children:n&&t.jsx("p",{className:"mb-2",children:n})}),t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:(o=r.commit_analysis)==null?void 0:o.description})]})}const Nt=G(()=>B(()=>import("./ng8nvh8e06ustinx.js").then(s=>s._),__vite__mapDeps([7,1])),{loading:s=>O(s)}),Mt=G(()=>B(()=>import("./ge82cdcgribxoqzz.js").then(s=>s._),__vite__mapDeps([8,1])),{loading:s=>O(s)});function wt({finding:s}){var g,f,o;const e=E(),[r,i]=$.useState(!1),l=(g=s.commit_analysis)==null?void 0:g.validation_report,n=(f=s.commit_analysis)==null?void 0:f.validation_rubric,c=String(l||((o=s==null?void 0:s.commit_analysis)==null?void 0:o.validation_str)||"");if(!c&&!n)return null;const x=n&&c?2:1;return t.jsx(T,{title:e.formatMessage({id:"aardvark.findings.validation",defaultMessage:"Validation"}),children:t.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-".concat(x),children:[n&&t.jsx("div",{className:"lg:col-span-1",children:t.jsx("div",{className:"text-token-text-secondary text-sm leading-6",children:t.jsx(se,{remarkPlugins:[de],components:{code(h){var p=h,{inline:a,children:m}=p,d=oe(p,["inline","children"]);const u=String(m!=null?m:"");if(a)return t.jsx("code",W(L({className:"bg-token-bg-primary rounded px-1 py-0.5 text-[12px]"},d),{children:u}));const _=String((d==null?void 0:d.className)||""),v=/language-([\w-]+)/.exec(_),w=v==null?void 0:v[1];return t.jsx(Ve,{content:u,language:w,wrapperClassName:"mt-1",showActionBar:!1,codeContainerClassName:"p-3"})},input(a){return(a==null?void 0:a.type)!=="checkbox"?t.jsx("input",L({},a)):!!a.checked?t.jsx(Mt,{className:"mt-0.5 h-4 w-4 shrink-0 text-emerald-600"}):t.jsx(Nt,{className:"text-token-text-quaternary mt-0.5 h-4 w-4 shrink-0 opacity-70"})},li({children:a}){return t.jsx("li",{className:"hover:bg-token-bg-elevated-secondary/40 flex items-start gap-2 rounded-lg p-2",children:a})}},children:n})})}),c&&c.trim().length>0&&t.jsxs("div",{className:"lg:col-span-1",children:[t.jsx("div",{className:"text-token-text-tertiary mb-2 text-xs font-semibold tracking-wide uppercase",children:e.formatMessage({id:"aardvark.findings.validationReportLabel",defaultMessage:"Validation report"})}),t.jsxs("div",{className:Q("relative rounded-md p-3 text-sm leading-6","bg-token-main-surface-primary/40"),children:[t.jsx("div",{className:Q("prose prose-sm text-foreground max-w-none",r?"max-h-none":"max-h-36 overflow-hidden"),children:t.jsx(se,{remarkPlugins:[de],children:c})}),!r&&t.jsx("div",{className:"from-token-main-surface-primary pointer-events-none absolute inset-x-0 bottom-0 h-10 bg-gradient-to-t"})]}),t.jsx("div",{className:"mt-2 flex items-center justify-end",children:t.jsx("button",{type:"button",className:"hover:bg-token-bg-elevated-secondary inline-flex h-8 items-center justify-center rounded px-2 text-xs",onClick:()=>i(a=>!a),children:r?e.formatMessage({id:"aardvark.findings.collapse",defaultMessage:"Collapse"}):e.formatMessage({id:"aardvark.findings.expand",defaultMessage:"Expand"})})})]})]})})}function St({finding:s,refetchFinding:e}){var r;return E(),t.jsx("div",{className:"relative mx-auto w-full max-w-[1200px]",children:t.jsx("div",{className:"flex flex-col gap-4",children:t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3 md:gap-6",children:[t.jsx("div",{className:"flex flex-col gap-4 md:col-span-2",children:t.jsx(bt,{finding:s})}),t.jsx("div",{className:"flex h-fit flex-col gap-4 self-start",children:t.jsx(et,{finding:s})}),s.proposed_patch?t.jsx("div",{className:"md:col-span-3",children:t.jsx(pt,{proposed_patch:s.proposed_patch,findingId:(r=s.hid)!=null?r:s.id,refetchFinding:e})}):null,t.jsx("div",{className:"md:col-span-3",children:t.jsx(yt,{finding:s})}),t.jsx("div",{className:"md:col-span-3",children:t.jsx(wt,{finding:s})})]})})})}function Pt(s){"use forget";const e=I.c(3);let r;if(e[0]!==s){let l;e[2]===Symbol.for("react.memo_cache_sentinel")?(l=/^\/aardvark\/findings\/([^/]+)$/,e[2]=l):l=e[2],r=s.match(l),e[0]=s,e[1]=r}else r=e[1];const i=r;return i?decodeURIComponent(i[1]):null}function At(){"use forget";const s=I.c(18),e=be(),r=Ne(),i=Pt(e.pathname),{data:l,isLoading:n,refetch:c}=De(i!=null?i:void 0,!!i);let x,g;if(s[0]!==i||s[1]!==e.search||s[2]!==r?(x=()=>{i||r("/aardvark"+(e.search||""),{replace:!0})},g=[i,r,e.search],s[0]=i,s[1]=e.search,s[2]=r,s[3]=x,s[4]=g):(x=s[3],g=s[4]),Z.useEffect(x,g),n||!l){let h;return s[5]===Symbol.for("react.memo_cache_sentinel")?(h=t.jsx("div",{className:"w-full px-4 pb-6",children:t.jsx("div",{className:"flex h-[60vh] w-full items-center justify-center",children:t.jsx(Ge,{})})}),s[5]=h):h=s[5],h}let f;s[6]!==e.search||s[7]!==r?(f=()=>{r("/aardvark"+(e.search||""))},s[6]=e.search,s[7]=r,s[8]=f):f=s[8];let o;s[9]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(A,{id:"aardvark.details.back",defaultMessage:"Back to findings"}),s[9]=o):o=s[9];let a;s[10]!==f?(a=t.jsx("div",{className:"mx-auto mb-4 w-full max-w-[1200px]",children:t.jsx(Oe,{as:"button",size:"small",color:"secondary",onClick:f,children:o})}),s[10]=f,s[11]=a):a=s[11];let m;s[12]!==l||s[13]!==c?(m=t.jsx(St,{finding:l,refetchFinding:c}),s[12]=l,s[13]=c,s[14]=m):m=s[14];let d;return s[15]!==a||s[16]!==m?(d=t.jsxs("div",{className:"w-full px-4 pb-6",children:[a,m]}),s[15]=a,s[16]=m,s[17]=d):d=s[17],d}function Ct(){const s=$e(),e=He();return s?t.jsx(Et,L({},e)):null}function Et(s){const e=E();return t.jsxs(Xe,{mobileHeaderRightContent:null,children:[t.jsx(Fe,{}),t.jsx(Re,{children:t.jsx(Le,{})}),t.jsxs(qe,{children:[t.jsx("div",{className:"no-scrollbar h-full w-full overflow-y-auto",children:t.jsx("div",{className:"z-0 mx-auto flex w-[90%] max-w-[1600px] flex-col",children:t.jsx(At,{})})}),t.jsx("a",{href:"https://forms.gle/arrj4MzLN1YqdR8S6",target:"_blank",rel:"noopener noreferrer","aria-label":e.formatMessage({id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),title:e.formatMessage({id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"}),"data-testid":"aardvark-feedback-fab",className:"border-token-border-light bg-token-main-surface-primary shadow-long hover:bg-token-main-surface-secondary fixed end-4 bottom-4 z-50 flex h-10 items-center justify-center rounded-full border px-4 text-sm font-medium focus:outline-hidden",children:t.jsx(A,{id:"aardvark.feedback.cta",defaultMessage:"Feedback survey"})})]})]})}const Ms=Me(function(){return t.jsx(Ct,{})});export{Ms as default};
//# sourceMappingURL=idb8szzl5t88077i.js.map
