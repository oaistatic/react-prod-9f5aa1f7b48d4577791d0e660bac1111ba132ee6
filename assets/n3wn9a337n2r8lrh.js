const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/gsas8pb1acnf7jnd.js","assets/i8clt0mfz495j7ii.js","assets/jmnvgtzhse37m0ro.js"])))=>i.map(i=>d[i]);
var Ae=Object.defineProperty,Me=Object.defineProperties;var Ne=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var pe=(t,e,s)=>e in t?Ae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,ee=(t,e)=>{for(var s in e||(e={}))Ee.call(e,s)&&pe(t,s,e[s]);if(fe)for(var s of fe(e))Te.call(e,s)&&pe(t,s,e[s]);return t},te=(t,e)=>Me(t,Ne(e));import{_ as he,c as le,e as ye,j as i,L as Ce,F as Ie,M as I,u as Se,a as De,r as ae}from"./i8clt0mfz495j7ii.js";import{x as K,bL as Le}from"./j0yo6uv6652vva62.js";import{T as ne}from"./zm1ki9l766pgg0bx.js";import{o as _e,L as xe,d as se,pt as ke,T as re,e as Ue,a5 as be,B as Re,h as Be,u as Oe}from"./ghewn7l2ynbm32fm.js";import{W as Fe,t as qe,C as we}from"./g5lgy1otfli5p2x7.js";import{u as Ve,a as We,c as Qe,b as Ke}from"./k0yjsblyrvonk8x1.js";const $e=_e(()=>he(()=>import("./gsas8pb1acnf7jnd.js").then(t=>t._),__vite__mapDeps([0,1])),{loading:t=>xe(t)}),ge=_e(()=>he(()=>import("./jmnvgtzhse37m0ro.js").then(t=>t._),__vite__mapDeps([2,1])),{loading:t=>xe(t)}),Ge=["everyone","team","default"];function Ye(t){return Ge.some(e=>e===t)}const ze={everyone:{globalReviewPreference:"review_everyone",reviewPreference:"team"},team:{globalReviewPreference:"review_if_enabled",reviewPreference:"team"},default:{globalReviewPreference:"review_if_enabled",reviewPreference:"never"}};function Pe(t){return t.global_review_preference==="review_everyone"?"everyone":t.review_preference==="team"?"team":"default"}function ut(t){var s,r,l,n;const e=(r=(s=t.repository.id)!=null?s:t.repository.repository_full_name)!=null?r:t.repository.name;return e?e.toString():"".concat((n=(l=t.repository.owner)==null?void 0:l.login)!=null?n:"repo","-").concat(Pe(t))}function He(t){return[{value:"everyone",title:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.always.title",defaultMessage:"Review all PRs"}),description:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.always.description",defaultMessage:"Run auto code reviews on every pull request, even from contributors outside this workspace"}),individual_description:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.always.individual_description",defaultMessage:"Run on every pull request, even from other contributors"})},{value:"team",title:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.team.title",defaultMessage:"Review team PRs"}),individual_title:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.always.individual_title",defaultMessage:"Review my PRs"}),description:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.team.description",defaultMessage:"Only run on pull requests opened by members of this workspace"}),individual_description:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.team.individual_description",defaultMessage:"Only run on pull requests opened by me"})},{value:"default",title:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.individuals.title",defaultMessage:"Follow personal preferences"}),individual_title:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.individuals.individual_title",defaultMessage:"Follow personal preferences"}),description:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.individuals.description",defaultMessage:"Let users opt in with their personal settings"}),individual_description:t.formatMessage({id:"wham.codeReviewPage.teamAutomations.option.individuals.individual_description",defaultMessage:"Run on your own pull requests based on your personal preference"})}]}function Je(t){"use forget";var W;const e=le.c(58),{repo:s,value:r,repoReviewOptions:l,isTeamOrEnterprise:n,isLegacyEnterprisey:c,isPlus:d,isPro:m,isDisabledRepo:v,ownerLogin:_,everyoneSetByDifferentAccount:f,updateCodeReviewRepositories:A}=t,p=s.repository.permissions,a=[p==null?void 0:p.admin,p==null?void 0:p.push].some(Boolean),w=r==="everyone",g=w&&!a;let U;if(e[0]!==l||e[1]!==r){let u;e[3]!==r?(u=o=>o.value===r,e[3]=r,e[4]=u):u=e[4],U=l.find(u),e[0]=l,e[1]=r,e[2]=U}else U=e[2];const j=U;let S;if(e[5]!==g||e[6]!==f||e[7]!==n){const u=[];if(f){let o;e[9]!==n?(o=n?i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.everyoneWarningTooltip.differentUser.team",defaultMessage:"This setting was set by a user in a different team."}):i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.everyoneWarningTooltip.differentUser.individual",defaultMessage:"This setting was set by a different user."}),e[9]=n,e[10]=o):o=e[10],u.push(o)}if(g){let o;e[11]===Symbol.for("react.memo_cache_sentinel")?(o=i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.everyoneWarningTooltip.noPermissions",defaultMessage:"You must have repo admin or push permissions to change this setting."}),e[11]=o):o=e[11],u.push(o)}else{let o;e[12]===Symbol.for("react.memo_cache_sentinel")?(o=i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.everyoneWarningTooltip.changeWarning",defaultMessage:"Changing this setting affects auto code reviews for other contributors to this repository."}),e[12]=o):o=e[12],u.push(o)}S=i.jsx(i.Fragment,{children:u.map(Xe)}),e[5]=g,e[6]=f,e[7]=n,e[8]=S}else S=e[8];const D=S;let T;e[13]!==s.repository.id||e[14]!==A?(T=u=>{if(!Ye(u))return;const o=ze[u];A({repo_review_settings:[{repository:s.repository.id,review_preference:o.reviewPreference,global_review_preference:o.globalReviewPreference}]})},e[13]=s.repository.id,e[14]=A,e[15]=T):T=e[15];const O=v||g,F=!(w&&g)||v,B=n?j==null?void 0:j.title:(W=j==null?void 0:j.individual_title)!=null?W:j==null?void 0:j.title;let M;e[16]!==B?(M=i.jsx("div",{className:"flex items-center gap-2 truncate text-sm font-normal",children:B}),e[16]=B,e[17]=M):M=e[17];let R;e[18]!==D||e[19]!==F||e[20]!==M?(R=i.jsx(re,{label:D,withArrow:!0,side:"top",sideOffset:0,disabled:F,children:M}),e[18]=D,e[19]=F,e[20]=M,e[21]=R):R=e[21];let h;e[22]!==g?(h=g?null:i.jsx(K.Icon,{}),e[22]=g,e[23]=h):h=e[23];let x;e[24]!==R||e[25]!==h?(x=i.jsxs(K.Trigger,{className:"w-full max-w-[250px] min-w-[150px] justify-between",children:[R,h]}),e[24]=R,e[25]=h,e[26]=x):x=e[26];let C;e[27]!==g||e[28]!==D||e[29]!==w?(C=w&&!g&&i.jsx(K.Item,{value:"unselectable",className:"items-start",disabled:!0,children:i.jsx("div",{className:"flex min-w-[220px] flex-col gap-1",children:i.jsx("span",{className:"text-token-text-tertiary text-xs whitespace-normal",children:D})})},"unselectable"),e[27]=g,e[28]=D,e[29]=w,e[30]=C):C=e[30];let b;if(e[31]!==a||e[32]!==c||e[33]!==d||e[34]!==m||e[35]!==n||e[36]!==l){let u;e[38]!==a||e[39]!==c||e[40]!==d||e[41]!==m||e[42]!==n?(u=o=>{var Q,q;return i.jsx(K.Item,{value:o.value,className:"items-start",disabled:o.value==="everyone"&&(!a||c||d),children:i.jsx(re,{label:a?i.jsxs(i.Fragment,{children:[n&&!c&&i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.everyoneCostTooltip.team",defaultMessage:"Free until November 20th, after which reviews will consume credits."}),d&&i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.everyoneCostTooltip.plus",defaultMessage:"Upgrade to Pro."}),m&&i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.everyoneCostTooltip.pro",defaultMessage:"Free until November 20th, after which reviews will count against your plan's limits."}),n&&c&&i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.everyoneCostTooltip.legacyEnterprisey",defaultMessage:"Ask your ChatGPT admin to upgrade to flexible pricing to enable."})]}):i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.everyoneDisabledTooltip",defaultMessage:"You must have repo admin or push permissions to select this option"}),disabled:o.value!=="everyone",withArrow:!0,side:"top",sideOffset:0,children:i.jsxs("div",{className:"flex min-w-[220px] flex-col gap-1",children:[i.jsx("span",{className:"text-sm font-normal",children:n?o.title:(Q=o.individual_title)!=null?Q:o.title}),i.jsx("span",{className:"text-token-text-tertiary text-xs whitespace-normal",children:n?o.description:(q=o.individual_description)!=null?q:o.description})]})})},o.value)},e[38]=a,e[39]=c,e[40]=d,e[41]=m,e[42]=n,e[43]=u):u=e[43],b=l.map(u),e[31]=a,e[32]=c,e[33]=d,e[34]=m,e[35]=n,e[36]=l,e[37]=b}else b=e[37];let N;e[44]!==C||e[45]!==b?(N=i.jsx(K.Portal,{children:i.jsxs(K.Content,{className:"max-w-[340px] min-w-[220px]","data-unbound-width":"",children:[C,b]})}),e[44]=C,e[45]=b,e[46]=N):N=e[46];let L;e[47]!==x||e[48]!==N||e[49]!==T||e[50]!==O||e[51]!==r?(L=i.jsxs(K.Root,{value:r,onValueChange:T,disabled:O,children:[x,N]}),e[47]=x,e[48]=N,e[49]=T,e[50]=O,e[51]=r,e[52]=L):L=e[52];const P=L;if(!v)return P;let k;e[53]!==_?(k=i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.repoDisabledTooltip",defaultMessage:"Update the {installation} GitHub installation to enable code review",values:{installation:_}}),e[53]=_,e[54]=k):k=e[54];let V;return e[55]!==P||e[56]!==k?(V=i.jsx(re,{label:k,withArrow:!0,side:"top",sideOffset:0,children:P}),e[55]=P,e[56]=k,e[57]=V):V=e[57],V}function Xe(t,e){return i.jsxs("span",{children:[t," "]},e)}function Ze(t){"use forget";const e=le.c(19),{columnClassName:s,lastUpdatedBy:r,lastUpdatedRelativeTime:l,tooltipLabel:n}=t;let c;e[0]!==s?(c=se(s,"min-w-0"),e[0]=s,e[1]=c):c=e[1];const d=!l;let m;e[2]!==d?(m=se("min-w-0 truncate text-start",{"col-span-2":d}),e[2]=d,e[3]=m):m=e[3];let v;e[4]!==r||e[5]!==m?(v=i.jsx("span",{className:m,children:r}),e[4]=r,e[5]=m,e[6]=v):v=e[6];let _;e[7]!==l?(_=l?i.jsx("span",{className:"text-token-text-tertiary min-w-0 truncate pe-2 text-end sm:min-w-[6rem]",children:l}):null,e[7]=l,e[8]=_):_=e[8];let f;e[9]!==v||e[10]!==_?(f=i.jsxs("div",{className:"hidden w-full min-w-0 items-center justify-between text-xs sm:text-sm md:flex",children:[v,_]}),e[9]=v,e[10]=_,e[11]=f):f=e[11];let A;e[12]===Symbol.for("react.memo_cache_sentinel")?(A=i.jsx($e,{className:"icon-sm text-token-text-secondary shrink-0"}),e[12]=A):A=e[12];let p;e[13]!==n?(p=i.jsx(re,{className:"flex w-full justify-end md:hidden",label:n,labelTextAlign:"left",labelClassName:"text-xs",align:"start",children:A}),e[13]=n,e[14]=p):p=e[14];let a;return e[15]!==c||e[16]!==f||e[17]!==p?(a=i.jsxs(ne.Cell,{textAlign:"left",className:c,children:[f,p]}),e[15]=c,e[16]=f,e[17]=p,e[18]=a):a=e[18],a}function ct(t){"use forget";var de,ue,ce,me;const e=le.c(74),{repo:s,isTeamOrEnterprise:r,isLegacyEnterprisey:l,isPlus:n,isPro:c,disabledInstallations:d,updateCodeReviewRepositories:m,currentAccountOwnerId:v,currentUserEmail:_,columnWidths:f,layout:A,showDivider:p}=t,a=ye(),w=(de=s.repository.owner)==null?void 0:de.login;let g;e[0]!==d||e[1]!==w?(g=w?d.includes(w):!1,e[0]=d,e[1]=w,e[2]=g):g=e[2];const U=g;let j;e[3]!==s?(j=Pe(s),e[3]=s,e[4]=j):j=e[4];const S=j,D=S==="everyone"&&s.global_review_account_id!==v;let T;e[5]!==a?(T=He(a),e[5]=a,e[6]=T):T=e[6];const O=T,F=!!D;let B;e[7]!==S||e[8]!==U||e[9]!==l||e[10]!==n||e[11]!==c||e[12]!==r||e[13]!==w||e[14]!==s||e[15]!==O||e[16]!==F||e[17]!==m?(B=i.jsx(Je,{repo:s,value:S,repoReviewOptions:O,isTeamOrEnterprise:r,isLegacyEnterprisey:l,isPlus:n,isPro:c,isDisabledRepo:U,ownerLogin:w,everyoneSetByDifferentAccount:F,updateCodeReviewRepositories:m}),e[7]=S,e[8]=U,e[9]=l,e[10]=n,e[11]=c,e[12]=r,e[13]=w,e[14]=s,e[15]=O,e[16]=F,e[17]=m,e[18]=B):B=e[18];const M=B;let R;e[19]!==a||e[20]!==s.repository.name||e[21]!==s.repository.repository_full_name?(R=(ce=(ue=s.repository.repository_full_name)!=null?ue:s.repository.name)!=null?ce:a.formatMessage({id:"wham.codeReviewPage.teamAutomations.unknownRepository",defaultMessage:"Unknown repository"}),e[19]=a,e[20]=s.repository.name,e[21]=s.repository.repository_full_name,e[22]=R):R=e[22];const h=R;if(A==="condensed"){const y=p&&"border-token-border-light border-t";let E;e[23]!==y?(E=se("flex items-center justify-between gap-3 py-3 ps-4 pe-1",y),e[23]=y,e[24]=E):E=e[24];let Z;e[25]===Symbol.for("react.memo_cache_sentinel")?(Z=i.jsx(ge,{className:"icon-sm shrink-0"}),e[25]=Z):Z=e[25];let J;e[26]!==h?(J=i.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[Z,i.jsx("span",{className:"truncate text-sm font-medium",children:h})]}),e[26]=h,e[27]=J):J=e[27];let X;e[28]!==M?(X=i.jsx("div",{className:"flex-shrink-0",children:M}),e[28]=M,e[29]=X):X=e[29];let oe;return e[30]!==J||e[31]!==X||e[32]!==E?(oe=i.jsxs("div",{className:E,children:[J,X]}),e[30]=J,e[31]=X,e[32]=E,e[33]=oe):oe=e[33],oe}let x,C;if(e[34]!==a||e[35]!==s.updated_at){const y=s.updated_at?new Date(s.updated_at):null,E=!!(y&&!Number.isNaN(y.getTime()));x=E&&y?i.jsx(Ie,{value:y,year:"numeric",month:"short",day:"2-digit"}):null,C=E&&y?ke({givenDate:y,now:new Date,intl:a,format:"descriptive"}):null,e[34]=a,e[35]=s.updated_at,e[36]=x,e[37]=C}else x=e[36],C=e[37];const b=C;let N;e[38]!==x||e[39]!==b?(N=(me=b!=null?b:x)!=null?me:i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.lastUpdatedUnknown",defaultMessage:"Not recorded"}),e[38]=x,e[39]=b,e[40]=N):N=e[40];const L=N;let P=null;if(D&&s.last_updated_by_github_id){const y="https://github.com/".concat(s.last_updated_by_github_id);let E;e[41]!==s.last_updated_by_github_id||e[42]!==y?(E=i.jsx(Ce,{className:"font-medium",target:"_blank",to:y,children:s.last_updated_by_github_id}),e[41]=s.last_updated_by_github_id,e[42]=y,e[43]=E):E=e[43],P=E}else if(s.last_updated_user_email===_){let y;e[44]===Symbol.for("react.memo_cache_sentinel")?(y=i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.lastUpdatedByUser",defaultMessage:"me"}),e[44]=y):y=e[44],P=y}else r&&(P=s.last_updated_user_email);let k;e[45]!==P||e[46]!==L?(k=i.jsx(I,{id:"wham.codeReviewPage.teamAutomations.lastUpdatedBy",defaultMessage:"{date} by {user}",values:{date:L,user:P}}),e[45]=P,e[46]=L,e[47]=k):k=e[47];const V=k;let W;e[48]!==f?(W=f!=null?f:["w-[50%] sm:w-[40%]","w-[30%] sm:w-[35%]","w-[20%] sm:w-[25%] lg:w-[30%]"],e[48]=f,e[49]=W):W=e[49];const u=W;let o;e[50]!==u[0]?(o=se(u[0],"min-w-[150px]"),e[50]=u[0],e[51]=o):o=e[51];let Q;e[52]===Symbol.for("react.memo_cache_sentinel")?(Q=i.jsx(ge,{className:"icon-md shrink-0"}),e[52]=Q):Q=e[52];let q;e[53]!==h?(q=i.jsxs("div",{className:"flex min-w-0 items-center gap-2",children:[Q,i.jsx("p",{className:"truncate text-sm",children:h})]}),e[53]=h,e[54]=q):q=e[54];let $;e[55]!==o||e[56]!==q?($=i.jsx(ne.Cell,{className:o,children:q}),e[55]=o,e[56]=q,e[57]=$):$=e[57];let G;e[58]!==u[1]?(G=se(u[1],"min-w-0"),e[58]=u[1],e[59]=G):G=e[59];let Y;e[60]!==M?(Y=i.jsx("div",{className:"flex w-full max-w-[250px] items-center justify-end sm:justify-start",children:M}),e[60]=M,e[61]=Y):Y=e[61];let z;e[62]!==G||e[63]!==Y?(z=i.jsx(ne.Cell,{textAlign:"left",className:G,children:Y}),e[62]=G,e[63]=Y,e[64]=z):z=e[64];let H;e[65]!==P||e[66]!==b||e[67]!==V||e[68]!==u[2]?(H=i.jsx(Ze,{columnClassName:u[2],lastUpdatedBy:P,lastUpdatedRelativeTime:b,tooltipLabel:V}),e[65]=P,e[66]=b,e[67]=V,e[68]=u[2],e[69]=H):H=e[69];let ie;return e[70]!==$||e[71]!==z||e[72]!==H?(ie=i.jsxs(ne.Row,{children:[$,z,H]}),e[70]=$,e[71]=z,e[72]=H,e[73]=ie):ie=e[73],ie}function et(t){return!!t&&typeof t=="object"&&"pages"in t}const ve=(t,e,s,r)=>{const l=te(ee({},t),{review_preference:e.review_preference,updated_at:new Date().toISOString(),last_updated_user_email:s});return e.global_review_preference!==void 0&&(l.global_review_preference=e.global_review_preference,l.global_review_account_id=r),l},je=t=>{var e,s;return(s=(e=t==null?void 0:t.getWorkspaceId())!=null?e:t==null?void 0:t.normalizedAccountUserId)!=null?s:null};function tt(){const t=Se(),e=ye(),s=Ue(),r=be(),l=Re();return De({mutationFn:n=>Fe.updateCodeReviewRepositories(n),onMutate:async n=>{await t.cancelQueries({queryKey:["wham","codeReviewRepositories"]});const c=t.getQueriesData({queryKey:["wham","codeReviewRepositories"]});return t.setQueriesData({queryKey:["wham","codeReviewRepositories"]},d=>{var A,p;if(!d)return d;const m=new Map(((A=n==null?void 0:n.repo_review_settings)!=null?A:[]).map(a=>[a.repository,a])),v=(p=r==null?void 0:r.email)!=null?p:null,_=je(l);if(et(d))return te(ee({},d),{pages:d.pages.map(a=>te(ee({},a),{repo_review_settings:a.repo_review_settings.map(w=>{const g=m.get(w.repository.id);return g===void 0?w:ve(w,g,v,_)})}))});const f=d;return te(ee({},f),{repo_review_settings:f.repo_review_settings.map(a=>{const w=m.get(a.repository.id);return w===void 0?a:ve(a,w,v,_)})})}),{previous:c}},onError:(n,c,d)=>{d!=null&&d.previous&&d.previous.forEach(([m,v])=>{t.setQueryData(m,v)}),s.danger(e.formatMessage({id:"wham.codeReviewPage.teamAutomations.toast.onError",defaultMessage:"Error updating code review preferences"}),{duration:2,hasCloseButton:!0})}})}function st(t){return Be(t,"3220695551")}function mt(){"use no forget";const[t,e]=ae.useState(""),r=Le(t,300).trim(),l=r.length>0,n=Oe(),{data:c,isLoading:d,isFetching:m,fetchNextPage:v,hasNextPage:_,isFetchingNextPage:f}=qe(r),{mutate:A}=tt(),p=ae.useMemo(()=>{var R;return((R=c==null?void 0:c.pages)!=null?R:[]).flatMap(h=>{var x;return(x=h.repo_review_settings)!=null?x:[]}).filter(h=>!!h)},[c]),a=ae.useMemo(()=>[...p].sort((R,h)=>{var b,N,L,P;const x=(N=(b=R.repository)==null?void 0:b.repository_full_name)!=null?N:"",C=(P=(L=h.repository)==null?void 0:L.repository_full_name)!=null?P:"";return x.localeCompare(C,void 0,{sensitivity:"base"})}),[p]),w=ae.useMemo(()=>l?a.slice(0,we):a,[a,l]),g=l&&p.length>=we,U=!l&&!d&&(!!_||!!f),j=Ve(),S=!!We(),D=!!Qe(),T=Re(),O=be(),F=st(n),B=Ke()&&!F,M=je(T);return{queryInput:t,setQueryInput:e,filteredSettings:w,isLoading:d,isFetching:m,fetchNextPage:v,hasNextPage:_,isFetchingNextPage:f,shouldShowMaxSuggestionsNote:g,shouldShowInfiniteScrollRow:U,isTeamOrEnterprise:j,isPlus:S,isPro:D,user:O,isLegacyEnterprisey:B,currentAccountOwnerId:M,updateCodeReviewRepositories:A}}export{ct as T,tt as a,ut as g,mt as u};
//# sourceMappingURL=n3wn9a337n2r8lrh.js.map
