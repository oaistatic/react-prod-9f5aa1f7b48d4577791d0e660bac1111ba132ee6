var fr=Object.defineProperty,dr=Object.defineProperties;var ur=Object.getOwnPropertyDescriptors;var Xs=Object.getOwnPropertySymbols;var mr=Object.prototype.hasOwnProperty,hr=Object.prototype.propertyIsEnumerable;var Ks=(t,e,n)=>e in t?fr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Zs=(t,e)=>{for(var n in e||(e={}))mr.call(e,n)&&Ks(t,n,e[n]);if(Xs)for(var n of Xs(e))hr.call(e,n)&&Ks(t,n,e[n]);return t},qs=(t,e)=>dr(t,ur(e));import{C as qt,a as me,A as Zt,b as pr,F as js,E as Js}from"./k5zh2h7fpzx4n2oe.js";import{b as gr,a as cr,r as wt,c as br,g as Qs,e as we}from"./gfxl3n7r4t82beqq.js";const yr=80,Mr=15,it=40,lt=20;function $r(t){return t==null||t===0?yr:Math.round(t*7)}function kr(t){const e=t==null||t===0?Mr:t;return Math.round(e*96/72)}function ee(t){let e="";for(t+=1;t;){const n=(t-1)%26;e=String.fromCharCode(65+n)+e,t=Math.floor((t-n)/26)}return e}function et(t){const e=t.match(/[A-Z]+/);if(!e)return 0;let n=0;for(const s of e[0])n=n*26+(s.charCodeAt(0)-64);return n-1}function ft(t){const e=t.match(/\d+/);return e?parseInt(e[0],10)-1:0}function xs(t){const e=t.replace(/^0x/i,"");if(e.length===8){const s=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16),h=parseInt(e.slice(6,8),16);return"rgba(".concat(s,", ").concat(l,", ").concat(h,", ").concat(1 .toFixed(3),")")}return e.length===6?"#".concat(e):"#ffffff"}function Re(t){return t==null?void 0:t===64?"#000000":["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"][t]}const tr=cr.get_table();function Cr(t){const e=t.replace(/^#/,"");if(e.length!==6)return null;const n=parseInt(e.slice(0,2),16),s=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);return{r:n,g:s,b:l}}function Sr(t,e,n){t/=255,e/=255,n/=255;const s=Math.max(t,e,n),l=Math.min(t,e,n);let h=0,M=0;const T=(s+l)/2;if(s!==l){const N=s-l;switch(M=T>.5?N/(2-s-l):N/(s+l),s){case t:h=(e-n)/N+(e<n?6:0);break;case e:h=(n-t)/N+2;break;case n:h=(t-e)/N+4;break}h/=6}return{h,s:M,l:T}}function Tr(t,e,n){let s,l,h;if(e===0)s=l=h=n;else{const M=(V,w,b)=>(b<0&&(b+=1),b>1&&(b-=1),b<.16666666666666666?V+(w-V)*6*b:b<.5?w:b<.6666666666666666?V+(w-V)*(.6666666666666666-b)*6:V),T=n<.5?n*(1+e):n+e-n*e,N=2*n-T;s=M(N,T,t+1/3),l=M(N,T,t),h=M(N,T,t-1/3)}return{r:Math.round(s*255),g:Math.round(l*255),b:Math.round(h*255)}}function Fr(t,e){const n=Cr(t);if(!n)return t;const{h:s,s:l,l:h}=Sr(n.r,n.g,n.b),M=e/1e5,T=M>=0?h+(1-h)*M:h*(1+M),{r:N,g:V,b:w}=Tr(s,l,Math.max(0,Math.min(1,T))),b=Mt=>Mt.toString(16).padStart(2,"0");return"#".concat(b(N)).concat(b(V)).concat(b(w))}function er(t,e,n,s,l){var h,M,T,N,V,w,b,Mt,Et,At,Rt,pt,$,vt,_t,$t;if(!(!t||!e)){if(t.numFmtId!=null){n.numberFormatId=t.numFmtId;const d=(h=e.numberFormats)==null?void 0:h.find(D=>D.id===t.numFmtId);d!=null&&d.formatCode?n.numberFormatCode=d.formatCode:tr[t.numFmtId]&&(n.numberFormatCode=tr[t.numFmtId])}if(t.fillId!=null&&(!s||t.applyFill||t.applyFill===void 0)){const d=(M=e.fills)==null?void 0:M[t.fillId];if(d!=null&&d.color){const D=wt(d.color,l);D&&(n.fill=D)}else{const D=(d==null?void 0:d.fgColor)||(d==null?void 0:d.bgColor);D&&(n.fill=xs(D))}}if(t.fontId!=null&&((T=!s||t.applyFont)==null||T)){const d=e.fonts[t.fontId],D=(N=n.font)!=null?N:n.font={};if(typeof(d==null?void 0:d.fontSize)=="number"){const P=d.fontSize*1.3333333333333333;D.size=P}D.bold=(V=d==null?void 0:d.bold)!=null?V:D.bold,D.italic=(w=d==null?void 0:d.italic)!=null?w:D.italic,D.family=d!=null&&d.name?d.name:D.family;const m=(Mt=(b=d==null?void 0:d.fill)==null?void 0:b.color)!=null?Mt:d==null?void 0:d.color;if(m){let P;if(m.type===qt.COLOR_TYPE_SYSTEM&&typeof m.value=="string"){if(m.value==="auto")P="#000000";else if(m.value.startsWith("indexed:")){const kt=parseInt((Et=m.value.split(":")[1])!=null?Et:"",10);Number.isNaN(kt)||(P=Re(kt))}}P||(P=wt(m,l)),P&&(D.color=P,n.textColor=P)}}if(t.horizontalAlignment&&(!s||t.applyAlignment||t.applyAlignment===void 0))switch(t.horizontalAlignment){case"left":case"center":case"right":n.align=t.horizontalAlignment;break}if(t.borderId!=null&&(!s||t.applyBorder||t.applyBorder===void 0)){const d=e.borders[t.borderId];if(d){(At=n.borders)!=null||(n.borders={}),(Rt=n.borderStyles)!=null||(n.borderStyles={});const D=(m,P)=>{var Gt,Qt;if(m){const zt=m.type===qt.COLOR_TYPE_SYSTEM,gt=m.value;if(m.type===qt.COLOR_TYPE_SCHEME&&typeof gt=="string"&&gt.startsWith("theme:")){const dt=parseInt((Gt=gt.split(":")[1])!=null?Gt:"",10);if(!Number.isNaN(dt)){const Ct=["lt1","dk1","lt2","dk2","accent1","accent2","accent3","accent4","accent5","accent6","hlink","folHlink"][dt];if(Ct){const Lt=l.colorMap[Ct];if(Lt)return(Qt=m.transform)!=null&&Qt.tint?Fr(Lt,m.transform.tint):Lt}else{const Lt=wt(m,l);if(Lt)return Lt}}}if(m.type===qt.COLOR_TYPE_RGB&&typeof gt=="string"){const dt=gt.replace(/^#/i,"");if(dt.length===8)return xs(dt);if(dt.length===6)return"#".concat(dt)}if(zt&&(gt!=null&&gt.startsWith("indexed:")||gt==="auto")){const dt=Re(P);if(dt)return dt}return wt(m,l)}return Re(P)};if((pt=d.left)!=null&&pt.style){let m=D(d.left.color,d.left.indexedColorId);m||(m="#000000"),m&&(n.borders.left=m),n.borderStyles.left=d.left.style}if(($=d.right)!=null&&$.style){let m=D(d.right.color,d.right.indexedColorId);m||(m="#000000"),m&&(n.borders.right=m),n.borderStyles.right=d.right.style}if((vt=d.top)!=null&&vt.style){let m=D(d.top.color,d.top.indexedColorId);m||(m="#000000"),m&&(n.borders.top=m),n.borderStyles.top=d.top.style}if((_t=d.bottom)!=null&&_t.style){let m=D(d.bottom.color,d.bottom.indexedColorId);m||(m="#000000"),m&&(n.borders.bottom=m),n.borderStyles.bottom=d.bottom.style}if(($t=d.diagonal)!=null&&$t.style){let m=D(d.diagonal.color,d.diagonal.indexedColorId);m||(m="#000000"),m&&(n.borders.diagonal=m),n.borderStyles.diagonal=d.diagonal.style}d.diagonalUp!=null&&(n.borderDiagonalUp=!!d.diagonalUp),d.diagonalDown!=null&&(n.borderDiagonalDown=!!d.diagonalDown)}}}}function Br(t){const{styles:e}=t,n=gr(t.theme),s={};return e&&e.cellXfs.forEach((l,h)=>{var T;const M={};if(l.xfId!=null&&e.cellStyleXfs&&e.cellStyleXfs[l.xfId]){const N=(T=e.cellStyleXfs[l.xfId])==null?void 0:T.format;er(N,e,M,!1,n)}er(l,e,M,!0,n),s[h]=M}),s}const pe=t=>t/9525;function Er(t,e,n,s,l,h,M,T,N,V,w){if(!(!e.drawings||e.drawings.length===0))for(const b of e.drawings){if(!b.chart||!b.fromAnchor||!b.toAnchor)continue;const Mt=Number(b.fromAnchor.colId),Et=Number(b.fromAnchor.rowId),At=Number(b.toAnchor.colId),Rt=Number(b.toAnchor.rowId)-1,pt=s[Mt],$=l[Et],vt=s[At],_t=l[Rt];if(!pt||!$||!vt||!_t)continue;const $t=it+pt+pe(Number(b.fromAnchor.colOffset))-h,d=lt+$+pe(Number(b.fromAnchor.rowOffset))-M,D=it+vt+pe(Number(b.toAnchor.colOffset))-h,m=lt+_t+pe(Number(b.toAnchor.rowOffset))-M;if(D<0||m<0||$t>T||d>N)continue;const P={x:$t,y:d,width:D-$t,height:m-d};br(t,b.chart,P,{themeMap:V,excelDefaults:!0})}}function nr(t,e,n){var T,N,V,w;if(t.value===""||t.value==null)return"";const s=(N=e[(T=t.styleIndex)!=null?T:0])!=null?N:{},l=n?"".concat(t.value,"||").concat((V=s.numberFormatCode)!=null?V:""):void 0;if(l&&(n!=null&&n.has(l)))return(w=n.get(l))!=null?w:"";let h=t.value;const M=t.dataType===me.CELL_DATA_TYPE_STRING||t.dataType===me.CELL_DATA_TYPE_SHARED_STRING||t.dataType===me.CELL_DATA_TYPE_INLINE_STRING;if(s.numberFormatCode&&!M){const b=Number(t.value);if(!Number.isNaN(b))try{h=cr.format(s.numberFormatCode,b)}catch(Mt){h=t.value}}return l&&(n==null||n.set(l,h)),h}function re(t,e,n){switch(t.save(),n&&(t.strokeStyle=n),t.lineWidth=1,t.setLineDash([]),e){case"thin":t.lineWidth=1;break;case"medium":t.lineWidth=2;break;case"thick":t.lineWidth=3;break;case"dashed":case"mediumDashed":t.lineWidth=e==="mediumDashed"?2:1,t.setLineDash([6,3]);break;case"dashDot":t.setLineDash([6,3,1,3]);break;case"dashDotDot":t.setLineDash([6,3,1,3,1,3]);break;case"slantDashDot":t.setLineDash([]);break;case"double":break;default:t.lineWidth=1;break}}function ge(t,e,n,s,l,h,M){t.save(),t.strokeStyle=n,t.setLineDash([]),t.lineWidth=1;const T=2;e==="top"?(t.beginPath(),t.moveTo(s,l),t.lineTo(s+h,l),t.stroke(),t.beginPath(),t.moveTo(s,l+T),t.lineTo(s+h,l+T),t.stroke()):e==="bottom"?(t.beginPath(),t.moveTo(s,l+M),t.lineTo(s+h,l+M),t.stroke(),t.beginPath(),t.moveTo(s,l+M-T),t.lineTo(s+h,l+M-T),t.stroke()):e==="left"?(t.beginPath(),t.moveTo(s,l),t.lineTo(s,l+M),t.stroke(),t.beginPath(),t.moveTo(s+T,l),t.lineTo(s+T,l+M),t.stroke()):e==="right"&&(t.beginPath(),t.moveTo(s+h,l),t.lineTo(s+h,l+M),t.stroke(),t.beginPath(),t.moveTo(s+h-T,l),t.lineTo(s+h-T,l+M),t.stroke()),t.restore()}function be(t,e,n,s,l,h,M){t.save(),t.strokeStyle=n,t.setLineDash([]),t.lineWidth=2,t.beginPath(),e==="top"?(t.moveTo(s,l),t.lineTo(s+h,l)):e==="bottom"?(t.moveTo(s,l+M),t.lineTo(s+h,l+M)):e==="left"?(t.moveTo(s,l),t.lineTo(s,l+M)):e==="right"&&(t.moveTo(s+h,l),t.lineTo(s+h,l+M)),t.stroke(),t.save(),t.globalAlpha=.5,t.strokeStyle="#ffffff",t.lineWidth=1;const T=8,N=6;if(e==="left"||e==="right"){const V=e==="right"?s+h:s,w=e==="right"?-N:N;for(let b=l;b<=l+M;b+=T)t.beginPath(),t.moveTo(V+w,b),t.lineTo(V,b+N),t.stroke()}else{const V=e==="bottom"?l+M:l,w=e==="bottom"?-N:N;for(let b=s;b<=s+h;b+=T)t.beginPath(),t.moveTo(b,V+w),t.lineTo(b+N,V),t.stroke()}t.restore(),t.restore()}const Ar=t=>{if(!t)return;let e=t.replace(/\s*\(Body\)\s*$/i,"");return e=e.replace(/\s+Regular$/i,""),e=e.replace(/\s+Bold$/i,""),e=e.replace(/\s+Italic$/i,""),e.trim()};function Nr(t){const e=t.match(/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*([\d.]+))?\)$/i);if(!e)return null;const[,n,s,l]=e;return!n||!s||!l?null:[parseInt(n,10),parseInt(s,10),parseInt(l,10)]}const ye=t=>t/9525,Me=new Map,Ce=new Map;function wr(t){const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}function or(t,e){if(!e)return null;const n=t.images;if(!n||n.length===0)return null;const s=n.find(h=>h.id===e);if(!s)return null;const l=typeof s.data=="string"?wr(s.data):s.data;return{id:s.id,contentType:s.contentType,data:l}}function Rr(t,e,n,s,l,h,M,T,N){var w,b,Mt,Et,At,Rt,pt,$,vt,_t;const V=(w=e.drawings)!=null?w:[];if(V.length!==0)for(const $t of V){const d=(b=$t.imageReference)==null?void 0:b.id;if(!d)continue;const D=$t.fromAnchor;if(!D)continue;const m=$t.toAnchor,P=Number(D.colId),kt=Number(D.rowId),Gt=s[P],Qt=l[kt];if(typeof Gt>"u"||typeof Qt>"u")continue;const zt=it+Gt+ye(Number((Mt=D.colOffset)!=null?Mt:0))-h,gt=lt+Qt+ye(Number((Et=D.rowOffset)!=null?Et:0))-M;let dt=0,Nt=0;if(m){const Pt=Number(m.colId),Ut=Number(m.rowId)-1,Bt=s[Pt],Vt=l[Ut];if(typeof Bt>"u"||typeof Vt>"u")continue;const St=it+Bt+ye(Number((At=m.colOffset)!=null?At:0))-h,Tt=lt+Vt+ye(Number((Rt=m.rowOffset)!=null?Rt:0))-M;dt=St-zt,Nt=Tt-gt}else{const Pt=(pt=s[P])!=null?pt:0,Ut=($=s[P+1])!=null?$:Pt,Bt=(vt=l[kt-1])!=null?vt:0,Vt=(_t=l[kt])!=null?_t:Bt,St=Math.max(0,Ut-Pt),Tt=Math.max(0,Vt-Bt),jt=or(n,d);if(!jt)continue;const Xt=Me.get(jt.id);if(!Xt){if(!Ce.has(jt.id)){const se=Qs(jt).then(ie=>(Me.set(jt.id,ie),ie));Ce.set(jt.id,se)}continue}const R=Xt.width,v=Xt.height;if(R<=0||v<=0||St<=0||Tt<=0)continue;const Jt=Math.min(St/R,Tt/v);dt=Math.max(0,Math.floor(R*Jt)),Nt=Math.max(0,Math.floor(v*Jt));const xt=(St-dt)/2,oe=(Tt-Nt)/2;t.drawImage(Xt,0,0,R,v,zt+xt,gt+oe,dt,Nt);continue}if(zt+dt<0||gt+Nt<0||zt>T||gt>N)continue;const Ct=or(n,d);if(!Ct)continue;const Lt=Me.get(Ct.id);if(Lt){t.drawImage(Lt,0,0,Lt.width,Lt.height,zt,gt,dt,Nt);continue}if(!Ce.has(Ct.id)){const Pt=Qs(Ct).then(Ut=>(Me.set(Ct.id,Ut),Ut));Ce.set(Ct.id,Pt)}}}const de=10/12,ne="#4F81BD",ae={headerFill:{type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:0,shade:0,lumMod:1e5,lumOff:1180,satMod:0,alpha:1e5}},rowStripeFill:{type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},colStripeFill:{type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:8e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},firstLastColFill:{type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}}},vr={type:qt.COLOR_TYPE_SCHEME,value:"accent1",transform:{tint:6e4,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:1e5}},sr=new WeakMap;function Se(t){let e=sr.get(t);return e||(e={rowCellByColIdx:new Map,rowNonEmptyCols:new Map,textMetrics:new Map},sr.set(t,e)),e}function ue(t,e){return t+":"+e}function Te(t,e){let n=0,s=t.length;for(;n<s;){const l=n+s>>>1,h=t[l];h!==void 0&&h<e?n=l+1:s=l}return n}function rr(t,e){let n=0,s=t.length;for(;n<s;){const l=n+s>>>1,h=t[l];h!==void 0&&h<=e?n=l+1:s=l}return n}const Lr=/((?:'[^']+'|[A-Za-z0-9_.]+)!)?(\$?[A-Za-z]{1,3}\$?\d{1,7})(?::(\$?[A-Za-z]{1,3}\$?\d{1,7}))?/g;function ar(t){var h;let e=0;t[e]==="$"&&e++;const n=e;for(;e<t.length&&/[A-Za-z]/.test((h=t[e])!=null?h:"");)e++;const s=t.slice(n,e);t[e]==="$"&&e++;const l=t.slice(e);return{col:et(s),row:parseInt(l,10)||0}}function Ir(t){t=Math.max(1,t);let e="";for(;t>0;){const n=(t-1)%26;e=String.fromCharCode(65+n)+e,t=Math.floor((t-1)/26)}return e}function ir(t,e,n){var $;const s=t.startsWith("$"),l=s?1:0;let h=l;for(;h<t.length&&/[A-Za-z]/.test(($=t[h])!=null?$:"");)h++;const M=t.slice(l,h);let T=!1,N=h;t[N]==="$"&&(T=!0,N++);const V=t.slice(N),w=et(M),b=parseInt(V,10)||0,Mt=s?w:Math.max(1,w+e),Et=T?b:Math.max(1,b+n),At=Ir(Mt),Rt=(s?"$":"")+At,pt=(T?"$":"")+String(Et);return Rt+pt}function lr(t,e,n){if(!t||!e||!n)return t;const{col:s,row:l}=ar(e),{col:h,row:M}=ar(n),T=h-s,N=M-l;return T===0&&N===0?t:t.replace(Lr,(V,w,b,Mt)=>{const Et=w?String(w):"",At=ir(String(b),T,N);if(!Mt)return"".concat(Et).concat(At);const Rt=ir(String(Mt),T,N);return"".concat(Et).concat(At,":").concat(Rt)})}function _r(t){var n;const e=new Map;for(const s of(n=t.sharedFormulas)!=null?n:[])typeof s.si=="number"&&s.base&&s.anchor&&e.set(s.si,{base:s.base,anchor:s.anchor});return e}function Wr(t,e,n,s,l,h,M,T,N,V,w,b,Mt,Et,At,Rt,pt,$,vt,_t,$t,d){var Le,Ie,_e,Pe,De,Oe,$e,ke,Be,We,Ye,He,Ge,ze,Ue,Ve,Xe,Ke,Ze,qe,je,Je,Qe,xe,tn,en,nn,on,sn,rn,an,ln,cn,fn,dn,un,mn,hn,pn,gn,bn,yn,Mn,Cn,Sn,Tn,Fn,En,An,Nn,wn,Rn,vn,Ln,In,_n,Pn,Dn,On,$n,kn,Bn,Wn,Yn,Hn,Gn,zn,Un,Vn,Xn,Kn,Zn,qn,jn,Jn,Qn,xn,to,eo,no,oo,so,ro,ao,io,lo,co,fo,uo,mo,ho,po,go,bo,yo,Mo,Co,So,To,Fo,Eo,Ao,No,wo,Ro,vo,Lo,Io,_o,Po,Do,Oo,$o,ko,Bo,Wo,Yo,Ho,Go,zo,Uo,Vo,Xo,Ko,Zo,qo,jo,Jo,Qo,xo,ts,es,ns,os,ss,rs,as,is,ls,cs,fs,ds,us,ms,hs,ps,gs,bs,ys,Ms,Cs,Ss,Ts,Fs,Es,As,Ns,ws,Rs,vs,Ls,Is,_s,Ps,Ds,Os,$s,ks,Bs,Ws,Ys,Hs,Gs,zs;const D=w||1,m=l/D,P=h/D,kt=new Set,Gt=_r(e);function Qt(o,i){var E,_,X,H,g;if(!(le.get(o)!=null))return(E=n[i])!=null?E:0;Fe(o);const y=(_=Se(e).rowNonEmptyCols.get(o))!=null?_:[],c=rr(y,i);let a=(X=y[c])!=null?X:n.length;const u=(F,q)=>{var at;const rt=Tt(F,q);if(Ct(rt)==null)return!1;for(const k of Bt)if(((at=k.ranges)!=null?at:[]).some(C=>C.sheetName&&C.sheetName!==e.name?!1:Nt(F,q,C)))return!0;return!1};for(let F=i+1;F<a;F++)if(u(o,F)){a=F;break}const p=(H=R[i])!=null?H:0,f=(g=R[a])!=null?g:p;return Math.max(0,f-p)}function zt(o,i){var E,_,X,H;if(i<0)return!1;Fe(o);const r=(E=Se(e).rowNonEmptyCols.get(o))!=null?E:[],y=rr(r,i)-1;if(y<0)return!1;const c=(_=r[y])!=null?_:-1;if(c<0)return!1;const a=Se(e).textMetrics.get(ue(o,c));if(!a||a.isNumeric)return!1;const u=Math.max(0,((X=R[i+1])!=null?X:0)-((H=R[c])!=null?H:0)),p=Math.max(0,u-(a.padLr+a.padLr));return a.firstLineW+.001>=p}function gt(o){var c,a,u,p,f;if(typeof o!="number")return null;const i=(c=pt.styles)==null?void 0:c.dxfs,r=i==null?void 0:i[o];if(!r)return null;const y=(f=(a=r==null?void 0:r.fill)==null?void 0:a.color)!=null?f:(p=(u=r==null?void 0:r.font)==null?void 0:u.fill)==null?void 0:p.color;return y?wt(y,$,"rgba(0,0,0,1)"):null}function dt(o){var c,a,u;if(typeof o!="number")return null;const i=(c=pt.styles)==null?void 0:c.dxfs,r=i==null?void 0:i[o],y=(u=(a=r==null?void 0:r.border)==null?void 0:a.bottom)==null?void 0:u.color;return y?wt(y,$,"#cccccc"):null}function Nt(o,i,r){const y=et(r.startAddress),c=ft(r.startAddress),a=et(r.endAddress),u=ft(r.endAddress),p=Math.min(c,u),f=Math.max(c,u),E=Math.min(y,a),_=Math.max(y,a);return o>=p&&o<=f&&i>=E&&i<=_}function Ct(o){if(!o)return null;const i=Number(o.value);return Number.isNaN(i)?null:i}function Lt(o,i,r){const y=Array.isArray(i)?i:void 0;if(r==null)return!1;const c=(y==null?void 0:y[0])!=null?Number(y[0]):NaN,a=(y==null?void 0:y[1])!=null?Number(y[1]):NaN;switch(o){case"greaterThan":return r>c;case"greaterThanOrEqual":return r>=c;case"lessThan":return r<c;case"lessThanOrEqual":return r<=c;case"equal":return r===c;case"notEqual":return r!==c;case"between":return r>=Math.min(c,a)&&r<=Math.max(c,a);case"notBetween":return!(r>=Math.min(c,a)&&r<=Math.max(c,a));default:return!1}}const Pt=(Le=e.conditionalFormattings)!=null?Le:[],Ut=[],Bt=[];for(const o of Pt)for(const i of(Ie=o.rules)!=null?Ie:[])if(i.type==="colorScale"&&i.colorScale){const r=[];for(const g of(_e=o.ranges)!=null?_e:[]){if(g.sheetName&&g.sheetName!==e.name)continue;const F=et(g.startAddress),q=ft(g.startAddress),rt=et(g.endAddress),st=ft(g.endAddress),at=Math.min(q,st),k=Math.max(q,st),G=Math.min(F,rt),C=Math.max(F,rt);for(let J=at;J<=k;J++){const Q=e.rows.find(I=>I.index-1===J);if(Q)for(let I=G;I<=C;I++){const nt=Q.cells.find(Wt=>et(Wt.address)===I),ut=Ct(nt);ut!=null&&r.push(ut)}}}const y=r.slice().sort((g,F)=>g-F),c=g=>{var G,C;if(y.length===0)return 0;const F=g/100*(y.length-1),q=Math.floor(F),rt=Math.min(y.length-1,Math.ceil(F)),st=F-q,at=(G=y[q])!=null?G:0,k=(C=y[rt])!=null?C:at;return at+(k-at)*st},a=(Pe=i.colorScale.cfvos)!=null?Pe:[],u=(De=i.colorScale.colors)!=null?De:[],p=[],f=[];for(let g=0;g<a.length;g++){const F=a[g];if(!F)continue;let q=0;F.type==="min"?q=(Oe=y[0])!=null?Oe:0:F.type==="max"?q=($e=y[y.length-1])!=null?$e:0:F.type==="num"?q=Number((ke=F.val)!=null?ke:0):F.type==="percentile"?q=c(Number((Be=F.val)!=null?Be:0)):q=Number((We=F.val)!=null?We:0),f.push(q);const rt=u[g],st=rt?wt(rt,$,"rgba(0,0,0,1)"):"rgba(0,0,0,1)",at=(Ye=Nr(st))!=null?Ye:[0,0,0];p.push({pos:0,rgb:at})}const E=Math.min(...f),_=Math.max(...f),X=g=>_===E?0:(g-E)/(_-E);for(let g=0;g<p.length;g++){const F=p[g];F&&(F.pos=X((He=f[g])!=null?He:0))}const H=(a!=null?a:[]).some(g=>g.type==="min"||g.type==="max");Ut.push({ranges:o.ranges,stops:p,vMin:E,vMax:_,priority:typeof i.priority=="number"?i.priority:9999,includeEndpoints:H})}for(const o of Pt)for(const i of(Ge=o.rules)!=null?Ge:[])if(i.type==="dataBar"){const r=[];for(const u of(ze=o.ranges)!=null?ze:[]){if(u.sheetName&&u.sheetName!==e.name)continue;const p=et(u.startAddress),f=ft(u.startAddress),E=et(u.endAddress),_=ft(u.endAddress),X=Math.min(f,_),H=Math.max(f,_),g=Math.min(p,E),F=Math.max(p,E);for(let q=X;q<=H;q++){const rt=e.rows.find(st=>st.index-1===q);if(rt)for(let st=g;st<=F;st++){const at=rt.cells.find(G=>et(G.address)===st),k=Ct(at);k!=null&&r.push(k)}}}if(r.length===0)continue;const y=Math.min(...r),c=Math.max(...r),a=wt((Ve=(Ue=i.dataBar)==null?void 0:Ue.color)!=null?Ve:vr,$,((Xe=$.colorMap)==null?void 0:Xe.accent1)||ne);Bt.push({ranges:o.ranges,vMin:y,vMax:c,colorCss:a,priority:typeof i.priority=="number"?i.priority:9999,showValue:!0})}t.save(),t.scale(w,w);const Vt=.5/(window.devicePixelRatio*w),St=Se(e);function Tt(o,i){var r;return Fe(o),(r=St.rowCellByColIdx.get(o))==null?void 0:r.get(i)}const jt={thin:1,dashed:2,dashDot:2,dashDotDot:2,medium:3,mediumDashed:3,slantDashDot:3,thick:4,double:5},Xt=o=>{var i;return o&&(i=jt[o])!=null?i:0},R=[0];for(let o=0;o<n.length;o++)R[o+1]=((Ke=R[o])!=null?Ke:0)+((Ze=n[o])!=null?Ze:0);const v=[0];for(let o=0;o<s.length;o++)v[o+1]=((qe=v[o])!=null?qe:0)+((je=s[o])!=null?je:0);const Jt=Math.max(0,Te(R,m)-1),xt=Math.min(n.length-1,Te(R,m+M/w)+1),oe=Math.max(0,Te(v,P)-1),se=Math.min(s.length-1,Te(v,P+T/w)+1);t.clearRect(0,0,M/w,T/w),t.fillStyle="white",t.fillRect(0,0,M/w,T/w);const ie=new Map;for(const o of e.rows)ie.set(o.index-1,o);const le=new Map;if(_t&&_t.length>0){const o=s.length;for(let i=0;i<o;i++){const r=(Je=_t[i])!=null?Je:i,y=ie.get(r);y&&le.set(i,y)}}else for(const o of e.rows)le.set(o.index-1,o);function Fe(o){var c;if(St.rowCellByColIdx.has(o)&&St.rowNonEmptyCols.has(o))return;const i=le.get(o);if(!i){St.rowCellByColIdx.set(o,new Map),St.rowNonEmptyCols.set(o,[]);return}const r=new Map,y=[];for(const a of i.cells){const u=et(a.address);r.set(u,a);const p=a.value!=null&&String(a.value)!=="",f=!!((c=a.paragraphs)!=null&&c.some(E=>{var _;return(_=E.runs)==null?void 0:_.some(X=>{var H;return((H=X.text)!=null?H:"").length>0})}));(p||f||a.formula||typeof a.sharedFormulaSi=="number")&&y.push(u)}y.sort((a,u)=>a-u),St.rowCellByColIdx.set(o,r),St.rowNonEmptyCols.set(o,y)}const Ee=[];for(const o of(Qe=e.columns)!=null?Qe:[]){const i=o,r=typeof(i==null?void 0:i.styleIndex)=="number"?i.styleIndex:void 0;if(typeof r=="number"){const y=Math.max(0,((xe=o.min)!=null?xe:1)-1),c=Math.max(y,((en=(tn=o.max)!=null?tn:o.min)!=null?en:1)-1);for(let a=y;a<=c;a++)Ee[a]==null&&(Ee[a]=r)}}const Ae=new Set,Ne=new Set;if(((on=(nn=e.pivotTables)==null?void 0:nn.length)!=null?on:0)>0)for(const o of(sn=e.pivotTables)!=null?sn:[]){const i=o.location,r=(rn=i==null?void 0:i.reference)!=null?rn:"";if(!r)continue;const[y,c]=r.split(":"),a=et(y||"A1"),u=ft(y||"A1"),p=c?et(c):a,f=c?ft(c):u,E=Math.max(Math.min(a,p),Jt),_=Math.min(Math.max(a,p),xt),X=Math.max(Math.min(u,f),oe),H=Math.min(Math.max(u,f),se);if(E>_||X>H)continue;const g=typeof(i==null?void 0:i.firstHeaderRow)=="number"&&i.firstHeaderRow>0?i.firstHeaderRow-1:u,F=typeof(i==null?void 0:i.firstDataRow)=="number"&&i.firstDataRow>0?i.firstDataRow-1:Math.min(f,g+1),q=typeof(i==null?void 0:i.firstHeaderColumn)=="number"&&i.firstHeaderColumn>0?i.firstHeaderColumn-1:a,rt=typeof(i==null?void 0:i.firstDataColumn)=="number"&&i.firstDataColumn>0?i.firstDataColumn-1:Math.min(p,q+1),st=wt(ae.headerFill,$,((an=$.colorMap)==null?void 0:an.accent1)||ne),at=wt(ae.firstLastColFill,$,((ln=$.colorMap)==null?void 0:ln.accent1)||ne);if(F>=X){const k=X,G=Math.min(H,F-1);if(G>=k){const C=it+((cn=R[E])!=null?cn:0)-m,J=lt+((fn=v[k])!=null?fn:0)-P,Q=((dn=R[_+1])!=null?dn:0)-((un=R[E])!=null?un:0),I=((mn=v[G+1])!=null?mn:0)-((hn=v[k])!=null?hn:0);t.fillStyle=st,t.fillRect(C,J,Q,I);for(let nt=k;nt<=G;nt++)for(let ut=E;ut<=_;ut++)Ae.add("".concat(ee(ut)).concat(nt+1))}}if(rt>=E){const k=E,G=Math.min(_,rt-1);if(G>=k){const C=it+((pn=R[k])!=null?pn:0)-m,J=lt+((gn=v[X])!=null?gn:0)-P,Q=((bn=R[G+1])!=null?bn:0)-((yn=R[k])!=null?yn:0),I=((Mn=v[H+1])!=null?Mn:0)-((Cn=v[X])!=null?Cn:0);t.fillStyle=st,t.fillRect(C,J,Q,I);for(let nt=X;nt<=H;nt++)for(let ut=k;ut<=G;ut++)Ae.add("".concat(ee(ut)).concat(nt+1))}}if(o.rowGrandTotals){const k=H,G=it+((Sn=R[E])!=null?Sn:0)-m,C=lt+((Tn=v[k])!=null?Tn:0)-P,J=((Fn=R[_+1])!=null?Fn:0)-((En=R[E])!=null?En:0),Q=(An=s[k])!=null?An:0;t.fillStyle=at,t.fillRect(G,C,J,Q);for(let I=E;I<=_;I++)Ne.add("".concat(ee(I)).concat(k+1))}if(o.columnGrandTotals){const k=_,G=it+((Nn=R[k])!=null?Nn:0)-m,C=lt+((wn=v[X])!=null?wn:0)-P,J=(Rn=n[k])!=null?Rn:0,Q=((vn=v[H+1])!=null?vn:0)-((Ln=v[X])!=null?Ln:0);t.fillStyle=at,t.fillRect(G,C,J,Q);for(let I=X;I<=H;I++)Ne.add("".concat(ee(k)).concat(I+1))}}const ce=(In=e.tables)!=null?In:[],ve=new Set;if(ce.length>0)for(const o of ce){if(!o.ref)continue;const[i,r]=o.ref.split(":");if(!i)continue;const y=et(i),c=ft(i),a=r?et(r):y,u=r?ft(r):c,p=Math.max(Math.min(y,a),Jt),f=Math.min(Math.max(y,a),xt),E=Math.max(Math.min(c,u),oe),_=Math.min(Math.max(c,u),se);if(p>f||E>_)continue;const X=Math.max(0,Math.min(1,(_n=o.headerRowCount)!=null?_n:1)),H=Math.max(0,Math.min(1,(Pn=o.totalsRowCount)!=null?Pn:o.totalsRowShown?1:0)),g=Math.min(_,Math.max(E,Math.min(c,u)+X)),F=Math.max(E,Math.min(_,Math.max(c,u)-H)),q=wt(ae.headerFill,$,((Dn=$.colorMap)==null?void 0:Dn.accent1)||ne),rt=wt(ae.rowStripeFill,$,((On=$.colorMap)==null?void 0:On.accent1)||ne),st=wt(ae.colStripeFill,$,(($n=$.colorMap)==null?void 0:$n.accent1)||ne),at=wt(ae.firstLastColFill,$,((kn=$.colorMap)==null?void 0:kn.accent1)||ne);if(X>0){const C=Math.min(_,Math.min(c,u));if(C>=E&&C<=_){const J=it+((Bn=R[p])!=null?Bn:0)-m,Q=lt+((Wn=v[C])!=null?Wn:0)-P,I=((Yn=R[f+1])!=null?Yn:0)-((Hn=R[p])!=null?Hn:0),nt=(Gn=s[C])!=null?Gn:0,ut=o==null?void 0:o.dataDxfId,Wt=(zn=gt(ut))!=null?zn:q;t.fillStyle=Wt,t.fillRect(J,Q,I,nt);for(let te=p;te<=f;te++)ve.add("".concat(ee(te)).concat(C+1))}}if((Un=o.style)!=null&&Un.showRowStripes&&g<=F){for(let C=g;C<=F;C++)if((C-g)%2===1){const Q=it+((Vn=R[p])!=null?Vn:0)-m,I=lt+((Xn=v[C])!=null?Xn:0)-P,nt=((Kn=R[f+1])!=null?Kn:0)-((Zn=R[p])!=null?Zn:0),ut=(qn=s[C])!=null?qn:0;t.fillStyle=rt,t.fillRect(Q,I,nt,ut)}}if((jn=o.style)!=null&&jn.showColumnStripes&&g<=F){for(let C=p;C<=f;C++)if((C-Math.min(y,a))%2===1){const Q=it+((Jn=R[C])!=null?Jn:0)-m,I=lt+((Qn=v[g])!=null?Qn:0)-P,nt=(xn=n[C])!=null?xn:0,ut=((to=v[F+1])!=null?to:0)-((eo=v[g])!=null?eo:0);t.fillStyle=st,t.fillRect(Q,I,nt,ut)}}const k=!!((no=o.style)!=null&&no.showFirstColumn),G=!!((oo=o.style)!=null&&oo.showLastColumn);if(g<=F&&(k||G)){if(k){const C=Math.min(y,a);if(C>=p&&C<=f){const J=it+((so=R[C])!=null?so:0)-m,Q=lt+((ro=v[g])!=null?ro:0)-P,I=(ao=n[C])!=null?ao:0,nt=((io=v[F+1])!=null?io:0)-((lo=v[g])!=null?lo:0);t.fillStyle=at,t.fillRect(J,Q,I,nt)}}if(G){const C=Math.max(y,a);if(C>=p&&C<=f){const J=it+((co=R[C])!=null?co:0)-m,Q=lt+((fo=v[g])!=null?fo:0)-P,I=(uo=n[C])!=null?uo:0,nt=((mo=v[F+1])!=null?mo:0)-((ho=v[g])!=null?ho:0);t.fillStyle=at,t.fillRect(J,Q,I,nt)}}}}for(let o=oe;o<=se;o++){const i=le.get(o),r=lt+((po=v[o])!=null?po:0)-P,y=[];for(let c=Jt;c<=xt;c++){const a=it+((go=R[c])!=null?go:0)-m;let u=(bo=n[c])!=null?bo:0,p=(yo=s[o])!=null?yo:0;const f=Tt(o,c),E="".concat(ee(c)).concat(o+1),_=i==null?void 0:i.styleIndex,X=Ee[c],H=(So=(Co=(Mo=f==null?void 0:f.styleIndex)!=null?Mo:_)!=null?Co:X)!=null?So:0,g=(To=b[H])!=null?To:{},F=(Fo=g.borders)==null?void 0:Fo.diagonal,q=!!g.borderDiagonalUp,rt=!!g.borderDiagonalDown,st=(Eo=g.borderStyles)==null?void 0:Eo.diagonal;if(f){const S=(()=>{if(vt){if(f.formula)return"= ".concat(f.formula);if(typeof f.sharedFormulaSi=="number"){const A=Gt.get(f.sharedFormulaSi);if(A)return"= ".concat(lr(A.base,A.anchor,f.address))}}return nr(f,b)})(),L=(()=>{if(vt&&(f.formula||typeof f.sharedFormulaSi=="number"&&Gt.has(f.sharedFormulaSi)))return!1;const A=Number(f.value);return f.dataType!==me.CELL_DATA_TYPE_STRING&&!Number.isNaN(A)})(),z=((No=(Ao=g.font)==null?void 0:Ao.size)!=null?No:11*(96/72))*de,ct=Math.max(2,Math.round((z||11)*.35)),O=Math.max(1,Math.round((z||11)*.25));if(L)St.textMetrics.set(ue(o,c),{firstLineW:0,padLr:ct,padTb:O,isNumeric:L});else{const mt={paragraphs:f.paragraphs&&f.paragraphs.length>0?f.paragraphs:[{runs:[{text:S,citations:[]}]}],textStyle:{alignment:Zt.ALIGNMENT_TYPE_LEFT},bbox:{xEmu:0,yEmu:0,widthEmu:Math.round(1e6*9525),heightEmu:Math.round(p*9525)},type:Js.ELEMENT_TYPE_TEXT,levelsStyles:[]},ot=we(mt,t,$,void 0,{resolvedStyle:{alignment:Zt.ALIGNMENT_TYPE_LEFT},bboxPx:{x:0,y:0,width:1e6,height:p},mode:"layout",textScale:de,wrap:!1}),j=(vo=(Ro=(wo=ot==null?void 0:ot.lines)==null?void 0:wo[0])==null?void 0:Ro.widthPx)!=null?vo:0;St.textMetrics.set(ue(o,c),{firstLineW:j,padLr:ct,padTb:O,isNumeric:L})}}const at=(Lo=e.mergedCells)!=null?Lo:[];let k=!1,G=o,C=o,J=c,Q=c,I=(Io=g.borders)!=null?Io:null,nt=(_o=g.borderStyles)!=null?_o:null;{const S=at.find(L=>Nt(o,c,L));if(S){const L=et(S.startAddress),x=ft(S.startAddress),z=et(S.endAddress),ct=ft(S.endAddress);if(G=Math.min(x,ct),C=Math.max(x,ct),J=Math.min(L,z),Q=Math.max(L,z),k=o===G&&c===J,!k)continue;u=((Po=R[Q+1])!=null?Po:0)-((Do=R[J])!=null?Do:0),p=((Oo=v[C+1])!=null?Oo:0)-(($o=v[G])!=null?$o:0);let O=0,A=0,mt=0,ot=0;const j={},tt={};for(let B=J;B<=Q;B++){const K=Tt(G,B),ht=(Bo=b[(ko=K==null?void 0:K.styleIndex)!=null?ko:0])!=null?Bo:{},W=(Wo=ht.borderStyles)==null?void 0:Wo.top,Z=Xt(W);(Yo=ht.borders)!=null&&Yo.top&&Z>=O&&(j.top=ht.borders.top,tt.top=W,O=Z)}for(let B=J;B<=Q;B++){const K=Tt(C,B),ht=(Go=b[(Ho=K==null?void 0:K.styleIndex)!=null?Ho:0])!=null?Go:{},W=(zo=ht.borderStyles)==null?void 0:zo.bottom,Z=Xt(W);(Uo=ht.borders)!=null&&Uo.bottom&&Z>=A&&(j.bottom=ht.borders.bottom,tt.bottom=W,A=Z)}for(let B=G;B<=C;B++){const K=Tt(B,J),ht=(Xo=b[(Vo=K==null?void 0:K.styleIndex)!=null?Vo:0])!=null?Xo:{},W=(Ko=ht.borderStyles)==null?void 0:Ko.left,Z=Xt(W);(Zo=ht.borders)!=null&&Zo.left&&Z>=mt&&(j.left=ht.borders.left,tt.left=W,mt=Z)}for(let B=G;B<=C;B++){const K=Tt(B,Q),ht=(jo=b[(qo=K==null?void 0:K.styleIndex)!=null?qo:0])!=null?jo:{},W=(Jo=ht.borderStyles)==null?void 0:Jo.right,Z=Xt(W);(Qo=ht.borders)!=null&&Qo.right&&Z>=ot&&(j.right=ht.borders.right,tt.right=W,ot=Z)}I=j,nt=tt}}const ut=g.fill;ut&&(t.fillStyle=ut,t.fillRect(a,r,u,p));let Wt=null,te=null,he=Number.POSITIVE_INFINITY,Us=Number.POSITIVE_INFINITY;if(Pt.length>0){for(const S of Pt)if(((xo=S.ranges)!=null?xo:[]).some(x=>x.sheetName&&x.sheetName!==e.name?!1:Nt(o,c,x)))for(const x of(ts=S.rules)!=null?ts:[]){const z=typeof x.priority=="number"?x.priority:9999;if(x.type==="cellIs"){const ct=Ct(f);if(Lt((es=x.operator)!=null?es:"",x.formula,ct)){const O=x.dxfId;if(z<he){const j=gt(O);j&&(Wt=j,he=z)}const A=(ns=pt.styles)==null?void 0:ns.dxfs,mt=typeof O=="number"?A==null?void 0:A[O]:void 0,ot=(ss=(os=mt==null?void 0:mt.font)==null?void 0:os.fill)==null?void 0:ss.color;ot&&z<Us&&(te=ot,Us=z),Wt||(Wt="rgba(255,199,206,1)")}}}for(const S of Ut){if(!((rs=S.ranges)!=null?rs:[]).some(j=>j.sheetName&&j.sheetName!==e.name?!1:Nt(o,c,j)))continue;const x=Ct(f);if(x==null)continue;const z=S.vMax===S.vMin?0:(x-S.vMin)/(S.vMax-S.vMin),ct=Math.max(0,Math.min(1,z));if(Number.isNaN(ct))continue;const O=S.stops;if(O.length===0)continue;let A=(is=(as=O[0])==null?void 0:as.rgb)!=null?is:[0,0,0];if(O.length===1)A=(cs=(ls=O[0])==null?void 0:ls.rgb)!=null?cs:[0,0,0];else{let j=0;for(;j<O.length-1&&ct>((ds=(fs=O[j+1])==null?void 0:fs.pos)!=null?ds:0);)j++;const tt=O[j];if(!tt)continue;const B=O[Math.min(j+1,O.length-1)];if(!B)continue;const K=tt.pos===B.pos?0:(ct-tt.pos)/(B.pos-tt.pos);A=[Math.round(tt.rgb[0]+(B.rgb[0]-tt.rgb[0])*K),Math.round(tt.rgb[1]+(B.rgb[1]-tt.rgb[1])*K),Math.round(tt.rgb[2]+(B.rgb[2]-tt.rgb[2])*K)]}const mt="rgba(".concat(A[0],",").concat(A[1],",").concat(A[2],",1)"),ot=S.priority;ot<he&&(Wt=mt,he=ot)}}if(Wt&&(t.fillStyle=Wt,t.fillRect(a,r,u,p)),At.has("".concat(e.name,":").concat(E))&&(t.fillStyle="#eeeeee",t.fillRect(a,r,u,p)),Rt&&N===o&&V===c&&(t.fillStyle="rgba(255,255,0,0.2)",t.fillRect(a,r,u,p)),Bt.length>0){let S=null;for(const L of Bt)((us=L.ranges)!=null?us:[]).some(z=>z.sheetName&&z.sheetName!==e.name?!1:Nt(o,c,z))&&(!S||L.priority<S.priority)&&(S=L);if(S){const L=Ct(f);if(L!=null){const z=Math.max(0,u-2),ct=Math.max(0,p-2),O=S.vMin,A=S.vMax;if(A!==O&&z>0&&ct>0){let mt=a+1,ot=0;if(O>=0)ot=Math.max(0,Math.min(1,(L-O)/(A-O)))*z;else if(A<=0)ot=Math.max(0,Math.min(1,(L-A)/(O-A)))*z,mt=a+1+(z-ot);else{const j=-O/(A-O),tt=z*j;if(L>=0){const B=Math.max(0,Math.min(1,L/A));mt=a+1+tt,ot=B*(z-tt)}else{const B=Math.max(0,Math.min(1,L/O));mt=a+1+tt-B*tt,ot=B*tt}}ot>.5&&(t.save(),t.globalAlpha=.6,t.fillStyle=S.colorCss,t.fillRect(mt,r+1,ot,ct),t.restore())}}}}if(I){const S=I,L=nt!=null?nt:{};S.top&&(L.top==="double"?ge(t,"top",S.top,a,r,u,p):L.top==="slantDashDot"?be(t,"top",S.top,a,r,u,p):(re(t,L.top,S.top),t.beginPath(),t.moveTo(a,r),t.lineTo(a+u,r),t.stroke(),t.restore())),S.bottom&&(L.bottom==="double"?ge(t,"bottom",S.bottom,a,r,u,p):L.bottom==="slantDashDot"?be(t,"bottom",S.bottom,a,r,u,p):(re(t,L.bottom,S.bottom),t.beginPath(),t.moveTo(a,r+p),t.lineTo(a+u,r+p),t.stroke(),t.restore())),S.left&&(L.left==="double"?ge(t,"left",S.left,a,r,u,p):L.left==="slantDashDot"?be(t,"left",S.left,a,r,u,p):(re(t,L.left,S.left),t.beginPath(),t.moveTo(a,r),t.lineTo(a,r+p),t.stroke(),t.restore())),S.right&&(L.right==="double"?ge(t,"right",S.right,a,r,u,p):L.right==="slantDashDot"?be(t,"right",S.right,a,r,u,p):(re(t,L.right,S.right),t.beginPath(),t.moveTo(a+u,r),t.lineTo(a+u,r+p),t.stroke(),t.restore()))}if(e.showGridLines!==!1&&!(!!g.fill||!!Wt)){t.strokeStyle="#ccc",t.lineWidth=Vt;const L=(()=>{var bt,yt;const W=Tt(o-1,c),Z=(bt=W==null?void 0:W.styleIndex)!=null?bt:0;return(yt=b[Z])!=null?yt:{}})(),x=(()=>{var bt,yt;const W=Tt(o,c-1),Z=(bt=W==null?void 0:W.styleIndex)!=null?bt:0;return(yt=b[Z])!=null?yt:{}})(),z=(W,Z)=>{var yt;const bt=(yt=e.mergedCells)!=null?yt:[];for(const Ft of bt){const Dt=et(Ft.startAddress),Ot=ft(Ft.startAddress),Yt=et(Ft.endAddress),Kt=ft(Ft.endAddress),U=Math.min(Dt,Yt),Y=Math.max(Dt,Yt),It=Math.min(Ot,Kt),Ht=Math.max(Ot,Kt);if(Z>=U&&Z<=Y&&W-1>=It&&W<=Ht)return!0}return!1},ct=(W,Z)=>{var yt;const bt=(yt=e.mergedCells)!=null?yt:[];for(const Ft of bt){const Dt=et(Ft.startAddress),Ot=ft(Ft.startAddress),Yt=et(Ft.endAddress),Kt=ft(Ft.endAddress),U=Math.min(Dt,Yt),Y=Math.max(Dt,Yt),It=Math.min(Ot,Kt),Ht=Math.max(Ot,Kt);if(W>=It&&W<=Ht&&Z-1>=U&&Z<=Y)return!0}return!1},O=!!(I!=null&&I.top),A=(W,Z)=>{for(const bt of ce){if(!bt.ref)continue;const yt=et(bt.ref.split(":")[0]||bt.ref),Ft=ft(bt.ref.split(":")[0]||bt.ref),Dt=bt.ref.split(":")[1],Ot=Dt?et(Dt):yt,Yt=Dt?ft(Dt):Ft,Kt=Math.min(yt,Ot),U=Math.max(yt,Ot),Y=Math.min(Ft,Yt),It=Math.max(Ft,Yt);if(Z>=Kt&&Z<=U&&W-1>=Y&&W<=It)return!0}return!1},mt=!!((ms=L.borders)!=null&&ms.bottom),ot=z(o,c),j=A(o,c);!O&&!mt&&!ot&&!j&&(t.beginPath(),t.moveTo(a,r),t.lineTo(a+u,r),t.stroke());const tt=!!(I!=null&&I.left),B=!!((hs=x.borders)!=null&&hs.right),K=zt(o,c-1),ht=ct(o,c);!tt&&!B&&!K&&!ht&&(t.beginPath(),t.moveTo(a,r),t.lineTo(a,r+p),t.stroke())}if(Et.has(E)){const S=Mt[E];S&&(t.save(),t.fillStyle=S+"22",t.fillRect(a,r,u,p),t.restore(),t.strokeStyle=S,t.lineWidth=2,t.strokeRect(a,r,u,p))}if(f){const S=(()=>{if(vt){if(f.formula)return"= ".concat(f.formula);if(typeof f.sharedFormulaSi=="number"){const U=Gt.get(f.sharedFormulaSi);if(U)return"= ".concat(lr(U.base,U.anchor,f.address))}}return nr(f,b)})(),L=f.paragraphs&&f.paragraphs.length>0?f.paragraphs:[{runs:[{text:S,citations:[]}]}],x=(()=>{if(vt&&(f.formula||typeof f.sharedFormulaSi=="number"&&Gt.has(f.sharedFormulaSi)))return!1;const U=Number(f.value);return f.dataType!==me.CELL_DATA_TYPE_STRING&&!Number.isNaN(U)})(),z={anchor:pr.ANCHOR_TYPE_MIDDLE,alignment:g.align==="center"?Zt.ALIGNMENT_TYPE_CENTER:g.align==="right"?Zt.ALIGNMENT_TYPE_RIGHT:g.align==="left"?Zt.ALIGNMENT_TYPE_LEFT:x?Zt.ALIGNMENT_TYPE_RIGHT:Zt.ALIGNMENT_TYPE_LEFT},ct={paragraphs:L,textStyle:z,bbox:{xEmu:Math.round(a*9525),yEmu:Math.round(r*9525),widthEmu:Math.round(u*9525),heightEmu:Math.round(p*9525)},type:Js.ELEMENT_TYPE_TEXT,levelsStyles:[]},O=(bs=(ps=pt.styles)==null?void 0:ps.cellXfs)==null?void 0:bs[(gs=H!=null?H:f==null?void 0:f.styleIndex)!=null?gs:0],A=O&&O.fontId!=null?(Ms=(ys=pt.styles)==null?void 0:ys.fonts)==null?void 0:Ms[O.fontId]:void 0,mt=ve.has(E),ot=Ae.has(E)||Ne.has(E);for(const U of(Cs=ct.paragraphs)!=null?Cs:[])for(const Y of(Ss=U.runs)!=null?Ss:[]){if(Y.textStyle=(Ts=Y.textStyle)!=null?Ts:{},typeof Y.textStyle.fontSize=="number"&&Y.textStyle.fontSize>0&&Y.textStyle.fontSize<100&&(Y.textStyle.fontSize=Math.round(Y.textStyle.fontSize*100)),!(typeof Y.textStyle.fontSize=="number"&&Y.textStyle.fontSize>0)){const It=(Fs=g.font)==null?void 0:Fs.size,Ht=typeof It=="number"&&It>0?It*72/96:11;Y.textStyle.fontSize=Math.round(Ht*100)}Y.textStyle.bold==null&&((Es=g.font)==null?void 0:Es.bold)!=null&&(Y.textStyle.bold=!!g.font.bold),(mt||ot)&&(Y.textStyle.bold=!0),Y.textStyle.italic==null&&((As=g.font)==null?void 0:As.italic)!=null&&(Y.textStyle.italic=!!g.font.italic),Y.textStyle.name==null&&(Y.textStyle.name=Ar((ws=A==null?void 0:A.name)!=null?ws:(Ns=g.font)==null?void 0:Ns.family)),Y.textStyle.underline==null&&(A!=null&&A.underline)&&(Y.textStyle.underline=A.underline),te?Y.textStyle.fill={color:te,type:js.FILL_TYPE_SOLID,gradientStops:[]}:!Y.textStyle.fill&&(A!=null&&A.fill)?Y.textStyle.fill=A.fill:Y.textStyle.fill||(Y.textStyle.fill={color:{type:2,value:"FF000000",transform:void 0,lastColor:""},type:js.FILL_TYPE_SOLID,gradientStops:[]})}typeof f.styleIndex=="number"&&!kt.has(f.styleIndex)&&kt.size<12&&kt.add(f.styleIndex);const j=Qt(o,c),B=((vs=(Rs=g.font)==null?void 0:Rs.size)!=null?vs:11*(96/72))*de,K=Math.max(2,Math.round((B||11)*.35)),ht=Math.max(1,Math.round((B||11)*.25)),W=we(ct,t,$,void 0,{resolvedStyle:z,bboxPx:{x:0,y:0,width:1e6,height:p},mode:"layout",textScale:de,wrap:!1}),Z=(Ds=(Ps=(Is=(Ls=W==null?void 0:W.lines)==null?void 0:Ls[0])==null?void 0:Is.widthPx)!=null?Ps:(_s=St.textMetrics.get(ue(o,c)))==null?void 0:_s.firstLineW)!=null?Ds:0;St.textMetrics.set(ue(o,c),{firstLineW:Z,padLr:K,padTb:ht,isNumeric:x});const bt=Math.max(0,u-(K+K)),yt=!x&&Z>bt,Ft=Math.max(u,Z+(K+K)),Dt=k&&(Q>J||C>G)?u:j,Ot=yt?Math.min(Dt,Ft):u,Yt=yt?qs(Zs({},z),{alignment:Zt.ALIGNMENT_TYPE_LEFT}):z;if(E==="B2"){const U=Tt(o,c+1);(U==null?void 0:U.value)!=null&&String(U.value),(Os=U==null?void 0:U.paragraphs)!=null&&Os.some(It=>{var Ht;return(Ht=It.runs)==null?void 0:Ht.some(fe=>{var Vs;return((Vs=fe.text)!=null?Vs:"").length>0})}),U!=null&&U.formula||(U==null||U.sharedFormulaSi);const Y=Ct(U);Bt.some(It=>{var Ht;return((Ht=It.ranges)!=null?Ht:[]).some(fe=>(!fe.sheetName||fe.sheetName===e.name)&&Nt(o,c+1,fe))})&&Y!=null}const Kt=()=>{t.save(),t.beginPath(),t.rect(a,r,Ot,p),t.clip();const U=Yt.alignment===Zt.ALIGNMENT_TYPE_LEFT?Math.max(Ot,Z+(K+K)):Ot;we(ct,t,$,void 0,{resolvedStyle:Yt,bboxPx:{x:a,y:r,width:U,height:p},textScale:de,wrap:!1}),t.restore()};y.push(()=>{Kt(),F&&(q||rt)&&(re(t,st,F),rt&&(t.beginPath(),t.moveTo(a,r),t.lineTo(a+u,r+p),t.stroke()),q&&(t.beginPath(),t.moveTo(a,r+p),t.lineTo(a+u,r),t.stroke()),t.restore())})}}if(ce.length>0)for(const c of ce){if(!c.ref)continue;const[a,u]=c.ref.split(":"),p=et(a!=null?a:"A1"),f=ft(a!=null?a:"A1"),E=u?et(u):p,_=u?ft(u):f,X=Math.max(Math.min(p,E),Jt),H=Math.min(Math.max(p,E),xt),g=Math.min(f,_),F=Math.max(f,_);if(!(X>H)&&o>=g&&o<=F){const q=it+(($s=R[X])!=null?$s:0)-m,rt=it+((ks=R[H+1])!=null?ks:0)-m,st=lt+((Ws=(Bs=v[o+1])!=null?Bs:v[o])!=null?Ws:0)-P,at=dt(c==null?void 0:c.dataDxfId)||"#cccccc";re(t,"thin",at),t.beginPath(),t.moveTo(q,st),t.lineTo(rt,st),t.stroke(),t.restore()}}for(const c of y)c()}Rr(t,e,pt,R,v,m,P,M/w,T/w),Er(t,e,pt,R,v,m,P,M/w,T/w,$),t.textAlign="center",t.textBaseline="middle",t.font="12px sans-serif";for(let o=Jt;o<=xt;o++){const i=it+((Ys=R[o])!=null?Ys:0)-m,r=(Hs=n[o])!=null?Hs:0;t.fillStyle="#f5f5f5",t.fillRect(i,0,r,lt),t.strokeStyle="#ccc",t.lineWidth=Vt,t.strokeRect(i,0,r,lt),t.fillStyle="#333",t.fillText(ee(o),i+r/2,lt/2)}for(let o=oe;o<=se;o++){const i=lt+((Gs=v[o])!=null?Gs:0)-P,r=(zs=s[o])!=null?zs:0;r<=0||(t.fillStyle="#f5f5f5",t.fillRect(0,i,it,r),t.strokeStyle="#ccc",t.lineWidth=Vt,t.strokeRect(0,i,it,r),t.fillStyle="#333",t.fillText((o+1).toString(),it/2,i+r/2))}t.fillStyle="#f5f5f5",t.fillRect(0,0,it,lt),t.strokeStyle="#ccc",t.lineWidth=Vt,t.strokeRect(0,0,it,lt),t.restore()}export{lt as C,yr as F,it as R,Mr as a,Br as b,$r as c,Wr as d,et as e,ee as f,nr as g,kr as p,ft as r};
//# sourceMappingURL=dabvy8uqe4jm1b47.js.map
