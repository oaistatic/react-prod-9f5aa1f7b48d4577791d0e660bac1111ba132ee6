import{ab as R,j as a,ai as T,e as U,h as E,u as B,a as D,d as O,M as v,A as $}from"./i8clt0mfz495j7ii.js";import{nn as I,e as L,b0 as q}from"./ghewn7l2ynbm32fm.js";import{d_ as z}from"./j0yo6uv6652vva62.js";import{W as Q}from"./kzwmj5bk0a8ido2q.js";import{R as G,I as m,S as b}from"./dl4laahs2jdlkw19.js";import{E as H,R as J,g as K}from"./nu0omb1rb0kisooc.js";import{u as X}from"./on3wbdiot3wz4dn8.js";import{d as Y,W as Z,f as V,w as ee,a as te,h as ae}from"./g5lgy1otfli5p2x7.js";import"./fgm9uzc3b50cz4e0.js";import"./d30gyor263984jzn.js";import"./kgnykbdth8mb50na.js";import"./g8i6bixylsxyemsr.js";import"./o108mlelkx5ejfzn.js";import"./fv135gy2k0pewip3.js";import"./pbvsc3do5o365cxq.js";import"./i94vqq9eycryltby.js";import"./mpzbsmypy64alaao.js";import"./fvjpw0lui4wq7vv3.js";import"./olrcssu7duieo6m7.js";import"./gzhyo73bmtx9f3d9.js";import"./o56jrqjpjpipvc65.js";import"./chs4g5r39qlnqw6r.js";import"./c80gqv0732s10rnu.js";import"./o6tyvbjf9zh9qku3.js";import"./opd3w2dk1rgqmcsu.js";import"./oivsnq7jwiwk2uhr.js";import"./6v0419d4xd3dzgv7.js";import"./mq11hu99eist2abq.js";import"./lptwpbjabrvjmhsj.js";import"./k0yjsblyrvonk8x1.js";import"./hp8el4cmh5hx2ts0.js";import"./zul7780usssm7kro.js";import"./mqebxepg7t6q2tie.js";import"./kmbpv6g63y0ugt37.js";import"./ieykhlrsk25lij4e.js";import"./i03gut32e8jn5ajq.js";import"./h1em0bjkpkjv8ykw.js";import"./e26n6uhwwtwdmiki.js";import"./mjq17q47489shd3e.js";import"./hxdh3tr5l8kut4ed.js";import"./hu1bt0oauegdhua6.js";function se(){const{environmentId:s}=R(),{eligible:r}=z();return r?a.jsx(T,{to:"/codex"}):s?a.jsx(re,{environmentId:s}):a.jsx(I,{})}function re({environmentId:s}){var u,l,h,_,f,g,S;const r=U(),i=L(),M=E(),c=B(),{data:e,isLoading:C,isError:N}=Y(s),p=(u=e==null?void 0:e.secrets)!=null?u:{},k=X()?"workspace":"private",{mutate:A,isPending:x}=D({mutationFn:t=>Z.updateEnvironment(s,t),onSuccess:async t=>{await te(c,s),ae(c,s,t),i.success(r.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),M("/codex/settings/environment/".concat(s))},onError:t=>{if(t instanceof V){ee(t,"wham_edit_environment_".concat(s),r,i);return}i.danger(O({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment"}),{toastId:"wham_edit_environment_failed_to_update_environment"})}});function F(t){var j,w;const n=K(t.secrets,p),W=t.envVars.reduce((o,y)=>(o[y.key]=y.value,o),{}),d=(w=(j=t.share_targets)==null?void 0:j.map(o=>o.trim()))==null?void 0:w.filter(Boolean),P=t.share_settings==="private"?[]:d==null?void 0:d.map(o=>({email:o,permission:"editor",type:"user"}));A({etag:e==null?void 0:e.etag,label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,maintenance_setup:t.maintenanceSetupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,share_targets:P,secrets:n,env_vars:W,auto_setup_settings:t.autoSetupSettings,cache_settings:t.cacheSettings})}return a.jsx(Q,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:C?a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(q,{})}):N?a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(v,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):e?a.jsxs(a.Fragment,{children:[a.jsxs(G,{className:"sticky top-0 px-4",children:[a.jsx(m,{label:r.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),a.jsx(b,{}),a.jsx(m,{label:e.label,url:"/codex/settings/environment/".concat(s),className:"font-medium"}),a.jsx(b,{}),a.jsx(m,{label:r.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),a.jsx(H,{initialEnvironmentId:s,existingEnvironment:e,initialValues:{label:e==null?void 0:e.label,description:(l=e==null?void 0:e.description)!=null?l:"",share_settings:(h=e==null?void 0:e.share_settings)!=null?h:k,share_targets:(f=(_=e==null?void 0:e.share_targets)==null?void 0:_.map(t=>t.email))!=null?f:[],machine:e==null?void 0:e.machine_id,repositoryId:e==null?void 0:e.repos[0],workspaceDirectory:(g=e==null?void 0:e.workspace_dir)!=null?g:"",agentNetworkAccess:e==null?void 0:e.agent_network_access,setupCommands:e!=null&&e.setup?Array.isArray(e==null?void 0:e.setup)?e.setup.join("\n"):e.setup:"",maintenanceSetupCommands:e!=null&&e.maintenance_setup?Array.isArray(e==null?void 0:e.maintenance_setup)?e.maintenance_setup.join("\n"):e.maintenance_setup:"",envVars:Object.entries((S=e==null?void 0:e.env_vars)!=null?S:{}).map(([t,n])=>({key:t,value:n})),secrets:Object.keys(p).map(t=>({key:t,value:J,isEditing:!1})),autoSetupSettings:e==null?void 0:e.auto_setup_settings,cacheSettings:e==null?void 0:e.cache_settings},primaryButtonText:r.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:F,isPending:x})]}):a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx(v,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const He=()=>[{title:"Codex"}],Je=$(function(){return a.jsx(se,{})});export{Je as default,He as meta};
//# sourceMappingURL=oaytqrnlo8upi0nr.js.map
