var z=Object.defineProperty;var G=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var H=(e,n,r)=>n in e?z(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,w=(e,n)=>{for(var r in n||(n={}))J.call(n,r)&&H(e,r,n[r]);if(G)for(var r of G(n))Q.call(n,r)&&H(e,r,n[r]);return e};import{r as i,i as U}from"./i8clt0mfz495j7ii.js";import{s as V,i as F,a as Z,b as ee,T as te,C as re,m as ie}from"./n8qbc0log2m0cne7.js";import"./ghewn7l2ynbm32fm.js";import"./j0yo6uv6652vva62.js";import"./dwikchly7agkd2y3.js";import"./julkxv3pzs8k4gnq.js";import"./iguylefzk1dr51wi.js";import"./mbmcx8v24u1ao1ke.js";import"./ia54sddtrl9qa2wj.js";import"./fy6752fpzkgozktl.js";const ne=()=>e=>e.targetY,se=()=>e=>e.targetX-1,ae=()=>e=>e.targetY-1,oe=()=>e=>e.targetWidth+2,de=()=>e=>e.targetHeight+2,le=()=>e=>e.targetY+10,ue=()=>e=>Math.max(0,(e.targetHeight-28)/2),ce=V("div")({name:"DataGridOverlayEditorStyle",class:"gdg-d19meir1",propsAsIs:!1,vars:{"d19meir1-0":[ne(),"px"],"d19meir1-1":[se(),"px"],"d19meir1-2":[ae(),"px"],"d19meir1-3":[oe(),"px"],"d19meir1-4":[de(),"px"],"d19meir1-5":[le(),"px"],"d19meir1-6":[ue(),"px"]}});function fe(){const[e,n]=i.useState();return[e!=null?e:void 0,n]}function ge(){const[e,n]=fe(),[r,y]=i.useState(0),[g,b]=i.useState(!0);i.useLayoutEffect(()=>{if(e===void 0||!("IntersectionObserver"in window))return;const o=new IntersectionObserver(d=>{d.length!==0&&b(d[0].isIntersecting)},{threshold:1});return o.observe(e),()=>o.disconnect()},[e]),i.useEffect(()=>{if(g||e===void 0)return;let o;const d=()=>{const{right:k}=e.getBoundingClientRect();y(p=>Math.min(p+window.innerWidth-k-10,0)),o=requestAnimationFrame(d)};return o=requestAnimationFrame(d),()=>{o!==void 0&&cancelAnimationFrame(o)}},[e,g]);const O=i.useMemo(()=>({transform:"translateX(".concat(r,"px)")}),[r]);return{ref:n,style:O}}const ve=e=>{const{target:n,content:r,onFinishEditing:y,forceEditMode:g,initialValue:b,imageEditorOverride:O,markdownDivCreateNode:o,highlight:d,className:k,theme:p,id:A,cell:S,validateCell:l,getCellRenderer:P,provideEditor:h,isOutsideClick:K}=e,[a,W]=i.useState(g?r:void 0),v=i.useRef(a!=null?a:r);v.current=a!=null?a:r;const[E,R]=i.useState(()=>l===void 0?!0:!(F(r)&&(l==null?void 0:l(S,r,v.current))===!1)),c=i.useCallback((t,s)=>{y(E?t:void 0,s)},[E,y]),X=i.useCallback(t=>{if(l!==void 0&&t!==void 0&&F(t)){const s=l(S,t,v.current);s===!1?R(!1):(typeof s=="object"&&(t=s),R(!0))}W(t)},[S,l]),x=i.useRef(!1),f=i.useRef(void 0),Y=i.useCallback(()=>{c(a,[0,0]),x.current=!0},[a,c]),j=i.useCallback((t,s)=>{var m;c(t,(m=s!=null?s:f.current)!=null?m:[0,0]),x.current=!0},[c]),q=i.useCallback(async t=>{let s=!1;t.key==="Escape"?(t.stopPropagation(),t.preventDefault(),f.current=[0,0]):t.key==="Enter"&&!t.shiftKey?(t.stopPropagation(),t.preventDefault(),f.current=[0,1],s=!0):t.key==="Tab"&&(t.stopPropagation(),t.preventDefault(),f.current=[t.shiftKey?-1:1,0],s=!0),window.setTimeout(()=>{!x.current&&f.current!==void 0&&(c(s?a:void 0,f.current),x.current=!0)},0)},[c,a]),D=a!=null?a:r,[u,B]=i.useMemo(()=>{var s,m;if(Z(r))return[];const t=h==null?void 0:h(r);return t!==void 0?[t,!1]:[(m=(s=P(r))==null?void 0:s.provideEditor)==null?void 0:m.call(s,r),!1]},[r,P,h]),{ref:L,style:$}=ge();let _=!0,M,N=!0,C;if(u!==void 0){_=u.disablePadding!==!0,N=u.disableStyling!==!0;const t=ee(u);t&&(C=u.styleOverride);const s=t?u.editor:u;M=i.createElement(s,{isHighlighted:d,onChange:X,value:D,initialValue:b,onFinishedEditing:j,validatedSelection:F(D)?D.selectionRange:void 0,forceEditMode:g,target:n,imageEditorOverride:O,markdownDivCreateNode:o,isValid:E,theme:p})}C=w(w({},C),$);const T=document.getElementById("portal");if(T===null)return console.error('Cannot open Data Grid overlay editor, because portal not found.  Please add `<div id="portal" />` as the last child of your `<body>`.'),null;let I=N?"gdg-style":"gdg-unstyle";return E||(I+=" gdg-invalid"),_&&(I+=" gdg-pad"),U.createPortal(i.createElement(te.Provider,{value:p},i.createElement(re,{style:ie(p),className:k,onClickOutside:Y,isOutsideClick:K},i.createElement(ce,{ref:L,id:A,className:I,style:C,as:B===!0?"label":void 0,targetX:n.x,targetY:n.y,targetWidth:n.width,targetHeight:n.height},i.createElement("div",{className:"gdg-clip-region",onKeyDown:q},M)))),T)};export{ve as default};
//# sourceMappingURL=dnxi692t1nq76tgc.js.map
