const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j0uat46g7ys1luov.js","assets/i8clt0mfz495j7ii.js","assets/gvu37gjt0kwip66n.js","assets/frf0wu8ouyfyu06j.js","assets/o16x9m1k4d29ak42.js"])))=>i.map(i=>d[i]);
var re=Object.freeze,Se=Object.defineProperty;var h=(n,s)=>re(Se(n,"raw",{value:re(s||n.slice())}));import{r as j,j as e,e as _e,M as o,F as pe,_ as R,h as O,b as Ee,A as Re,ab as Oe}from"./i8clt0mfz495j7ii.js";import{F as b,d as y,aW as Pe,T as H,o as P,L as F,cK as Fe,pc as Ve,pd as Be,b0 as Ue,u as we,a as $e,z as Ce,n as w,aV as de,aR as He,q as Je,pe as We,C as qe,$ as oe,pf as Ye,eU as Ke,fH as Qe,oy as Xe,c4 as Ze}from"./ghewn7l2ynbm32fm.js";import{N as ze}from"./ce3hgmw4iyyhicud.js";import{i1 as Te,i2 as Ge,i3 as J,bk as et,h7 as tt,r as st}from"./j0yo6uv6652vva62.js";import{G as nt}from"./hkf72jbegajnqi38.js";import{F as m,a as _,b as S,c as at,G as it}from"./h1jbqtena24viel6.js";const lt=j.memo(function({onSelectVersion:s,selectedVersion:t,currentVersion:l,gizmoVersions:i}){return e.jsx(dt,{selectedVersion:t,onSelectVersion:s,currentVersion:l,gizmoVersions:i})});var ue;const rt=b.div(ue||(ue=h(["flex h-full w-full max-w-3xs flex-col overflow-y-scroll bg-token-sidebar-surface-primary px-2 py-6"])));function dt({onSelectVersion:n,selectedVersion:s,currentVersion:t,gizmoVersions:l}){const i=l==null?void 0:l.items.reduce((a,d)=>{const r=new Date(d.updated_at),u="".concat(r.getFullYear(),"-").concat(r.getMonth()+1,"-").concat(r.getDate());return a[u]||(a[u]=[]),a[u].push(d),a},{});return i?e.jsx(rt,{children:Object.keys(i).map((a,d)=>e.jsx(ft,{date:a,entries:i[a],selectedVersion:s,onSelectVersion:n,currentVersion:t},d))}):null}const Me=({name:n,userId:s,showName:t=!1})=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[t&&e.jsx(H,{delayDuration:2e3,label:n,className:"text-token-text-secondary max-w-[100px] truncate text-xs",children:n}),e.jsx("div",{className:y("icon flex items-center justify-center rounded-full text-[8px] text-white",Ge(s)),children:Te(n)})]});var xe;const ot=b.div(xe||(xe=h(["flex w-full flex-col rounded-lg px-3 py-2 text-base hover:cursor-pointer hover:bg-token-sidebar-surface-tertiary"])));var fe;const ct=b.div(fe||(fe=h(["px-3 text-xs font-medium text-token-text-secondary"])));var ge;const ut=b.div(ge||(ge=h(["flex flex-col space-y-1"])));var he;const xt=b.div(he||(he=h(["mb-8 flex flex-col space-y-2"])));function Ne(n,s){const t=new Date(s),l=new Date,i=new Date(l);i.setDate(l.getDate()-1);const a=n.locale||"en-US";return t.toDateString()===l.toDateString()?"Today":t.toDateString()===i.toDateString()?"Yesterday":new Intl.DateTimeFormat(a,{dateStyle:"medium"}).format(t)}const ft=({date:n,entries:s,onSelectVersion:t,selectedVersion:l,currentVersion:i})=>{const a=_e(),d=r=>r===i;return e.jsxs(xt,{children:[e.jsx(ct,{children:Ne(a,n)}),e.jsx(ut,{children:s.map((r,u)=>e.jsx(gt,{item:r,isCurrentVersion:d,selectedVersion:l,onSelectVersion:t},u))})]})},gt=({item:n,isCurrentVersion:s,selectedVersion:t,onSelectVersion:l})=>{const[i,a]=j.useState(!1),{version:d,updated_at:r,author:u}=n;return e.jsx(ot,{className:y(t===d&&"bg-token-sidebar-surface-tertiary"),onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),onClick:()=>l(d),children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"text-base",children:s(d)?e.jsx(o,{id:"gizmo.version.current",defaultMessage:"Current version"}):e.jsx(pe,{value:r,timeStyle:"short"})}),e.jsx(Pe,{children:!s(d)&&u&&e.jsx(Me,{showName:t===d||i,name:u.user_name,userId:u.user_id})})]})})},ht=P(()=>R(()=>import("./j0uat46g7ys1luov.js").then(n=>n._),__vite__mapDeps([0,1])),{loading:n=>F(n)}),jt=P(()=>R(()=>import("./gvu37gjt0kwip66n.js").then(n=>n._),__vite__mapDeps([2,1])),{loading:n=>F(n)}),yt=P(()=>R(()=>import("./frf0wu8ouyfyu06j.js").then(n=>n._),__vite__mapDeps([3,1])),{loading:n=>F(n)}),bt=P(()=>R(()=>import("./o16x9m1k4d29ak42.js").then(n=>n._),__vite__mapDeps([4,1])),{loading:n=>F(n)}),vt=({gizmoId:n,version:s,skip:t=!1})=>Ee({queryFn:async()=>Ke.getVersion({gizmoId:n,version:s}),queryKey:["gizmo","version",{gizmoId:n,version:s}],enabled:!t}),ce=(n,s)=>"/gpts/editor/".concat(n,"?version=").concat(s);var je;const Ie=b.div(je||(je=h(["flex h-screen w-full flex-col items-center"])));var ye;const Le=b.div(ye||(ye=h(["flex w-full grow overflow-hidden"])));var be;const Ae=b.div(be||(be=h(["flex h-full grow flex-wrap items-start justify-between gap-4 overflow-auto"])));var ve;const De=b.div(ve||(ve=h(["sticky top-0 flex h-16 w-full items-center justify-between gap-2 border-b border-token-border-medium bg-token-main-surface-primary px-3 py-3"])));function mt({gizmoId:n}){var r,u,v;const{data:s,isLoading:t,refetch:l}=Fe(n),i=(r=s==null?void 0:s.gizmo)==null?void 0:r.current_user_permission,a=(u=i==null?void 0:i.can_write)!=null?u:!1,d=(v=i==null?void 0:i.can_view_config)!=null?v:!1;return!s||t?null:a?e.jsx(pt,{gizmoResource:s,refetchGizmo:l}):d?e.jsx(_t,{gizmoResource:s}):null}const ke=({children:n})=>{const s=O();return e.jsxs("div",{className:"flex cursor-pointer items-center gap-1.5",onClick:()=>s(-1),children:[e.jsx(yt,{className:"icon"}),e.jsx("div",{children:n})]})},_t=({gizmoResource:n})=>{const s=O(),t=Be(),l=n.gizmo.id,i=async()=>{const a=await t.mutateAsync({gizmoId:l});a.gizmo.id&&s("/gpts/editor/".concat(a.gizmo.id))};return e.jsxs(Ie,{children:[e.jsxs(De,{children:[e.jsx(ke,{children:e.jsx(o,{id:"gizmoReadOnly.configurationTitle",defaultMessage:"Configuration"})}),e.jsx("div",{className:"me-4 flex gap-2",children:e.jsx(J,{color:"secondary",loading:t.isPending,onClick:i,children:e.jsx(o,{id:"gizmo.readonly.duplicate",defaultMessage:"Duplicate"})})})]}),e.jsx(Le,{children:e.jsx(Ae,{children:e.jsx(W,{displayGizmo:n})})})]})},pt=({gizmoResource:n,refetchGizmo:s})=>{const t=n.gizmo.id,{data:l,refetch:i}=Ve({gizmoId:t});j.useEffect(()=>{s(),i()},[s,i]);const a=n==null?void 0:n.gizmo.live_version;return a==null||!l?null:e.jsx(wt,{gizmoResource:n,currentVersion:a,gizmoVersions:l})};function wt({gizmoResource:n,currentVersion:s,gizmoVersions:t}){const l=O(),i=n.gizmo.id,[a,d]=j.useState(s),[r,u]=j.useState(!1),[v,p]=j.useState(!1),g=()=>{l(a?ce(i,a):Ye(i))},V=()=>{if(a!==s&&n.tools.find(k=>{var M;return k.type===w.JIT_PLUGIN&&((M=k.metadata.auth)==null?void 0:M.type)!==We.None})){p(!0);return}l(ce(i,a))},f=()=>{a===s&&s>1&&d(s-1),r&&d(s),u(!r)},N=s>1;j.useEffect(()=>{a===s&&u(!1)},[a,s]);const{data:C,isLoading:D}=vt({gizmoId:i,version:a});return e.jsxs(Ie,{children:[e.jsxs(De,{children:[e.jsx(ke,{children:e.jsx(o,{id:"gizmoReadOnly.versionHistoryTitle",defaultMessage:"Version History"})}),e.jsxs("div",{className:"me-4 flex gap-2",children:[N&&e.jsx(H,{label:e.jsx(o,{id:"gizmo.readonly.compareTooltip",defaultMessage:"Compare to the previous version"}),disabled:!N||r,triggerAs:null,children:e.jsx(J,{color:r?"primary":"secondary",className:y("btn rounded-full border transition-colors",r?y(ze,"border-transparent"):"border-token-border-default hover:bg-token-surface-hover bg-transparent"),onClick:f,icon:r?jt:ht,children:r?e.jsx(o,{id:"gizmo.readonly.comparing",defaultMessage:"Comparing changes"}):e.jsx(o,{id:"gizmo.readonly.compare",defaultMessage:"Compare changes"})})}),e.jsx(H,{label:e.jsx(o,{id:"gizmo.readonly.restoreVersionTooltip",defaultMessage:"You will be able to edit before publishing"}),disabled:a===s,triggerAs:null,children:e.jsx(J,{color:"secondary",disabled:a===s,icon:bt,onClick:V,children:e.jsx(o,{id:"gizmo.readonly.restoreVersion",defaultMessage:"Restore this version"})})})]})]}),e.jsxs(Le,{children:[e.jsx(lt,{selectedVersion:a,currentVersion:s,onSelectVersion:d,gizmoVersions:t}),D&&e.jsx("div",{className:"flex h-full w-full grow flex-col items-center justify-center",children:e.jsx(Ue,{})}),C&&e.jsxs(Ae,{children:[e.jsx(W,{displayGizmo:C,isComparing:r,gizmoVersions:t}),r&&e.jsx(W,{displayGizmo:n,compareToGizmo:C,setIsComparing:u,isComparing:!0,gizmoVersions:t})]})]}),v&&e.jsx(Nt,{onClose:()=>p(!1),onContinue:g})]})}const $=(n,s=[],t=[],l)=>n?[...t,...s.filter(l)]:s,E=(n,s)=>y(n&&s?"bg-blue-400/10":"bg-token-main-surface-secondary");function W({isComparing:n,displayGizmo:s,compareToGizmo:t,setIsComparing:l,gizmoVersions:i}){var Y,K,Q,X,Z,z,T,G,ee,te,se,ne,ae,ie,le;const a=we(),d=_e(),r=$e(()=>Qe(a,{isGizmo:!0})),u=(Y=Ce(a))==null?void 0:Y.hasPaidFeatures(),v=s.gizmo.default_model!==(t==null?void 0:t.gizmo.default_model),p=s.gizmo.display.name!==(t==null?void 0:t.gizmo.display.name),g=s.gizmo.display.description!==(t==null?void 0:t.gizmo.display.description),V=s.gizmo.instructions!==(t==null?void 0:t.gizmo.instructions),f=n&&!!t,N=$(f,(K=s.gizmo.display.prompt_starters)!=null?K:[],(Q=t==null?void 0:t.gizmo.display.prompt_starters)!=null?Q:[],c=>{var x;return!((x=t==null?void 0:t.gizmo.display.prompt_starters)!=null&&x.includes(c))}),C=$(f,(X=s.files)!=null?X:[],(Z=t==null?void 0:t.files)!=null?Z:[],c=>{var x;return!((x=t==null?void 0:t.files)!=null&&x.find(I=>I.id===c.id))}),D=$(f,(T=(z=s.tools)==null?void 0:z.filter(c=>c.type===w.JIT_PLUGIN))!=null?T:[],(ee=(G=t==null?void 0:t.tools)==null?void 0:G.filter(c=>c.type===w.JIT_PLUGIN))!=null?ee:[],c=>c.type===w.JIT_PLUGIN&&!(t!=null&&t.tools.find(x=>x.type===w.JIT_PLUGIN&&x.metadata.action_id===c.metadata.action_id))),k=s.gizmo.display.profile_picture_url!==(t==null?void 0:t.gizmo.display.profile_picture_url),M=(te=i==null?void 0:i.items.find(c=>c.version===s.gizmo.version))==null?void 0:te.author;return e.jsx(de.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.2},className:y("relative flex min-w-0 flex-1 grow justify-center overflow-auto",f&&"border-s"),children:e.jsxs("div",{className:"flex w-full max-w-2xl flex-col px-4 py-8 text-sm",children:[e.jsxs(de.div,{initial:{opacity:0},animate:{opacity:n?1:0},transition:{duration:n?.2:0},className:"mb-4 flex w-full items-center justify-between",children:[e.jsx("div",{className:"text-token-text-tertiary text-base",children:t?e.jsx(o,{id:"gizmo.readonly.currentVersion",defaultMessage:"Current"}):e.jsx(o,{id:"gizmo.readonly.previous",defaultMessage:"Previous"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.gizmo.version_updated_at&&e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(o,{id:"gizmo.readonly.updatedAt",defaultMessage:"{date} at {time}",values:{date:Ne(d,s.gizmo.version_updated_at),time:e.jsx(pe,{value:new Date(s.gizmo.version_updated_at),hour:"numeric",minute:"numeric"})}})}),M&&e.jsx(Me,{name:M.user_name,userId:M.user_id}),t&&l&&e.jsx(He,{onClick:()=>l(!1)})]})]}),e.jsx(m,{className:"self-center",children:e.jsx(et,{src:s.gizmo.display.profile_picture_url,isFirstParty:!1,className:y("h-20 w-20",k&&t&&"border-opacity-10 rounded-full border-4 border-blue-400"),showLoading:!0})}),e.jsxs(m,{children:[e.jsx(_,{label:e.jsx(o,{id:"gizmo.readonly.nameLabel",defaultMessage:"Name"})}),e.jsx(S,{type:"text",value:(se=s.gizmo.display.name)!=null?se:"",disabled:!0,className:E(f,p)})]}),e.jsxs(m,{children:[e.jsx(_,{label:e.jsx(o,{id:"gizmo.readonly.descriptionLabel",defaultMessage:"Description"})}),e.jsx(S,{type:"text",value:(ne=s.gizmo.display.description)!=null?ne:"",disabled:!0,className:E(f,g)})]}),e.jsxs(m,{children:[e.jsx(_,{label:e.jsx(o,{id:"gizmo.readonly.instructionsLabel",defaultMessage:"Instructions"})}),e.jsx(at,{rows:8,value:(ae=s.gizmo.instructions)!=null?ae:"",disabled:!0,className:y("resize-none",E(f,V))})]}),N.length>0&&e.jsxs(m,{children:[e.jsx(_,{label:e.jsx(o,{id:"gizmo.readonly.conversationStartersLabel",defaultMessage:"Conversation starters"})}),N.map((c,x)=>{var L,A;const I=!((L=t==null?void 0:t.gizmo.display.prompt_starters)!=null&&L.includes(c)),B=!((A=s.gizmo.display.prompt_starters)!=null&&A.includes(c));return e.jsx(S,{type:"text",value:c,disabled:!0,className:y("bg-token-main-surface-secondary mb-2 resize-none",q(f,I,B))},x)})]}),C.length>0&&e.jsxs(m,{children:[e.jsx(_,{label:e.jsx(o,{id:"gizmo.readonly.knowledgeLabel",defaultMessage:"Knowledge"})}),e.jsx("div",{className:"flex flex-wrap gap-1",children:C.map((c,x)=>{var L,A;const I=!((L=t==null?void 0:t.files)!=null&&L.find(U=>U.id===c.id)),B=!((A=s.files)!=null&&A.find(U=>U.id===c.id));return e.jsx(tt,{file:c.name,fileId:c.id,className:q(f,I,B)},x)})})]}),e.jsxs(m,{children:[e.jsx(_,{label:e.jsx(o,{id:"gizmo.readonly.capabilitiesLabel",defaultMessage:"Capabilities"})}),e.jsx(nt,{enabledTools:s.tools,diffedEnabledTools:t==null?void 0:t.tools,onEnabledToolsChange:Je})]}),u&&e.jsxs(m,{children:[e.jsx(_,{label:e.jsx(o,{id:"gizmo.readonly.recommendedModelLabel",defaultMessage:"Recommended Model"})}),e.jsx(S,{type:"text",value:s.gizmo.default_model?(le=(ie=r.models.get(s.gizmo.default_model))==null?void 0:ie.title)!=null?le:s.gizmo.default_model:d.formatMessage({id:"gizmoEditor.noneOption",defaultMessage:"No Recommended Model - Users will use any model they prefer"}),disabled:!0,className:E(f,v)})]}),!!D.length&&e.jsxs(m,{children:[e.jsx(_,{label:e.jsx(o,{id:"gizmo.readonly.actionsLabel",defaultMessage:"Actions"})}),e.jsx("div",{className:"flex flex-col gap-1",children:D.map((c,x)=>e.jsx(Mt,{tool:c,isDiffed:f,compareToGizmo:t,displayGizmo:s},x))})]})]})})}var me;const Ct=b.textarea(me||(me=h(["mb-8 rounded-lg block h-96 w-full border-token-main-surface-tertiary bg-transparent p-2 font-mono text-xs text-token-text-primary"]))),Mt=({tool:n,compareToGizmo:s,displayGizmo:t,isDiffed:l})=>{var v,p;const i=n,[a,d]=j.useState(!1),r=!((v=s==null?void 0:s.tools)!=null&&v.find(g=>g.type===w.JIT_PLUGIN&&g.metadata.action_id===i.metadata.action_id)),u=!t.tools.find(g=>g.type===w.JIT_PLUGIN&&g.metadata.action_id===i.metadata.action_id);return e.jsxs(e.Fragment,{children:[e.jsx(it,{isDisabled:!1,actionTool:i,className:q(l,r,u),onShowActionsEditor:()=>d(g=>!g)}),a&&e.jsx(Ct,{readOnly:!0,value:(p=i.metadata.raw_spec)!=null?p:""})]})},q=(n,s,t)=>y(n&&s&&"bg-blue-400/10!",n&&t&&"bg-blue-400/10! text-token-text-secondary line-through opacity-50");function Nt({onClose:n,onContinue:s}){const[t,l]=j.useState(!1);return e.jsx(qe,{testId:"modal-gizmo-auth-restore",isOpen:!0,onClose:n,type:"warning",showCloseButton:!0,title:e.jsx(o,{id:"gizmoReadOnly.authModalWarningTitle",defaultMessage:"Reset Authentication for Custom Actions"}),primaryButton:e.jsx(oe,{onClick:()=>{l(!0),s()},loading:t,color:"secondary",children:e.jsx(o,{id:"gizmoReadOnly.authModalContinueButton",defaultMessage:"Continue"})}),secondaryButton:e.jsx(oe,{onClick:n,color:"secondary",children:e.jsx(o,{id:"gizmoReadOnly.authModalCancelButton",defaultMessage:"Cancel"})}),size:"normal",children:e.jsx(o,{id:"gizmoReadOnly.authModalWarningBody",defaultMessage:"Restoring this version will reset authentication of your custom actions. You may need to reconfigure each custom action afterwards."})})}const Rt=()=>(st(),null),Ot=Re(function(){var r;const s=we(),t=Ce(s),l=O(),a=(r=Oe().gizmoId)!=null?r:"",d=Xe(a);return j.useEffect(()=>{t!=null&&t.isFree()&&l("/")},[t,l]),j.useEffect(()=>{d&&Ze(d)&&l("/g/".concat(a,"/project"))},[d,l,a]),e.jsx(mt,{gizmoId:d})});export{Rt as clientLoader,Ot as default};
//# sourceMappingURL=o9166f6eo48i5que.js.map
