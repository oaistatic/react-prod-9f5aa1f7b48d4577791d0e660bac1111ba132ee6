const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/o84nb2862ibyoi1c.js","assets/i8clt0mfz495j7ii.js","assets/j0yo6uv6652vva62.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/pfg8sguwg6pyv34z.js","assets/jics938ioiejxmr3.js","assets/ig60ujc76weklqmh.js","assets/g03e0l13yr8s5v7c.js","assets/otyqbgm5k20lfbwp.js","assets/hm9ujel5qp4i8yne.js","assets/kaxn2bizrxslkpa3.js","assets/i1tb1w6bhijregtp.js","assets/fr2n5yqcoayleu1k.js","assets/ghnvrdqxofgwprfv.js","assets/g69peh4qbpo7a7d7.js","assets/jo0yr7ku7v9ac6ge.js","assets/kq8d654gegx6snmr.js","assets/zul7780usssm7kro.js","assets/ansi-1f6vhsjh.css","assets/i84uy1p9ly5pjwpt.js","assets/g5lgy1otfli5p2x7.js","assets/ieykhlrsk25lij4e.js","assets/i03gut32e8jn5ajq.js","assets/h1em0bjkpkjv8ykw.js","assets/e26n6uhwwtwdmiki.js","assets/mjq17q47489shd3e.js","assets/hxdh3tr5l8kut4ed.js","assets/hu1bt0oauegdhua6.js","assets/o6tyvbjf9zh9qku3.js","assets/lptwpbjabrvjmhsj.js","assets/gf67njbmurwfkel2.js","assets/dntm9op0tz5bndrs.js","assets/fzrn137102spawew.js","assets/eflwd0j5c3pxruh8.js","assets/l2r1du6tfxyv7jaj.js","assets/ln88gzx578175chd.js","assets/c80gqv0732s10rnu.js","assets/wham-task-turn-grouping-e50ctjec.css","assets/i94vqq9eycryltby.js","assets/hf1acpjenvjtaqkn.js","assets/dzlsnt42nnmwuxsc.js"])))=>i.map(i=>d[i]);
import{f as ft,j as s,_ as R,e as Q,u as ts,r as y,a as ss,M as K,c as pt,b as ns,h as Ms}from"./i8clt0mfz495j7ii.js";import{h as z,o as F,L,e as as,$ as ve,b0 as Ft,u as we,ed as _s,T as be,be as Ss,jk as Ts,jH as os,a as Nt,oz as is,hr as rs,aU as ls,kS as cs,e4 as Y,d as mt,ic as Es,id as js,ie as As,ih as Is,il as Ns,iX as P,rb as Rs,rc as Fs,rd as _e,rf as Ps,fV as Ls,jq as Rt,en as Bs,rg as Os,C as Ds,aW as us,R as qs,a4 as Ws,iu as Hs,kv as $t,gh as Vs,js as It,l7 as Qs,iv as rt,iw as Us,ix as Gs,d_ as Ks,rC as $s,ja as zt,j as lt,rI as zs,k2 as Xs,jv as Js}from"./ghewn7l2ynbm32fm.js";import{uG as Ys,uH as Zs,tn as en,uI as tn,gX as ds,uJ as sn,uK as nn,uL as an,uM as on,bc as rn,uN as ln,q6 as cn,lb as un,qn as dn,aC as ct,aD as mn,qJ as fn,qB as pn,qC as hn,qD as gn,qp as Xt,qr as xn,qG as bn,qs as vn,qI as wn,qH as Cn}from"./j0yo6uv6652vva62.js";import{W as ne,g as yn,f as kn,i as ms,b as Mn}from"./i94vqq9eycryltby.js";import{W as Se,l as A,X as _n,n as Pt,k as Sn,B as Tn,z as En,A as jn,f as Jt,w as Yt}from"./g5lgy1otfli5p2x7.js";import{g as An,C as In,a as Nn,W as Rn}from"./pn83wqr6w775mq4b.js";import{u as Fn}from"./eh21clr7cewe9q6y.js";import{C as Pn}from"./chs4g5r39qlnqw6r.js";import{u as Ln}from"./gutjuo0v1j4y19t1.js";import{u as Bn}from"./ivhm4b1s5w1b1cuw.js";import{W as On}from"./c80gqv0732s10rnu.js";import{s as dt}from"./g69peh4qbpo7a7d7.js";function Dn(t){return z(t,"3651421897")}const xe=ft({codeLabel:{id:"wham.composer.tool.codeLabel",defaultMessage:"Code"},codeSubmitLabel:{id:"wham.composer.tool.codeSubmitLabel",defaultMessage:"Code"},codeDescription:{id:"wham.composer.tool.codeDescription",defaultMessage:"Generate and edit code with full environment setup."},planLabel:{id:"wham.composer.tool.planLabel",defaultMessage:"Plan"},planSubmitLabel:{id:"wham.composer.tool.askSubmitLabel",defaultMessage:"Plan"},planDescription:{id:"wham.composer.tool.planDescription",defaultMessage:"Get a quick answer without modifying the repository."}}),qn=[{key:"code",environmentMode:"code",runEnvironmentInQaMode:!1,slashCommand:"code",icon:s.jsx(Ys,{className:"icon","aria-hidden":!0}),analyticsAction:"code",messages:{label:xe.codeLabel,submitLabel:xe.codeSubmitLabel,description:xe.codeDescription}},{key:"plan",environmentMode:"ask",runEnvironmentInQaMode:!0,slashCommand:"plan",slashAliases:["qa","ask"],icon:s.jsx(Zs,{className:"icon","aria-hidden":!0}),analyticsAction:"ask",messages:{label:xe.planLabel,submitLabel:xe.planSubmitLabel,description:xe.planDescription}}],Wn=F(()=>R(()=>import("./o84nb2862ibyoi1c.js").then(t=>t._),__vite__mapDeps([0,1])),{loading:t=>L(t)});function Hn({taskId:t,hasMultipleInProgressOrStreamingTurns:e}){const o=Q(),a=as(),l=ts(),[r,n]=y.useState(!1),{mutate:c}=ss({mutationFn:async()=>{n(!0),await Se.cancelTask(t)},onError:()=>{a.danger(o.formatMessage({id:"wham.whamTaskRow.failedToCancelTask",defaultMessage:"Failed to cancel task"}))},onSuccess:()=>{l.refetchQueries({queryKey:["wham","task",t]}),l.invalidateQueries({queryKey:["wham","tasks"]})}});return s.jsx(ve,{color:"primary",type:"button",size:"small",className:e?void 0:"h-9 w-9",icon:r?Ft:Wn,onClick:()=>(ne.recordCancel("task-details"),c()),disabled:r,"aria-label":o.formatMessage({id:"wham.composer.cancelTask",defaultMessage:"Cancel task"}),"data-testid":"stop-button",children:e&&s.jsx(K,{id:"wham.composer.stopButton.multipleInProgressOrStreamingTurns",defaultMessage:"Stop all"})})}function Vn(t,e){return{label:e,description:"",share_settings:"workspace",machine:"wham-public/wham-universal",repositoryId:t,workspaceDirectory:"/workspace",agentNetworkAccess:{mode:"off"},setupCommands:"",maintenanceSetupCommands:"",secrets:[],envVars:[],autoSetupSettings:null,cacheSettings:{post_setup_cache_enabled:!0}}}function Qn(){"use forget";const t=pt.c(21),e=A(Xn),o=A(zn),a=A($n),l=A(Kn),r=A(Gn),n=A(Un),c=e!=null?e:"";let x;t[0]!==c?(x=["wham","repository",c],t[0]=c,t[1]=x):x=t[1];const f=!!e&&n;let h;t[2]!==e?(h=()=>Se.getRepository(e!=null?e:""),t[2]=e,t[3]=h):h=t[3];let p;t[4]!==x||t[5]!==f||t[6]!==h?(p={queryKey:x,enabled:f,queryFn:h,staleTime:3e5},t[4]=x,t[5]=f,t[6]=h,t[7]=p):p=t[7];const{data:g}=ns(p);let b;t[8]!==l||t[9]!==a||t[10]!==o||t[11]!==r?(b={onSuccess:T=>{if(!T)return;if(o(T.id),!A.getState().branch){const w=An(T);a(w)}l(T.id),r(!1)}},t[8]=l,t[9]=a,t[10]=o,t[11]=r,t[12]=b):b=t[12];const{mutateAsync:M,isPending:k}=Fn(b);let i;t[13]!==M||t[14]!==g||t[15]!==e?(i=async()=>{const T=A.getState().environmentId;if(T)return T;if(!e)throw new Error("Repository is required to create an environment");if(!A.getState().useRepositoryAsEnvironment)return T;const u=g!=null?g:await Se.getRepository(e!=null?e:"");return(await M(Vn(u.id,u.name))).id},t[13]=M,t[14]=g,t[15]=e,t[16]=i):i=t[16];const d=i,v=!!e&&n;let S;return t[17]!==d||t[18]!==k||t[19]!==v?(S={isCreatingEnvironment:k,ensureEnvironment:d,hasRepository:v},t[17]=d,t[18]=k,t[19]=v,t[20]=S):S=t[20],S}function Un(t){return t.useRepositoryAsEnvironment}function Gn(t){return t.setUseRepositoryAsEnvironment}function Kn(t){return t.setAutoCreatedEnvironment}function $n(t){return t.setBranch}function zn(t){return t.setEnvironmentId}function Xn(t){return t.selectedRepositoryId}const Jn=F(()=>R(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yn),__vite__mapDeps([2,1,3,4,5])),{loading:t=>L(t)});function Yn({isSubmitDisabled:t,createTask:e,selectedTool:o,disabledReason:a,isFollowUp:l}){const r=Q(),n=we(),c=_s(),[x,f]=y.useState(!1),h=A(v=>v.environmentId),{isCreatingEnvironment:p,ensureEnvironment:g,hasRepository:b}=Qn(),M=!l&&!h&&b,k=z(n,"3419038745"),i=y.useCallback(v=>{ne.recordComposerAction(v?"ask":"code"),e({runEnvironmentInQaMode:v})},[e]),d=y.useCallback(async v=>{if(t){f(!0);return}if(!p){if(M){try{if(!await g())return}catch(S){return}i(v);return}i(v)}},[t,g,p,i,M]);return s.jsx("div",{className:"flex items-center gap-2 px-2",onClick:v=>v.stopPropagation(),children:k?s.jsx(be,{label:a,open:c?x:void 0,onOpenChange:f,children:s.jsx("button",{"aria-label":r.formatMessage(Zn.submitLabel),color:"primary",type:"button",className:"composer-submit-btn composer-submit-button-color h-9 w-9",disabled:(t||p)&&!c,onClick:t?()=>f(!0):()=>d(o.runEnvironmentInQaMode),children:s.jsx(Jn,{className:"icon"})})}):s.jsxs(s.Fragment,{children:[s.jsx(be,{open:c?x:void 0,onOpenChange:f,label:a!=null?a:r.formatMessage({id:"wham.whamComposer.fasterTitle",defaultMessage:"Fast mode where the agent doesn't edit code"}),children:s.jsx(ve,{color:"secondary",type:"button",className:c&&t?"opacity-50":"",disabled:(t||p)&&!c,onClick:()=>d(!0),children:s.jsx(K,{id:"wham.composer.askButton",defaultMessage:"Ask"})})}),s.jsx(be,{label:a,children:s.jsx(ve,{color:"primary",type:"button",className:c&&t?"opacity-50":"",disabled:(t||p)&&!c,onClick:()=>d(!1),children:s.jsx(K,{id:"wham.composer.codeItButton",defaultMessage:"Code"})})})]})})}const Zn=ft({submitLabel:{id:"gVT0DB",defaultMessage:"Submit"}}),ea=F(()=>R(()=>import("./pfg8sguwg6pyv34z.js"),__vite__mapDeps([6,1])),{loading:t=>L(t)}),ta=F(()=>R(()=>import("./jics938ioiejxmr3.js"),__vite__mapDeps([7,1])),{loading:t=>L(t)}),sa=F(()=>R(()=>import("./ig60ujc76weklqmh.js"),__vite__mapDeps([8,1])),{loading:t=>L(t)}),na=F(()=>R(()=>import("./g03e0l13yr8s5v7c.js"),__vite__mapDeps([9,1])),{loading:t=>L(t)}),aa=4,oa=t=>{switch(t){case 1:return s.jsx(na,{"aria-hidden":!0,className:"icon-sm"});case 2:return s.jsx(sa,{"aria-hidden":!0,className:"icon-sm"});case 3:return s.jsx(ta,{"aria-hidden":!0,className:"icon-sm"});default:return s.jsx(ea,{"aria-hidden":!0,className:"icon-sm"})}};function ia({attempts:t,setAttempts:e}){var f;const o=Q(),[a,l]=y.useState(!1),r=y.useRef(null),n=()=>l(!1),c=we(),x=(f=Ss(c,"2179180337").value.max_attempts)!=null?f:aa;return s.jsx(ra,{children:s.jsxs(en,{open:a,onOpenChange:l,children:[s.jsx(In,{triggerText:o.formatMessage({id:"wham.attemptsSelector.trigger",defaultMessage:"{count}x"},{count:t}),toolTip:o.formatMessage({id:"wham.attemptsSelector.tooltip",defaultMessage:"Number of simultaneous versions"}),ariaLabel:o.formatMessage({id:"wham.attemptsSelector.ariaLabel",defaultMessage:"Open versions number selector, currently set to {count}x"},{count:t}),Icon:oa(t),truncate:!1}),s.jsx(Pn,{align:"start",isOpen:a,closePopover:n,popoverContentRef:r,children:s.jsx("div",{className:"flex w-50 flex-col rounded-lg p-1.5",children:[...Array(x)].map((h,p)=>s.jsx(Nn,{className:"w-full",onClick:()=>{e(p+1),n()},isSelected:t===p+1,label:o.formatMessage({id:"wham.attemptsSelector.option",defaultMessage:"{count, plural, one {# version} other {# versions}}"},{count:p+1})},p+1))})})]})})}function ra({children:t}){const e=Q(),o=tn(),a=_n(),l=o&&!o.isLoading&&o.eligible&&!a.isLoading&&!!a.data;return s.jsx(ds,{side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",show:l,sideOffset:0,className:"w-60",announcementKey:sn,title:e.formatMessage({id:"wham.composerBon.nuxTooltip.title",defaultMessage:"Best-of-N"}),description:e.formatMessage({id:"wham.composerBon.nuxTooltip.description",defaultMessage:"Generate multiple solutions so you can pick the best approach."}),onDismiss:o.markAsViewed,children:t})}function Lt(t){const e=Q(),{data:o}=Pt(),a=yn(o);switch(t){case"enabled":return;case"rate-limit":return e.formatMessage({id:"wham.whamComposer.hitRateLimit",defaultMessage:"You have reached your rate limit. It will reset at {resetsAfterText}"},{resetsAfterText:a!=null?kn(e,a):void 0});case"no-environment":return e.formatMessage({id:"wham.whamComposer.noEnvironment",defaultMessage:"No environment selected"});case"no-content":return e.formatMessage({id:"wham.whamComposer.noContent",defaultMessage:"Enter a prompt to continue"});case"no-github-connection":return e.formatMessage({id:"wham.whamComposer.noGitHubConnection",defaultMessage:"No GitHub connection"});case"no-repository":return e.formatMessage({id:"wham.whamComposer.noRepository",defaultMessage:"No repository selected"});case"connect-github-error":return e.formatMessage({id:"wham.whamComposer.connectGitHubError",defaultMessage:"Failed to load environments"});default:Ts(t)}}function Bt({isFollowUp:t,hasComments:e}){const{data:o}=Pt(),a=ms(o),l=A(({environmentId:b})=>b),r=A(({selectedRepositoryId:b})=>b),n=A(b=>b.useRepositoryAsEnvironment),c=A(({branch:b})=>b),x=os(),h=!Nt(()=>cs(x))||e,{isConnected:p,error:g}=is(ls.GITHUB_CONNECTOR,"github","/codex",rs.CODEX);if(a)return"rate-limit";if(!l&&!c&&!t){if(!n)return"no-environment";if(!r)return"no-repository"}return!t&&!p?"no-github-connection":!t&&g?"connect-github-error":h?"enabled":"no-content"}function la(t){"use forget";const e=pt.c(18),{children:o}=t,a=we(),{eligible:l,markAsViewed:r,isLoading:n}=nn();let c;e[0]!==a?(c=z(a,"3419038745"),e[0]=a,e[1]=c):c=e[1];const x=c,f=x&&!n&&l;let h;e[2]!==f?(h={enabled:f},e[2]=f,e[3]=h):h=e[3];const{isLoading:p,data:g}=Sn(h),b=x&&!n&&l&&!p&&g;let M,k;if(e[4]!==l||e[5]!==g||e[6]!==x||e[7]!==p||e[8]!==r?(M=()=>{l&&x&&!p&&!g&&r()},k=[l,x,p,g,r],e[4]=l,e[5]=g,e[6]=x,e[7]=p,e[8]=r,e[9]=M,e[10]=k):(M=e[9],k=e[10]),y.useEffect(M,k),!b){let S;return e[11]!==o?(S=s.jsx(s.Fragment,{children:o}),e[11]=o,e[12]=S):S=e[12],S}let i;e[13]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx(K,{id:"wham.combinedSubmitButtonNux.title",defaultMessage:"Ask mode is now /plan"}),e[13]=i):i=e[13];let d;e[14]===Symbol.for("react.memo_cache_sentinel")?(d=s.jsx("div",{className:"flex flex-col gap-3 text-sm",children:s.jsx("p",{children:s.jsx(K,{id:"wham.combinedSubmitButtonNux.body.combined",defaultMessage:"Type /plan or click + to ask Codex to plan changes or answer questions quickly."})})}),e[14]=d):d=e[14];let v;return e[15]!==o||e[16]!==r?(v=s.jsx(ds,{announcementKey:an,show:!0,side:"bottom",align:"center",sideOffset:12,theme:"bright",badge:"new",contentAlign:"start",dismissOnOutsideClick:!0,className:"max-w-xs",onDismiss:r,title:i,description:d,children:o}),e[15]=o,e[16]=r,e[17]=v):v=e[17],v}const ca=F(()=>R(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yq),__vite__mapDeps([2,1,3,4,5])),{loading:t=>L(t)});function ua(t){"use forget";const e=pt.c(46),{selectableTools:o,selectedTool:a,onSelectTool:l,isGitHubConnected:r,isImageUploadEnabled:n,fileInputRef:c,onFileChange:x}=t,f=Q();let h;e[0]!==f?(h=f.formatMessage({id:"wham.whamComposer.plusMenu",defaultMessage:"Add files and more"}),e[0]=f,e[1]=h):h=e[1];let p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p=s.jsx("kbd",{className:"bg-token-bg-tertiary -me-1 inline-grid aspect-square w-4 items-center justify-center rounded-sm text-[11px]",children:s.jsx("span",{children:"/"})}),e[2]=p):p=e[2];let g;e[3]!==h?(g=s.jsxs(s.Fragment,{children:[h," ",p]}),e[3]=h,e[4]=g):g=e[4];let b;e[5]!==f?(b=f.formatMessage({id:"wham.whamComposer.plusMenu",defaultMessage:"Add files and more"}),e[5]=f,e[6]=b):b=e[6];let M;e[7]===Symbol.for("react.memo_cache_sentinel")?(M=s.jsx(ca,{className:"icon"}),e[7]=M):M=e[7];let k;e[8]!==b?(k=s.jsx(Y.BasicTrigger,{asChild:!0,children:s.jsx("button",{type:"button",className:"composer-btn","aria-label":b,children:M})}),e[8]=b,e[9]=k):k=e[9];let i;e[10]!==g||e[11]!==k?(i=s.jsx("div",{onPointerDown:ma,onClick:da,children:s.jsx(be,{side:"bottom",label:g,children:k})}),e[10]=g,e[11]=k,e[12]=i):i=e[12];let d;if(e[13]!==l||e[14]!==o||e[15]!==a.key){let _;e[17]!==l||e[18]!==a.key?(_=j=>s.jsxs(Y.Item,{disabled:!j.available,className:"hover:bg-token-bg-tertiary flex items-center gap-2 rounded-lg px-3 py-2 text-start text-sm",onSelect:N=>{N.preventDefault(),j.available&&l(j.key)},children:[s.jsx("span",{className:"text-token-text-secondary",children:j.icon}),s.jsx("span",{className:mt("flex-1",j.key===a.key&&j.available?"text-token-text-brand font-medium":void 0),children:j.label})]},j.key),e[17]=l,e[18]=a.key,e[19]=_):_=e[19],d=o.map(_),e[13]=l,e[14]=o,e[15]=a.key,e[16]=d}else d=e[16];let v;e[20]!==c||e[21]!==f||e[22]!==r||e[23]!==n||e[24]!==o.length?(v=r&&n&&s.jsxs(s.Fragment,{children:[o.length>0&&s.jsx(Y.Separator,{className:"my-1"}),s.jsx(Y.Item,{className:"hover:bg-token-bg-tertiary rounded-lg px-3 py-2 text-start text-sm",onSelect:_=>{var j;_.preventDefault(),(j=c.current)==null||j.click()},children:f.formatMessage({id:"wham.whamComposer.attachImage",defaultMessage:"Upload attachment"})})]}),e[20]=c,e[21]=f,e[22]=r,e[23]=n,e[24]=o.length,e[25]=v):v=e[25];let S;e[26]!==d||e[27]!==v?(S=s.jsx(Y.Portal,{children:s.jsxs(Y.Content,{align:"start",sideOffset:8,className:"min-w-[16rem] p-1",children:[d,v]})}),e[26]=d,e[27]=v,e[28]=S):S=e[28];let T;e[29]!==S||e[30]!==i?(T=s.jsxs(Y.Root,{modal:!1,children:[i,S]}),e[29]=S,e[30]=i,e[31]=T):T=e[31];let u;e[32]!==l||e[33]!==a.icon||e[34]!==a.key||e[35]!==a.label?(u=a.key!=="code"&&s.jsx(on,{icon:a.icon,label:a.label,content:a.label,removable:!0,onRemove:()=>l("code")}),e[32]=l,e[33]=a.icon,e[34]=a.key,e[35]=a.label,e[36]=u):u=e[36];let w;e[37]!==c||e[38]!==r||e[39]!==n||e[40]!==x?(w=r&&n&&s.jsx("input",{ref:c,type:"file",accept:"image/*",multiple:!0,hidden:!0,onChange:x}),e[37]=c,e[38]=r,e[39]=n,e[40]=x,e[41]=w):w=e[41];let E;return e[42]!==T||e[43]!==u||e[44]!==w?(E=s.jsx(la,{children:s.jsxs("div",{className:"flex items-center",children:[T,u,w]})}),e[42]=T,e[43]=u,e[44]=w,e[45]=E):E=e[45],E}function da(t){return t.stopPropagation()}function ma(t){return t.stopPropagation()}const fa=F(()=>R(()=>import("./ghewn7l2ynbm32fm.js").then(t=>t.vJ),__vite__mapDeps([3,1,4])),{loading:t=>L(t)}),pa=F(()=>R(()=>import("./otyqbgm5k20lfbwp.js").then(t=>t._),__vite__mapDeps([10,1])),{loading:t=>L(t)});function ha({comments:t,onClearComments:e}){const o=Q();return t.length===0?null:s.jsxs("div",{className:"bg bg-token-bg-secondary mx-1 mt-1 flex items-center gap-2 rounded-t-3xl rounded-b-lg py-0.5 ps-3 pe-0.5 font-semibold text-blue-400",children:[s.jsx(pa,{className:"icon"}),s.jsx("div",{className:"flex-1 text-sm",children:s.jsx(K,{id:"wham.composer.commentCount",defaultMessage:"{count, plural, one {One code comment} other {# code comments}}",values:{count:t.length}})}),s.jsx("button",{className:"text-token-text-secondary flex h-9 w-9 shrink-0 items-center justify-center",onClick:a=>{a.preventDefault(),a.stopPropagation(),e()},"aria-label":o.formatMessage({id:"wham.composer.clearComments",defaultMessage:"Clear comments"}),children:s.jsx(fa,{className:"icon"})})]})}function ga({composerController:t,layoutMode:e,slashCommands:o}){const a=Q(),{refs:l,floatingStyles:r}=Es({placement:"bottom-start",middleware:[js({mainAxis:10,alignmentAxis:-18}),As({padding:6}),Is({apply:({elements:u,availableWidth:w,availableHeight:E})=>{u.floating.style.setProperty("--radix-popper-available-width","".concat(w,"px")),u.floating.style.setProperty("--radix-popper-available-height","".concat(E,"px"))}})],whileElementsMounted:Ns}),[n,c]=y.useState(void 0);y.useEffect(()=>{const u=P(t);u.dispatch(Rs(u.state.tr,{setReferencePosition:l.setReference,onHintMatch(w){c(E=>Bs(E,w)?E:w)}}))},[t,l.setReference]);const x=y.useMemo(()=>!n||n.triggerSymbol!=="/"?[]:o.length?n.text?[rn(o,n.text,u=>ln(u),{locale:a.locale})]:[o.filter(u=>!u.noMatchEmpty)]:[],[n,a.locale,o]),f=y.useMemo(()=>e!=="bottom"?x:x.slice().reverse().map(u=>[...u].reverse()),[x,e]),h=y.useMemo(()=>f.flat(),[f]),[p,g]=y.useState(e==="bottom"?-1:0),b=p==null?null:(p+h.length)%h.length,M=y.useCallback(u=>{g(w=>{if(w==null)return null;const E=h.length;for(let _=0;_<E;_++){const j=(w+E+(_+1)*u)%E;if(!h[j].disabled)return j}return null})},[h]),k=y.useRef(M);k.current=M;const i=h.length===0;y.useEffect(()=>{if(i){g(null);return}e==="bottom"?(g(0),k.current(-1)):(g(-1),k.current(1))},[e,i]);const d=b==null?null:h[b],v=y.useCallback(()=>{if(n!=null&&n.range){const u=P(t);Fs(u,n.range.from,n.range.to)}},[t,n]),S=y.useCallback(({commandToSave:u=d,expectPerfectMatch:w})=>{var N;if(!n||!u||u.disabled)return!1;const E=n.text.toLocaleLowerCase(),_=[u.command,...(N=u.aliases)!=null?N:[]].some(ht=>ht.toLocaleLowerCase()===E);if(w&&!_)return!1;v();const j=P(t);return _e(j),u.onSelect(),!0},[v,t,n,d]),T=y.useRef(S);return T.current=S,y.useEffect(()=>{if(i){const w=P(t);_e(w);return}const u=P(t);return Ps(u,w=>{if(w==="up")k.current(-1);else if(w==="down")k.current(1);else if(w==="cancel")_e(u),Os(u);else{if(w==="submit")return _e(u),T.current({expectPerfectMatch:!1});if(w==="checkMatch")return T.current({expectPerfectMatch:!0})}}),()=>_e(u)},[t,i]),i?null:s.jsx(Ls,{ref:l.setFloating,style:r,className:mt("max-w-[min(var(--radix-popper-available-width,100vw),--spacing(100))] overflow-y-auto [scrollbar-width:none]",h.length>6?"max-h-[min(var(--radix-popper-available-height,50svh),--spacing(1.5)+5*var(--menu-item-height))]":"max-h-[var(--radix-popper-available-height,50svh)]"),onPointerDown:u=>{u.preventDefault()},children:f.map((u,w)=>{let E=0;for(let _=0;_<w;_++)E+=f[_].length;return s.jsx(Y.Group,{children:u.map((_,j)=>{const N=E+j;return s.jsx(cn,{command:_,isHighlighted:N===b,onHighlight:()=>g(N),onClick:()=>{S({commandToSave:_,expectPerfectMatch:!1}),Rt(P(t))}},_.command)})},w)})})}function xa(){const t=Q(),e=Ms(),{setupMfa:o}=Ln({redirectUrl:"/codex"});return s.jsx(Ds,{isOpen:!0,onClose:()=>{},type:"warning",title:t.formatMessage({id:"wham.mfaRequiredModal.title",defaultMessage:"Enable multi-factor authentication to access Codex"}),description:t.formatMessage({id:"wham.mfaRequiredModal.description",defaultMessage:"To continue using Codex, please turn on multi-factor authentication for your account."}),testId:"modal-mfa-required",children:s.jsxs("div",{className:"flex w-full justify-end gap-2",children:[s.jsx(ve,{color:"secondary",onClick:()=>{e("/")},children:s.jsx(K,{id:"wham.mfaRequiredModal.backToChatGPT",defaultMessage:"Back to ChatGPT"})}),s.jsx(ve,{color:"primary",onClick:()=>{o()},children:s.jsx(K,{id:"wham.mfaRequiredModal.enableMFA",defaultMessage:"Enable MFA"})})]})})}function Ya(t){const{outputDiffs:e}=fs(t==null?void 0:t.output_items);return{filesModified:dt(e,o=>{var a;return(a=o.files_modified)!=null?a:0}),linesAdded:dt(e,o=>{var a;return(a=o.lines_added)!=null?a:0}),linesRemoved:dt(e,o=>{var a;return(a=o.lines_removed)!=null?a:0})}}function fs(t){let e=!1;return t?{outputDiffs:t.map(a=>{switch(a.type){case"output_diff":return a;case"pr":return e=!!a.pre_apply_patch,a.output_diff;case"cr":return a.reviewed_diff;default:return null}}).filter(a=>a!=null),hasPreApplyPatch:e}:{outputDiffs:[],hasPreApplyPatch:e}}const ba=F(()=>R(()=>import("./hm9ujel5qp4i8yne.js"),__vite__mapDeps([11,1])),{loading:t=>L(t)}),va=F(()=>R(()=>import("./kaxn2bizrxslkpa3.js").then(t=>t._),__vite__mapDeps([12,1])),{loading:t=>L(t)}),wa=F(()=>R(()=>import("./i1tb1w6bhijregtp.js"),__vite__mapDeps([13,1,3,4,2,5,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41])).then(t=>t.SpeculativeTaskContentModal));function Ca({taskId:t,index:e,assistantTurn:o,suggestion:a,disabledReason:l,loading:r}){const{outputDiffs:n}=fs(o.output_items),c=n[0];return s.jsx(be,{side:"right",sideOffset:10,label:l,children:s.jsxs("div",{className:"flex w-full items-center gap-1.5 rounded-lg px-2 py-1",children:[s.jsx("span",{className:"self-start pt-[0.125rem]",children:r?s.jsx(Ft,{className:"text-token-text-tertiary icon-sm"}):s.jsx(ba,{className:"text-token-text-tertiary icon-sm"})}),s.jsx("span",{className:"text-token-text-primary line-clamp-2 flex-1 text-start text-sm leading-snug break-words",children:a.title}),c&&c.lines_added!=null&&c.lines_removed!=null&&s.jsx(On,{className:"text-sm",linesAdded:c.lines_added,linesRemoved:c.lines_removed}),s.jsx(ya,{taskId:t,assistantTurn:o,suggestion:a,index:e})]})})}function ya({taskId:t,assistantTurn:e,suggestion:o,index:a}){const[l,r]=y.useState(!1);return s.jsxs("div",{onClick:n=>{n.stopPropagation(),n.preventDefault()},children:[s.jsx(ve,{color:"secondary",size:"small",icon:va,onClick:n=>{n.stopPropagation(),n.preventDefault(),r(!0)},children:s.jsx(K,{id:"wham.speculativeFollowUpSuggestionRow.preview",defaultMessage:"Preview"})}),s.jsx(wa,{taskId:t,suggestion:o,index:a,assistantTurn:e,isOpen:l,onClose:()=>r(!1)})]})}const ka=F(()=>R(()=>import("./dzlsnt42nnmwuxsc.js").then(t=>t._),__vite__mapDeps([42,1])),{loading:t=>L(t)});function Ma({taskId:t,turnId:e,followupVisibilityState:o,followUpSuggestions:a,hasComments:l,isSubmitting:r,onSuggestionClick:n,children:c}){const x=Q(),[f,h]=y.useState(null),{data:p}=_a({taskId:t,turnId:e}),g=Bt({isFollowUp:!0,hasComments:l});let b=Lt(g);g==="no-content"&&(b=void 0);const M=!!(p!=null&&p.length)&&t&&e;return y.useEffect(()=>{M&&ne.recordFollowUpsSeen(t,e,a.length)},[M,t,e,a.length]),M?s.jsxs("div",{className:"bg-token-bg-tertiary flex flex-col gap-1.5 rounded-2xl p-2",children:[s.jsx(us,{initial:!1,children:o==="visible"&&s.jsx("div",{className:"flex flex-col",inert:r,children:p.map(({suggested_task:k,assistant_turn:i},d)=>s.jsx(Ca,{index:d,taskId:t,turnId:e,assistantTurn:i,suggestion:k,disabledReason:b,loading:f===d&&r,onClick:()=>{r||(h(d),n(k))}},d))})}),o==="collapsed"&&s.jsxs("button",{type:"button",className:"text-token-text-tertiary enabled:hover:text-token-text-secondary focus:bg-token-bg-secondary flex items-center gap-2 rounded-lg p-2 text-xs font-semibold focus:outline-none","aria-label":x.formatMessage({id:"wham.speculativeFollowUpContainer.showSuggestions",defaultMessage:"Show follow up suggestions"}),onClick:()=>{ne.recordFollowUpsExpanded(t,e)},children:[s.jsx(ka,{className:"icon-sm"}),s.jsx(K,{id:"wham.composer.followup.show",defaultMessage:"Suggestions"},"text")]},"collapsed"),c({isWrappedByContainer:!0})]}):c({isWrappedByContainer:!1})}function _a({taskId:t,turnId:e}){return ns({queryKey:["wham","speculative-turns",t,e],queryFn:async()=>{const o=await qs.safeGet("/wham/tasks/{task_id}/speculative_turns/{task_turn_id}",{parameters:{path:{task_id:t,task_turn_id:e}}}),a=o.speculative_turns;return un(a,r=>r.assistant_turn.turn_status==="completed")?o.speculative_turns.filter(r=>!r.assistant_turn.discarded):[]},refetchInterval:o=>{var l,r;return o&&((r=(l=o.state)==null?void 0:l.data)==null?void 0:r.some(n=>n.assistant_turn.turn_status==="pending"||n.assistant_turn.turn_status==="in_progress"))?3e4:!1}})}const Sa=F(()=>R(()=>import("./dzlsnt42nnmwuxsc.js").then(t=>t._),__vite__mapDeps([42,1])),{loading:t=>L(t)}),Ta=F(()=>R(()=>import("./otyqbgm5k20lfbwp.js").then(t=>t._),__vite__mapDeps([10,1])),{loading:t=>L(t)});function Ea({taskId:t,turnId:e,isComposerExpanded:o,followUpSuggestions:a,hasComments:l,isSubmitting:r,onSuggestionClick:n,children:c}){const x=we(),f=Aa(x,o),h=Q(),[p,g]=y.useState(null),b=Bt({isFollowUp:!0,hasComments:l});let M=Lt(b);b==="no-content"&&(M=void 0);const k=!(f==="hidden"||!a.length)&&t&&e;if(y.useEffect(()=>{k&&ne.recordFollowUpsSeen(t,e,a.length)},[k,t,e,a.length]),k){if(z(x,"2007094101")&&a.find(i=>!!i.assistantTurnId))return s.jsx(Ma,{taskId:t,turnId:e,followupVisibilityState:f,followUpSuggestions:a,hasComments:l,isSubmitting:r,onSuggestionClick:n,children:({isWrappedByContainer:i})=>c({isWrappedByContainer:i})})}else return c({isWrappedByContainer:!1});return s.jsxs("div",{className:"bg-token-bg-tertiary flex flex-col gap-1.5 rounded-2xl p-2",children:[s.jsx(us,{initial:!1,children:f==="visible"&&s.jsx("div",{className:"flex flex-col",inert:r,children:a.map((i,d)=>s.jsx(ja,{index:d,taskId:t,turnId:e,suggestion:i.suggestion,disabledReason:M,loading:p===d&&r,onClick:()=>{r||(g(d),n(i.suggestion))}},d))})}),f==="collapsed"&&s.jsxs("button",{type:"button",className:"text-token-text-tertiary enabled:hover:text-token-text-secondary focus:bg-token-bg-secondary flex items-center gap-2 rounded-lg p-2 text-xs font-semibold focus:outline-none","aria-label":h.formatMessage({id:"wham.followUpContainer.showSuggestions",defaultMessage:"Show follow up suggestions"}),onClick:()=>{ne.recordFollowUpsExpanded(t,e)},children:[s.jsx(Sa,{className:"icon-sm"}),s.jsx(K,{id:"wham.composer.followup.show",defaultMessage:"Suggestions"},"text")]},"collapsed"),c({isWrappedByContainer:!0})]})}function ja({taskId:t,turnId:e,index:o,suggestion:a,disabledReason:l,loading:r,onClick:n}){return s.jsx(be,{side:"right",sideOffset:10,label:l,children:s.jsxs("button",{type:"button",disabled:!!l||r,className:"group hover:bg-token-bg-secondary focus:bg-token-bg-secondary -disabled:cursor-pointer flex w-full items-start gap-1.5 rounded-lg px-2 py-1 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>{n(),ne.recordFollowUpsClicked(t,e,o,a.severity)},children:[s.jsx("span",{className:"pt-[0.125rem]",children:r?s.jsx(Ft,{className:"text-token-text-tertiary icon-sm"}):s.jsx(Ta,{className:"text-token-text-tertiary icon-sm"})}),s.jsx("span",{className:"text-token-text-primary line-clamp-2 text-start text-sm leading-snug break-words",children:a.title})]})})}function Aa(t,e){return z(t,"3485296344")||void 0?e?"collapsed":"visible":"hidden"}function Ia(){const t=we(),e=A(a=>a.bestOfN);return e!=null?e:Ws(t,"2398649844").get("default_attempts",1)}const ut=ft({describeTask:{id:"wham.whamComposer.describeACodingTask",defaultMessage:"Describe a task"},describeAnotherTask:{id:"wham.whamComposer.describeAnotherCodingTask",defaultMessage:"Describe another task"},askQuestionWithPlan:{id:"wham.whamComposer.askAQuestionWithPlan",defaultMessage:"Ask a question with /plan"},askQuestionWithPlanAnother:{id:"wham.whamComposer.askAQuestionWithPlanAnother",defaultMessage:"Ask a question with /plan"}}),Zt=[{firstTaskMessage:ut.describeTask,subsequentTaskMessage:ut.describeAnotherTask},{firstTaskMessage:ut.askQuestionWithPlan,subsequentTaskMessage:ut.askQuestionWithPlanAnother}];function Za(t){"use forget";var Wt,Ht,Vt,Qt,Ut,Gt;const e=pt.c(136),{disableAutoFocus:o,isBigBoxMode:a,disableDuringSubmit:l,expanded:r,followUp:n,onClearComments:c,onSubmit:x,onSuccess:f,onCreateEnvironment:h,attemptIndex:p,ariaLabel:g}=t,b=o===void 0?!1:o,M=a===void 0?!1:a,k=l===void 0?!1:l,i=Q(),d=as(),v=ts(),[S,T]=y.useState("code"),{refetch:u}=Tn(),{refetch:w}=En(n==null?void 0:n.taskId),{refetch:E}=jn(n==null?void 0:n.taskId),_=A(Da),j=A(Oa),[N,ht]=y.useState(!0),[X,Ot]=y.useState(!1),H=Hs(),Te=$t(Ba),ps=$t(It.hasUploadInProgress),hs=Ia(),gs=A(La),[xs,bs]=y.useState(1),Z=n?xs:hs,gt=n?bs:gs,B=we();let Ee;e[0]!==B?(Ee=z(B,"3492040717"),e[0]=B,e[1]=Ee):Ee=e[1];const ee=Ee;let je;e[2]!==B?(je=z(B,"879591222")||void 0,e[2]=B,e[3]=je):je=e[3];const vs=je;let Ae;e[4]!==B?(Ae=z(B,"3536244140"),e[4]=B,e[5]=Ae):Ae=e[5];const Ie=Ae,Ce=z(B,"3419038745");let Ne;e[6]!==B?(Ne=Dn(B),e[6]=B,e[7]=Ne):Ne=e[7];const U=Ne,[xt,Re]=y.useState(!1),C=os();let Fe;e[8]!==C?(Fe=dn(C),e[8]=C,e[9]=Fe):Fe=e[9];const ae=Nt(Fe.isWhisperActive$),ws=y.useRef(null),Dt=y.useRef(Zt[Math.floor(Math.random()*Zt.length)]),{data:bt}=Pt();let Pe;e[10]!==bt?(Pe=ms(bt),e[10]=bt,e[11]=Pe):Pe=e[11];const Le=Pe,oe=Le&&!!n,ye=oe?!1:ae?!0:r;let Be;e[12]!==C||e[13]!==ye?(Be=()=>ye!=null?ye:!cs(C)||Qs(C),e[12]=C,e[13]=ye,e[14]=Be):Be=e[14];const J=Nt(Be),vt=k&&X||oe,V=!!n&&((Wt=n.comments.length)!=null?Wt:0)>0;let Oe;e[15]!==H||e[16]!==i||e[17]!==d?(Oe=m=>{for(const I of m)rt.uploadFile(H,Us(I),I,Gs.Codex,[],i,d)},e[15]=H,e[16]=i,e[17]=d,e[18]=Oe):Oe=e[18];const te=Oe;let De;e[19]!==te?(De=function(I){const D=I.target.files;D&&(te(D),I.target.value="")},e[19]=te,e[20]=De):De=e[20];const wt=De;let qe,We;e[21]!==C||e[22]!==U||e[23]!==te?(qe=()=>{if(!U)return;const m=I=>{var ke;const D=(ke=I.clipboardData)==null?void 0:ke.items;if(!D)return;const q=[];for(const At of D)if(At.kind==="file"){const ge=At.getAsFile();ge&&ge.type.startsWith("image/")&&q.push(ge)}q.length>0&&(I.preventDefault(),te(q))};return Ks(P(C).dom,{paste:m})},We=[C,U,te],e[21]=C,e[22]=U,e[23]=te,e[24]=qe,e[25]=We):(qe=e[24],We=e[25]),y.useEffect(qe,We);let He;e[26]!==H?(He=function(){return It.getReadyFiles(H.getState()).flatMap(Pa)},e[26]=H,e[27]=He):He=e[27];const Ct=He;let ie;e[28]!==C?(ie=()=>Rt(P(C)),e[28]=C,e[29]=ie):ie=e[29];let re;e[30]!==i?(re=i.formatMessage({id:"wham.keyboardActions.focusComposer",defaultMessage:"Focus chat"}),e[30]=i,e[31]=re):re=e[31];let Ve;e[32]===Symbol.for("react.memo_cache_sentinel")?(Ve=[ct.Shift,ct.Escape],e[32]=Ve):Ve=e[32];let le;e[33]!==n?(le=n?void 0:[[ct.Mod,ct.Shift,"o"]],e[33]=n,e[34]=le):le=e[34];let Qe;e[35]!==ie||e[36]!==re||e[37]!==le?(Qe=[{key:"focusComposer",action:ie,actionMessageDescriptor:re,group:mn.Chat,keyboardBinding:Ve,altKeyboardBindings:le}],e[35]=ie,e[36]=re,e[37]=le,e[38]=Qe):Qe=e[38],Bn(Qe);const yt=!!n;let Ue;e[39]!==V||e[40]!==yt?(Ue={isFollowUp:yt,hasComments:V},e[39]=V,e[40]=yt,e[41]=Ue):Ue=e[41];const Cs=Bt(Ue),{isConnected:ce}=is(ls.GITHUB_CONNECTOR,"github","/codex",rs.CODEX),Ge=Lt(Cs),ue=!!Ge||X&&k||ps,kt=qn.map(m=>{const I=!m.requiresGitHubConnection||ce,D=!m.requiresReviewFeature,q=I&&D&&Ce;return{key:m.key,label:i.formatMessage(m.messages.label),submitLabel:i.formatMessage(m.messages.submitLabel),description:i.formatMessage(m.messages.description),environmentMode:m.environmentMode,runEnvironmentInQaMode:m.runEnvironmentInQaMode,slashCommand:m.slashCommand,slashAliases:m.slashAliases,icon:m.icon,analyticsAction:m.analyticsAction,available:q,disabledReason:!q&&m.messages.unavailable?i.formatMessage(m.messages.unavailable):void 0}}),qt=new Map(kt.map(Fa)),Ke=kt.filter(Ra),ys=(Ht=qt.get("code"))!=null?Ht:kt[0],$=(Vt=qt.get(S))!=null?Vt:ys;let $e;e[42]===Symbol.for("react.memo_cache_sentinel")?($e=m=>({command:m.slashCommand,aliases:m.slashAliases,title:m.label,secondary:void 0,icon:m.icon,disabled:!m.available,onSelect:()=>{m.available&&T(m.key)}}),e[42]=$e):$e=e[42];const Mt=Ke.map($e);let de;e[43]!==Z||e[44]!==ee||e[45]!==C||e[46]!==H||e[47]!==n||e[48]!==Ct||e[49]!==V||e[50]!==i||e[51]!==N||e[52]!==U||e[53]!==x||e[54]!==v||e[55]!==Re||e[56]!==d?(de=async m=>{const{runEnvironmentInQaMode:I,promptOverride:D}=m===void 0?{runEnvironmentInQaMode:!1}:m,q=D!=null?D:$s(P(C).state.doc).content,ke=It.getReadyFiles(H.getState());if(!(!!q.length||V))throw new Error("No content to submit");const ge=U?Ct():[];if(x==null||x(),rt.reset(H),Ot(!0),n)return await Se.createFollowUpTask(n.taskId,n.turnId,q,n.comments,I,ee?Z:void 0,ge).catch(G=>{var Me;throw D||(zt(P(C),q),rt.restoreFiles(H,ke)),G instanceof lt&&G.status===429?(v.invalidateQueries({queryKey:["wham","usage","rate-limit-status"]}),d.danger(i.formatMessage(es.rateLimit),{id:n.turnId,duration:5,hasCloseButton:!0})):G instanceof Jt?Yt(G,n.turnId,i,d):G instanceof lt&&G.status===403&&((Me=G.detail)!=null&&Me.toLowerCase().includes("multi-factor authentication"))?Re(!0):d.danger(i.formatMessage({id:"wham.whamComposer.failedToCreateFollowUpTask",defaultMessage:"Failed to create follow-up"}),{id:n.turnId,duration:5,hasCloseButton:!0}),G});{const{branch:G,environmentId:Me}=A.getState(),ks=N;if(G){if(!Me)throw new Error("Environment is required for new tasks.")}else throw new Error("Branch is required");const se=crypto.randomUUID();return A.getState().addPendingTaskId(se),Se.createNewTask(Me,G,q,I,ee?Z:void 0,ge).catch(W=>{throw A.getState().removePendingTaskId(se),D||(zs(P(C).state.doc)?(zt(P(C),q),rt.restoreFiles(H,ke)):(d.danger(i.formatMessage({id:"wham.whamComposer.failedToCreateTaskCopyToClipboard",defaultMessage:"Failed to create task. Previous prompt copied to clipboard."}),{id:se,duration:5,hasCloseButton:!0}),navigator.clipboard.writeText(q))),W}).catch(W=>{var Kt;throw W instanceof lt&&W.status===429?(v.invalidateQueries({queryKey:["wham","usage","rate-limit-status"]}),d.danger(i.formatMessage(es.rateLimit),{id:se,duration:5,hasCloseButton:!0})):W instanceof Jt?Yt(W,se,i,d):W instanceof lt&&W.status===403&&((Kt=W.detail)!=null&&Kt.toLowerCase().includes("multi-factor authentication"))?Re(!0):d.danger(i.formatMessage({id:"wham.whamComposer.failedToCreateTask",defaultMessage:"Failed to create task"}),{id:se,duration:5,hasCloseButton:!0}),W}).then(W=>(A.getState().assignPendingTaskToFinalTask(se,W.task.id),v.invalidateQueries({queryKey:["wham","usage","rate-limit-status"]}),ks&&ht(!1),W))}},e[43]=Z,e[44]=ee,e[45]=C,e[46]=H,e[47]=n,e[48]=Ct,e[49]=V,e[50]=i,e[51]=N,e[52]=U,e[53]=x,e[54]=v,e[55]=Re,e[56]=d,e[57]=de):de=e[57];let me;e[58]!==_||e[59]!==C||e[60]!==n||e[61]!==f||e[62]!==w||e[63]!==u||e[64]!==E||e[65]!==j?(me=m=>{j(!0),_(m.task.id,m.turn),m.user_turn&&_(m.task.id,m.user_turn),f==null||f(m),setTimeout(()=>{Rt(P(C))},0),u(),n&&(w(),E())},e[58]=_,e[59]=C,e[60]=n,e[61]=f,e[62]=w,e[63]=u,e[64]=E,e[65]=j,e[66]=me):me=e[66];let ze;e[67]===Symbol.for("react.memo_cache_sentinel")?(ze=()=>{Ot(!1)},e[67]=ze):ze=e[67];let Xe;e[68]!==de||e[69]!==me?(Xe={mutationFn:de,onSuccess:me,onSettled:ze},e[68]=de,e[69]=me,e[70]=Xe):Xe=e[70];const{mutate:O,isPending:Je}=ss(Xe);let Ye;e[71]!==Ce||e[72]!==O||e[73]!==ue||e[74]!==$?(Ye=m=>ue?!1:m.metaKey?(O(Ce?{runEnvironmentInQaMode:$.runEnvironmentInQaMode}:{runEnvironmentInQaMode:!1}),!0):m.altKey?(O(Ce?{runEnvironmentInQaMode:$.runEnvironmentInQaMode}:{runEnvironmentInQaMode:!0}),!0):!1,e[71]=Ce,e[72]=O,e[73]=ue,e[74]=$,e[75]=Ye):Ye=e[75];const Ze=Vs(Ye);let et,tt;e[76]!==C||e[77]!==Ze?(et=()=>Xs(P(C),{Enter:Ze}),tt=[C,Ze],e[76]=C,e[77]=Ze,e[78]=et,e[79]=tt):(et=e[78],tt=e[79]),y.useEffect(et,tt);let st;e[80]!==n?(st=dt(n?[n.turnStatus,...n.siblingTurnStatuses]:[],Na),e[80]=n,e[81]=st):st=e[81];const nt=st,at=!!n&&vs&&nt>0,_t=!at&&(Ie?!ae:!0),St=((Ut=(Qt=n==null?void 0:n.siblingTurnStatuses)==null?void 0:Qt.length)!=null?Ut:0)>1;let ot;e[82]!==p||e[83]!==St||e[84]!==i?(ot=St&&p?i.formatMessage({id:"wham.whamComposer.followUpOnTurn",defaultMessage:"Follow-up on version {version}"},{version:p}):i.formatMessage({id:"wham.whamComposer.requestChangesOrAskAQuestion",defaultMessage:"Request changes or ask a question"}),e[82]=p,e[83]=St,e[84]=i,e[85]=ot):ot=e[85];const Tt=ot,Et=n==null?void 0:n.taskId,jt=n==null?void 0:n.turnId;let fe;e[86]!==(n==null?void 0:n.followUpSuggestions)?(fe=(Gt=n==null?void 0:n.followUpSuggestions)!=null?Gt:[],e[86]=n==null?void 0:n.followUpSuggestions,e[87]=fe):fe=e[87];let pe;e[88]!==O?(pe=m=>{O({runEnvironmentInQaMode:!1,promptOverride:m.body})},e[88]=O,e[89]=pe):pe=e[89];let he;e[90]!==g||e[91]!==Z||e[92]!==ee||e[93]!==C||e[94]!==vt||e[95]!==O||e[96]!==b||e[97]!==Ge||e[98]!==n||e[99]!==Tt||e[100]!==V||e[101]!==Le||e[102]!==nt||e[103]!==i||e[104]!==M||e[105]!==Je||e[106]!==J||e[107]!==N||e[108]!==ce||e[109]!==U||e[110]!==ue||e[111]!==X||e[112]!==ae||e[113]!==c||e[114]!==h||e[115]!==wt||e[116]!==Te||e[117]!==Ke||e[118]!==$||e[119]!==gt||e[120]!==xt||e[121]!==oe||e[122]!==at||e[123]!==_t||e[124]!==Mt||e[125]!==Ie?(he=m=>{const{isWrappedByContainer:I}=m;return s.jsxs("div",{className:"contents",inert:vt,children:[s.jsxs(fn,{expanded:J,canCollapseWithInput:!Je&&I,isTemporaryChat:!1,shouldUseTightRadius:I,onSubmit:()=>{Je||O({runEnvironmentInQaMode:$.runEnvironmentInQaMode})},composerController:C,ariaLabel:g!=null?g:i.formatMessage({id:"wham.whamComposer.ariaLabel",defaultMessage:"Codex composer"}),children:[s.jsx(pn,{children:ae?s.jsx("div",{className:mt("flex max-w-full min-w-0 flex-1 items-center",M&&J&&"min-h-30"),children:s.jsx(hn,{composerController:C,className:"h-14"})}):s.jsx(gn,{composerController:C,disableAutoFocus:b||Le,textareaMaxHeightClassName:mt(M&&J&&"min-h-30",n?"max-h-[max(10rem,min(calc(100dvh-29rem),10rem))]":"max-h-[max(10rem,min(calc(100dvh-29rem),50dvh))]"),placeholder:n?Tt:i.formatMessage(N?Dt.current.firstTaskMessage:Dt.current.subsequentTaskMessage)})}),ce&&U&&Te.length>0&&s.jsx(Xt,{children:s.jsx(xn,{files:Te,selectedApps:[],activeSystemHintType:void 0,disableEditButton:!0,forceSmallView:!0,className:"no-scrollbar horizontal-scroll-fade-mask flex flex-nowrap gap-2 overflow-x-auto px-2.5 pt-2.5 pb-1.5 [--edge-fade-distance:1rem]"})}),s.jsx(bn,{children:s.jsx(ua,{selectableTools:Ke,selectedTool:$,onSelectTool:T,isGitHubConnected:ce,isImageUploadEnabled:U,fileInputRef:ws,onFileChange:wt})}),V&&s.jsx(Xt,{children:s.jsx(ha,{comments:n.comments,onClearComments:c})}),!ae&&s.jsx(vn,{children:s.jsxs("div",{className:"flex gap-2",children:[!n&&s.jsx(Rn,{onCreateEnvironment:h}),ee&&ce&&s.jsx(ia,{attempts:Z,setAttempts:gt})]})}),s.jsxs(wn,{children:[!oe&&s.jsxs("div",{className:"flex",children:[Ie&&s.jsx("div",{inert:X,children:s.jsx(Cn,{composerController:C,composerType:"codex"})}),_t&&s.jsx(Yn,{isSubmitDisabled:ue,createTask:O,selectedTool:$,disabledReason:Ge,isFollowUp:!!n}),at&&s.jsx(Hn,{taskId:n.taskId,hasMultipleInProgressOrStreamingTurns:nt>1})]}),oe&&s.jsx(Mn,{})]})]}),s.jsx(ga,{composerController:C,layoutMode:"bottom",slashCommands:Mt}),xt&&s.jsx(xa,{})]})},e[90]=g,e[91]=Z,e[92]=ee,e[93]=C,e[94]=vt,e[95]=O,e[96]=b,e[97]=Ge,e[98]=n,e[99]=Tt,e[100]=V,e[101]=Le,e[102]=nt,e[103]=i,e[104]=M,e[105]=Je,e[106]=J,e[107]=N,e[108]=ce,e[109]=U,e[110]=ue,e[111]=X,e[112]=ae,e[113]=c,e[114]=h,e[115]=wt,e[116]=Te,e[117]=Ke,e[118]=$,e[119]=gt,e[120]=xt,e[121]=oe,e[122]=at,e[123]=_t,e[124]=Mt,e[125]=Ie,e[126]=he):he=e[126];let it;return e[127]!==V||e[128]!==J||e[129]!==X||e[130]!==Et||e[131]!==jt||e[132]!==fe||e[133]!==pe||e[134]!==he?(it=s.jsx(Ea,{taskId:Et,turnId:jt,isComposerExpanded:J,followUpSuggestions:fe,hasComments:V,isSubmitting:X,onSuggestionClick:pe,children:he}),e[127]=V,e[128]=J,e[129]=X,e[130]=Et,e[131]=jt,e[132]=fe,e[133]=pe,e[134]=he,e[135]=it):it=e[135],it}function Na(t){return t==="pending"||t==="in_progress"?1:0}function Ra(t){return t.key!=="code"&&t.available}function Fa(t){return[t.key,t]}function Pa(t){const e=t.fileSpec;return e&&"width"in e&&"height"in e&&t.fileId?[{type:"image_asset_pointer",asset_pointer:Js(t.fileId),width:e.width,height:e.height,size_bytes:e.size}]:[]}function La(t){return t.setBestOfN}function Ba(t){return t.files}function Oa(t){return t.setHasSubmittedTaskInSession}function Da(t){const{addTurnToTaskMap:e}=t;return e}const es=ft({rateLimit:{id:"wham.whamComposer.failedToCreateTaskRateLimit",defaultMessage:"Rate limit reached"}});export{Za as W,Ya as a,fs as g,Dn as i,Qn as u};
//# sourceMappingURL=ozgq3nk5vhninx80.js.map
