const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ghewn7l2ynbm32fm.js","assets/i8clt0mfz495j7ii.js","assets/root-c4psboex.css","assets/ef28lc1b3o54kec9.js"])))=>i.map(i=>d[i]);
var ye=Object.defineProperty,we=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var le=(a,t,e)=>t in a?ye(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,se=(a,t)=>{for(var e in t||(t={}))je.call(t,e)&&le(a,e,t[e]);if(te)for(var e of te(t))Se.call(t,e)&&le(a,e,t[e]);return a},ne=(a,t)=>we(a,_e(t));import{r as x,j as n,c as V,_ as fe,e as ue}from"./i8clt0mfz495j7ii.js";import{pj as Q,aV as Z,d as ke,a$ as U,pk as Ee,pl as Le,o as me,L as he,ar as Ne,M as J,P as Te,$ as re,b0 as oe}from"./ghewn7l2ynbm32fm.js";import{g as Re}from"./ghnvrdqxofgwprfv.js";import{aI as O,d6 as Me,iL as Ce,hQ as Ie}from"./j0yo6uv6652vva62.js";const ae=1.2,ie=.95,ze=80,Ae=56,ce=.34,xe=x.memo(function({img:t,size:e,active:o,onClick:r,axis:s,index:l,indexMv:f}){var N,c;const i=x.useCallback(u=>{const v=Math.abs(u-l);return v<1?ae-(ae-ie)*v:ie},[l]),y=x.useCallback(u=>{const v=Math.abs(u-l);return v<1?1-(1-ce)*v:ce},[l]),h=Q(f,i),_=Q(f,y);return n.jsx(Z.button,{"aria-selected":o,role:"option",onClick:r,style:{height:e,width:e,scale:h,opacity:_},className:ke("border-thin focus-visible:ring-ring overflow-hidden rounded-lg border-black/10 bg-gray-200 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-none dark:border-white/10",s==="vertical"?"mx-auto mb-2 block":"flex-shrink-0"),children:n.jsx("img",{src:(N=t.thumbnail)!=null?N:t.url,alt:(c=t.title)!=null?c:"",loading:"lazy",decoding:"async",className:"h-full w-full rounded-lg object-cover"})})});function ve(a){"use forget";const t=V.c(51),{axis:e,itemSize:o,gap:r,imagesLen:s,index:l,setIndex:f,externalSyncRef:i,wheelHostRef:y}=a,h=x.useRef(null),[_,N]=x.useState(0),c=o+r,u=c*(s-1);let v;t[0]!==e||t[1]!==l||t[2]!==c||t[3]!==u?(v=()=>{const m=h.current;if(!m)return;const d=Math.round(l*c);e==="vertical"?m.scrollTop=O(d,0,u):m.scrollLeft=O(d,0,u)},t[0]=e,t[1]=l,t[2]=c,t[3]=u,t[4]=v):v=t[4];let w;t[5]===Symbol.for("react.memo_cache_sentinel")?(w=[],t[5]=w):w=t[5],U(v,w);let E,j;t[6]!==e||t[7]!==c?(E=()=>{const m=()=>{const R=e==="vertical"?window.innerHeight-Ae:window.innerWidth,I=Math.max(1,Math.floor(R/c)),z=I%2===0?I-1:I,A=e==="vertical"?ze:0;N(z*c-A)};m();let d=null;return typeof ResizeObserver<"u"&&(d=new ResizeObserver(()=>m()),d.observe(document.documentElement)),()=>{d&&d.disconnect()}},j=[e,c],t[6]=e,t[7]=c,t[8]=E,t[9]=j):(E=t[8],j=t[9]),U(E,j);let S;t[10]===Symbol.for("react.memo_cache_sentinel")?(S={container:h},t[10]=S):S=t[10];const{scrollX:M,scrollY:g}=Ee(S),k=e==="vertical"?g:M;let T;t[11]!==c?(T=m=>m/c,t[11]=c,t[12]=T):T=t[12];const p=Q(k,T);let b;t[13]!==s||t[14]!==l||t[15]!==c||t[16]!==f?(b=m=>{const d=Math.round(m/c);d!==l&&d>=0&&d<s&&f(d)},t[13]=s,t[14]=l,t[15]=c,t[16]=f,t[17]=b):b=t[17],Le(k,"change",b);let C;t[18]!==e||t[19]!==c||t[20]!==u?(C=(m,d)=>{const R=d===void 0?!1:d,I=h.current;if(!I)return;const z=Math.round(m*c),A=e==="vertical"?{top:O(z,0,u)}:{left:O(z,0,u)};R?I.scrollTo(ne(se({},A),{behavior:"smooth"})):e==="vertical"?I.scrollTop=A.top:I.scrollLeft=A.left},t[18]=e,t[19]=c,t[20]=u,t[21]=C):C=t[21];const L=C,H=x.useRef(null);let P;t[22]!==s||t[23]!==L||t[24]!==f?(P=m=>{H.current||(H.current=requestAnimationFrame(()=>{f(d=>{const R=O(d+m,0,s-1);return R!==d&&L(R),R}),H.current=null}))},t[22]=s,t[23]=L,t[24]=f,t[25]=P):P=t[25];const X=P;let F;t[26]!==e||t[27]!==X||t[28]!==s||t[29]!==l||t[30]!==L?(F=m=>{if(e!=="vertical")return;const d=m.key==="ArrowUp"?-1:m.key==="ArrowDown"?1:0;if(d){if(m.repeat)X(d);else{const R=O(l+d,0,s-1);L(R,!0)}m.preventDefault()}},t[26]=e,t[27]=X,t[28]=s,t[29]=l,t[30]=L,t[31]=F):F=t[31];const D=F;let $,W;t[32]!==e||t[33]!==D?($=()=>{if(e==="vertical")return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},W=[e,D],t[32]=e,t[33]=D,t[34]=$,t[35]=W):($=t[34],W=t[35]),x.useEffect($,W);let Y,B;t[36]!==e||t[37]!==u||t[38]!==y?(Y=()=>{if(!(y!=null&&y.current)||e!=="vertical")return;const m=y.current,d=h.current;if(!d)return;const R=I=>{I.preventDefault();let z=d.scrollTop+I.deltaY;const A=d.scrollTop<=0&&I.deltaY<0,be=d.scrollTop>=u&&I.deltaY>0;(A||be)&&(z=d.scrollTop+I.deltaY*.2),z=O(z,0,u),z!==d.scrollTop&&(d.scrollTop=z)};return m.addEventListener("wheel",R,{passive:!1}),()=>m.removeEventListener("wheel",R)},B=[e,y,u],t[36]=e,t[37]=u,t[38]=y,t[39]=Y,t[40]=B):(Y=t[39],B=t[40]),x.useEffect(Y,B);let K,q;t[41]!==i||t[42]!==s||t[43]!==l||t[44]!==f?(K=()=>{if(!(i!=null&&i.current))return;const m=i.current,d=()=>{const R=Math.round(m.scrollLeft/m.clientWidth);R!==l&&R>=0&&R<s&&f(R)};return m.addEventListener("scroll",d,{passive:!0}),()=>m.removeEventListener("scroll",d)},q=[i,s,l,f],t[41]=i,t[42]=s,t[43]=l,t[44]=f,t[45]=K,t[46]=q):(K=t[45],q=t[46]),x.useEffect(K,q);let G;return t[47]!==p||t[48]!==_||t[49]!==L?(G={railRef:h,railHeight:_,indexMv:p,scrollToIndex:L},t[47]=p,t[48]=_,t[49]=L,t[50]=G):G=t[50],G}const Oe=x.memo(function(t){"use forget";const e=V.c(34),{images:o,index:r,setIndex:s,wheelHostRef:l}=t;let f;e[0]!==o.length||e[1]!==r||e[2]!==s||e[3]!==l?(f={axis:"vertical",itemSize:46,gap:8,imagesLen:o.length,index:r,setIndex:s,wheelHostRef:l},e[0]=o.length,e[1]=r,e[2]=s,e[3]=l,e[4]=f):f=e[4];const{railRef:i,railHeight:y,indexMv:h,scrollToIndex:_}=ve(f);let N;e[5]!==_||e[6]!==s?(N=p=>{s(p),_(p)},e[5]=_,e[6]=s,e[7]=N):N=e[7];const c=N;let u;if(e[8]!==c||e[9]!==o){let p;e[11]!==c?(p=(b,C)=>()=>c(C),e[11]=c,e[12]=p):p=e[12],u=o.map(p),e[8]=c,e[9]=o,e[10]=u}else u=e[10];const v=u;let w;e[13]!==y?(w={height:y,contain:"layout size style"},e[13]=y,e[14]=w):w=e[14];let E;e[15]===Symbol.for("react.memo_cache_sentinel")?(E=n.jsx("div",{style:{height:"calc(50% - 23px)"}}),e[15]=E):E=e[15];let j;if(e[16]!==v||e[17]!==o||e[18]!==r||e[19]!==h){let p;e[21]!==v||e[22]!==r||e[23]!==h?(p=(b,C)=>{var L;return n.jsx(xe,{img:b,size:46,active:C===r,onClick:v[C],axis:"vertical",index:C,indexMv:h},(L=b.id)!=null?L:b.url)},e[21]=v,e[22]=r,e[23]=h,e[24]=p):p=e[24],j=o.map(p),e[16]=v,e[17]=o,e[18]=r,e[19]=h,e[20]=j}else j=e[20];let S;e[25]===Symbol.for("react.memo_cache_sentinel")?(S=n.jsx("div",{style:{height:"calc(50% - 23px)"}}),e[25]=S):S=e[25];let M;e[26]!==i||e[27]!==w||e[28]!==j?(M=n.jsxs(Z.div,{ref:i,style:w,className:"no-scrollbar overflow-y-scroll",children:[E,j,S]}),e[26]=i,e[27]=w,e[28]=j,e[29]=M):M=e[29];let g,k;e[30]===Symbol.for("react.memo_cache_sentinel")?(k=n.jsx("div",{className:"pointer-events-none absolute inset-x-0 top-0 z-10 h-16 bg-gradient-to-b from-white via-white/90 to-transparent dark:from-[#212121] dark:via-[#212121]/60 dark:to-transparent"}),g=n.jsx("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 z-10 h-16 bg-gradient-to-t from-white via-white/90 to-transparent dark:from-[#212121] dark:via-[#212121]/60 dark:to-transparent"}),e[30]=g,e[31]=k):(g=e[30],k=e[31]);let T;return e[32]!==M?(T=n.jsxs("div",{className:"relative mt-4 w-24 self-start",role:"listbox","aria-orientation":"vertical",children:[M,k,g]}),e[32]=M,e[33]=T):T=e[33],T}),He=x.memo(function(t){"use forget";const e=V.c(37),{images:o,index:r,setIndex:s,carouselRef:l}=t;let f;e[0]!==l||e[1]!==o.length||e[2]!==r||e[3]!==s?(f={axis:"horizontal",itemSize:32,gap:6,imagesLen:o.length,index:r,setIndex:s,externalSyncRef:l},e[0]=l,e[1]=o.length,e[2]=r,e[3]=s,e[4]=f):f=e[4];const{railRef:i,indexMv:y,scrollToIndex:h}=ve(f);let _,N;e[5]!==r||e[6]!==h?(_=()=>{h(r)},N=[r,h],e[5]=r,e[6]=h,e[7]=_,e[8]=N):(_=e[7],N=e[8]),U(_,N);let c;e[9]!==l||e[10]!==h||e[11]!==s?(c=b=>{s(b),h(b),l.current&&l.current.scrollTo({behavior:"instant",left:l.current.clientWidth*b})},e[9]=l,e[10]=h,e[11]=s,e[12]=c):c=e[12];const u=c;let v;if(e[13]!==u||e[14]!==o){let b;e[16]!==u?(b=(C,L)=>()=>u(L),e[16]=u,e[17]=b):b=e[17],v=o.map(b),e[13]=u,e[14]=o,e[15]=v}else v=e[15];const w=v;let E,j;e[18]===Symbol.for("react.memo_cache_sentinel")?(E={contain:"layout size style",contentVisibility:"auto"},j=n.jsx("div",{style:{width:"max(calc(50% - 32px + 6px), 0px)",flexShrink:0}}),e[18]=E,e[19]=j):(E=e[18],j=e[19]);let S;if(e[20]!==w||e[21]!==o||e[22]!==r||e[23]!==y){let b;e[25]!==w||e[26]!==r||e[27]!==y?(b=(C,L)=>{var H;return n.jsx(xe,{img:C,size:32,active:L===r,onClick:w[L],axis:"horizontal",index:L,indexMv:y},(H=C.id)!=null?H:C.url)},e[25]=w,e[26]=r,e[27]=y,e[28]=b):b=e[28],S=o.map(b),e[20]=w,e[21]=o,e[22]=r,e[23]=y,e[24]=S}else S=e[24];let M;e[29]===Symbol.for("react.memo_cache_sentinel")?(M=n.jsx("div",{style:{width:"max(calc(50% - 32px + 6px), 0px)",flexShrink:0}}),e[29]=M):M=e[29];let g;e[30]!==i||e[31]!==S?(g=n.jsxs(Z.div,{ref:i,className:"flex flex-1 gap-1.5 overflow-x-hidden px-4 py-2",style:E,children:[j,S,M]}),e[30]=i,e[31]=S,e[32]=g):g=e[32];let k,T;e[33]===Symbol.for("react.memo_cache_sentinel")?(k=n.jsx("div",{className:"pointer-events-none absolute inset-y-0 start-0 z-10 w-8 bg-gradient-to-r from-white via-white/90 to-transparent dark:from-[#212121] dark:via-[#212121]/60 dark:to-transparent"}),T=n.jsx("div",{className:"pointer-events-none absolute inset-y-0 end-0 z-10 w-8 bg-gradient-to-l from-white via-white/90 to-transparent dark:from-[#212121] dark:via-[#212121]/60 dark:to-transparent"}),e[33]=k,e[34]=T):(k=e[33],T=e[34]);let p;return e[35]!==g?(p=n.jsxs("div",{className:"relative flex min-h-[48px] w-full overflow-hidden",role:"listbox","aria-orientation":"horizontal",children:[g,k,T]}),e[35]=g,e[36]=p):p=e[36],p}),Ve=me(()=>fe(()=>import("./ghewn7l2ynbm32fm.js").then(a=>a.vJ),__vite__mapDeps([0,1,2])),{loading:a=>he(a)}),ee=x.createContext({activeImage:void 0,index:0});function De({images:a,initialIndex:t=0,onClose:e,onIndexChange:o,children:r,inpaintingProps:s}){var j,S,M;const[l,f]=x.useState(t),i=a[l];x.useEffect(()=>{o==null||o(l)},[l,o]);const y=ue(),h=Ne()===!1,_=x.useRef(null),{footerSlot:N,headerActionsSlot:c}=Re(r,{footerSlot:ge,headerActionsSlot:pe}),u=x.useRef(null),v=a.length>1,w=x.useCallback(g=>{g.key==="Escape"&&(e(),g.preventDefault())},[e]);x.useEffect(()=>(document.addEventListener("keydown",w),()=>{document.removeEventListener("keydown",w)}),[w]),U(()=>{var k;if(!h||!_.current)return;const g=(k=_.current)==null?void 0:k.querySelector('[data-position="'.concat(l,'"]'));g&&_.current.scrollTo({behavior:"instant",left:g.offsetLeft})},[h]);const E=s&&(s==null?void 0:s.mode)==="inpaint";return n.jsx(ee.Provider,{value:{activeImage:i,index:l},children:n.jsx(J.Root,{isOpen:!0,onClose:e,testId:"modal-lightbox-new",shouldIgnoreClickOutside:E,children:n.jsx(J.Overlay,{children:n.jsxs(J.Content,{size:"fullscreen",removePopoverStyling:!0,className:"grid min-h-0 grid-rows-[auto_minmax(0,1fr)] overflow-hidden",children:[n.jsxs(Pe,{children:[n.jsxs("div",{className:"grid w-full grid-cols-[auto_1fr] items-start justify-between gap-1 md:gap-2",children:[n.jsx(Me,{icon:Ve,onClick:e,"aria-label":y.formatMessage({id:"EYLKSm",defaultMessage:"Close"})}),(i==null?void 0:i.title)&&n.jsx("h2",{className:"line-clamp-1 self-center text-base font-medium md:line-clamp-none",children:i.title})]}),c]}),h?n.jsxs("div",{className:"grid h-full min-h-0 w-full grid-rows-[minmax(0,1fr)_auto] overflow-hidden",children:[n.jsx("ol",{ref:_,className:"no-scrollbar flex h-full snap-x snap-mandatory overflow-x-auto scroll-smooth",children:a.map((g,k)=>{var T,p;return n.jsx("li",{"data-position":k,className:"flex w-full flex-shrink-0 snap-start snap-always items-center justify-center px-4",children:n.jsx("img",{src:g.url,alt:(T=g.title)!=null?T:"",className:"max-h-full max-w-full rounded object-contain",fetchPriority:k===l?"high":"auto",loading:k===l?"eager":"lazy",decoding:"async"})},(p=g.id)!=null?p:g.url)})}),n.jsxs("div",{className:"no-scrollbar flex flex-col gap-2 overflow-hidden py-4",children:[v&&n.jsx(He,{images:a,index:l,setIndex:f,carouselRef:_}),n.jsx("div",{className:"px-4",children:N})]})]}):n.jsxs("div",{ref:u,className:"grid h-full w-full grid-cols-[1fr_auto] items-center overflow-y-auto overscroll-contain",children:[n.jsxs("div",{className:"grid h-full min-h-0 w-full grid-rows-[minmax(0,1fr)_auto] justify-items-center px-4 pb-9",children:[i&&n.jsxs("div",{className:"relative mt-12 mb-12 flex items-center justify-center rounded bg-neutral-100",children:[n.jsx("img",{src:i.url,alt:(j=i.title)!=null?j:"",className:"h-full max-h-full w-auto max-w-full rounded object-contain",fetchPriority:"high",loading:"eager",decoding:"async"},(S=i.id)!=null?S:i.url),E&&n.jsx(Ce,{image:i,drawingState:s.drawingState,drawingCanvasRef:s.drawingCanvasRef})]},(M=i.id)!=null?M:i.url),N]}),!E&&v?n.jsx(Oe,{images:a,index:l,setIndex:f,wheelHostRef:u}):n.jsx("div",{className:"h-full w-24"})]})]})})})})}function Pe(a){"use forget";const t=V.c(2),{children:e}=a;let o;return t[0]!==e?(o=n.jsx("header",{className:"grid w-full grid-cols-[auto_1fr] gap-1 p-2",children:e}),t[0]=e,t[1]=o):o=t[1],o}function ge(a){"use forget";const t=V.c(5),{children:e}=a,{activeImage:o}=x.useContext(ee);let r;t[0]!==o||t[1]!==e?(r=typeof e=="function"?e({activeImage:o}):e,t[0]=o,t[1]=e,t[2]=r):r=t[2];const s=r;let l;return t[3]!==s?(l=n.jsx("footer",{className:"pointer-events-auto w-full max-w-[768px]",children:s}),t[3]=s,t[4]=l):l=t[4],l}function pe(a){"use forget";const t=V.c(5),{children:e}=a,{activeImage:o}=x.useContext(ee);let r;if(t[0]!==o||t[1]!==e){const l=typeof e=="function"?e({activeImage:o}):e;r=[],x.Children.forEach(l,f=>{x.isValidElement(f)&&r.push(f)}),t[0]=o,t[1]=e,t[2]=r}else r=t[2];let s;return t[3]!==r?(s=n.jsx("div",{className:"flex items-baseline justify-end gap-2",children:r.map(Fe)}),t[3]=r,t[4]=s):s=t[4],s}function Fe(a,t){return n.jsx(x.Fragment,{children:a},t)}const qe={Root:De,Footer:ge,LightboxHeaderActions:pe},de=me(()=>fe(()=>import("./ef28lc1b3o54kec9.js").then(a=>a._),__vite__mapDeps([3,1])),{loading:a=>he(a)}),Ge=({assetPointer:a,serverThreadId:t,messageId:e})=>{"use no forget";const o=ue(),[r,s]=x.useState(!1),l=Ie({assetPointer:a,clientThreadId:t,imageGenMessageId:e}),f=x.useCallback(async()=>{s(!0);try{await l()}finally{s(!1)}Te.logEventWithStatsig("chatgpt_web_image_library_lightbox_image_share_clicked","chatgpt_web_image_library_lightbox_image_share_clicked")},[l]),i=o.formatMessage({id:"lqgWN2",defaultMessage:"Share"});return n.jsxs(n.Fragment,{children:[n.jsx(re,{className:"max-md:hidden",color:"secondary",icon:r?oe:de,onClick:f,disabled:r,children:i}),n.jsx(re,{color:"ghost",className:"text-token-text-secondary w-10 md:hidden",icon:r?oe:de,onClick:f,label:i,disabled:r})]})};export{qe as L,Ge as S};
//# sourceMappingURL=gkuhfrmysvpuw4uo.js.map
