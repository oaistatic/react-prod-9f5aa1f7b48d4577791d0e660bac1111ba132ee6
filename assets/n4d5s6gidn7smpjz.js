import{E as L,d as R,b as T}from"./gfxl3n7r4t82beqq.js";import{F as y,c as _,p as g,a as A,b as M,d as E}from"./dabvy8uqe4jm1b47.js";function C(t=0){return t>0?t:self.devicePixelRatio||1}async function D(t,w,u=404,h=0){const e=C(h),n=t.widthEmu*L,f=t.heightEmu*L,a=Math.min(1,u/Math.max(n,f)),m=Math.round(n*a*e),r=Math.round(f*a*e),x=new OffscreenCanvas(m,r),s=x.getContext("2d");if(!s)throw new Error("Failed to create 2D context");s.scale(e*a,e*a),await R(t,w,s,[]);const b=await x.convertToBlob({type:"image/png"});return new Promise(d=>{const i=new FileReader;i.onload=()=>d(i.result),i.readAsDataURL(b)})}async function F(t,w=20,u=10,h=0,e){const n=C(h),f=80,a=20,m=new OffscreenCanvas(u*f*n,w*a*n),r=m.getContext("2d");if(!r)return Promise.resolve("");r.scale(n,n);const s=Array(50).fill(y);for(const o of t.columns){const l=_(o.width);for(let c=o.min-1;c<o.max;c++)s[c]=l}const d=Array(50).fill(g(t.defaultRowHeight||A));for(const o of t.rows)o.customHeight&&(d[o.index-1]=g(o.height));const i=M(e);E(r,t,s,d,0,0,800,400,null,null,1,i,{},new Set,new Set,!1,e,T({colorScheme:{name:"default",colors:[]},lineStyleList:[],effectStyleList:[]}),!1);const P=await m.convertToBlob({type:"image/png"});return new Promise(o=>{const l=new FileReader;l.onload=()=>{var c,p;return o((p=(c=l.result)==null?void 0:c.toString())!=null?p:"")},l.readAsDataURL(P)})}export{F as a,D as s};
//# sourceMappingURL=n4d5s6gidn7smpjz.js.map
