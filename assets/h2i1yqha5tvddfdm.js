const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ceivmd4pm4umbvdn.js","assets/i8clt0mfz495j7ii.js"])))=>i.map(i=>d[i]);
var pe=Object.defineProperty,Me=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var ne=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var de=(a,e,s)=>e in a?pe(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s,R=(a,e)=>{for(var s in e||(e={}))xe.call(e,s)&&de(a,s,e[s]);if(ne)for(var s of ne(e))Te.call(e,s)&&de(a,s,e[s]);return a},le=(a,e)=>Me(a,ye(e));import{c as De,e as me,r as P,f as Ce,j as t,M as A,u as ke,a as je,_ as be}from"./i8clt0mfz495j7ii.js";import{e as fe,D as se,P as f,M as $,C as Ee,R as Ie,$ as re,o as Se,L as we}from"./ghewn7l2ynbm32fm.js";import{C as ce}from"./nb9dlstb4iu1wrqb.js";import{d8 as Be,d9 as Re,o as Ve,da as Ae}from"./j0yo6uv6652vva62.js";import{T as p}from"./zm1ki9l766pgg0bx.js";const Ne=Se(()=>be(()=>import("./ceivmd4pm4umbvdn.js").then(a=>a._),__vite__mapDeps([0,1])),{loading:a=>we(a)});function We(a){const e=ke(),s=fe();return je({mutationFn:({domainId:n})=>Ie.safePost("/accounts/{account_id}/domains/{domain_id}/check",{parameters:{path:{account_id:a,domain_id:n}}}),onSuccess:()=>{e.invalidateQueries({queryKey:["workspace/identity",a]}),e.invalidateQueries({queryKey:["builderProfile"]})},onError:n=>{s.danger(n.message,{toastId:"domain_modal",loggingTitle:n.message,loggingDescription:"Domain check failed"})}})}function Ue(a){"use forget";const e=De.c(75),{workspaceId:s,isOpen:n,onClose:m,currentDomain:d,domains:M,showUnverifiedDomains:y,onVerifyDomain:N}=a;let W;e[0]!==M?(W=M===void 0?[]:M,e[0]=M,e[1]=W):W=e[1];const x=W,J=y===void 0?!1:y,o=me(),u=fe(),{mutateAsync:Z,isPending:F}=Be(s),_=Re(),{mutateAsync:ee,isPending:H}=We(s);let X,z;e[2]!==n?(X=()=>{n&&f.logEventWithStatsig("Identity: Domain Modal Opened","chatgpt_identity_domain_modal_opened")},z=[n],e[2]=n,e[3]=X,e[4]=z):(X=e[3],z=e[4]),P.useEffect(X,z);const[i,L]=P.useState(d!=null?d:void 0),[g,ue]=P.useState(d==null?void 0:d.hostname),[r,V]=P.useState((d==null?void 0:d.status)===void 0?0:(d==null?void 0:d.status)===se.PENDING?1:2);let q;e[5]!==d?(q=()=>{d||(L(void 0),V(0))},e[5]=d,e[6]=q):q=e[6];const te=q;let O;e[7]!==m||e[8]!==te?(O=()=>{te(),f.logEventWithStatsig("Identity: Domain Modal Closed","chatgpt_identity_domain_modal_closed"),m()},e[7]=m,e[8]=te,e[9]=O):O=e[9];const h=O;let Q;e[10]!==Z||e[11]!==x||e[12]!==_||e[13]!==g?(Q=async()=>{if(g===void 0)return;const c=x.find(v=>v.hostname===g&&v.status===se.PENDING);if(c)L(c),V(1),f.logEventWithStatsig("Identity: Domain Added","chatgpt_identity_domain_added");else try{const v=await Z({hostname:g});if(!_())return;"id"in v&&(L(v),f.logEventWithStatsig("Identity: Domain Added","chatgpt_identity_domain_added")),V(1)}catch(v){const _e=v;if(!_())return;throw f.logEventWithStatsig("Identity: Domain Verification Error","chatgpt_identity_domain_verification_error"),_e}},e[10]=Z,e[11]=x,e[12]=_,e[13]=g,e[14]=Q):Q=e[14];const T=Q;let D;e[15]!==o?(D=o.formatMessage(l.check),e[15]=o,e[16]=D):D=e[16];const ie=(i==null?void 0:i.id)===void 0||H;let C;e[17]!==ee||e[18]!==i||e[19]!==o||e[20]!==_||e[21]!==N||e[22]!==u?(C=async()=>{if(i!=null&&i.id)try{const c=await ee({domainId:i.id});if(!_())return;f.logEventWithStatsig("Identity: Domain Verification Started","chatgpt_identity_domain_verification_started"),"error"in c&&(u.danger(o.formatMessage(l.domainCheckError,{message:c.error.message}),{toastId:"domain_modal",loggingTitle:l.domainCheckError.defaultMessage,loggingDescription:"Domain check failed"}),f.logEventWithStatsig("Identity: Domain Verification Error","chatgpt_identity_domain_verification_error")),"id"in c&&(N&&N(c),c.status===se.VERIFIED&&(f.logEventWithStatsig("Identity: Domain Verification Success","chatgpt_identity_domain_verification_success"),V(2)))}catch(c){const v=c;if(!_())return;throw f.logEventWithStatsig("Identity: Domain Verification Error","chatgpt_identity_domain_verification_error"),v}},e[17]=ee,e[18]=i,e[19]=o,e[20]=_,e[21]=N,e[22]=u,e[23]=C):C=e[23];let U;e[24]!==H||e[25]!==ie||e[26]!==C||e[27]!==D?(U=t.jsx($.Button,{title:D,color:"primary",disabled:ie,loading:H,onClick:C}),e[24]=H,e[25]=ie,e[26]=C,e[27]=D,e[28]=U):U=e[28];const ge=U;let k;e[29]!==o?(k=o.formatMessage(l.submit),e[29]=o,e[30]=k):k=e[30];const oe=g===void 0||F;let Y;e[31]!==T||e[32]!==F||e[33]!==k||e[34]!==oe?(Y=t.jsx($.Button,{title:k,color:"primary",disabled:oe,loading:F,onClick:T}),e[31]=T,e[32]=F,e[33]=k,e[34]=oe,e[35]=Y):Y=e[35];const he=Y;let j;e[36]!==o?(j=o.formatMessage(l.done),e[36]=o,e[37]=j):j=e[37];let G;e[38]!==h||e[39]!==j?(G=t.jsx($.Button,{title:j,color:"primary",onClick:h}),e[38]=h,e[39]=j,e[40]=G):G=e[40];const ve=G;let b;e[41]!==o||e[42]!==r?(b=o.formatMessage(r===0?l.newTitle:l.editTitle),e[41]=o,e[42]=r,e[43]=b):b=e[43];const ae=r===0?he:r===1?ge:ve;let E;e[44]!==o?(E=o.formatMessage(l.cancel),e[44]=o,e[45]=E):E=e[45];let I;e[46]!==h||e[47]!==E?(I=t.jsx($.Button,{title:E,color:"secondary",onClick:h}),e[46]=h,e[47]=E,e[48]=I):I=e[48];let S;e[49]!==x||e[50]!==T||e[51]!==J||e[52]!==r||e[53]!==g||e[54]!==s?(S=r===0&&t.jsx(He,{hostname:g,onSetHostname:ue,onSubmit:T,unverifiedDomains:J?x:[],onVerifyDomain:c=>{V(1),L(c)},workspaceId:s}),e[49]=x,e[50]=T,e[51]=J,e[52]=r,e[53]=g,e[54]=s,e[55]=S):S=e[55];let w;e[56]!==i||e[57]!==o||e[58]!==r||e[59]!==u?(w=r===1&&t.jsxs("div",{className:"flex flex-col gap-3",children:[o.formatMessage(l.verificationTokenMessage,{hostname:i==null?void 0:i.hostname}),(i==null?void 0:i.dns_verification_token_string)&&t.jsx(ce,{value:i.dns_verification_token_string,onCopied:()=>{u.success(o.formatMessage(l.copiedTXTRecordToClipboard),{duration:3})}}),t.jsx(A,R({},l.verificationTokenFooter))]}),e[56]=i,e[57]=o,e[58]=r,e[59]=u,e[60]=w):w=e[60];let B;e[61]!==i||e[62]!==o||e[63]!==r||e[64]!==u?(B=r===2&&t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsx(A,le(R({},l.successfulVerification),{values:{hostname:i==null?void 0:i.hostname}})),(i==null?void 0:i.dns_verification_token_string)&&t.jsx(ce,{value:i.dns_verification_token_string,onCopied:()=>{u.success(o.formatMessage(l.copiedTXTRecordToClipboard),{duration:3})}})]}),e[61]=i,e[62]=o,e[63]=r,e[64]=u,e[65]=B):B=e[65];let K;return e[66]!==h||e[67]!==n||e[68]!==b||e[69]!==ae||e[70]!==I||e[71]!==S||e[72]!==w||e[73]!==B?(K=t.jsxs(Ee,{testId:"modal-domain",isOpen:n,onClose:h,type:"success",className:"text-token-text-secondary",title:b,primaryButton:ae,secondaryButton:I,children:[S,w,B]}),e[66]=h,e[67]=n,e[68]=b,e[69]=ae,e[70]=I,e[71]=S,e[72]=w,e[73]=B,e[74]=K):K=e[74],K}function Fe({unverifiedDomains:a,onVerifyDomain:e,workspaceId:s}){const{mutateAsync:n}=Ae(s);return t.jsxs(p.Root,{fixed:!0,size:"compact",className:"border-token-border-default mb-6 border-b",children:[t.jsxs(p.Header,{children:[t.jsx(p.HeaderCell,{children:t.jsx(A,R({},l.unverifiedDomainsTableHeader))}),t.jsx(p.HeaderCell,{textAlign:"right"})]}),a.map(m=>t.jsxs(p.Row,{children:[t.jsx(p.Cell,{children:m.hostname}),t.jsx(p.Cell,{textAlign:"right",children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(re,{color:"secondary",size:"small",onClick:()=>e(m),children:t.jsx(A,R({},l.verifyDomainButton))}),t.jsx(re,{color:"secondary",size:"small",onClick:()=>{n({domainId:m.id}),f.logEventWithStatsig("Identity: Domain Removed","chatgpt_identity_domain_removed")},icon:Ne})]})})]},m.id))]})}function He({hostname:a,onSetHostname:e,onSubmit:s,unverifiedDomains:n,onVerifyDomain:m,workspaceId:d}){const M=me();return t.jsxs(t.Fragment,{children:[n&&n.length>0&&t.jsx(Fe,{workspaceId:d,unverifiedDomains:n,onVerifyDomain:m}),t.jsx("form",{onSubmit:y=>{y.preventDefault(),s()},children:t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"hostname",className:"mb-2 flex items-center text-sm font-semibold",children:t.jsx(A,R({},l.domainInput))}),t.jsx(Ve,{ariaLabel:!1,name:"hostname",placeholder:M.formatMessage(l.placeholder),value:a!=null?a:"",onChange:y=>{e(y.target.value)}})]})})]})}const l=Ce({newTitle:{id:"domainModal.newTitle.0",defaultMessage:"Verify a new domain"},editTitle:{id:"domainModal.editTitle",defaultMessage:"Manage Domain"},submit:{id:"domainModal.submit",defaultMessage:"Submit"},check:{id:"domainModal.check",defaultMessage:"Check"},done:{id:"domainModal.done",defaultMessage:"Done"},cancel:{id:"domainModal.cancel",defaultMessage:"Cancel"},domainInput:{id:"domainModal.domainInput.0",defaultMessage:"Add a new domain"},placeholder:{id:"domainModal.placeholder",defaultMessage:"openai.com"},domainCheckError:{id:"domainModal.domainCheckError",defaultMessage:"Your domain could not be verified: {message}"},verificationTokenMessage:{id:"domainModal.verificationTokenMessage",defaultMessage:"To verify ownership of {hostname}, navigate to your DNS provider and add a TXT record with this value:"},verificationTokenFooter:{id:"domainModal.verificationTokenFooter",defaultMessage:"Then, check the record to complete the verification."},successfulVerification:{id:"domainModal.successfulVerification.0",defaultMessage:'Success! Your domain, "{hostname}" has been verified.'},copiedTXTRecordToClipboard:{id:"domainModal.copiedTXTRecordToClipboard",defaultMessage:"Copied DNS TXT record to clipboard"},verifyDomainButton:{id:"domainModal.verifyDomainButton",defaultMessage:"Verify"},unverifiedDomainsTableHeader:{id:"domainModal.unverifiedDomainsTableHeader",defaultMessage:"Your unverified domains"}});export{Ue as default};
//# sourceMappingURL=h2i1yqha5tvddfdm.js.map
