const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/bci083mws0hai8bl.js","assets/i8clt0mfz495j7ii.js","assets/e6eptpe9toj61kmv.js","assets/oz2w8uv2a0ics46w.js","assets/j0yo6uv6652vva62.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css"])))=>i.map(i=>d[i]);
var q=Object.defineProperty;var k=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var O=(s,t,o)=>t in s?q(s,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[t]=o,A=(s,t)=>{for(var o in t||(t={}))U.call(t,o)&&O(s,o,t[o]);if(k)for(var o of k(t))V.call(t,o)&&O(s,o,t[o]);return s};import{j as e,M as r,_ as b,r as a,e as z,u as H}from"./i8clt0mfz495j7ii.js";import{o as _,$ as P,ky as Q,L as C,eq as Y,u as $,oO as F,B as K,eI as J,eK as W,aS as L,aU as w,oP as X,aY as Z,C as ee,oQ as B,mQ as se,a1 as te}from"./ghewn7l2ynbm32fm.js";import{gB as p,bL as oe,gC as ne,o as ae}from"./j0yo6uv6652vva62.js";import{G as ie}from"./haxs88dyx78kruos.js";const re=_(()=>b(()=>import("./bci083mws0hai8bl.js").then(s=>s._),__vite__mapDeps([0,1])),{loading:s=>C(s)}),le=_(()=>b(()=>import("./e6eptpe9toj61kmv.js").then(s=>s._),__vite__mapDeps([2,1])),{loading:s=>C(s)}),ce=_(()=>b(()=>import("./oz2w8uv2a0ics46w.js").then(s=>s._),__vite__mapDeps([3,1])),{loading:s=>C(s)});function de({onClose:s}){const t=Q("installations/select_target");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-0 mb-4 flex justify-center",children:e.jsx("div",{className:"bg-tertiary border-token-border-subtle rounded-lg border p-3",children:e.jsx(ce,{className:"h-10 w-10"})})}),e.jsx("h2",{className:"mb-6 text-center text-xl font-semibold",children:e.jsx(r,{id:"e7S220",defaultMessage:"One last step"})}),e.jsxs("div",{className:"bg-tertiary border-token-border-subtle mb-6 flex items-start gap-3 rounded-lg border p-4",children:[e.jsx(re,{className:"icon mt-0.5"}),e.jsxs("div",{className:"flex flex-grow flex-col gap-1",children:[e.jsx("span",{className:"font-medium",children:e.jsx(r,{id:"MQhj3s",defaultMessage:"Configure your repositories"})}),e.jsx("span",{className:"text-token-text-tertiary text-sm",children:e.jsx(r,{id:"ZvosJF",defaultMessage:"You still need to choose the repositories ChatGPT can access."})})]})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs(P,{className:"w-full",size:"large",onClick:()=>{window.open(t,"_blank"),s(!1)},children:[e.jsx(r,{id:"o1jiyf",defaultMessage:"Configure Repositories on GitHub"}),e.jsx(le,{className:"icon-sm ms-2 inline-block"})]})})]})}const ue=_(()=>b(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yo),__vite__mapDeps([4,1,5,6,7])),{loading:s=>C(s)}),pe=_(()=>b(()=>import("./e6eptpe9toj61kmv.js").then(s=>s._),__vite__mapDeps([2,1])),{loading:s=>C(s)}),D=_(()=>b(()=>import("./oz2w8uv2a0ics46w.js").then(s=>s._),__vite__mapDeps([3,1])),{loading:s=>C(s)}),me=({connectorLink:s,isLoading:t,onClose:o,onContinue:l})=>{var T;const S=z(),m=H(),[u,c]=a.useState(""),[h,N]=a.useState(new Map),y=oe(u,500),{data:g,isLoading:I,isFetchingNextPage:R,hasNextPage:v,fetchNextPage:E}=ne({enabled:!!s,debouncedSearchTerm:y,linkId:(T=s==null?void 0:s.id)!=null?T:""}),{mutateAsync:j,isPending:G}=se(),M=a.useCallback(async()=>{if(s)try{await j({link:s,user_extension:{type:"GithubUserApiExtension",opted_in_repository_ids:Array.from(h.keys())}}),m.invalidateQueries({queryKey:["user_connection_sync_configuration"]}),l({reposToIndex:Array.from(h.values()).filter(n=>!n.is_code_search_indexed).map(n=>n.repository_full_name)})}catch(n){}},[s,j,h,m,l]),f=a.useMemo(()=>{var n;return(n=g==null?void 0:g.pages.flatMap(x=>x.repos))!=null?n:[]},[g]),d=f.length>5||!!y,i=I||t;return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:e.jsx(r,{id:"BhSDq8",defaultMessage:"Which repositories do you use?"}),connectorIcon:e.jsx("div",{className:"rounded-xl border-[0.5px] p-2 shadow-sm",children:e.jsx(D,{className:"icon-2xl"})}),onClose:()=>o(!1)}),e.jsx("div",{className:"text-token-text-secondary mt-2 mb-6 text-center text-sm",children:d?e.jsx(r,{id:"o+DCDE",defaultMessage:"Choose up to 5. These repositories will sync with ChatGPT for improved speed and quality. Not seeing a repository? <link>Learn more</link>",values:{link:n=>e.jsx("a",{href:"https://help.openai.com/en/articles/11145903-chatgpt-connectors",target:"_blank",rel:"noopener noreferrer",className:"underline",children:n})}}):e.jsx(r,{id:"8FVBwU",defaultMessage:"These repositories will sync with ChatGPT for improved speed and quality. Not seeing a repository? <link>Learn more</link>",values:{link:n=>e.jsx("a",{href:"https://help.openai.com/en/articles/11145903-chatgpt-connectors",target:"_blank",rel:"noopener noreferrer",className:"underline",children:n})}})}),d&&e.jsx(ae,{ariaLabel:S.formatMessage({id:"D2Xhv1",defaultMessage:"Search repositories"}),autoComplete:"off",className:"mb-2",icon:ue,iconPosition:"left",name:"search-repos",onChange:n=>{c(n.target.value)},placeholder:S.formatMessage({id:"jYgjAb",defaultMessage:"Search repositories"})}),e.jsx(ie,{allRepos:f,fetchNextPage:E,hasNextPage:v,isFetchingNextPage:R,isLoading:i,onChange:N,searchTerm:y,selectedRepos:h}),e.jsx(P,{className:"mt-2 w-full",disabled:i,loading:G,onClick:()=>{h.size===0?l({reposToIndex:[]}):M()},size:"large",children:e.jsx(r,A({},te.continueButtonText))})]})},he=({isLoading:s,onClose:t,reposToIndex:o})=>e.jsxs(e.Fragment,{children:[e.jsx(B,{title:e.jsx(r,{id:"hxqAFz",defaultMessage:"Complete setup"}),connectorIcon:e.jsx("div",{className:"rounded-xl border-[0.5px] p-2 shadow-sm",children:e.jsx(D,{className:"icon-2xl"})}),onClose:()=>t(!1)}),e.jsx("div",{className:"text-token-text-secondary mt-2 mb-6 text-center text-sm",children:e.jsx(r,{id:"IQqMC0",defaultMessage:"Your repositories must be indexed by GitHub before they can be accessed by ChatGPT. GitHub will open in a new tab, and automatically close. Indexing should complete in 5-10 minutes."})}),e.jsxs(P,{className:"mt-2 w-full",loading:s,onClick:()=>{window.open("https://github.com/search?q=".concat(o.map(l=>"repo:".concat(l)).join("+"),"&type=code"),"_blank"),t(!1)},size:"large",children:[e.jsx(r,{id:"CfvY9y",defaultMessage:"Start indexing on GitHub"}),e.jsx(pe,{className:"icon-sm ms-2 inline-block"})]})]});function Ce({initialState:s=p.ConfigureRepos,onClose:t,onFinishFlow:o}){var n;const l=Y(),S=$(),m=F(S),u=K(),[c,h]=a.useState(s),[N,y]=a.useState([]),{platformConnectors:g,isLoading:I}=J(!0),{connectorLinks:R,isLoading:v}=W({fetchValidLinksOnly:!0}),E=g.get(L[w.GITHUB_CONNECTOR]),j=(n=R.get(L[w.GITHUB_CONNECTOR]))==null?void 0:n[0],{isLoading:G,isEnabled:M}=X(),f=I||v||G,d=a.useCallback(x=>{t(x)},[t]),i=a.useCallback(()=>{d(!1),o==null||o()},[d,o]),T=a.useMemo(()=>{switch(c){case p.ConfigureRepos:return e.jsx(de,{onClose:()=>d(!1)});case p.SyncRepos:return l&&!m&&e.jsx(me,{connector:E,connectorLink:j,isLoading:f,onContinue:({reposToIndex:x})=>{x.length>0?(y(x),h(p.IndexRepos)):i()},onClose:i});case p.IndexRepos:return e.jsx(he,{isLoading:f,onClose:i,reposToIndex:N})}},[c,N,d,E,j,f,l,m,i]);return a.useEffect(()=>{!l&&c===p.SyncRepos&&d(!1)},[l,c,d]),a.useEffect(()=>{m&&c===p.SyncRepos&&i()},[m,c,i]),a.useEffect(()=>{!(u!=null&&u.isPersonalAccount())&&(u==null?void 0:u.planType)!==Z.SELF_SERVE_BUSINESS&&!M&&i()},[u,i,M]),e.jsx(ee,{className:"max-w-[400px] px-2",hideSeparator:!0,isOpen:!0,onClose:()=>d(!1),showCloseButton:c===p.ConfigureRepos,title:c===p.ConfigureRepos?e.jsx("span",{}):void 0,testId:"modal-github-onboarding",type:"success",children:T})}export{Ce as GithubOnboardingModal};
//# sourceMappingURL=b4xre65mpwtmpsm5.js.map
