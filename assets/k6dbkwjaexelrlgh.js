const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/bqk4d9uy5l3d6vsz.js","assets/i8clt0mfz495j7ii.js","assets/j0yo6uv6652vva62.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css"])))=>i.map(i=>d[i]);
var Zt=Object.defineProperty,Jt=Object.defineProperties;var Qt=Object.getOwnPropertyDescriptors;var Ge=Object.getOwnPropertySymbols;var Xt=Object.prototype.hasOwnProperty,en=Object.prototype.propertyIsEnumerable;var ge=(e,t,n)=>t in e?Zt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Re=(e,t)=>{for(var n in t||(t={}))Xt.call(t,n)&&ge(e,n,t[n]);if(Ge)for(var n of Ge(t))en.call(t,n)&&ge(e,n,t[n]);return e},He=(e,t)=>Jt(e,Qt(t));var T=(e,t,n)=>ge(e,typeof t!="symbol"?t+"":t,n);import{O as tn,j,_ as ot,r as x,e as nn}from"./i8clt0mfz495j7ii.js";import{S as N,b as F,E as M,D as b,e as Q,A as st,q as ae,F as rn,V as Le,R as X,W as De,G as it,P as Be,g as ct,h as at,f as on,t as sn,v as cn,a as Ve,w as an,x as ln,y as fn,n as dn,z as Z}from"./gdq1l97elemowxcc.js";import{c as un,s as Pe,a as hn,b as mn,d as gn}from"./kiv50zw1ij6k8vyj.js";import{d as lt,dd as ke,o as ft,L as dt,ba as pn,e as Cn}from"./ghewn7l2ynbm32fm.js";import{uf as xn,n4 as ut,ug as An,aF as wn}from"./j0yo6uv6652vva62.js";import{x as kn,y as En,z as bn,A as Mn,B as Sn,C as vn}from"./k1t8elp5z7nmkg2d.js";import{a as Ln,Z as Dn}from"./ce3hgmw4iyyhicud.js";import{d as Bn,h as Tn,e as yn,f as Nn,j as _n,k as On,l as Fn,m as Gn,n as Rn,o as Hn,p as pe,q as Vn}from"./kau2ug0899cbkpxh.js";import{i as Pn,g as jn,h as Wn,j as Un}from"./6ji8ehbh56ghw0zw.js";import{u as In}from"./mqebxepg7t6q2tie.js";const Ee=N.define(),ht=F.define({create:()=>null,update:(e,t)=>{const n=t.effects.find(s=>s.is(Ee));return n?n.value:e}}),qn=e=>b.line({class:"bg-[Highlight]!"}).range(e),Kn=e=>b.line({class:"streaming-line-overlay before:content-['*'] before:bg-white/50 dark:before:bg-gray-750/50"}).range(e),zn=F.define({create:()=>b.none,update:(e,t)=>{e=e.map(t.changes);const n=t.state.field(ht);if(n==null)return b.none;const s=t.state.doc,o=n+1;if(o>s.lines)return b.none;const r=s.line(o),i=qn(r.from),c=Array.from({length:s.lines-o},(a,f)=>Kn(s.line(o+1+f).from));return b.set([i,...c])},provide:e=>M.decorations.from(e)}),$n=e=>[ht.init(()=>e),zn],mt=N.define(),gt=N.define(),pt=N.define(),Ct=N.define(),be=(e,t)=>e.doc.line(t).from,se=(e,t,n,s)=>{const o=be(t,n),r=b.line({attributes:{class:lt("transition-colors bg-transparent",s===1&&"bg-yellow-100 dark:bg-yellow-500/50")}}).range(be(t,n));return e.update({add:s===3?[]:[r],filter:i=>i!==o})},Yn=F.define({create(){return b.none},update(e,t){for(const n of t.effects){const{value:s}=n;if(n.is(mt))return se(e,t.state,s,0);if(n.is(gt))return se(e,t.state,s,1);if(n.is(pt))return se(e,t.state,s,2);if(n.is(Ct))return se(e,t.state,s,3)}return e.map(t.changes)},provide:e=>M.decorations.from(e)}),Zn=[Yn];async function Jn(e,t,n=500){await new Promise(o=>e.requestMeasure({read:()=>{},write:()=>o(void 0)})),e.dispatch({effects:mt.of(t)});const s=be(e.state,t);e.dispatch({effects:M.scrollIntoView(s,{y:"center"})}),requestAnimationFrame(()=>{e.dispatch({effects:gt.of(t)})}),setTimeout(()=>{e.dispatch({effects:pt.of(t)}),setTimeout(()=>{e.dispatch({effects:Ct.of(t)})},150)},n),e.focus()}function Qn(e){return e.toString().length}function Xn(e,t,n){return s=>{if(!s.docChanged)return s;const o=Qn(s.state.doc);if(o<=e)return s;n&&t&&xn(n,t);const r=s.state.doc.sliceString(0,e),i=s.startState.update({changes:{from:0,to:s.startState.doc.length,insert:r}});return ut.logEvent("Canvas Codemirror Max Length",{maxLength:e,newLength:o}),[i]}}function er(e,t,n){return[Q.transactionFilter.of(Xn(n,e,t))]}const xt=st.define();function tr(){return M.updateListener.of(e=>{if(!e.docChanged||e.state.readOnly)return;const t=e.state.doc;t.length>0&&t.sliceString(t.length-1)!=="\n"&&e.view.dispatch({changes:{from:t.length,to:t.length,insert:"\n"},annotations:xt.of(!0)})})}class k{constructor(t,n,s,o){this.fromA=t,this.toA=n,this.fromB=s,this.toB=o}offset(t,n=t){return new k(this.fromA+t,this.toA+t,this.fromB+n,this.toB+n)}}function U(e,t,n,s,o,r){if(e==s)return[];const i=le(e,t,n,s,o,r),c=Te(e,t+i,n,s,o+i,r);t+=i,n-=c,o+=i,r-=c;const a=n-t,f=r-o;if(!a||!f)return[new k(t,n,o,r)];if(a>f){const d=e.slice(t,n).indexOf(s.slice(o,r));if(d>-1)return[new k(t,t+d,o,o),new k(t+d+f,n,r,r)]}else if(f>a){const d=s.slice(o,r).indexOf(e.slice(t,n));if(d>-1)return[new k(t,t,o,o+d),new k(n,n,o+d+a,r)]}if(a==1||f==1)return[new k(t,n,o,r)];const l=kt(e,t,n,s,o,r);if(l){const[d,u,h]=l;return U(e,t,d,s,o,u).concat(U(e,d+h,n,s,u+h,r))}return nr(e,t,n,s,o,r)}let J=1e9;function nr(e,t,n,s,o,r){const i=n-t,c=r-o;if(J<1e9&&Math.min(i,c)>J*16)return Math.min(i,c)>J*64?[new k(t,n,o,r)]:je(e,t,n,s,o,r);const a=Math.ceil((i+c)/2);Ce.reset(a),xe.reset(a);const f=(h,p)=>e.charCodeAt(t+h)==s.charCodeAt(o+p),l=(h,p)=>e.charCodeAt(n-h-1)==s.charCodeAt(r-p-1),d=(i-c)%2!=0?xe:null,u=d?null:Ce;for(let h=0;h<a;h++){if(h>J)return je(e,t,n,s,o,r);const p=Ce.advance(h,i,c,a,d,!1,f)||xe.advance(h,i,c,a,u,!0,l);if(p)return rr(e,t,n,t+p[0],s,o,r,o+p[1])}return[new k(t,n,o,r)]}class At{constructor(){T(this,"vec",[]);T(this,"len");T(this,"start");T(this,"end")}reset(t){this.len=t<<1;for(let n=0;n<this.len;n++)this.vec[n]=-1;this.vec[t+1]=0,this.start=this.end=0}advance(t,n,s,o,r,i,c){for(let a=-t+this.start;a<=t-this.end;a+=2){const f=o+a;let l=a==-t||a!=t&&this.vec[f-1]<this.vec[f+1]?this.vec[f+1]:this.vec[f-1]+1,d=l-a;for(;l<n&&d<s&&c(l,d);)l++,d++;if(this.vec[f]=l,l>n)this.end+=2;else if(d>s)this.start+=2;else if(r){const u=o+(n-s)-a;if(u>=0&&u<this.len&&r.vec[u]!=-1)if(i){const h=r.vec[u];if(h>=n-l)return[h,o+h-u]}else{const h=n-r.vec[u];if(l>=h)return[l,d]}}}return null}}const Ce=new At,xe=new At;function rr(e,t,n,s,o,r,i,c){let a=!1;return!q(e,s)&&++s==n&&(a=!0),!q(o,c)&&++c==i&&(a=!0),a?[new k(t,n,r,i)]:U(e,t,s,o,r,c).concat(U(e,s,n,o,c,i))}function wt(e,t){let n=1;const s=Math.min(e,t);for(;n<s;)n=n<<1;return n}function le(e,t,n,s,o,r){if(t==n||t==r||e.charCodeAt(t)!=s.charCodeAt(o))return 0;let i=wt(n-t,r-o);for(let c=t,a=o;;){const f=c+i,l=a+i;if(f>n||l>r||e.slice(c,f)!=s.slice(a,l)){if(i==1)return c-t-(q(e,c)?0:1);i=i>>1}else{if(f==n||l==r)return f-t;c=f,a=l}}}function Te(e,t,n,s,o,r){if(t==n||o==r||e.charCodeAt(n-1)!=s.charCodeAt(r-1))return 0;let i=wt(n-t,r-o);for(let c=n,a=r;;){const f=c-i,l=a-i;if(f<t||l<o||e.slice(f,c)!=s.slice(l,a)){if(i==1)return n-c-(q(e,c)?0:1);i=i>>1}else{if(f==t||l==o)return n-f;c=f,a=l}}}function Me(e,t,n,s,o,r,i,c){const a=s.slice(o,r);let f=null;for(;;){if(f||i<c)return f;for(let l=t+i;;){q(e,l)||l++;let d=l+i;if(q(e,d)||(d+=d==l+1?1:-1),d>=n)break;const u=e.slice(l,d);let h=-1;for(;(h=a.indexOf(u,h+1))!=-1;){const p=le(e,d,n,s,o+h+u.length,r),C=Te(e,t,l,s,o,o+h),g=u.length+p+C;(!f||f[2]<g)&&(f=[l-C,o+h-C,g])}l=d}if(c<0)return f;i=i>>1}}function kt(e,t,n,s,o,r){const i=n-t,c=r-o;if(i<c){const a=kt(s,o,r,e,t,n);return a&&[a[1],a[0],a[2]]}return i<4||c*2<i?null:Me(e,t,n,s,o,r,Math.floor(i/4),-1)}function je(e,t,n,s,o,r){const i=n-t,c=r-o;let a;if(i<c){const u=Me(s,o,r,e,t,n,Math.floor(i/6),50);a=u&&[u[1],u[0],u[2]]}else a=Me(e,t,n,s,o,r,Math.floor(c/6),50);if(!a)return[new k(t,n,o,r)];const[f,l,d]=a;return U(e,t,f,s,o,l).concat(U(e,f+d,n,s,l+d,r))}function Et(e,t){for(let n=1;n<e.length;n++){const s=e[n-1],o=e[n];s.toA>o.fromA-t&&s.toB>o.fromB-t&&(e[n-1]=new k(s.fromA,o.toA,s.fromB,o.toB),e.splice(n--,1))}}function or(e,t,n){for(;;){Et(n,1);let s=!1;for(let o=0;o<n.length;o++){let r=n[o],i,c;(i=le(e,r.fromA,r.toA,t,r.fromB,r.toB))&&(r=n[o]=new k(r.fromA+i,r.toA,r.fromB+i,r.toB)),(c=Te(e,r.fromA,r.toA,t,r.fromB,r.toB))&&(r=n[o]=new k(r.fromA,r.toA-c,r.fromB,r.toB-c));const a=r.toA-r.fromA,f=r.toB-r.fromB;if(a&&f)continue;const l=r.fromA-(o?n[o-1].toA:0),d=(o<n.length-1?n[o+1].fromA:e.length)-r.toA;if(!l||!d)continue;const u=a?e.slice(r.fromA,r.toA):t.slice(r.fromB,r.toB);l<=u.length&&e.slice(r.fromA-l,r.fromA)==u.slice(u.length-l)?(n[o]=new k(r.fromA-l,r.toA-l,r.fromB-l,r.toB-l),s=!0):d<=u.length&&e.slice(r.toA,r.toA+d)==u.slice(0,d)&&(n[o]=new k(r.fromA+d,r.toA+d,r.fromB+d,r.toB+d),s=!0)}if(!s)break}return n}function sr(e,t,n){for(let s=0,o=0;o<e.length;o++){let r=e[o];const i=r.toA-r.fromA,c=r.toB-r.fromB;if(i&&c||i>3||c>3){const a=o==e.length-1?t.length:e[o+1].fromA,f=r.fromA-s,l=a-r.toA;let d=Ue(t,r.fromA,Math.min(f,5)),u=We(t,r.toA,Math.min(l,5)),h=r.fromA-d,p=u-r.toA;if(!i||!c){const C=Math.max(i,c),[g,E,B]=i?[t,r.fromA,r.toA]:[n,r.fromB,r.toB];h&&p&&(C>h&&t.slice(d,r.fromA)==g.slice(B-h,B)?(r=e[o]=new k(d,d+i,r.fromB-h,r.toB-h),d=r.fromA,u=We(t,r.toA,Math.min(a-r.toA,5))):C>p&&t.slice(r.toA,u)==g.slice(E,E+p)&&(r=e[o]=new k(u-i,u,r.fromB+p,r.toB+p),u=r.toA,d=Ue(t,r.fromA,Math.min(r.fromA-s,5))),h=r.fromA-d,p=u-r.toA)}if(h||p)r=e[o]=new k(r.fromA-h,r.toA+p,r.fromB-h,r.toB+p);else if(i){if(!c){const C=qe(t,r.fromA,r.toA);let g;const E=C<0?-1:Ie(t,r.toA,r.fromA);C>-1&&(g=C-r.fromA)<=l&&t.slice(r.fromA,C)==t.slice(r.toA,r.toA+g)?r=e[o]=r.offset(g):E>-1&&(g=r.toA-E)>=f&&n.slice(r.fromA-g,r.fromA)==n.slice(E,r.toA)&&(r=e[o]=r.offset(-g))}}else{const C=qe(n,r.fromB,r.toB);let g;const E=C<0?-1:Ie(n,r.toB,r.fromB);C>-1&&(g=C-r.fromB)<=l&&n.slice(r.fromB,C)==n.slice(r.toB,r.toB+g)?r=e[o]=r.offset(g):E>-1&&(g=r.toB-E)>=f&&n.slice(r.fromB-g,r.fromB)==n.slice(E,r.toB)&&(r=e[o]=r.offset(-g))}s=r.toA}}return Et(e,3),e}let W;try{W=new RegExp("[\\p{Alphabetic}\\p{Number}]","u")}catch(e){}function bt(e){return e>48&&e<58||e>64&&e<91||e>96&&e<123}function Mt(e,t){if(t==e.length)return 0;const n=e.charCodeAt(t);return n<192?bt(n)?1:0:W?!vt(n)||t==e.length-1?W.test(String.fromCharCode(n))?1:0:W.test(e.slice(t,t+2))?2:0:0}function St(e,t){if(!t)return 0;const n=e.charCodeAt(t-1);return n<192?bt(n)?1:0:W?!Lt(n)||t==1?W.test(String.fromCharCode(n))?1:0:W.test(e.slice(t-2,t))?2:0:0}function We(e,t,n){if(t==e.length||!St(e,t))return t;for(let s=t,o=t+n;;){const r=Mt(e,s);if(!r)return s;if(s+=r,s>o)return t}}function Ue(e,t,n){if(!t||!Mt(e,t))return t;for(let s=t,o=t-n;;){const r=St(e,s);if(!r)return s;if(s-=r,s<o)return t}}function Ie(e,t,n){for(;t!=n;t--)if(e.charCodeAt(t-1)==10)return t;return-1}function qe(e,t,n){for(;t!=n;t++)if(e.charCodeAt(t)==10)return t;return-1}const vt=e=>e>=55296&&e<=56319,Lt=e=>e>=56320&&e<=57343;function q(e,t){return!t||t==e.length||!vt(e.charCodeAt(t-1))||!Lt(e.charCodeAt(t))}function ir(e,t,n){var s;return J=((s=n==null?void 0:n.scanLimit)!=null?s:1e9)>>1,or(e,t,U(e,0,e.length,t,0,t.length))}function Dt(e,t,n){return sr(ir(e,t,n),e,t)}function cr(e){const{start:t,end:n}=e.positionBefore,{start:s,end:o}=e.positionAfter;return new k(t,n,s,o)}class ee{constructor(t,n,s,o,r){this.changes=t,this.fromA=n,this.toA=s,this.fromB=o,this.toB=r}offset(t,n){return t||n?new ee(this.changes,this.fromA+t,this.toA+t,this.fromB+n,this.toB+n):this}get endA(){return Math.max(this.fromA,this.toA)}get endB(){return Math.max(this.fromB,this.toB)}static buildFromTextdocDiff(t){const s=t.edits.map(cr);return s.sort((r,i)=>r.fromA-i.fromA),Se(s,ae.of(t.contentBefore.split("\n")),ae.of(t.contentAfter.split("\n")),0,0)}static build(t,n,s){const o=Dt(t.toString(),n.toString(),s);return Se(o,t,n,0,0)}static updateA(t,n,s,o,r){return Ze(Ye(t,o,!0,s.length),t,n,s,r)}static updateB(t,n,s,o,r){return Ze(Ye(t,o,!1,n.length),t,n,s,r)}}function Ke(e,t,n,s){const o=n.lineAt(e),r=s.lineAt(t);return o.to==e&&r.to==t&&e<n.length&&t<s.length?[e+1,t+1]:[o.from,r.from]}function ze(e,t,n,s){const o=n.lineAt(e),r=s.lineAt(t);return o.from==e&&r.from==t?[e,t]:[o.to+1,r.to+1]}function Se(e,t,n,s,o){const r=[];for(let i=0;i<e.length;i++){const c=e[i],[a,f]=Ke(c.fromA+s,c.fromB+o,t,n);let[l,d]=ze(c.toA+s,c.toB+o,t,n);const u=[c.offset(-a+s,-f+o)];for(;i<e.length-1;){const h=e[i+1],[p,C]=Ke(h.fromA+s,h.fromB+o,t,n);if(p>l+1&&C>d+1)break;u.push(h.offset(-a+s,-f+o)),[l,d]=ze(h.toA+s,h.toB+o,t,n),i++}r.push(new ee(u,a,Math.max(a,l),f,Math.max(f,d)))}return r}const ie=1e3;function $e(e,t,n,s){let o=0,r=e.length;for(;;){if(o==r){let l=0,d=0;o&&({toA:l,toB:d}=e[o-1]);const u=t-(n?l:d);return[l+u,d+u]}const i=o+r>>1,c=e[i],[a,f]=n?[c.fromA,c.toA]:[c.fromB,c.toB];if(a>t)r=i;else if(f<=t)o=i+1;else return s?[c.fromA,c.fromB]:[c.toA,c.toB]}}function Ye(e,t,n,s){const o=[];return t.iterChangedRanges((r,i,c,a)=>{let f=0,l=n?t.length:s,d=0,u=n?s:t.length;r>ie&&([f,d]=$e(e,r-ie,n,!0)),i<t.length-ie&&([l,u]=$e(e,i+ie,n,!1));const h=a-c-(i-r);let p;const[C,g]=n?[h,0]:[0,h];o.length&&(p=o[o.length-1]).toA>=f?o[o.length-1]={fromA:p.fromA,fromB:p.fromB,toA:l,toB:u,diffA:p.diffA+C,diffB:p.diffB+g}:o.push({fromA:f,toA:l,fromB:d,toB:u,diffA:C,diffB:g})}),o}function Ze(e,t,n,s,o){if(!e.length)return t;const r=[];for(let i=0,c=0,a=0,f=0;;i++){const l=i==e.length?null:e[i],d=l?l.fromA+c:n.length,u=l?l.fromB+a:s.length;for(;f<t.length;){const g=t[f];if(g.toA+c>d||g.toB+a>u)break;r.push(g.offset(c,a)),f++}if(!l)break;const h=l.toA+c+l.diffA,p=l.toB+a+l.diffB,C=Dt(n.sliceString(d,h),s.sliceString(u,p),o);for(const g of Se(C,n,s,d,u))r.push(g);for(c+=l.diffA,a+=l.diffB;f<t.length;){const g=t[f];if(g.fromA+c>h&&g.fromB+a>p)break;f++}}return r}const I=rn.define({combine:e=>e[0]}),Bt=N.define(),y=F.define({create(){return null},update(e,t){for(const n of t.effects)n.is(Bt)&&(e=n.value);return e}}),ar="bg-red-100 dark:bg-red-600/30",lr="bg-green-100 dark:bg-green-600/30",ye=Le.fromClass(class{constructor(e){T(this,"deco");T(this,"gutter");({deco:this.deco,gutter:this.gutter}=Xe(e))}update(e){(e.docChanged||e.viewportChanged||fr(e.startState,e.state)||dr(e.startState,e.state))&&({deco:this.deco,gutter:this.gutter}=Xe(e.view))}},{decorations:e=>e.deco});Be.low(ct({class:"cm-changeGutter",markers:e=>{var t;return((t=e.plugin(ye))==null?void 0:t.gutter)||at.empty}}));function fr(e,t){return e.field(y,!1)!=t.field(y,!1)}function dr(e,t){return e.facet(I)!=t.facet(I)}const Je=b.line({class:"cm-changedLine ".concat(lr)}),ur=b.mark({class:"cm-changedText"}),hr=b.mark({tagName:"ins",class:"cm-insertedLine"}),mr=b.mark({tagName:"del",class:"cm-deletedLine"}),Qe=new class extends it{constructor(){super(...arguments);T(this,"elementClass","cm-changedLineGutter")}};function gr(e,t,n,s,o,r){const i=n?e.fromA:e.fromB,c=n?e.toA:e.toB;let a=0;if(i!=c){o.add(i,i,Je),o.add(i,c,n?mr:hr),r&&r.add(i,i,Qe);for(let f=t.iterRange(i,c-1),l=i;!f.next().done;){if(f.lineBreak){l++,o.add(l,l,Je),r&&r.add(l,l,Qe);continue}const d=l+f.value.length;if(s)for(;a<e.changes.length;){const u=e.changes[a],h=i+(n?u.fromA:u.fromB),p=i+(n?u.toA:u.toB),C=Math.max(l,h),g=Math.min(d,p);if(C<g&&o.add(C,g,ur),p<d)a++;else break}l=d}}}function Xe(e){const t=e.state.field(y),{side:n,highlightChanges:s,markGutter:o}=e.state.facet(I),r=n=="a",i=new X,c=o?new X:null,{from:a,to:f}=e.viewport;for(const l of t){if((r?l.fromA:l.fromB)>=f)break;(r?l.toA:l.toB)>a&&gr(l,e.state.doc,r,s,i,c)}return{deco:i.finish(),gutter:c&&c.finish()}}const pr=N.define({map:(e,t)=>e.map(t)});F.define({create:()=>b.none,update:(e,t)=>{for(const n of t.effects)if(n.is(pr))return n.value;return e.map(t.changes)},provide:e=>M.decorations.from(e)});const ve=N.define({map:(e,t)=>t.mapPos(e)});class Cr extends De{constructor(t){super(),this.lines=t}eq(t){return this.lines==t.lines}toDOM(t){const n=document.createElement("div");return n.className="cm-collapsedLines",n.textContent="⦚ "+t.state.phrase("$ unchanged lines",this.lines)+" ⦚",n.addEventListener("click",s=>{const o=t.posAtDOM(s.target);t.dispatch({effects:ve.of(o)});const{side:r,sibling:i}=t.state.facet(I);i&&i().dispatch({effects:ve.of(xr(o,t.state.field(y),r=="a"))})}),n}ignoreEvent(t){return t instanceof MouseEvent}get estimatedHeight(){return 27}}function xr(e,t,n){let s=0,o=0;for(let r=0;;r++){const i=r<t.length?t[r]:null;if(!i||(n?i.fromA:i.fromB)>=e)return o+(e-s);[s,o]=n?[i.toA,i.toB]:[i.toB,i.toA]}}const Ar=F.define({create(){return b.none},update(e,t){e=e.map(t.changes);for(const n of t.effects)n.is(ve)&&(e=e.update({filter:s=>s!=n.value}));return e},provide:e=>M.decorations.from(e)});function wr({margin:e=3,minSize:t=4}){return Ar.init(n=>kr(n,e,t))}function kr(e,t,n){const s=new X,o=e.facet(I).side=="a",r=e.field(y);let i=1;for(let c=0;;c++){const a=c<r.length?r[c]:null,f=c?i+t:1,l=a?e.doc.lineAt(o?a.fromA:a.fromB).number-1-t:e.doc.lines,d=l-f+1;if(d>=n&&s.add(e.doc.line(f).from,e.doc.line(l).to,b.replace({widget:new Cr(d),block:!0})),!a)break;i=e.doc.lineAt(Math.min(e.doc.length,o?a.toA:a.toB)).number}return s.finish()}M.styleModule.of(new on({".cm-mergeView":{overflowY:"auto"},".cm-mergeViewEditors":{display:"flex",alignItems:"stretch"},".cm-mergeViewEditor":{flexGrow:1,flexBasis:0,overflow:"hidden"},".cm-merge-revert":{width:"1.6em",flexGrow:0,flexShrink:0,position:"relative"},".cm-merge-revert button":{position:"absolute",display:"block",width:"100%",boxSizing:"border-box",textAlign:"center",background:"none",border:"none",font:"inherit",cursor:"pointer"}}));const Er=M.baseTheme({".cm-mergeView & .cm-scroller, .cm-mergeView &":{height:"auto !important",overflowY:"visible !important"},"&light.cm-merge-a .cm-changedText, &light .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ee443366, #ee443366) bottom/100% 2px no-repeat"},"&dark.cm-merge-a .cm-changedText, &dark .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ffaa9966, #ffaa9966) bottom/100% 2px no-repeat"},"&light.cm-merge-b .cm-changedText":{background:"linear-gradient(#22bb2266, #22bb2266) bottom/100% 2px no-repeat"},"&dark.cm-merge-b .cm-changedText":{background:"linear-gradient(#88ff8866, #88ff8866) bottom/100% 2px no-repeat"},".cm-insertedLine, .cm-deletedLine":{textDecoration:"none"},".cm-deletedChunk":{paddingLeft:"6px","& .cm-chunkButtons":{position:"absolute",insetInlineEnd:"5px"},"& button":{border:"none",cursor:"pointer",color:"white",margin:"0 2px",borderRadius:"3px","&[name=accept]":{background:"#2a2"},"&[name=reject]":{background:"#d43"}}},".cm-collapsedLines":{padding:"5px 5px 5px 10px",cursor:"pointer"},"&light .cm-collapsedLines":{color:"#444",background:"linear-gradient(to bottom, transparent 0, #f3f3f3 30%, #f3f3f3 70%, transparent 100%)"},"&dark .cm-collapsedLines":{color:"#ddd",background:"linear-gradient(to bottom, transparent 0, #222 30%, #222 70%, transparent 100%)"},".cm-changeGutter":{width:"3px",paddingLeft:"1px"},"&light.cm-merge-a .cm-changedLineGutter, &light .cm-deletedLineGutter":{background:"#e43"},"&dark.cm-merge-a .cm-changedLineGutter, &dark .cm-deletedLineGutter":{background:"#fa9"},"&light.cm-merge-b .cm-changedLineGutter":{background:"#2b2"},"&dark.cm-merge-b .cm-changedLineGutter":{background:"#8f8"}}),Ae="unknown",br=new class extends it{constructor(){super(...arguments);T(this,"elementClass","cm-deletedLineGutter")}},Mr=Be.low(ct({class:"cm-changeGutter",markers:e=>{var t;return((t=e.plugin(ye))==null?void 0:t.gutter)||at.empty},widgetMarker:(e,t)=>t instanceof yt?br:null}));function Sr(e){const t=ae.of(e.textdocDiff.contentBefore.split("\n"));return[Be.low(ye),Br(e.language),Er,M.editorAttributes.of({class:"cm-merge-b"}),I.of({highlightChanges:e.highlightChanges!==!1,markGutter:e.gutter!==!1,syntaxHighlightDeletions:e.syntaxHighlightDeletions!==!1,mergeControls:e.mergeControls!==!1,side:"b"}),fe.init(()=>t),e.gutter!==!1?Mr:[],e.collapseUnchanged?wr(e.collapseUnchanged):[],y.init(()=>ee.buildFromTextdocDiff(e.textdocDiff))]}const Tt=N.define(),fe=F.define({create:()=>ae.empty,update(e,t){for(const n of t.effects)n.is(Tt)&&(e=n.value.doc);return e}}),Y=new WeakMap;class yt extends De{constructor(n){super();T(this,"dom",null);this.buildDOM=n}eq(n){return this.dom==n.dom}toDOM(n){return this.dom||(this.dom=this.buildDOM(n))}}function vr(e,t,n){var r,i,c;if(Y.has(t.changes)){const a=ke(Y.get(t.changes)).get((r=n==null?void 0:n.name)!=null?r:Ae);if(a)return a}const s=a=>{const{highlightChanges:f,syntaxHighlightDeletions:l,mergeControls:d}=e.facet(I),u=a.state.field(fe).sliceString(t.fromA,t.endA),h=document.createElement("div");if(h.className="cm-deletedChunk ".concat(ar),d){const D=h.appendChild(document.createElement("div"));D.className="cm-chunkButtons";const v=D.appendChild(document.createElement("button"));v.name="accept",v.textContent=e.phrase("Accept"),v.onmousedown=S=>{S.preventDefault(),Lr(a,a.posAtDOM(h))};const L=D.appendChild(document.createElement("button"));L.name="reject",L.textContent=e.phrase("Reject"),L.onmousedown=S=>{S.preventDefault(),Dr(a,a.posAtDOM(h))}}const p=h.appendChild(document.createElement("del")),C=t.changes;let g=0,E=!1;function B(D,v,L){for(let S=D;S<v;){let A=v,_=!1;const G=L+(E?" cm-deletedText":"");if(f&&g<C.length){const R=Math.max(0,E?C[g].toA:C[g].fromA);R<=A&&(A=R,E&&g++,_=!0)}if(A>S){const R=document.createTextNode(u.slice(S,A));if(G){const K=p.appendChild(document.createElement("span"));K.className=G,K.appendChild(R)}else p.appendChild(R)}S=A,_&&(E=!E)}}if(l&&n){const D=n.parser.parse(u);let v=0;kn(D,{style:L=>En(e,L)},(L,S,A)=>{L>v&&B(v,L,""),B(L,S,A),v=S}),B(v,u.length,"")}else B(0,u.length,"");return h},o=b.widget({block:!0,side:-1,widget:new yt(s)});return Y.has(t.changes)?ke(Y.get(t.changes)).set((i=n==null?void 0:n.name)!=null?i:Ae,o):Y.set(t.changes,new Map([[(c=n==null?void 0:n.name)!=null?c:Ae,o]])),o}function Lr(e,t){const{state:n}=e,s=t!=null?t:n.selection.main.head,o=e.state.field(y).find(a=>a.fromB<=s&&a.endB>=s);if(!o)return!1;let r=e.state.sliceDoc(o.fromB,Math.max(o.fromB,o.toB-1));const i=e.state.field(fe);o.fromB!=o.toB&&o.toA<=i.length&&(r+=e.state.lineBreak);const c=sn.of({from:o.fromA,to:Math.min(i.length,o.toA),insert:r},i.length);return e.dispatch({effects:Tt.of({doc:c.apply(i),changes:c}),userEvent:"accept"}),!0}function Dr(e,t){const{state:n}=e,s=t!=null?t:n.selection.main.head,o=n.field(y).find(c=>c.fromB<=s&&c.endB>=s);if(!o)return!1;let i=n.field(fe).sliceString(o.fromA,Math.max(o.fromA,o.toA-1));return o.fromA!=o.toA&&o.toB<=n.doc.length&&(i+=n.lineBreak),e.dispatch({changes:{from:o.fromB,to:Math.min(n.doc.length,o.toB),insert:i},userEvent:"revert"}),!0}function et(e,t){const n=new X;for(const s of e.field(y))n.add(s.fromB,s.fromB,vr(e,s,t));return n.finish()}const Br=e=>F.define({create:t=>et(t,e),update(t,n){return n.state.field(y,!1)!=n.startState.field(y,!1)?et(n.state,e):t},provide:t=>M.decorations.from(t)}),Nt=N.define(),ce=F.define({create:()=>{},update(e,t){for(const n of t.effects)if(n.is(Nt))return n.value;return e}});class Tr extends De{toDOM(){const t=document.createElement("span");return t.className=Bn.modelCursor,t}}const yr=Le.fromClass(class{constructor(e){T(this,"decorations");this.decorations=this.buildDecorations(e)}update(e){(e.docChanged||e.viewportChanged||e.state.field(ce)!==e.startState.field(ce))&&(this.decorations=this.buildDecorations(e.view))}buildDecorations(e){const t=new X,n=e.state.field(ce);if(!n)return b.none;const{doc:s}=e.state,{modelCursorPosition:o,modelSelectionPositionRange:r}=n;if(o!=null)o>=0&&o<=s.length&&t.add(o,o,b.widget({widget:new Tr,side:1}));else if(r!=null){const{start:i,end:c}=r;i>=0&&c<=s.length&&i<c&&t.add(i,c,b.mark({class:"".concat(Ln," bg-[Highlight]!")}))}return t.finish()}},{decorations:e=>e.decorations}),Nr=e=>[ce.init(()=>e),yr],de=N.define(),Ne=F.define({create(){return null},update(e,t){for(const n of t.effects)if(n.is(de))return n.value;return e}});function _t(e,t){const{selectionStart:n,selectionEnd:s}=t,[o,r]=n.from>s.from?[s.from,n.to]:[n.from,s.to];e.dispatch({selection:Ve.create([Ve.range(o,r)]),effects:de.of(t)})}function _r(e,t){_t(e,{selectionStart:t,selectionEnd:t}),e.focus();const s=()=>{e.dispatch({effects:de.of(null)}),window.removeEventListener("mouseup",s)};return window.addEventListener("mouseup",s),!0}function Or(e,t){const n=e.state.field(Ne);if(n){const s=He(Re({},n),{selectionEnd:t});_t(e,s)}return!0}const Fr=Le.fromClass(class{constructor(e){this.view=e,this.updateCursor()}update(e){e.transactions.some(t=>t.effects.some(n=>n.is(de)))&&this.updateCursor()}updateCursor(){this.view.state.field(Ne)?this.view.dom.classList.add("cm-line-number-dragging"):this.view.dom.classList.remove("cm-line-number-dragging")}}),Gr=M.theme({".cm-gutters":{cursor:"default"},"&.cm-line-number-dragging .cm-gutters":{cursor:"text"}});function Rr(){return[Ne,Fr,Gr,cn({domEventHandlers:{mousedown:_r,mousemove:Or}})]}const Hr=ft(()=>ot(()=>import("./bqk4d9uy5l3d6vsz.js").then(e=>e._),__vite__mapDeps([0,1])),{loading:e=>dt(e)}),Vr=ft(()=>ot(()=>import("./j0yo6uv6652vva62.js").then(e=>e.yA),__vite__mapDeps([2,1,3,4,5])),{loading:e=>dt(e)}),tt=st.define();function Ot(e,t){return e==null?[]:Sr({highlightChanges:!1,gutter:!1,syntaxHighlightDeletions:!0,mergeControls:!1,language:t,textdocDiff:e})}function we(e,t,n){const s=e.reconfigure(Ot(t,n!=null?n:null));if(t==null)return[s];const o=ee.buildFromTextdocDiff(t);return[s,Bt.of(o)]}const Pr=({currentlyStreamingLineIndex:e,value:t,textdocDiff:n,placeholderContent:s,languageCompartment:o,languageCompartmentInit:r,editableCompartment:i,readOnlyCompartment:c,editableInit:a,handleChange:f,handleBlur:l,handleSave:d,extensionsProp:u,editorTheme:h,comments:p,maxLength:C=An,intl:g,toaster:E,modelCursor:B,unifiedMergeViewCompartment:D,hideLineNumbers:v=!1})=>{var S;const L=[an(s),...C!=Number.POSITIVE_INFINITY?[er(g,E,C)]:[],Tn(),o.of(r!=null?r:[]),i.of([M.editable.of(a)]),c.of([Q.readOnly.of(!a)]),ln(),Q.allowMultipleSelections.of(!0),yn(),bn(),...v?[]:[Rr(),fn(),Mn({markerDOM:A=>{const _=document.createElement("span"),G=tn.createRoot(_),R=A?j.jsx(Vr,{className:"icon-sm text-token-text-tertiary"}):j.jsx(Hr,{className:"icon-sm text-token-text-tertiary"});return G.render(R),_}})],Nr(B),D.of(Ot(n,(S=r==null?void 0:r.language)!=null?S:null)),...u!=null?u:[],...Zn,dn.of([..._n,...On,...Sn,...Fn,...Gn,Rn]),Nn(),h,un(p),tr(),$n(e!=null?e:null),M.updateListener.of(f),M.domEventHandlers({blur:l,keydown(A){(A.key==="s"||A.key==="S")&&A.metaKey&&(d==null||d())},paste(A){var G;const _=(G=A.clipboardData)==null?void 0:G.getData("text/plain");_!=null&&ut.logEvent("Canvas Codemirror Paste",{textLength:_.length})}})];return Q.create({doc:t,extensions:L})};function jr({state:e,parent:t,onUpdateState:n}){const s=(o,r)=>{r.update(o);const i=r.state;n(i)};return new M({state:e,parent:t,dispatchTransactions:s})}const Wr="_codemirror_hsqxh_1",Ur="_preview_hsqxh_26",nt={codemirror:Wr,preview:Ur},Ir=M.theme({".cm-tooltip-autocomplete":{backgroundColor:"var(--main-surface-primary)",color:"var(--text-primary)",border:"1px solid var(--border-light)",borderRadius:"6px",padding:"4px",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1)"},".cm-tooltip-autocomplete > ul > li":{borderRadius:"5px",color:"var(--text-primary)"},".cm-tooltip-autocomplete > ul > li[aria-selected]":{backgroundColor:"var(--main-surface-secondary)",color:"var(--text-primary)"},".cm-tooltip-autocomplete > ul > li:hover":{backgroundColor:"var(--selection)",color:"#ffffff"},".cm-completionMatchedText":{textDecoration:"none",fontWeight:"700"}}),qr=M.theme({".cm-scroller":{fontFamily:"ui-monospace, SFMono-Regular, SF Mono, Menlo, Consolas, Liberation Mono, monospace !important"}}),Kr=M.theme({"&":{backgroundColor:"transparent"}}),rt=e=>[qr,Kr,Ir,vn(Hn(e),{fallback:!0})],zr=e=>{const[t]=x.useState(()=>new Z),n=pn();x.useEffect(()=>{var o;(o=e.current)==null||o.dispatch({effects:t.reconfigure(rt(n))})},[n,t,e]);const[s]=x.useState(()=>t.of(rt(n)));return s},Ft=({id:e,children:t,comments:n,commentingOn:s,currentlyStreamingLineIndex:o,hoveredCommentId:r,focusedCommentId:i,placeholder:c="",readonlyReason:a,language:f,value:l,textdocDiff:d,extensions:u,maxLength:h,onBlur:p,onSave:C,onChange:g,editorRef:E,width:B,modelCursor:D,isPreview:v,hideLineNumbers:L=!1})=>{const S=x.useRef(null),A=x.useRef(null),_=nn(),G=Cn(),[R,K]=x.useState(null),ue=x.useRef(null),[{width:Ht},Vt]=In(),[z]=x.useState(()=>new Z),[he]=x.useState(()=>new Z),[me]=x.useState(()=>new Z),[V]=x.useState(()=>new Z),te=x.useRef(g);te.current=g;const Pt=x.useCallback(({docChanged:m,state:w,transactions:O})=>{var H;for(const P of O)if(P.annotation(tt)===!0||P.annotation(xt)===!0)return;if(m){const P=w.doc.toString();ue.current=P,(H=te.current)==null||H.call(te,w)}},[]),ne=x.useRef(p);ne.current=p;const jt=x.useCallback(()=>{var m;return(m=ne.current)==null?void 0:m.call(ne)},[]),re=x.useRef(C);re.current=C;const Wt=x.useCallback(()=>{var m;return(m=re.current)==null?void 0:m.call(re)},[]),Ut=async m=>m?await Vn(m):null,_e=x.useCallback(async m=>{var O;const w=await Ut(m);w&&((O=A.current)==null||O.dispatch({effects:[z.reconfigure(w),...we(V,d,w==null?void 0:w.language)]}))},[z,V]),It=zr(A),qt=x.useCallback(m=>{if(m===ue.current){ue.current=null;return}const{current:w}=A;if(!w)return;const O=w.state.doc,H=O.toString(),P=le(H,0,H.length,m,0,m.length),zt=m.slice(P),$t={from:P,to:O.length,insert:zt},$=f!=null?pe(f):null,Yt=w.state.update({changes:$t,effects:[Pe.of(n!=null?n:[]),Ee.of(o!=null?o:null),...$!=null?[z.reconfigure($)]:[],...we(V,d,$==null?void 0:$.language)],annotations:tt.of(!0)});w.update([Yt])},[n,o,f,z,d,V]);x.useImperativeHandle(E,()=>({UNSAFE_setValue:qt,codeViewRef:A,highlightLine:(m,w)=>Jn(ke(A.current),m,w)})),x.useEffect(()=>{_e(f)},[f,_e]),x.useEffect(()=>{var w;const m=f==null?null:pe(f);(w=A.current)==null||w.dispatch({effects:we(V,d,m==null?void 0:m.language)})},[V,d]);const oe=(a==null?void 0:a.isReadonly)===!0;x.useEffect(()=>{var m;(m=A.current)==null||m.dispatch({effects:[he.reconfigure(M.editable.of(!oe)),me.reconfigure(Q.readOnly.of(oe))]})},[oe,he,me]),x.useEffect(()=>{var m;(s==null||Pn(s))&&((m=A.current)==null||m.dispatch({effects:hn.of(s!=null?s:null)}))},[s]),x.useEffect(()=>{var m;(m=A.current)==null||m.dispatch({effects:Pe.of(n!=null?n:[])})},[n]),x.useEffect(()=>{var m;(m=A.current)==null||m.dispatch({effects:mn.of(r)})},[r]),x.useEffect(()=>{var m;(m=A.current)==null||m.dispatch({effects:gn.of(i)})},[i]),x.useEffect(()=>{var m;(m=A.current)==null||m.dispatch({effects:Nt.of(D)})},[D]),x.useEffect(()=>{var m;(m=A.current)==null||m.dispatch({effects:Ee.of(o!=null?o:null)})},[o]),x.useEffect(()=>{const m=S.current;if(m==null)return;const w=f==null?null:pe(f),O=Pr({currentlyStreamingLineIndex:o,value:l,placeholderContent:c,editableCompartment:he,readOnlyCompartment:me,editableInit:!oe,languageCompartment:z,languageCompartmentInit:w!=null?w:null,handleChange:Pt,handleBlur:jt,handleSave:Wt,extensionsProp:u,editorTheme:It,intl:_,toaster:G,maxLength:h,comments:n!=null?n:[],modelCursor:D,textdocDiff:d,unifiedMergeViewCompartment:V,hideLineNumbers:L});K(O);const H=jr({state:O,parent:m,onUpdateState:K});return A.current=H,()=>{H.destroy()}},[e,u,c]);const Kt=x.useCallback(()=>A.current,[A]),Oe=[],Fe=[];return x.Children.forEach(t,m=>{if(!x.isValidElement(m))return;const{type:w}=m;if(w===Rt)Oe.push(m);else if(w===Gt)Fe.push(m);else throw new Error("Invalid Codemirror child: "+JSON.stringify(w))}),j.jsx(jn.Provider,{value:Kt,children:j.jsx(Wn.Provider,{value:R,children:j.jsxs(Un.Provider,{value:Ht,children:[j.jsxs("div",{className:"relative z-0 flex h-full max-w-full",children:[j.jsx("div",{id:e,className:lt(nt.codemirror,v&&nt.preview,Dn.composer,"flex h-full w-full flex-col items-stretch"),ref:wn(S,Vt),style:{width:B}}),Fe]}),Oe]})})})},Gt=({children:e})=>e,Rt=({children:e})=>e;Ft.EditorChildren=Gt;Ft.ContextChildren=Rt;export{Ft as C};
//# sourceMappingURL=k6dbkwjaexelrlgh.js.map
