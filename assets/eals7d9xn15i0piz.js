const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/e23v0up48ofc1v2q.js","assets/i8clt0mfz495j7ii.js","assets/bimaydywrdin6h6p.js"])))=>i.map(i=>d[i]);
var _o=Object.defineProperty,jo=Object.defineProperties;var es=Object.getOwnPropertyDescriptors;var mt=Object.getOwnPropertySymbols;var ns=Object.prototype.hasOwnProperty,rs=Object.prototype.propertyIsEnumerable;var Et=(e,n,t)=>n in e?_o(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,tn=(e,n)=>{for(var t in n||(n={}))ns.call(n,t)&&Et(e,t,n[t]);if(mt)for(var t of mt(n))rs.call(n,t)&&Et(e,t,n[t]);return e},En=(e,n)=>jo(e,es(n));import{l as Wr,r as Z,c as Pn,e as Xt,j as le,_ as Kt,i as ts,d as Nn}from"./i8clt0mfz495j7ii.js";import{J as Zt,d as Qt,o as Jt,L as bt,il as os,id as ss,ig as is,ie as fs,ic as us,a$ as ls}from"./ghewn7l2ynbm32fm.js";import{C as Oe,R as Le,F as _t,p as Br,a as jt,e as Re,r as De,f as cs,g as Rn,c as as,d as hs,b as gs}from"./dabvy8uqe4jm1b47.js";import{a as ds,u as vs}from"./k5zh2h7fpzx4n2oe.js";import{b8 as ps}from"./j0yo6uv6652vva62.js";import{h as ws,b as ms}from"./gfxl3n7r4t82beqq.js";import{x as Es}from"./kf7tqzde2yk57qjr.js";const Ns=ws("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3");function Is(e,n,t,r,s,c){const a=n.current;if(!a||t.current)return;const h=a.getBoundingClientRect(),g=e.clientX-h.left,f=e.clientY-h.top,o=a.scrollLeft+g/r,i=a.scrollTop+f/r,u=i>=0&&i<=Oe,l=o>=0&&o<=Le,d=[0];for(let E=0;E<s.length;E++)d[E+1]=d[E]+s[E];const v=[0];for(let E=0;E<c.length;E++)v[E+1]=v[E]+c[E];let p="";const m=4/Math.max(r,1e-4);if(u){const E=o-Le;if(E>=0)for(let w=1;w<d.length;w++){const N=d[w];if(Math.abs(N-E)<=m){p="col-resize";break}}}else if(l){const E=i-Oe;if(E>=0)for(let w=1;w<v.length;w++){const N=v[w];if(Math.abs(N-E)<=m){p="row-resize";break}}}try{a.style.cursor=p}catch(E){}}function eo(e){var t;const n=new Map;for(const r of(t=e.sharedFormulas)!=null?t:[])typeof r.si=="number"&&r.base&&r.anchor&&n.set(r.si,{base:r.base,anchor:r.anchor});return n}const no=/([$]?[A-Z]+[$]?\d+)/g;function As(e){var n;return Array.from(new Set((n=e.match(no))!=null?n:[]))}function Rs(e,n){var ae,se,ie;const{containerRef:t,canvasRef:r,zoom:s,viewColWidths:c,rowHeights:a,selectionStartRef:h,selectionEndRef:g,setSelectionRect:f,setIsDragging:o,redrawSelectionOverlay:i,setResizeGuide:u,resizingRef:l,setColSizeOverrides:d,setRowSizeOverrides:v,redraw:p,setSelectedAddr:m,setSelectedRow:E,sheet:w}=n,N=t.current,I=r.current;if(!I||!N)return;try{N.focus()}catch(J){}const R=I.getBoundingClientRect(),y=e.clientX-R.left,M=e.clientY-R.top,D=N.scrollLeft+y/s,P=N.scrollTop+M/s,z=P>=0&&P<=Oe,G=D>=0&&D<=Le,S=[0];for(let J=0;J<c.length;J++)S[J+1]=S[J]+c[J];const _=[0];for(let J=0;J<a.length;J++)_[J+1]=_[J]+a[J];const ue=4/Math.max(s,1e-4),ge=20,Y=12;if(z){const J=D-Le;if(J>=0){let ve=-1;for(let X=1;X<S.length;X++){const pe=S[X];if(Math.abs(pe-J)<=ue){ve=X;break}}if(ve>0){e.preventDefault();const X=ve-1,pe=(ae=c[X])!=null?ae:_t;l.current={type:"col",index:X,startClientX:e.clientX,startClientY:e.clientY,startSize:pe};const me=Le+S[X]-N.scrollLeft;u({type:"col",pos:me+pe});const de=O=>{const L=l.current;if(!L||L.type!=="col")return;const $=(O.clientX-L.startClientX)/s,F=Math.max(ge,L.startSize+$),x=Le+S[L.index]-N.scrollLeft;u({type:"col",pos:x+F}),i()},T=O=>{window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",T);const L=l.current;l.current=null;const $=L?(O.clientX-L.startClientX)/s:0,F=L?Math.max(ge,L.startSize+$):void 0;u(null),L&&typeof F=="number"&&(d(x=>En(tn({},x),{[L.index]:F})),p(),i());try{N.style.cursor=""}catch(x){}};window.addEventListener("mousemove",de),window.addEventListener("mouseup",T);try{N.style.cursor="col-resize"}catch(O){}return}}}if(G){const J=P-Oe;if(J>=0){let ve=-1;for(let X=1;X<_.length;X++){const pe=_[X];if(Math.abs(pe-J)<=ue){ve=X;break}}if(ve>0){e.preventDefault();const X=ve-1,pe=(se=a[X])!=null?se:Br(jt);l.current={type:"row",index:X,startClientX:e.clientX,startClientY:e.clientY,startSize:pe};const me=Oe+_[X]-N.scrollTop;u({type:"row",pos:me+pe});const de=O=>{const L=l.current;if(!L||L.type!=="row")return;const $=(O.clientY-L.startClientY)/s,F=Math.max(Y,L.startSize+$),x=Oe+_[L.index]-N.scrollTop;u({type:"row",pos:x+F}),i()},T=O=>{window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",T);const L=l.current;l.current=null;const $=L?(O.clientY-L.startClientY)/s:0,F=L?Math.max(Y,L.startSize+$):void 0;u(null),L&&typeof F=="number"&&(v(x=>En(tn({},x),{[L.index]:F})),p(),i());try{N.style.cursor=""}catch(x){}};window.addEventListener("mousemove",de),window.addEventListener("mouseup",T);try{N.style.cursor="row-resize"}catch(O){}return}}}const j=N.scrollLeft+y/s-Le,ne=N.scrollTop+M/s-Oe;if(j<0||ne<0)return;let re=0,B=0;for(;B<c.length&&re+c[B]<=j;)re+=c[B],B++;re=0;let Q=0;for(;Q<a.length&&re+a[Q]<=ne;)re+=a[Q],Q++;{const ve=((ie=w.mergedCells)!=null?ie:[]).find(X=>{const pe=Re(X.startAddress),me=De(X.startAddress),de=Re(X.endAddress),T=De(X.endAddress),O=Math.min(pe,de),L=Math.max(pe,de),$=Math.min(me,T),F=Math.max(me,T);return B>=O&&B<=L&&Q>=$&&Q<=F});if(ve){const X=Re(ve.startAddress),pe=De(ve.startAddress),me=Re(ve.endAddress),de=De(ve.endAddress),T=Math.min(X,me),O=Math.min(pe,de);B=T,Q=O}m("".concat(cs(B)).concat(Q+1)),E(Q)}const q={row:Q,col:B};h.current=q,g.current=q,f({r1:q.row,c1:q.col,r2:q.row,c2:q.col}),o(!0),i();const k=J=>{const ve=t.current,X=r.current;if(!ve||!X)return;const pe=X.getBoundingClientRect(),me=J.clientX-pe.left,de=J.clientY-pe.top,T=ve.scrollLeft+me/s-Le,O=ve.scrollTop+de/s-Oe;if(T<0||O<0)return;let L=0,$=0;for(;$<c.length&&L+c[$]<=T;)L+=c[$],$++;let F=0,x=0;for(;x<a.length&&F+a[x]<=O;)F+=a[x],x++;$=Math.max(0,Math.min($,c.length-1)),x=Math.max(0,Math.min(x,a.length-1)),g.current={row:x,col:$},f({r1:Math.min(q.row,x),c1:Math.min(q.col,$),r2:Math.max(q.row,x),c2:Math.max(q.col,$)}),i()},oe=()=>{window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",oe),o(!1)};window.addEventListener("mousemove",k),window.addEventListener("mouseup",oe)}function ys(e){var u,l,d,v,p,m,E,w,N,I,R,y,M,D,P,z,G,S,_,ue,ge;const{selectionRect:n,selRow:t,selCol:r,sheet:s,styleInfos:c}=e,a=new Map,h=n!=null?n:{r1:t,c1:r,r2:t,c2:r},g=h.r2-h.r1+1,f=h.c2-h.c1+1,o=Array.from({length:g},()=>Array.from({length:f},()=>({})));for(let Y=h.r1;Y<=h.r2;Y++){const j=s.rows.find(ne=>ne.index-1===Y);for(let ne=h.c1;ne<=h.c2;ne++){const re=j==null?void 0:j.cells.find(ie=>Re(ie.address)===ne),B=(l=c[(u=re==null?void 0:re.styleIndex)!=null?u:0])!=null?l:{},Q=Y-h.r1,q=ne-h.c1,k={};k.v=re?Rn(re,c,a):"";const oe=typeof((d=B.font)==null?void 0:d.size)=="number"&&B.font.size>0?B.font.size*72/96:void 0,ae=B.align==="left"||B.align==="center"||B.align==="right"?B.align:void 0;k.fmt={bold:(v=B.font)==null?void 0:v.bold,italic:(p=B.font)==null?void 0:p.italic,color:(E=B.textColor)!=null?E:(m=B.font)==null?void 0:m.color,bg:B.fill,align:ae,numFmt:B.numberFormatCode,fontFamily:(w=B.font)==null?void 0:w.family,fontSizePt:oe,border:{top:(N=B.borderStyles)!=null&&N.top?{style:B.borderStyles.top,color:(I=B.borders)==null?void 0:I.top}:void 0,right:(R=B.borderStyles)!=null&&R.right?{style:B.borderStyles.right,color:(y=B.borders)==null?void 0:y.right}:void 0,bottom:(M=B.borderStyles)!=null&&M.bottom?{style:B.borderStyles.bottom,color:(D=B.borders)==null?void 0:D.bottom}:void 0,left:(P=B.borderStyles)!=null&&P.left?{style:B.borderStyles.left,color:(z=B.borders)==null?void 0:z.left}:void 0},diagonal:(G=B.borderStyles)!=null&&G.diagonal||(S=B.borders)!=null&&S.diagonal?{style:(_=B.borderStyles)==null?void 0:_.diagonal,color:(ue=B.borders)==null?void 0:ue.diagonal,up:!!B.borderDiagonalUp,down:!!B.borderDiagonalDown}:void 0};const se=o[Q];se&&(se[q]=k)}}const i=[];for(const Y of(ge=s.mergedCells)!=null?ge:[]){const j=Math.min(Re(Y.startAddress),Re(Y.endAddress)),ne=Math.max(Re(Y.startAddress),Re(Y.endAddress)),re=Math.min(De(Y.startAddress),De(Y.endAddress)),B=Math.max(De(Y.startAddress),De(Y.endAddress)),Q=Math.max(h.r1,re),q=Math.min(h.r2,B),k=Math.max(h.c1,j),oe=Math.min(h.c2,ne);if(Q>q||k>oe)continue;const ae=Q-h.r1,se=k-h.c1,ie=q-Q+1,J=oe-k+1;(ie>1||J>1)&&i.push({r:ae,c:se,rowspan:ie,colspan:J})}return{rows:o,merges:i}}function Ts(e){const n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return String(e!=null?e:"").replace(/[&<>"]/g,t=>{var r;return(r=n[t])!=null?r:t})}function Ms(e,n){var l,d,v,p,m,E,w,N,I,R,y,M,D,P,z,G,S,_,ue,ge;const t=new Map,r=new Set;for(const Y of n)t.set("".concat(Y.r,",").concat(Y.c),Y);const s=e.reduce((Y,j)=>{var ne;return Math.max(Y,(ne=j==null?void 0:j.length)!=null?ne:0)},0),c=new Array(s).fill(0),a=Y=>{const B=Y.length*7+10,Q=Math.max(20,Math.min(B,360));return Math.round(Q)};for(let Y=0;Y<e.length;Y++){const j=(d=(l=e[Y])==null?void 0:l.length)!=null?d:0;for(let ne=0;ne<j;ne++){const re="".concat(Y,",").concat(ne);if(r.has(re))continue;const B=t.get(re);let Q=1;if(B){Q=Math.max(1,B.colspan);for(let se=0;se<B.rowspan;se++)for(let ie=0;ie<B.colspan;ie++)(se||ie)&&r.add("".concat(Y+se,",").concat(ne+ie))}const q=(p=(v=e[Y])==null?void 0:v[ne])!=null?p:{},k=String((m=q.v)!=null?m:"");if(!s)continue;const oe=a(k),ae=Math.max(1,Math.round(oe/Q));for(let se=0;se<Q&&ne+se<s;se++){const ie=(E=c[ne+se])!=null?E:0;c[ne+se]=Math.max(ie,ae)}}}for(let Y=0;Y<c.length;Y++){const j=c[Y];(!j||!isFinite(j))&&(c[Y]=32)}function h(Y){if(!Y)return"#000";if(/^#/i.test(Y))return Y;const j=Y.match(/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*[\d.]+)?\)$/i);if(j){const ne=Number(j[1]),re=Number(j[2]),B=Number(j[3]),Q=q=>Math.max(0,Math.min(255,q)).toString(16).padStart(2,"0");return"#".concat(Q(ne)).concat(Q(re)).concat(Q(B)).toUpperCase()}return Y}let g='<table style="table-layout:fixed;border-collapse:collapse;width:0px">';if(s>0){g+="<colgroup>";for(let Y=0;Y<s;Y++){const j=Math.max(1,Math.round((w=c[Y])!=null?w:0));g+='<col width="'.concat(j,'"/>')}g+="</colgroup>"}for(let Y=0;Y<e.length;Y++){g+="<tr>";const j=(I=(N=e[Y])==null?void 0:N.length)!=null?I:0;for(let ne=0;ne<j;ne++){if(r.has("".concat(Y,",").concat(ne)))continue;const re=t.get("".concat(Y,",").concat(ne));let B="";if(re){re.rowspan>1&&(B+=' rowspan="'.concat(re.rowspan,'"')),re.colspan>1&&(B+=' colspan="'.concat(re.colspan,'"'));for(let ie=0;ie<re.rowspan;ie++)for(let J=0;J<re.colspan;J++)(ie||J)&&r.add("".concat(Y+ie,",").concat(ne+J))}const Q=(y=(R=e[Y])==null?void 0:R[ne])!=null?y:{},q=(M=Q.fmt)!=null?M:{},k=[];if(q.bold&&k.push("font-weight:bold"),q.italic&&k.push("font-style:italic"),q.underline&&k.push("text-decoration:underline"),q.strike&&k.push("text-decoration:line-through"),q.color&&k.push("color:".concat(h(q.color))),q.fontFamily){const ie=/\s/.test(q.fontFamily)?'"'.concat(q.fontFamily,'"'):q.fontFamily;k.push("font-family:".concat(ie))}if(typeof q.fontSizePt=="number"&&isFinite(q.fontSizePt)&&q.fontSizePt>0){const ie="".concat(Math.round(q.fontSizePt*10)/10,"pt");k.push("font-size:".concat(ie))}if(q.bg){k.push("background-color:".concat(q.bg));const ie=h(q.bg);k.push("background:".concat(ie)),k.push("mso-pattern:black none")}q.align&&k.push("text-align:".concat(q.align)),q.valign&&k.push("vertical-align:".concat(q.valign)),q.wrap===!1&&k.push("white-space:nowrap"),q.numFmt?k.push('mso-number-format:"'.concat(String(q.numFmt).replace(/"/g,'\\"'),'"')):k.push('mso-number-format:"General"'),typeof Q.v=="string"&&/^\s*=/.test(Q.v)&&k.push('mso-number-format:"\\@"');const oe=ie=>{switch(ie){case"hair":return{widthPx:1,cssStyle:"solid"};case"thin":return{widthPx:1,cssStyle:"solid"};case"medium":return{widthPx:2,cssStyle:"solid"};case"thick":return{widthPx:3,cssStyle:"solid"};case"dotted":return{widthPx:1,cssStyle:"dotted"};case"dashed":return{widthPx:1,cssStyle:"dashed"};case"mediumDashed":return{widthPx:2,cssStyle:"dashed"};case"dashDot":return{widthPx:1,cssStyle:"dashed"};case"dashDotDot":return{widthPx:1,cssStyle:"dotted"};case"mediumDashDot":return{widthPx:2,cssStyle:"dashed"};case"mediumDashDotDot":return{widthPx:2,cssStyle:"dotted"};case"double":return{widthPx:3,cssStyle:"double"};case"slantDashDot":return{widthPx:2,cssStyle:"dashed"};default:return null}},ae=(ie,J,ve)=>{const X=oe(J);if(!X)return;const pe=ve!=null?ve:"#000",me="".concat(X.widthPx,"px ").concat(X.cssStyle," ").concat(pe),de=X.widthPx*72/96,T="".concat(de,"pt ").concat(X.cssStyle," ").concat(h(pe));k.push("border-".concat(ie,":").concat(me)),k.push("mso-border-".concat(ie,"-alt:").concat(T))};if((D=q.border)!=null&&D.top&&ae("top",q.border.top.style,q.border.top.color),(P=q.border)!=null&&P.right&&ae("right",q.border.right.style,q.border.right.color),(z=q.border)!=null&&z.bottom&&ae("bottom",q.border.bottom.style,q.border.bottom.color),(G=q.border)!=null&&G.left&&ae("left",q.border.left.style,q.border.left.color),(S=q.diagonal)!=null&&S.up||(_=q.diagonal)!=null&&_.down){const ie=q.diagonal.style,J=(ue=q.diagonal.color)!=null?ue:"#000",ve=oe(ie);if(ve){const X=ve.widthPx*72/96,pe="".concat(X,"pt ").concat(ve.cssStyle," ").concat(h(J));q.diagonal.up&&k.push("mso-diagonal-up:".concat(pe)),q.diagonal.down&&k.push("mso-diagonal-down:".concat(pe))}}const se=k.length?" style='".concat(k.join(";"),"'"):"";g+="<td".concat(B).concat(se,">").concat(Ts((ge=Q.v)!=null?ge:""),"</td>")}g+="</tr>"}return g+="</table>","".concat('<html><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta name=ProgId content="Excel.Sheet"><meta name=Generator content="Microsoft Excel 15"><style>table{mso-displayed-decimal-separator:"\\.";mso-displayed-thousand-separator:"\\,";}tr{mso-height-source:auto;}td{padding-top:1px;padding-right:1px;padding-left:1px;mso-ignore:padding;color:black;font-size:12.0pt;font-weight:400;font-style:normal;text-decoration:none;font-family:"Aptos Narrow", sans-serif;mso-font-charset:0;text-align:general;vertical-align:bottom;border:none;white-space:nowrap;mso-rotate:0;}</style></head><body>').concat("<!--StartFragment-->").concat(g).concat("<!--EndFragment-->").concat("</body></html>")}function Cs(e){return e.map(n=>(n!=null?n:[]).map(t=>{var c;const r=(c=t==null?void 0:t.v)!=null?c:"",s=String(r);return/[\t\n\r]/.test(s)?'"'.concat(s.replace(/"/g,'""'),'"'):s}).join("	")).join("\n")}function Ds(e){const{containerRef:n,selectionRectRef:t,sheetRef:r,styleInfosRef:s,selRowRef:c,selColRef:a,selectionStartRef:h,selectionEndRef:g,copyOutlineRectRef:f,copyAnimReqRef:o,copyDashOffsetRef:i,redrawSelectionOverlay:u}=e,l=()=>{try{o.current!=null&&(cancelAnimationFrame(o.current),o.current=null);const d=h.current,v=g.current;if(d&&v){const p=Math.min(d.row,v.row),m=Math.max(d.row,v.row),E=Math.min(d.col,v.col),w=Math.max(d.col,v.col);f.current={r1:p,c1:E,r2:m,c2:w},i.current=0;const N=()=>{i.current=(i.current+.08)%1e3,u(),o.current=requestAnimationFrame(N)};N()}}catch(d){}};return async function(v){var D,P;const p=n.current;if(!p)return;const m=(D=document.activeElement)!=null?D:null;if(m&&!p.contains(m))return;const E=t.current,w=r.current,N=s.current;if(!w||!N)return;const{rows:I,merges:R}=ys({selectionRect:E,selRow:c.current,selCol:a.current,sheet:w,styleInfos:N}),y=Ms(I,R),M=Cs(I);try{if(v.clipboardData){v.preventDefault(),v.clipboardData.setData("text/html",y),v.clipboardData.setData("text/plain",M),l();return}}catch(z){}try{const z=window.ClipboardItem;if(z&&((P=navigator.clipboard)!=null&&P.write)){const G=new z({"text/html":new Blob([y],{type:"text/html"}),"text/plain":new Blob([M],{type:"text/plain"})});await navigator.clipboard.write([G]),v.preventDefault(),l();return}}catch(z){}try{v.clipboardData&&(v.preventDefault(),v.clipboardData.setData("text/plain",M),l())}catch(z){}}}var Xn={exports:{}},Os=Xn.exports,Nt;function Ls(){return Nt||(Nt=1,(function(e,n){(function(t,r){e.exports=r()})(Os,function(){var t=(function(r,s){var c=Array.prototype.concat,a=Array.prototype.slice,h=Object.prototype.toString;function g(E,w){var N=E>w?E:w;return r.pow(10,17-~~(r.log(N>0?N:-N)*r.LOG10E))}var f=Array.isArray||function(w){return h.call(w)==="[object Array]"};function o(E){return h.call(E)==="[object Function]"}function i(E){return typeof E=="number"?E-E===0:!1}function u(E){return c.apply([],E)}function l(){return new l._init(arguments)}l.fn=l.prototype,l._init=function(w){if(f(w[0]))if(f(w[0][0])){o(w[1])&&(w[0]=l.map(w[0],w[1]));for(var N=0;N<w[0].length;N++)this[N]=w[0][N];this.length=w[0].length}else this[0]=o(w[1])?l.map(w[0],w[1]):w[0],this.length=1;else if(i(w[0]))this[0]=l.seq.apply(null,w),this.length=1;else{if(w[0]instanceof l)return l(w[0].toArray());this[0]=[],this.length=1}return this},l._init.prototype=l.prototype,l._init.constructor=l,l.utils={calcRdx:g,isArray:f,isFunction:o,isNumber:i,toVector:u},l._random_fn=r.random,l.setRandom=function(w){if(typeof w!="function")throw new TypeError("fn is not a function");l._random_fn=w},l.extend=function(w){var N,I;if(arguments.length===1){for(I in w)l[I]=w[I];return this}for(N=1;N<arguments.length;N++)for(I in arguments[N])w[I]=arguments[N][I];return w},l.rows=function(w){return w.length||1},l.cols=function(w){return w[0].length||1},l.dimensions=function(w){return{rows:l.rows(w),cols:l.cols(w)}},l.row=function(w,N){return f(N)?N.map(function(I){return l.row(w,I)}):w[N]},l.rowa=function(w,N){return l.row(w,N)},l.col=function(w,N){if(f(N)){var I=l.arange(w.length).map(function(){return new Array(N.length)});return N.forEach(function(M,D){l.arange(w.length).forEach(function(P){I[P][D]=w[P][M]})}),I}for(var R=new Array(w.length),y=0;y<w.length;y++)R[y]=[w[y][N]];return R},l.cola=function(w,N){return l.col(w,N).map(function(I){return I[0]})},l.diag=function(w){for(var N=l.rows(w),I=new Array(N),R=0;R<N;R++)I[R]=[w[R][R]];return I},l.antidiag=function(w){for(var N=l.rows(w)-1,I=new Array(N),R=0;N>=0;N--,R++)I[R]=[w[R][N]];return I},l.transpose=function(w){var N=[],I,R,y,M,D;for(f(w[0])||(w=[w]),R=w.length,y=w[0].length,D=0;D<y;D++){for(I=new Array(R),M=0;M<R;M++)I[M]=w[M][D];N.push(I)}return N.length===1?N[0]:N},l.map=function(w,N,I){var R,y,M,D,P;for(f(w[0])||(w=[w]),y=w.length,M=w[0].length,D=I?w:new Array(y),R=0;R<y;R++)for(D[R]||(D[R]=new Array(M)),P=0;P<M;P++)D[R][P]=N(w[R][P],R,P);return D.length===1?D[0]:D},l.cumreduce=function(w,N,I){var R,y,M,D,P;for(f(w[0])||(w=[w]),y=w.length,M=w[0].length,D=I?w:new Array(y),R=0;R<y;R++)for(D[R]||(D[R]=new Array(M)),M>0&&(D[R][0]=w[R][0]),P=1;P<M;P++)D[R][P]=N(D[R][P-1],w[R][P]);return D.length===1?D[0]:D},l.alter=function(w,N){return l.map(w,N,!0)},l.create=function(w,N,I){var R=new Array(w),y,M;for(o(N)&&(I=N,N=w),y=0;y<w;y++)for(R[y]=new Array(N),M=0;M<N;M++)R[y][M]=I(y,M);return R};function d(){return 0}l.zeros=function(w,N){return i(N)||(N=w),l.create(w,N,d)};function v(){return 1}l.ones=function(w,N){return i(N)||(N=w),l.create(w,N,v)},l.rand=function(w,N){return i(N)||(N=w),l.create(w,N,l._random_fn)};function p(E,w){return E===w?1:0}l.identity=function(w,N){return i(N)||(N=w),l.create(w,N,p)},l.symmetric=function(w){var N=w.length,I,R;if(w.length!==w[0].length)return!1;for(I=0;I<N;I++)for(R=0;R<N;R++)if(w[R][I]!==w[I][R])return!1;return!0},l.clear=function(w){return l.alter(w,d)},l.seq=function(w,N,I,R){o(R)||(R=!1);var y=[],M=g(w,N),D=(N*M-w*M)/((I-1)*M),P=w,z;for(z=0;P<=N&&z<I;z++,P=(w*M+D*M*z)/M)y.push(R?R(P,z):P);return y},l.arange=function(w,N,I){var R=[],y;if(I=I||1,N===s&&(N=w,w=0),w===N||I===0)return[];if(w<N&&I<0)return[];if(w>N&&I>0)return[];if(I>0)for(y=w;y<N;y+=I)R.push(y);else for(y=w;y>N;y+=I)R.push(y);return R},l.slice=(function(){function E(N,I,R,y){var M,D=[],P=N.length;if(I===s&&R===s&&y===s)return l.copy(N);if(I=I||0,R=R||N.length,I=I>=0?I:P+I,R=R>=0?R:P+R,y=y||1,I===R||y===0)return[];if(I<R&&y<0)return[];if(I>R&&y>0)return[];if(y>0)for(M=I;M<R;M+=y)D.push(N[M]);else for(M=I;M>R;M+=y)D.push(N[M]);return D}function w(N,I){var R,y;if(I=I||{},i(I.row)){if(i(I.col))return N[I.row][I.col];var M=l.rowa(N,I.row);return R=I.col||{},E(M,R.start,R.end,R.step)}if(i(I.col)){var D=l.cola(N,I.col);return y=I.row||{},E(D,y.start,y.end,y.step)}y=I.row||{},R=I.col||{};var P=E(N,y.start,y.end,y.step);return P.map(function(z){return E(z,R.start,R.end,R.step)})}return w})(),l.sliceAssign=function(w,N,I){var R,y;if(i(N.row)){if(i(N.col))return w[N.row][N.col]=I;N.col=N.col||{},N.col.start=N.col.start||0,N.col.end=N.col.end||w[0].length,N.col.step=N.col.step||1,R=l.arange(N.col.start,r.min(w.length,N.col.end),N.col.step);var M=N.row;return R.forEach(function(P,z){w[M][P]=I[z]}),w}if(i(N.col)){N.row=N.row||{},N.row.start=N.row.start||0,N.row.end=N.row.end||w.length,N.row.step=N.row.step||1,y=l.arange(N.row.start,r.min(w[0].length,N.row.end),N.row.step);var D=N.col;return y.forEach(function(P,z){w[P][D]=I[z]}),w}return I[0].length===s&&(I=[I]),N.row.start=N.row.start||0,N.row.end=N.row.end||w.length,N.row.step=N.row.step||1,N.col.start=N.col.start||0,N.col.end=N.col.end||w[0].length,N.col.step=N.col.step||1,y=l.arange(N.row.start,r.min(w.length,N.row.end),N.row.step),R=l.arange(N.col.start,r.min(w[0].length,N.col.end),N.col.step),y.forEach(function(P,z){R.forEach(function(G,S){w[P][G]=I[z][S]})}),w},l.diagonal=function(w){var N=l.zeros(w.length,w.length);return w.forEach(function(I,R){N[R][R]=I}),N},l.copy=function(w){return w.map(function(N){return i(N)?N:N.map(function(I){return I})})};var m=l.prototype;return m.length=0,m.push=Array.prototype.push,m.sort=Array.prototype.sort,m.splice=Array.prototype.splice,m.slice=Array.prototype.slice,m.toArray=function(){return this.length>1?a.call(this):a.call(this)[0]},m.map=function(w,N){return l(l.map(this,w,N))},m.cumreduce=function(w,N){return l(l.cumreduce(this,w,N))},m.alter=function(w){return l.alter(this,w),this},(function(E){for(var w=0;w<E.length;w++)(function(N){m[N]=function(I){var R=this,y;return I?(setTimeout(function(){I.call(R,m[N].call(R))}),this):(y=l[N](this),f(y)?l(y):y)}})(E[w])})("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),(function(E){for(var w=0;w<E.length;w++)(function(N){m[N]=function(I,R){var y=this;return R?(setTimeout(function(){R.call(y,m[N].call(y,I))}),this):l(l[N](this,I))}})(E[w])})("row col".split(" ")),(function(E){for(var w=0;w<E.length;w++)(function(N){m[N]=function(){return l(l[N].apply(null,arguments))}})(E[w])})("create zeros ones rand identity".split(" ")),l})(Math);return(function(r,s){var c=r.utils.isFunction;function a(f,o){return f-o}function h(f,o,i){return s.max(o,s.min(f,i))}r.sum=function(o){for(var i=0,u=o.length;--u>=0;)i+=o[u];return i},r.sumsqrd=function(o){for(var i=0,u=o.length;--u>=0;)i+=o[u]*o[u];return i},r.sumsqerr=function(o){for(var i=r.mean(o),u=0,l=o.length,d;--l>=0;)d=o[l]-i,u+=d*d;return u},r.sumrow=function(o){for(var i=0,u=o.length;--u>=0;)i+=o[u];return i},r.product=function(o){for(var i=1,u=o.length;--u>=0;)i*=o[u];return i},r.min=function(o){for(var i=o[0],u=0;++u<o.length;)o[u]<i&&(i=o[u]);return i},r.max=function(o){for(var i=o[0],u=0;++u<o.length;)o[u]>i&&(i=o[u]);return i},r.unique=function(o){for(var i={},u=[],l=0;l<o.length;l++)i[o[l]]||(i[o[l]]=!0,u.push(o[l]));return u},r.mean=function(o){return r.sum(o)/o.length},r.meansqerr=function(o){return r.sumsqerr(o)/o.length},r.geomean=function(o){var i=o.map(s.log),u=r.mean(i);return s.exp(u)},r.median=function(o){var i=o.length,u=o.slice().sort(a);return i&1?u[i/2|0]:(u[i/2-1]+u[i/2])/2},r.cumsum=function(o){return r.cumreduce(o,function(i,u){return i+u})},r.cumprod=function(o){return r.cumreduce(o,function(i,u){return i*u})},r.diff=function(o){var i=[],u=o.length,l;for(l=1;l<u;l++)i.push(o[l]-o[l-1]);return i},r.rank=function(f){var o,i=[],u={};for(o=0;o<f.length;o++){var l=f[o];u[l]?u[l]++:(u[l]=1,i.push(l))}var d=i.sort(a),v={},p=1;for(o=0;o<d.length;o++){var l=d[o],m=u[l],E=p,w=p+m-1,N=(E+w)/2;v[l]=N,p+=m}return f.map(function(I){return v[I]})},r.mode=function(o){var i=o.length,u=o.slice().sort(a),l=1,d=0,v=0,p=[],m;for(m=0;m<i;m++)u[m]===u[m+1]?l++:(l>d?(p=[u[m]],d=l,v=0):l===d&&(p.push(u[m]),v++),l=1);return v===0?p[0]:p},r.range=function(o){return r.max(o)-r.min(o)},r.variance=function(o,i){return r.sumsqerr(o)/(o.length-(i?1:0))},r.pooledvariance=function(o){var i=o.reduce(function(l,d){return l+r.sumsqerr(d)},0),u=o.reduce(function(l,d){return l+d.length},0);return i/(u-o.length)},r.deviation=function(f){for(var o=r.mean(f),i=f.length,u=new Array(i),l=0;l<i;l++)u[l]=f[l]-o;return u},r.stdev=function(o,i){return s.sqrt(r.variance(o,i))},r.pooledstdev=function(o){return s.sqrt(r.pooledvariance(o))},r.meandev=function(o){for(var i=r.mean(o),u=[],l=o.length-1;l>=0;l--)u.push(s.abs(o[l]-i));return r.mean(u)},r.meddev=function(o){for(var i=r.median(o),u=[],l=o.length-1;l>=0;l--)u.push(s.abs(o[l]-i));return r.median(u)},r.coeffvar=function(o){return r.stdev(o)/r.mean(o)},r.quartiles=function(o){var i=o.length,u=o.slice().sort(a);return[u[s.round(i/4)-1],u[s.round(i/2)-1],u[s.round(i*3/4)-1]]},r.quantiles=function(o,i,u,l){var d=o.slice().sort(a),v=[i.length],p=o.length,m,E,w,N,I,R;for(typeof u>"u"&&(u=3/8),typeof l>"u"&&(l=3/8),m=0;m<i.length;m++)E=i[m],w=u+E*(1-u-l),N=p*E+w,I=s.floor(h(N,1,p-1)),R=h(N-I,0,1),v[m]=(1-R)*d[I-1]+R*d[I];return v},r.percentile=function(o,i,u){var l=o.slice().sort(a),d=i*(l.length+(u?1:-1))+(u?0:1),v=parseInt(d),p=d-v;return v+1<l.length?l[v-1]+p*(l[v]-l[v-1]):l[v-1]},r.percentileOfScore=function(o,i,u){var l=0,d=o.length,v=!1,p,m;for(u==="strict"&&(v=!0),m=0;m<d;m++)p=o[m],(v&&p<i||!v&&p<=i)&&l++;return l/d},r.histogram=function(o,i){i=i||4;var u=r.min(o),l=(r.max(o)-u)/i,d=o.length,v=[],p;for(p=0;p<i;p++)v[p]=0;for(p=0;p<d;p++)v[s.min(s.floor((o[p]-u)/l),i-1)]+=1;return v},r.covariance=function(o,i){var u=r.mean(o),l=r.mean(i),d=o.length,v=new Array(d),p;for(p=0;p<d;p++)v[p]=(o[p]-u)*(i[p]-l);return r.sum(v)/(d-1)},r.corrcoeff=function(o,i){return r.covariance(o,i)/r.stdev(o,1)/r.stdev(i,1)},r.spearmancoeff=function(f,o){return f=r.rank(f),o=r.rank(o),r.corrcoeff(f,o)},r.stanMoment=function(o,i){for(var u=r.mean(o),l=r.stdev(o),d=o.length,v=0,p=0;p<d;p++)v+=s.pow((o[p]-u)/l,i);return v/o.length},r.skewness=function(o){return r.stanMoment(o,3)},r.kurtosis=function(o){return r.stanMoment(o,4)-3};var g=r.prototype;(function(f){for(var o=0;o<f.length;o++)(function(i){g[i]=function(u,l){var d=[],v=0,p=this;if(c(u)&&(l=u,u=!1),l)return setTimeout(function(){l.call(p,g[i].call(p,u))}),this;if(this.length>1){for(p=u===!0?this:this.transpose();v<p.length;v++)d[v]=r[i](p[v]);return d}return r[i](this[0],u)}})(f[o])})("cumsum cumprod".split(" ")),(function(f){for(var o=0;o<f.length;o++)(function(i){g[i]=function(u,l){var d=[],v=0,p=this;if(c(u)&&(l=u,u=!1),l)return setTimeout(function(){l.call(p,g[i].call(p,u))}),this;if(this.length>1){for(i!=="sumrow"&&(p=u===!0?this:this.transpose());v<p.length;v++)d[v]=r[i](p[v]);return u===!0?r[i](r.utils.toVector(d)):d}return r[i](this[0],u)}})(f[o])})("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),(function(f){for(var o=0;o<f.length;o++)(function(i){g[i]=function(){var u=[],l=0,d=this,v=Array.prototype.slice.call(arguments),p;if(c(v[v.length-1])){p=v[v.length-1];var m=v.slice(0,v.length-1);return setTimeout(function(){p.call(d,g[i].apply(d,m))}),this}else{p=void 0;var E=function(N){return r[i].apply(d,[N].concat(v))}}if(this.length>1){for(d=d.transpose();l<d.length;l++)u[l]=E(d[l]);return u}return E(this[0])}})(f[o])})("quantiles percentileOfScore".split(" "))})(t,Math),(function(r,s){r.gammaln=function(a){var h=0,g=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015,o,i,u;for(u=(i=o=a)+5.5,u-=(o+.5)*s.log(u);h<6;h++)f+=g[h]/++i;return s.log(2.5066282746310007*f/o)-u},r.loggam=function(a){var h,g,f,o,i,u,l,d=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(h=a,l=0,a==1||a==2)return 0;for(a<=7&&(l=s.floor(7-a),h=a+l),g=1/(h*h),f=2*s.PI,i=d[9],u=8;u>=0;u--)i*=g,i+=d[u];if(o=i/h+.5*s.log(f)+(h-.5)*s.log(h)-h,a<=7)for(u=1;u<=l;u++)o-=s.log(h-1),h-=1;return o},r.gammafn=function(a){var h=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],g=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,o=0,i=0,u=0,l=a,d,v,p,m;if(a>171.6243769536076)return 1/0;if(l<=0)if(m=l%1+36e-17,m)f=(l&1?-1:1)*s.PI/s.sin(s.PI*m),l=1-l;else return 1/0;for(p=l,l<1?v=l++:v=(l-=o=(l|0)-1)-1,d=0;d<8;++d)u=(u+h[d])*v,i=i*v+g[d];if(m=u/i+1,p<l)m/=p;else if(p>l)for(d=0;d<o;++d)m*=l,l++;return f&&(m=f/m),m},r.gammap=function(a,h){return r.lowRegGamma(a,h)*r.gammafn(a)},r.lowRegGamma=function(a,h){var g=r.gammaln(a),f=a,o=1/a,i=o,u=h+1-a,l=1/1e-30,d=1/u,v=d,p=1,m=-~(s.log(a>=1?a:1/a)*8.5+a*.4+17),E;if(h<0||a<=0)return NaN;if(h<a+1){for(;p<=m;p++)o+=i*=h/++f;return o*s.exp(-h+a*s.log(h)-g)}for(;p<=m;p++)E=-p*(p-a),u+=2,d=E*d+u,l=u+E/l,d=1/d,v*=d*l;return 1-v*s.exp(-h+a*s.log(h)-g)},r.factorialln=function(a){return a<0?NaN:r.gammaln(a+1)},r.factorial=function(a){return a<0?NaN:r.gammafn(a+1)},r.combination=function(a,h){return a>170||h>170?s.exp(r.combinationln(a,h)):r.factorial(a)/r.factorial(h)/r.factorial(a-h)},r.combinationln=function(a,h){return r.factorialln(a)-r.factorialln(h)-r.factorialln(a-h)},r.permutation=function(a,h){return r.factorial(a)/r.factorial(a-h)},r.betafn=function(a,h){if(!(a<=0||h<=0))return a+h>170?s.exp(r.betaln(a,h)):r.gammafn(a)*r.gammafn(h)/r.gammafn(a+h)},r.betaln=function(a,h){return r.gammaln(a)+r.gammaln(h)-r.gammaln(a+h)},r.betacf=function(a,h,g){var f=1e-30,o=1,i=h+g,u=h+1,l=h-1,d=1,v=1-i*a/u,p,m,E,w;for(s.abs(v)<f&&(v=f),v=1/v,w=v;o<=100&&(p=2*o,m=o*(g-o)*a/((l+p)*(h+p)),v=1+m*v,s.abs(v)<f&&(v=f),d=1+m/d,s.abs(d)<f&&(d=f),v=1/v,w*=v*d,m=-(h+o)*(i+o)*a/((h+p)*(u+p)),v=1+m*v,s.abs(v)<f&&(v=f),d=1+m/d,s.abs(d)<f&&(d=f),v=1/v,E=v*d,w*=E,!(s.abs(E-1)<3e-7));o++);return w},r.gammapinv=function(a,h){var g=0,f=h-1,o=1e-8,i=r.gammaln(h),u,l,d,v,p,m,E;if(a>=1)return s.max(100,h+100*s.sqrt(h));if(a<=0)return 0;for(h>1?(m=s.log(f),E=s.exp(f*(m-1)-i),p=a<.5?a:1-a,d=s.sqrt(-2*s.log(p)),u=(2.30753+d*.27061)/(1+d*(.99229+d*.04481))-d,a<.5&&(u=-u),u=s.max(.001,h*s.pow(1-1/(9*h)-u/(3*s.sqrt(h)),3))):(d=1-h*(.253+h*.12),a<d?u=s.pow(a/d,1/h):u=1-s.log(1-(a-d)/(1-d)));g<12;g++){if(u<=0)return 0;if(l=r.lowRegGamma(h,u)-a,h>1?d=E*s.exp(-(u-f)+f*(s.log(u)-m)):d=s.exp(-u+f*s.log(u)-i),v=l/d,u-=d=v/(1-.5*s.min(1,v*((h-1)/u-1))),u<=0&&(u=.5*(u+d)),s.abs(d)<o*u)break}return u},r.erf=function(a){var h=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],g=h.length-1,f=!1,o=0,i=0,u,l,d,v;for(a<0&&(a=-a,f=!0),u=2/(2+a),l=4*u-2;g>0;g--)d=o,o=l*o-i+h[g],i=d;return v=u*s.exp(-a*a+.5*(h[0]+l*o)-i),f?v-1:1-v},r.erfc=function(a){return 1-r.erf(a)},r.erfcinv=function(a){var h=0,g,f,o,i;if(a>=2)return-100;if(a<=0)return 100;for(i=a<1?a:2-a,o=s.sqrt(-2*s.log(i/2)),g=-.70711*((2.30753+o*.27061)/(1+o*(.99229+o*.04481))-o);h<2;h++)f=r.erfc(g)-i,g+=f/(1.1283791670955126*s.exp(-g*g)-g*f);return a<1?g:-g},r.ibetainv=function(a,h,g){var f=1e-8,o=h-1,i=g-1,u=0,l,d,v,p,m,E,w,N,I,R,y;if(a<=0)return 0;if(a>=1)return 1;for(h>=1&&g>=1?(v=a<.5?a:1-a,p=s.sqrt(-2*s.log(v)),w=(2.30753+p*.27061)/(1+p*(.99229+p*.04481))-p,a<.5&&(w=-w),N=(w*w-3)/6,I=2/(1/(2*h-1)+1/(2*g-1)),R=w*s.sqrt(N+I)/I-(1/(2*g-1)-1/(2*h-1))*(N+5/6-2/(3*I)),w=h/(h+g*s.exp(2*R))):(l=s.log(h/(h+g)),d=s.log(g/(h+g)),p=s.exp(h*l)/h,m=s.exp(g*d)/g,R=p+m,a<p/R?w=s.pow(h*R*a,1/h):w=1-s.pow(g*R*(1-a),1/g)),y=-r.gammaln(h)-r.gammaln(g)+r.gammaln(h+g);u<10;u++){if(w===0||w===1)return w;if(E=r.ibeta(w,h,g)-a,p=s.exp(o*s.log(w)+i*s.log(1-w)+y),m=E/p,w-=p=m/(1-.5*s.min(1,m*(o/w-i/(1-w)))),w<=0&&(w=.5*(w+p)),w>=1&&(w=.5*(w+p+1)),s.abs(p)<f*w&&u>0)break}return w},r.ibeta=function(a,h,g){var f=a===0||a===1?0:s.exp(r.gammaln(h+g)-r.gammaln(h)-r.gammaln(g)+h*s.log(a)+g*s.log(1-a));return a<0||a>1?!1:a<(h+1)/(h+g+2)?f*r.betacf(a,h,g)/h:1-f*r.betacf(1-a,g,h)/g},r.randn=function(a,h){var g,f,o,i,u;if(h||(h=a),a)return r.create(a,h,function(){return r.randn()});do g=r._random_fn(),f=1.7156*(r._random_fn()-.5),o=g-.449871,i=s.abs(f)+.386595,u=o*o+i*(.196*i-.25472*o);while(u>.27597&&(u>.27846||f*f>-4*s.log(g)*g*g));return f/g},r.randg=function(a,h,g){var f=a,o,i,u,l,d,v;if(g||(g=h),a||(a=1),h)return v=r.zeros(h,g),v.alter(function(){return r.randg(a)}),v;a<1&&(a+=1),o=a-1/3,i=1/s.sqrt(9*o);do{do d=r.randn(),l=1+i*d;while(l<=0);l=l*l*l,u=r._random_fn()}while(u>1-.331*s.pow(d,4)&&s.log(u)>.5*d*d+o*(1-l+s.log(l)));if(a==f)return o*l;do u=r._random_fn();while(u===0);return s.pow(u,1/f)*o*l},(function(c){for(var a=0;a<c.length;a++)(function(h){r.fn[h]=function(){return r(r.map(this,function(g){return r[h](g)}))}})(c[a])})("gammaln gammafn factorial factorialln".split(" ")),(function(c){for(var a=0;a<c.length;a++)(function(h){r.fn[h]=function(){return r(r[h].apply(null,arguments))}})(c[a])})("randn".split(" "))})(t,Math),(function(r,s){(function(f){for(var o=0;o<f.length;o++)(function(i){r[i]=function u(l,d,v){return this instanceof u?(this._a=l,this._b=d,this._c=v,this):new u(l,d,v)},r.fn[i]=function(u,l,d){var v=r[i](u,l,d);return v.data=this,v},r[i].prototype.sample=function(u){var l=this._a,d=this._b,v=this._c;return u?r.alter(u,function(){return r[i].sample(l,d,v)}):r[i].sample(l,d,v)},(function(u){for(var l=0;l<u.length;l++)(function(d){r[i].prototype[d]=function(v){var p=this._a,m=this._b,E=this._c;return!v&&v!==0&&(v=this.data),typeof v!="number"?r.fn.map.call(v,function(w){return r[i][d](w,p,m,E)}):r[i][d](v,p,m,E)}})(u[l])})("pdf cdf inv".split(" ")),(function(u){for(var l=0;l<u.length;l++)(function(d){r[i].prototype[d]=function(){return r[i][d](this._a,this._b,this._c)}})(u[l])})("mean median mode variance".split(" "))})(f[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(o,i,u){return o>1||o<0?0:i==1&&u==1?1:i<512&&u<512?s.pow(o,i-1)*s.pow(1-o,u-1)/r.betafn(i,u):s.exp((i-1)*s.log(o)+(u-1)*s.log(1-o)-r.betaln(i,u))},cdf:function(o,i,u){return o>1||o<0?(o>1)*1:r.ibeta(o,i,u)},inv:function(o,i,u){return r.ibetainv(o,i,u)},mean:function(o,i){return o/(o+i)},median:function(o,i){return r.ibetainv(.5,o,i)},mode:function(o,i){return(o-1)/(o+i-2)},sample:function(o,i){var u=r.randg(o);return u/(u+r.randg(i))},variance:function(o,i){return o*i/(s.pow(o+i,2)*(o+i+1))}}),r.extend(r.centralF,{pdf:function(o,i,u){var l,d,v;return o<0?0:i<=2?o===0&&i<2?1/0:o===0&&i===2?1:1/r.betafn(i/2,u/2)*s.pow(i/u,i/2)*s.pow(o,i/2-1)*s.pow(1+i/u*o,-(i+u)/2):(l=i*o/(u+o*i),d=u/(u+o*i),v=i*d/2,v*r.binomial.pdf((i-2)/2,(i+u-2)/2,l))},cdf:function(o,i,u){return o<0?0:r.ibeta(i*o/(i*o+u),i/2,u/2)},inv:function(o,i,u){return u/(i*(1/r.ibetainv(o,i/2,u/2)-1))},mean:function(o,i){return i>2?i/(i-2):void 0},mode:function(o,i){return o>2?i*(o-2)/(o*(i+2)):void 0},sample:function(o,i){var u=r.randg(o/2)*2,l=r.randg(i/2)*2;return u/o/(l/i)},variance:function(o,i){if(!(i<=4))return 2*i*i*(o+i-2)/(o*(i-2)*(i-2)*(i-4))}}),r.extend(r.cauchy,{pdf:function(o,i,u){return u<0?0:u/(s.pow(o-i,2)+s.pow(u,2))/s.PI},cdf:function(o,i,u){return s.atan((o-i)/u)/s.PI+.5},inv:function(f,o,i){return o+i*s.tan(s.PI*(f-.5))},median:function(o){return o},mode:function(o){return o},sample:function(o,i){return r.randn()*s.sqrt(1/(2*r.randg(.5)))*i+o}}),r.extend(r.chisquare,{pdf:function(o,i){return o<0?0:o===0&&i===2?.5:s.exp((i/2-1)*s.log(o)-o/2-i/2*s.log(2)-r.gammaln(i/2))},cdf:function(o,i){return o<0?0:r.lowRegGamma(i/2,o/2)},inv:function(f,o){return 2*r.gammapinv(f,.5*o)},mean:function(f){return f},median:function(o){return o*s.pow(1-2/(9*o),3)},mode:function(o){return o-2>0?o-2:0},sample:function(o){return r.randg(o/2)*2},variance:function(o){return 2*o}}),r.extend(r.exponential,{pdf:function(o,i){return o<0?0:i*s.exp(-i*o)},cdf:function(o,i){return o<0?0:1-s.exp(-i*o)},inv:function(f,o){return-s.log(1-f)/o},mean:function(f){return 1/f},median:function(f){return 1/f*s.log(2)},mode:function(){return 0},sample:function(o){return-1/o*s.log(r._random_fn())},variance:function(f){return s.pow(f,-2)}}),r.extend(r.gamma,{pdf:function(o,i,u){return o<0?0:o===0&&i===1?1/u:s.exp((i-1)*s.log(o)-o/u-r.gammaln(i)-i*s.log(u))},cdf:function(o,i,u){return o<0?0:r.lowRegGamma(i,o/u)},inv:function(f,o,i){return r.gammapinv(f,o)*i},mean:function(f,o){return f*o},mode:function(o,i){if(o>1)return(o-1)*i},sample:function(o,i){return r.randg(o)*i},variance:function(o,i){return o*i*i}}),r.extend(r.invgamma,{pdf:function(o,i,u){return o<=0?0:s.exp(-(i+1)*s.log(o)-u/o-r.gammaln(i)+i*s.log(u))},cdf:function(o,i,u){return o<=0?0:1-r.lowRegGamma(i,u/o)},inv:function(f,o,i){return i/r.gammapinv(1-f,o)},mean:function(f,o){return f>1?o/(f-1):void 0},mode:function(o,i){return i/(o+1)},sample:function(o,i){return i/r.randg(o)},variance:function(o,i){if(!(o<=2))return i*i/((o-1)*(o-1)*(o-2))}}),r.extend(r.kumaraswamy,{pdf:function(o,i,u){return o===0&&i===1?u:o===1&&u===1?i:s.exp(s.log(i)+s.log(u)+(i-1)*s.log(o)+(u-1)*s.log(1-s.pow(o,i)))},cdf:function(o,i,u){return o<0?0:o>1?1:1-s.pow(1-s.pow(o,i),u)},inv:function(o,i,u){return s.pow(1-s.pow(1-o,1/u),1/i)},mean:function(f,o){return o*r.gammafn(1+1/f)*r.gammafn(o)/r.gammafn(1+1/f+o)},median:function(o,i){return s.pow(1-s.pow(2,-1/i),1/o)},mode:function(o,i){if(o>=1&&i>=1&&o!==1&&i!==1)return s.pow((o-1)/(o*i-1),1/o)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(o,i,u){return o<=0?0:s.exp(-s.log(o)-.5*s.log(2*s.PI)-s.log(u)-s.pow(s.log(o)-i,2)/(2*u*u))},cdf:function(o,i,u){return o<0?0:.5+.5*r.erf((s.log(o)-i)/s.sqrt(2*u*u))},inv:function(f,o,i){return s.exp(-1.4142135623730951*i*r.erfcinv(2*f)+o)},mean:function(o,i){return s.exp(o+i*i/2)},median:function(o){return s.exp(o)},mode:function(o,i){return s.exp(o-i*i)},sample:function(o,i){return s.exp(r.randn()*i+o)},variance:function(o,i){return(s.exp(i*i)-1)*s.exp(2*o+i*i)}}),r.extend(r.noncentralt,{pdf:function(o,i,u){var l=1e-14;return s.abs(u)<l?r.studentt.pdf(o,i):s.abs(o)<l?s.exp(r.gammaln((i+1)/2)-u*u/2-.5*s.log(s.PI*i)-r.gammaln(i/2)):i/o*(r.noncentralt.cdf(o*s.sqrt(1+2/i),i+2,u)-r.noncentralt.cdf(o,i,u))},cdf:function(o,i,u){var l=1e-14,d=200;if(s.abs(u)<l)return r.studentt.cdf(o,i);var v=!1;o<0&&(v=!0,u=-u);for(var p=r.normal.cdf(-u,0,1),m=l+1,E=m,w=o*o/(o*o+i),N=0,I=s.exp(-u*u/2),R=s.exp(-u*u/2-.5*s.log(2)-r.gammaln(3/2))*u;N<d||E>l||m>l;)E=m,N>0&&(I*=u*u/(2*N),R*=u*u/(2*(N+1/2))),m=I*r.beta.cdf(w,N+.5,i/2)+R*r.beta.cdf(w,N+1,i/2),p+=.5*m,N++;return v?1-p:p}}),r.extend(r.normal,{pdf:function(o,i,u){return s.exp(-.5*s.log(2*s.PI)-s.log(u)-s.pow(o-i,2)/(2*u*u))},cdf:function(o,i,u){return .5*(1+r.erf((o-i)/s.sqrt(2*u*u)))},inv:function(f,o,i){return-1.4142135623730951*i*r.erfcinv(2*f)+o},mean:function(f){return f},median:function(o){return o},mode:function(f){return f},sample:function(o,i){return r.randn()*i+o},variance:function(f,o){return o*o}}),r.extend(r.pareto,{pdf:function(o,i,u){return o<i?0:u*s.pow(i,u)/s.pow(o,u+1)},cdf:function(o,i,u){return o<i?0:1-s.pow(i/o,u)},inv:function(o,i,u){return i/s.pow(1-o,1/u)},mean:function(o,i){if(!(i<=1))return i*s.pow(o,i)/(i-1)},median:function(o,i){return o*(i*s.SQRT2)},mode:function(o){return o},variance:function(f,o){if(!(o<=2))return f*f*o/(s.pow(o-1,2)*(o-2))}}),r.extend(r.studentt,{pdf:function(o,i){return i=i>1e100?1e100:i,1/(s.sqrt(i)*r.betafn(.5,i/2))*s.pow(1+o*o/i,-((i+1)/2))},cdf:function(o,i){var u=i/2;return r.ibeta((o+s.sqrt(o*o+i))/(2*s.sqrt(o*o+i)),u,u)},inv:function(f,o){var i=r.ibetainv(2*s.min(f,1-f),.5*o,.5);return i=s.sqrt(o*(1-i)/i),f>.5?i:-i},mean:function(o){return o>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(o){return r.randn()*s.sqrt(o/(2*r.randg(o/2)))},variance:function(o){return o>2?o/(o-2):o>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(o,i,u){return o<0||i<0||u<0?0:u/i*s.pow(o/i,u-1)*s.exp(-s.pow(o/i,u))},cdf:function(o,i,u){return o<0?0:1-s.exp(-s.pow(o/i,u))},inv:function(f,o,i){return o*s.pow(-s.log(1-f),1/i)},mean:function(f,o){return f*r.gammafn(1+1/o)},median:function(o,i){return o*s.pow(s.log(2),1/i)},mode:function(o,i){return i<=1?0:o*s.pow((i-1)/i,1/i)},sample:function(o,i){return o*s.pow(-s.log(r._random_fn()),1/i)},variance:function(o,i){return o*o*r.gammafn(1+2/i)-s.pow(r.weibull.mean(o,i),2)}}),r.extend(r.uniform,{pdf:function(o,i,u){return o<i||o>u?0:1/(u-i)},cdf:function(o,i,u){return o<i?0:o<u?(o-i)/(u-i):1},inv:function(f,o,i){return o+f*(i-o)},mean:function(o,i){return .5*(o+i)},median:function(o,i){return r.mean(o,i)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,i){return o/2+i/2+(i/2-o/2)*(2*r._random_fn()-1)},variance:function(o,i){return s.pow(i-o,2)/12}});function c(f,o,i,u){for(var l=0,d=1,v=1,p=1,m=0,E=0,w;s.abs((v-E)/v)>u;)E=v,w=-(o+m)*(o+i+m)*f/(o+2*m)/(o+2*m+1),l=v+w*l,d=p+w*d,m=m+1,w=m*(i-m)*f/(o+2*m-1)/(o+2*m),v=l+w*v,p=d+w*p,l=l/p,d=d/p,v=v/p,p=1;return v/o}r.extend(r.binomial,{pdf:function(o,i,u){return u===0||u===1?i*u===o?1:0:r.combination(i,o)*s.pow(u,o)*s.pow(1-u,i-o)},cdf:function(o,i,u){var l,d=1e-10;if(o<0)return 0;if(o>=i)return 1;if(u<0||u>1||i<=0)return NaN;o=s.floor(o);var v=u,p=o+1,m=i-o,E=p+m,w=s.exp(r.gammaln(E)-r.gammaln(m)-r.gammaln(p)+p*s.log(v)+m*s.log(1-v));return v<(p+1)/(E+2)?l=w*c(v,p,m,d):l=1-w*c(1-v,m,p,d),s.round((1-l)*(1/d))/(1/d)}}),r.extend(r.negbin,{pdf:function(o,i,u){return o!==o>>>0?!1:o<0?0:r.combination(o+i-1,i-1)*s.pow(1-u,o)*s.pow(u,i)},cdf:function(o,i,u){var l=0,d=0;if(o<0)return 0;for(;d<=o;d++)l+=r.negbin.pdf(d,i,u);return l}}),r.extend(r.hypgeom,{pdf:function(o,i,u,l){if(o!==o|0)return!1;if(o<0||o<u-(i-l))return 0;if(o>l||o>u)return 0;if(u*2>i)return l*2>i?r.hypgeom.pdf(i-u-l+o,i,i-u,i-l):r.hypgeom.pdf(l-o,i,i-u,l);if(l*2>i)return r.hypgeom.pdf(u-o,i,u,i-l);if(u<l)return r.hypgeom.pdf(o,i,l,u);for(var d=1,v=0,p=0;p<o;p++){for(;d>1&&v<l;)d*=1-u/(i-v),v++;d*=(l-p)*(u-p)/((p+1)*(i-u-l+p+1))}for(;v<l;v++)d*=1-u/(i-v);return s.min(1,s.max(0,d))},cdf:function(o,i,u,l){if(o<0||o<u-(i-l))return 0;if(o>=l||o>=u)return 1;if(u*2>i)return l*2>i?r.hypgeom.cdf(i-u-l+o,i,i-u,i-l):1-r.hypgeom.cdf(l-o-1,i,i-u,l);if(l*2>i)return 1-r.hypgeom.cdf(u-o-1,i,u,i-l);if(u<l)return r.hypgeom.cdf(o,i,l,u);for(var d=1,v=1,p=0,m=0;m<o;m++){for(;d>1&&p<l;){var E=1-u/(i-p);v*=E,d*=E,p++}v*=(l-m)*(u-m)/((m+1)*(i-u-l+m+1)),d+=v}for(;p<l;p++)d*=1-u/(i-p);return s.min(1,s.max(0,d))}}),r.extend(r.poisson,{pdf:function(o,i){return i<0||o%1!==0||o<0?0:s.pow(i,o)*s.exp(-i)/r.factorial(o)},cdf:function(o,i){var u=[],l=0;if(o<0)return 0;for(;l<=o;l++)u.push(r.poisson.pdf(l,i));return r.sum(u)},mean:function(f){return f},variance:function(f){return f},sampleSmall:function(o){var i=1,u=0,l=s.exp(-o);do u++,i*=r._random_fn();while(i>l);return u-1},sampleLarge:function(o){var i=o,u,l,d,v,p,m,E,w,N,I;for(v=s.sqrt(i),p=s.log(i),E=.931+2.53*v,m=-.059+.02483*E,w=1.1239+1.1328/(E-3.4),N=.9277-3.6224/(E-2);;){if(l=s.random()-.5,d=s.random(),I=.5-s.abs(l),u=s.floor((2*m/I+E)*l+i+.43),I>=.07&&d<=N)return u;if(!(u<0||I<.013&&d>I)&&s.log(d)+s.log(w)-s.log(m/(I*I)+E)<=-i+u*p-r.loggam(u+1))return u}},sample:function(o){return o<10?this.sampleSmall(o):this.sampleLarge(o)}}),r.extend(r.triangular,{pdf:function(o,i,u,l){return u<=i||l<i||l>u?NaN:o<i||o>u?0:o<l?2*(o-i)/((u-i)*(l-i)):o===l?2/(u-i):2*(u-o)/((u-i)*(u-l))},cdf:function(o,i,u,l){return u<=i||l<i||l>u?NaN:o<=i?0:o>=u?1:o<=l?s.pow(o-i,2)/((u-i)*(l-i)):1-s.pow(u-o,2)/((u-i)*(u-l))},inv:function(o,i,u,l){return u<=i||l<i||l>u?NaN:o<=(l-i)/(u-i)?i+(u-i)*s.sqrt(o*((l-i)/(u-i))):i+(u-i)*(1-s.sqrt((1-o)*(1-(l-i)/(u-i))))},mean:function(o,i,u){return(o+i+u)/3},median:function(o,i,u){if(u<=(o+i)/2)return i-s.sqrt((i-o)*(i-u))/s.sqrt(2);if(u>(o+i)/2)return o+s.sqrt((i-o)*(u-o))/s.sqrt(2)},mode:function(o,i,u){return u},sample:function(o,i,u){var l=r._random_fn();return l<(u-o)/(i-o)?o+s.sqrt(l*(i-o)*(u-o)):i-s.sqrt((1-l)*(i-o)*(i-u))},variance:function(o,i,u){return(o*o+i*i+u*u-o*i-o*u-i*u)/18}}),r.extend(r.arcsine,{pdf:function(o,i,u){return u<=i?NaN:o<=i||o>=u?0:2/s.PI*s.pow(s.pow(u-i,2)-s.pow(2*o-i-u,2),-.5)},cdf:function(o,i,u){return o<i?0:o<u?2/s.PI*s.asin(s.sqrt((o-i)/(u-i))):1},inv:function(f,o,i){return o+(.5-.5*s.cos(s.PI*f))*(i-o)},mean:function(o,i){return i<=o?NaN:(o+i)/2},median:function(o,i){return i<=o?NaN:(o+i)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,i){return(o+i)/2+(i-o)/2*s.sin(2*s.PI*r.uniform.sample(0,1))},variance:function(o,i){return i<=o?NaN:s.pow(i-o,2)/8}});function a(f){return f/s.abs(f)}r.extend(r.laplace,{pdf:function(o,i,u){return u<=0?0:s.exp(-s.abs(o-i)/u)/(2*u)},cdf:function(o,i,u){return u<=0?0:o<i?.5*s.exp((o-i)/u):1-.5*s.exp(-(o-i)/u)},mean:function(f){return f},median:function(f){return f},mode:function(f){return f},variance:function(f,o){return 2*o*o},sample:function(o,i){var u=r._random_fn()-.5;return o-i*a(u)*s.log(1-2*s.abs(u))}});function h(f,o,i){var u=12,l=6,d=-30,v=-50,p=60,m=8,E=3,w=2,N=3,I=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],R=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],y=f*.5;if(y>=m)return 1;var M=2*r.normal.cdf(y,0,1,1,0)-1;M>=s.exp(v/i)?M=s.pow(M,i):M=0;var D;f>E?D=w:D=N;for(var P=y,z=(m-y)/D,G=P+z,S=0,_=i-1,ue=1;ue<=D;ue++){for(var ge=0,Y=.5*(G+P),j=.5*(G-P),ne=1;ne<=u;ne++){var re,B;l<ne?(re=u-ne+1,B=I[re-1]):(re=ne,B=-I[re-1]);var Q=j*B,q=Y+Q,k=q*q;if(k>p)break;var oe=2*r.normal.cdf(q,0,1,1,0),ae=2*r.normal.cdf(q,f,1,1,0),se=oe*.5-ae*.5;se>=s.exp(d/_)&&(se=R[re-1]*s.exp(-(.5*k))*s.pow(se,_),ge+=se)}ge*=2*j*i/s.sqrt(2*s.PI),S+=ge,P=G,G+=z}return M+=S,M<=s.exp(d/o)?0:(M=s.pow(M,o),M>=1?1:M)}function g(f,o,i){var u=.322232421088,l=.099348462606,d=-1,v=.588581570495,p=-.342242088547,m=.531103462366,E=-.204231210125,w=.10353775285,N=-453642210148e-16,I=.0038560700634,R=.8832,y=.2368,M=1.208,D=1.4142,P=120,z=.5-.5*f,G=s.sqrt(s.log(1/(z*z))),S=G+((((G*N+E)*G+p)*G+d)*G+u)/((((G*I+w)*G+m)*G+v)*G+l);i<P&&(S+=(S*S*S+S)/i/4);var _=R-y*S;return i<P&&(_+=-1.214/i+M*S/i),S*(_*s.log(o-1)+D)}r.extend(r.tukey,{cdf:function(o,i,u){var l=1,d=i,v=16,p=8,m=-30,E=1e-14,w=100,N=800,I=5e3,R=25e3,y=1,M=.5,D=.25,P=.125,z=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],G=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(o<=0)return 0;if(u<2||l<1||d<2)return NaN;if(!Number.isFinite(o))return 1;if(u>R)return h(o,l,d);var S=u*.5,_=S*s.log(u)-u*s.log(2)-r.gammaln(S),ue=S-1,ge=u*.25,Y;u<=w?Y=y:u<=N?Y=M:u<=I?Y=D:Y=P,_+=s.log(Y);for(var j=0,ne=1;ne<=50;ne++){for(var re=0,B=(2*ne-1)*Y,Q=1;Q<=v;Q++){var q,k;p<Q?(q=Q-p-1,k=_+ue*s.log(B+z[q]*Y)-(z[q]*Y+B)*ge):(q=Q-1,k=_+ue*s.log(B-z[q]*Y)+(z[q]*Y-B)*ge);var oe;if(k>=m){p<Q?oe=o*s.sqrt((z[q]*Y+B)*.5):oe=o*s.sqrt((-(z[q]*Y)+B)*.5);var ae=h(oe,l,d),se=ae*G[q]*s.exp(k);re+=se}}if(ne*Y>=1&&re<=E)break;j+=re}if(re>E)throw new Error("tukey.cdf failed to converge");return j>1&&(j=1),j},inv:function(f,o,i){var u=1,l=o,d=1e-4,v=50;if(i<2||u<1||l<2)return NaN;if(f<0||f>1)return NaN;if(f===0)return 0;if(f===1)return 1/0;var p=g(f,l,i),m=r.tukey.cdf(p,o,i)-f,E;m>0?E=s.max(0,p-1):E=p+1;for(var w=r.tukey.cdf(E,o,i)-f,N,I=1;I<v;I++){N=E-w*(E-p)/(w-m),m=w,p=E,N<0&&(N=0,w=-f),w=r.tukey.cdf(N,o,i)-f,E=N;var R=s.abs(E-p);if(R<d)return N}throw new Error("tukey.inv failed to converge")}})})(t,Math),(function(r,s){var c=Array.prototype.push,a=r.utils.isArray;function h(g){return a(g)||g instanceof r}r.extend({add:function(f,o){return h(o)?(h(o[0])||(o=[o]),r.map(f,function(i,u,l){return i+o[u][l]})):r.map(f,function(i){return i+o})},subtract:function(f,o){return h(o)?(h(o[0])||(o=[o]),r.map(f,function(i,u,l){return i-o[u][l]||0})):r.map(f,function(i){return i-o})},divide:function(f,o){return h(o)?(h(o[0])||(o=[o]),r.multiply(f,r.inv(o))):r.map(f,function(i){return i/o})},multiply:function(f,o){var i,u,l,d,v,p,m,E;if(f.length===void 0&&o.length===void 0)return f*o;if(v=f.length,p=f[0].length,m=r.zeros(v,l=h(o)?o[0].length:p),E=0,h(o)){for(;E<l;E++)for(i=0;i<v;i++){for(d=0,u=0;u<p;u++)d+=f[i][u]*o[u][E];m[i][E]=d}return v===1&&E===1?m[0][0]:m}return r.map(f,function(w){return w*o})},outer:function(f,o){return r.multiply(f.map(function(i){return[i]}),[o])},dot:function(f,o){h(f[0])||(f=[f]),h(o[0])||(o=[o]);for(var i=f[0].length===1&&f.length!==1?r.transpose(f):f,u=o[0].length===1&&o.length!==1?r.transpose(o):o,l=[],d=0,v=i.length,p=i[0].length,m,E;d<v;d++){for(l[d]=[],m=0,E=0;E<p;E++)m+=i[d][E]*u[d][E];l[d]=m}return l.length===1?l[0]:l},pow:function(f,o){return r.map(f,function(i){return s.pow(i,o)})},exp:function(f){return r.map(f,function(o){return s.exp(o)})},log:function(f){return r.map(f,function(o){return s.log(o)})},abs:function(f){return r.map(f,function(o){return s.abs(o)})},norm:function(f,o){var i=0,u=0;for(isNaN(o)&&(o=2),h(f[0])&&(f=f[0]);u<f.length;u++)i+=s.pow(s.abs(f[u]),o);return s.pow(i,1/o)},angle:function(f,o){return s.acos(r.dot(f,o)/(r.norm(f)*r.norm(o)))},aug:function(f,o){var i=[],u;for(u=0;u<f.length;u++)i.push(f[u].slice());for(u=0;u<i.length;u++)c.apply(i[u],o[u]);return i},inv:function(f){for(var o=f.length,i=f[0].length,u=r.identity(o,i),l=r.gauss_jordan(f,u),d=[],v=0,p;v<o;v++)for(d[v]=[],p=i;p<l[0].length;p++)d[v][p-i]=l[v][p];return d},det:function g(f){if(f.length===2)return f[0][0]*f[1][1]-f[0][1]*f[1][0];for(var o=0,i=0;i<f.length;i++){for(var u=[],l=1;l<f.length;l++){u[l-1]=[];for(var d=0;d<f.length;d++)d<i?u[l-1][d]=f[l][d]:d>i&&(u[l-1][d-1]=f[l][d])}var v=i%2?-1:1;o+=g(u)*f[0][i]*v}return o},gauss_elimination:function(f,o){var i=0,u=0,l=f.length,d=f[0].length,v=1,p=0,m=[],E,w,N,I;for(f=r.aug(f,o),E=f[0].length,i=0;i<l;i++){for(w=f[i][i],u=i,I=i+1;I<d;I++)w<s.abs(f[I][i])&&(w=f[I][i],u=I);if(u!=i)for(I=0;I<E;I++)N=f[i][I],f[i][I]=f[u][I],f[u][I]=N;for(u=i+1;u<l;u++)for(v=f[u][i]/f[i][i],I=i;I<E;I++)f[u][I]=f[u][I]-v*f[i][I]}for(i=l-1;i>=0;i--){for(p=0,u=i+1;u<=l-1;u++)p=p+m[u]*f[i][u];m[i]=(f[i][E-1]-p)/f[i][i]}return m},gauss_jordan:function(f,o){var i=r.aug(f,o),u=i.length,l=i[0].length,d=0,v,p,m;for(p=0;p<u;p++){var E=p;for(m=p+1;m<u;m++)s.abs(i[m][p])>s.abs(i[E][p])&&(E=m);var w=i[p];for(i[p]=i[E],i[E]=w,m=p+1;m<u;m++)for(d=i[m][p]/i[p][p],v=p;v<l;v++)i[m][v]-=i[p][v]*d}for(p=u-1;p>=0;p--){for(d=i[p][p],m=0;m<p;m++)for(v=l-1;v>p-1;v--)i[m][v]-=i[p][v]*i[m][p]/d;for(i[p][p]/=d,v=u;v<l;v++)i[p][v]/=d}return i},triaUpSolve:function(f,o){var i=f[0].length,u=r.zeros(1,i)[0],l,d=!1;return o[0].length!=null&&(o=o.map(function(v){return v[0]}),d=!0),r.arange(i-1,-1,-1).forEach(function(v){l=r.arange(v+1,i).map(function(p){return u[p]*f[v][p]}),u[v]=(o[v]-r.sum(l))/f[v][v]}),d?u.map(function(v){return[v]}):u},triaLowSolve:function(f,o){var i=f[0].length,u=r.zeros(1,i)[0],l,d=!1;return o[0].length!=null&&(o=o.map(function(v){return v[0]}),d=!0),r.arange(i).forEach(function(v){l=r.arange(v).map(function(p){return f[v][p]*u[p]}),u[v]=(o[v]-r.sum(l))/f[v][v]}),d?u.map(function(v){return[v]}):u},lu:function(f){var o=f.length,i=r.identity(o),u=r.zeros(f.length,f[0].length),l;return r.arange(o).forEach(function(d){u[0][d]=f[0][d]}),r.arange(1,o).forEach(function(d){r.arange(d).forEach(function(v){l=r.arange(v).map(function(p){return i[d][p]*u[p][v]}),i[d][v]=(f[d][v]-r.sum(l))/u[v][v]}),r.arange(d,o).forEach(function(v){l=r.arange(d).map(function(p){return i[d][p]*u[p][v]}),u[d][v]=f[l.length][v]-r.sum(l)})}),[i,u]},cholesky:function(f){var o=f.length,i=r.zeros(f.length,f[0].length),u;return r.arange(o).forEach(function(l){u=r.arange(l).map(function(d){return s.pow(i[l][d],2)}),i[l][l]=s.sqrt(f[l][l]-r.sum(u)),r.arange(l+1,o).forEach(function(d){u=r.arange(l).map(function(v){return i[l][v]*i[d][v]}),i[d][l]=(f[l][d]-r.sum(u))/i[l][l]})}),i},gauss_jacobi:function(f,o,i,u){for(var l=0,d=0,v=f.length,p=[],m=[],E=[],w,N,I,R;l<v;l++)for(p[l]=[],m[l]=[],E[l]=[],d=0;d<v;d++)l>d?(p[l][d]=f[l][d],m[l][d]=E[l][d]=0):l<d?(m[l][d]=f[l][d],p[l][d]=E[l][d]=0):(E[l][d]=f[l][d],p[l][d]=m[l][d]=0);for(I=r.multiply(r.multiply(r.inv(E),r.add(p,m)),-1),N=r.multiply(r.inv(E),o),w=i,R=r.add(r.multiply(I,i),N),l=2;s.abs(r.norm(r.subtract(R,w)))>u;)w=R,R=r.add(r.multiply(I,w),N),l++;return R},gauss_seidel:function(f,o,i,u){for(var l=0,d=f.length,v=[],p=[],m=[],E,w,N,I,R;l<d;l++)for(v[l]=[],p[l]=[],m[l]=[],E=0;E<d;E++)l>E?(v[l][E]=f[l][E],p[l][E]=m[l][E]=0):l<E?(p[l][E]=f[l][E],v[l][E]=m[l][E]=0):(m[l][E]=f[l][E],v[l][E]=p[l][E]=0);for(I=r.multiply(r.multiply(r.inv(r.add(m,v)),p),-1),N=r.multiply(r.inv(r.add(m,v)),o),w=i,R=r.add(r.multiply(I,i),N),l=2;s.abs(r.norm(r.subtract(R,w)))>u;)w=R,R=r.add(r.multiply(I,w),N),l=l+1;return R},SOR:function(f,o,i,u,l){for(var d=0,v=f.length,p=[],m=[],E=[],w,N,I,R,y;d<v;d++)for(p[d]=[],m[d]=[],E[d]=[],w=0;w<v;w++)d>w?(p[d][w]=f[d][w],m[d][w]=E[d][w]=0):d<w?(m[d][w]=f[d][w],p[d][w]=E[d][w]=0):(E[d][w]=f[d][w],p[d][w]=m[d][w]=0);for(R=r.multiply(r.inv(r.add(E,r.multiply(p,l))),r.subtract(r.multiply(E,1-l),r.multiply(m,l))),I=r.multiply(r.multiply(r.inv(r.add(E,r.multiply(p,l))),o),l),N=i,y=r.add(r.multiply(R,i),I),d=2;s.abs(r.norm(r.subtract(y,N)))>u;)N=y,y=r.add(r.multiply(R,N),I),d++;return y},householder:function(f){for(var o=f.length,i=f[0].length,u=0,l=[],d=[],v,p,m,E,w;u<o-1;u++){for(v=0,E=u+1;E<i;E++)v+=f[E][u]*f[E][u];for(w=f[u+1][u]>0?-1:1,v=w*s.sqrt(v),p=s.sqrt((v*v-f[u+1][u]*v)/2),l=r.zeros(o,1),l[u+1][0]=(f[u+1][u]-v)/(2*p),m=u+2;m<o;m++)l[m][0]=f[m][u]/(2*p);d=r.subtract(r.identity(o,i),r.multiply(r.multiply(l,r.transpose(l)),2)),f=r.multiply(d,r.multiply(f,d))}return f},QR:(function(){var g=r.sum,f=r.arange;function o(i){var u=i.length,l=i[0].length,d=r.zeros(l,l);i=r.copy(i);var v,p,m;for(p=0;p<l;p++){for(d[p][p]=s.sqrt(g(f(u).map(function(E){return i[E][p]*i[E][p]}))),v=0;v<u;v++)i[v][p]=i[v][p]/d[p][p];for(m=p+1;m<l;m++)for(d[p][m]=g(f(u).map(function(E){return i[E][p]*i[E][m]})),v=0;v<u;v++)i[v][m]=i[v][m]-i[v][p]*d[p][m]}return[i,d]}return o})(),lstsq:(function(){function g(o){o=r.copy(o);var i=o.length,u=r.identity(i);return r.arange(i-1,-1,-1).forEach(function(l){r.sliceAssign(u,{row:l},r.divide(r.slice(u,{row:l}),o[l][l])),r.sliceAssign(o,{row:l},r.divide(r.slice(o,{row:l}),o[l][l])),r.arange(l).forEach(function(d){var v=r.multiply(o[d][l],-1),p=r.slice(o,{row:d}),m=r.multiply(r.slice(o,{row:l}),v);r.sliceAssign(o,{row:d},r.add(p,m));var E=r.slice(u,{row:d}),w=r.multiply(r.slice(u,{row:l}),v);r.sliceAssign(u,{row:d},r.add(E,w))})}),u}function f(o,i){var u=!1;i[0].length===void 0&&(i=i.map(function(R){return[R]}),u=!0);var l=r.QR(o),d=l[0],v=l[1],p=o[0].length,m=r.slice(d,{col:{end:p}}),E=r.slice(v,{row:{end:p}}),w=g(E),N=r.transpose(m);N[0].length===void 0&&(N=[N]);var I=r.multiply(r.multiply(w,N),i);return I.length===void 0&&(I=[[I]]),u?I.map(function(R){return R[0]}):I}return f})(),jacobi:function(f){for(var o=1,i=f.length,u=r.identity(i,i),l=[],d,v,p,m,E,w,N,I;o===1;){for(w=f[0][1],m=0,E=1,v=0;v<i;v++)for(p=0;p<i;p++)v!=p&&w<s.abs(f[v][p])&&(w=s.abs(f[v][p]),m=v,E=p);for(f[m][m]===f[E][E]?N=f[m][E]>0?s.PI/4:-s.PI/4:N=s.atan(2*f[m][E]/(f[m][m]-f[E][E]))/2,I=r.identity(i,i),I[m][m]=s.cos(N),I[m][E]=-s.sin(N),I[E][m]=s.sin(N),I[E][E]=s.cos(N),u=r.multiply(u,I),d=r.multiply(r.multiply(r.inv(I),f),I),f=d,o=0,v=1;v<i;v++)for(p=1;p<i;p++)v!=p&&s.abs(f[v][p])>.001&&(o=1)}for(v=0;v<i;v++)l.push(f[v][v]);return[u,l]},rungekutta:function(f,o,i,u,l,d){var v,p,m,E,w;if(d===2)for(;u<=i;)v=o*f(u,l),p=o*f(u+o,l+v),m=l+(v+p)/2,l=m,u=u+o;if(d===4)for(;u<=i;)v=o*f(u,l),p=o*f(u+o/2,l+v/2),E=o*f(u+o/2,l+p/2),w=o*f(u+o,l+E),m=l+(v+2*p+2*E+w)/6,l=m,u=u+o;return l},romberg:function(f,o,i,u){for(var l=0,d=(i-o)/2,v=[],p=[],m=[],E,w,N,I,R;l<u/2;){for(R=f(o),N=o,I=0;N<=i;N=N+d,I++)v[I]=N;for(E=v.length,N=1;N<E-1;N++)R+=(N%2!==0?4:2)*f(v[N]);R=d/3*(R+f(i)),m[l]=R,d/=2,l++}for(w=m.length,E=1;w!==1;){for(N=0;N<w-1;N++)p[N]=(s.pow(4,E)*m[N+1]-m[N])/(s.pow(4,E)-1);w=p.length,m=p,p=[],E++}return m},richardson:function(f,o,i,u){function l(y,M){for(var D=0,P=y.length,z;D<P;D++)y[D]===M&&(z=D);return z}for(var d=s.abs(i-f[l(f,i)+1]),v=0,p=[],m=[],E,w,N,I,R;u>=d;)E=l(f,i+u),w=l(f,i),p[v]=(o[E]-2*o[w]+o[2*w-E])/(u*u),u/=2,v++;for(I=p.length,N=1;I!=1;){for(R=0;R<I-1;R++)m[R]=(s.pow(4,N)*p[R+1]-p[R])/(s.pow(4,N)-1);I=m.length,p=m,m=[],N++}return p},simpson:function(f,o,i,u){for(var l=(i-o)/u,d=f(o),v=[],p=o,m=0,E=1,w;p<=i;p=p+l,m++)v[m]=p;for(w=v.length;E<w-1;E++)d+=(E%2!==0?4:2)*f(v[E]);return l/3*(d+f(i))},hermite:function(f,o,i,u){for(var l=f.length,d=0,v=0,p=[],m=[],E=[],w=[],N;v<l;v++){for(p[v]=1,N=0;N<l;N++)v!=N&&(p[v]*=(u-f[N])/(f[v]-f[N]));for(m[v]=0,N=0;N<l;N++)v!=N&&(m[v]+=1/(f[v]-f[N]));E[v]=(1-2*(u-f[v])*m[v])*(p[v]*p[v]),w[v]=(u-f[v])*(p[v]*p[v]),d+=E[v]*o[v]+w[v]*i[v]}return d},lagrange:function(f,o,i){for(var u=0,l=0,d,v,p=f.length;l<p;l++){for(v=o[l],d=0;d<p;d++)l!=d&&(v*=(i-f[d])/(f[l]-f[d]));u+=v}return u},cubic_spline:function(f,o,i){for(var u=f.length,l=0,d,v=[],p=[],m=[],E=[],w=[],N=[],I=[];l<u-1;l++)w[l]=f[l+1]-f[l];for(m[0]=0,l=1;l<u-1;l++)m[l]=3/w[l]*(o[l+1]-o[l])-3/w[l-1]*(o[l]-o[l-1]);for(l=1;l<u-1;l++)v[l]=[],p[l]=[],v[l][l-1]=w[l-1],v[l][l]=2*(w[l-1]+w[l]),v[l][l+1]=w[l],p[l][0]=m[l];for(E=r.multiply(r.inv(v),p),d=0;d<u-1;d++)N[d]=(o[d+1]-o[d])/w[d]-w[d]*(E[d+1][0]+2*E[d][0])/3,I[d]=(E[d+1][0]-E[d][0])/(3*w[d]);for(d=0;d<u&&!(f[d]>i);d++);return d-=1,o[d]+(i-f[d])*N[d]+r.sq(i-f[d])*E[d]+(i-f[d])*r.sq(i-f[d])*I[d]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var o=f.length,i=f[0].length,u=0,l,d,v=[],p=[],m=[],E=[],w=[],N=[],I=[],R=[],y=[],M=[];for(u=0;u<o;u++)v[u]=r.sum(f[u])/i;for(u=0;u<i;u++)for(I[u]=[],l=0;l<o;l++)I[u][l]=f[l][u]-v[l];for(I=r.transpose(I),u=0;u<o;u++)for(R[u]=[],l=0;l<o;l++)R[u][l]=r.dot([I[u]],[I[l]])/(i-1);for(m=r.jacobi(R),y=m[0],p=m[1],M=r.transpose(y),u=0;u<p.length;u++)for(l=u;l<p.length;l++)p[u]<p[l]&&(d=p[u],p[u]=p[l],p[l]=d,E=M[u],M[u]=M[l],M[l]=E);for(N=r.transpose(I),u=0;u<o;u++)for(w[u]=[],l=0;l<N.length;l++)w[u][l]=r.dot([M[u]],[N[l]]);return[f,p,M,w]}}),(function(g){for(var f=0;f<g.length;f++)(function(o){r.fn[o]=function(i,u){var l=this;return u?(setTimeout(function(){u.call(l,r.fn[o].call(l,i))},15),this):typeof r[o](this,i)=="number"?r[o](this,i):r(r[o](this,i))}})(g[f])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(t,Math),(function(r,s){var c=[].slice,a=r.utils.isNumber,h=r.utils.isArray;r.extend({zscore:function(){var o=c.call(arguments);return a(o[1])?(o[0]-o[1])/o[2]:(o[0]-r.mean(o[1]))/r.stdev(o[1],o[2])},ztest:function(){var o=c.call(arguments),i;return h(o[1])?(i=r.zscore(o[0],o[1],o[3]),o[2]===1?r.normal.cdf(-s.abs(i),0,1):r.normal.cdf(-s.abs(i),0,1)*2):o.length>2?(i=r.zscore(o[0],o[1],o[2]),o[3]===1?r.normal.cdf(-s.abs(i),0,1):r.normal.cdf(-s.abs(i),0,1)*2):(i=o[0],o[1]===1?r.normal.cdf(-s.abs(i),0,1):r.normal.cdf(-s.abs(i),0,1)*2)}}),r.extend(r.fn,{zscore:function(o,i){return(o-this.mean())/this.stdev(i)},ztest:function(o,i,u){var l=s.abs(this.zscore(o,u));return i===1?r.normal.cdf(-l,0,1):r.normal.cdf(-l,0,1)*2}}),r.extend({tscore:function(){var o=c.call(arguments);return o.length===4?(o[0]-o[1])/(o[2]/s.sqrt(o[3])):(o[0]-r.mean(o[1]))/(r.stdev(o[1],!0)/s.sqrt(o[1].length))},ttest:function(){var o=c.call(arguments),i;return o.length===5?(i=s.abs(r.tscore(o[0],o[1],o[2],o[3])),o[4]===1?r.studentt.cdf(-i,o[3]-1):r.studentt.cdf(-i,o[3]-1)*2):a(o[1])?(i=s.abs(o[0]),o[2]==1?r.studentt.cdf(-i,o[1]-1):r.studentt.cdf(-i,o[1]-1)*2):(i=s.abs(r.tscore(o[0],o[1])),o[2]==1?r.studentt.cdf(-i,o[1].length-1):r.studentt.cdf(-i,o[1].length-1)*2)}}),r.extend(r.fn,{tscore:function(o){return(o-this.mean())/(this.stdev(!0)/s.sqrt(this.cols()))},ttest:function(o,i){return i===1?1-r.studentt.cdf(s.abs(this.tscore(o)),this.cols()-1):r.studentt.cdf(-s.abs(this.tscore(o)),this.cols()-1)*2}}),r.extend({anovafscore:function(){var o=c.call(arguments),i,u,l,d,v,p,m,E;if(o.length===1){for(v=new Array(o[0].length),m=0;m<o[0].length;m++)v[m]=o[0][m];o=v}for(u=new Array,m=0;m<o.length;m++)u=u.concat(o[m]);for(l=r.mean(u),i=0,m=0;m<o.length;m++)i=i+o[m].length*s.pow(r.mean(o[m])-l,2);for(i/=o.length-1,p=0,m=0;m<o.length;m++)for(d=r.mean(o[m]),E=0;E<o[m].length;E++)p+=s.pow(o[m][E]-d,2);return p/=u.length-o.length,i/p},anovaftest:function(){var o=c.call(arguments),i,u,l,d;if(a(o[0]))return 1-r.centralF.cdf(o[0],o[1],o[2]);var v=r.anovafscore(o);for(i=o.length-1,l=0,d=0;d<o.length;d++)l=l+o[d].length;return u=l-i-1,1-r.centralF.cdf(v,i,u)},ftest:function(o,i,u){return 1-r.centralF.cdf(o,i,u)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var o=0,i;for(i=0;i<this.length;i++)o=o+this[i].length;return r.ftest(this.anovafscore(),this.length-1,o-this.length)}}),r.extend({qscore:function(){var o=c.call(arguments),i,u,l,d,v;return a(o[0])?(i=o[0],u=o[1],l=o[2],d=o[3],v=o[4]):(i=r.mean(o[0]),u=r.mean(o[1]),l=o[0].length,d=o[1].length,v=o[2]),s.abs(i-u)/(v*s.sqrt((1/l+1/d)/2))},qtest:function(){var o=c.call(arguments),i;o.length===3?(i=o[0],o=o.slice(1)):o.length===7?(i=r.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(i=r.qscore(o[0],o[1],o[2]),o=o.slice(3));var u=o[0],l=o[1];return 1-r.tukey.cdf(i,l,u-l)},tukeyhsd:function(o){for(var i=r.pooledstdev(o),u=o.map(function(E){return r.mean(E)}),l=o.reduce(function(E,w){return E+w.length},0),d=[],v=0;v<o.length;++v)for(var p=v+1;p<o.length;++p){var m=r.qtest(u[v],u[p],o[v].length,o[p].length,i,l,o.length);d.push([[v,p],m])}return d}}),r.extend({normalci:function(){var o=c.call(arguments),i=new Array(2),u;return o.length===4?u=s.abs(r.normal.inv(o[1]/2,0,1)*o[2]/s.sqrt(o[3])):u=s.abs(r.normal.inv(o[1]/2,0,1)*r.stdev(o[2])/s.sqrt(o[2].length)),i[0]=o[0]-u,i[1]=o[0]+u,i},tci:function(){var o=c.call(arguments),i=new Array(2),u;return o.length===4?u=s.abs(r.studentt.inv(o[1]/2,o[3]-1)*o[2]/s.sqrt(o[3])):u=s.abs(r.studentt.inv(o[1]/2,o[2].length-1)*r.stdev(o[2],!0)/s.sqrt(o[2].length)),i[0]=o[0]-u,i[1]=o[0]+u,i},significant:function(o,i){return o<i}}),r.extend(r.fn,{normalci:function(o,i){return r.normalci(o,i,this.toArray())},tci:function(o,i){return r.tci(o,i,this.toArray())}});function g(f,o,i,u){if(f>1||i>1||f<=0||i<=0)throw new Error("Proportions should be greater than 0 and less than 1");var l=(f*o+i*u)/(o+u),d=s.sqrt(l*(1-l)*(1/o+1/u));return(f-i)/d}r.extend(r.fn,{oneSidedDifferenceOfProportions:function(o,i,u,l){var d=g(o,i,u,l);return r.ztest(d,1)},twoSidedDifferenceOfProportions:function(o,i,u,l){var d=g(o,i,u,l);return r.ztest(d,2)}})})(t,Math),t.models=(function(){function r(g){var f=g[0].length,o=t.arange(f).map(function(i){var u=t.arange(f).filter(function(l){return l!==i});return s(t.col(g,i).map(function(l){return l[0]}),t.col(g,u))});return o}function s(g,f){var o=g.length,i=f[0].length-1,u=o-i-1,l=t.lstsq(f,g),d=t.multiply(f,l.map(function(I){return[I]})).map(function(I){return I[0]}),v=t.subtract(g,d),p=t.mean(g),m=t.sum(d.map(function(I){return Math.pow(I-p,2)})),E=t.sum(g.map(function(I,R){return Math.pow(I-d[R],2)})),w=m+E,N=m/w;return{exog:f,endog:g,nobs:o,df_model:i,df_resid:u,coef:l,predict:d,resid:v,ybar:p,SST:w,SSE:m,SSR:E,R2:N}}function c(g){var f=r(g.exog),o=Math.sqrt(g.SSR/g.df_resid),i=f.map(function(p){var m=p.SST,E=p.R2;return o/Math.sqrt(m*(1-E))}),u=g.coef.map(function(p,m){return(p-0)/i[m]}),l=u.map(function(p){var m=t.studentt.cdf(p,g.df_resid);return(m>.5?1-m:m)*2}),d=t.studentt.inv(.975,g.df_resid),v=g.coef.map(function(p,m){var E=d*i[m];return[p-E,p+E]});return{se:i,t:u,p:l,sigmaHat:o,interval95:v}}function a(g){var f=g.R2/g.df_model/((1-g.R2)/g.df_resid),o=function(u,l,d){return t.beta.cdf(u/(d/l+u),l/2,d/2)},i=1-o(f,g.df_model,g.df_resid);return{F_statistic:f,pvalue:i}}function h(g,f){var o=s(g,f),i=c(o),u=a(o),l=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=i,o.f=u,o.adjust_R2=l,o}return{ols:h}})(),t.extend({buildxmatrix:function(){for(var s=new Array(arguments.length),c=0;c<arguments.length;c++){var a=[1];s[c]=a.concat(arguments[c])}return t(s)},builddxmatrix:function(){for(var s=new Array(arguments[0].length),c=0;c<arguments[0].length;c++){var a=[1];s[c]=a.concat(arguments[0][c])}return t(s)},buildjxmatrix:function(s){for(var c=new Array(s.length),a=0;a<s.length;a++)c[a]=s[a];return t.builddxmatrix(c)},buildymatrix:function(s){return t(s).transpose()},buildjymatrix:function(s){return s.transpose()},matrixmult:function(s,c){var a,h,g,f,o;if(s.cols()==c.rows()){if(c.rows()>1){for(f=[],a=0;a<s.rows();a++)for(f[a]=[],h=0;h<c.cols();h++){for(o=0,g=0;g<s.cols();g++)o+=s.toArray()[a][g]*c.toArray()[g][h];f[a][h]=o}return t(f)}for(f=[],a=0;a<s.rows();a++)for(f[a]=[],h=0;h<c.cols();h++){for(o=0,g=0;g<s.cols();g++)o+=s.toArray()[a][g]*c.toArray()[h];f[a][h]=o}return t(f)}},regress:function(s,c){var a=t.xtranspxinv(s),h=s.transpose(),g=t.matrixmult(t(a),h);return t.matrixmult(g,c)},regresst:function(s,c,a){var h=t.regress(s,c),g={};g.anova={};var f=t.jMatYBar(s,h);g.yBar=f;var o=c.mean();g.anova.residuals=t.residuals(c,f),g.anova.ssr=t.ssr(f,o),g.anova.msr=g.anova.ssr/(s[0].length-1),g.anova.sse=t.sse(c,f),g.anova.mse=g.anova.sse/(c.length-(s[0].length-1)-1),g.anova.sst=t.sst(c,o),g.anova.mst=g.anova.sst/(c.length-1),g.anova.r2=1-g.anova.sse/g.anova.sst,g.anova.r2<0&&(g.anova.r2=0),g.anova.fratio=g.anova.msr/g.anova.mse,g.anova.pvalue=t.anovaftest(g.anova.fratio,s[0].length-1,c.length-(s[0].length-1)-1),g.anova.rmse=Math.sqrt(g.anova.mse),g.anova.r2adj=1-g.anova.mse/g.anova.mst,g.anova.r2adj<0&&(g.anova.r2adj=0),g.stats=new Array(s[0].length);for(var i=t.xtranspxinv(s),u,l,d,v=0;v<h.length;v++)u=Math.sqrt(g.anova.mse*Math.abs(i[v][v])),l=Math.abs(h[v]/u),d=t.ttest(l,c.length-s[0].length-1,a),g.stats[v]=[h[v],u,l,d];return g.regress=h,g},xtranspx:function(s){return t.matrixmult(s.transpose(),s)},xtranspxinv:function(s){var c=t.matrixmult(s.transpose(),s),a=t.inv(c);return a},jMatYBar:function(s,c){var a=t.matrixmult(s,c);return new t(a)},residuals:function(s,c){return t.matrixsubtract(s,c)},ssr:function(s,c){for(var a=0,h=0;h<s.length;h++)a+=Math.pow(s[h]-c,2);return a},sse:function(s,c){for(var a=0,h=0;h<s.length;h++)a+=Math.pow(s[h]-c[h],2);return a},sst:function(s,c){for(var a=0,h=0;h<s.length;h++)a+=Math.pow(s[h]-c,2);return a},matrixsubtract:function(s,c){for(var a=new Array(s.length),h=0;h<s.length;h++){a[h]=new Array(s[h].length);for(var g=0;g<s[h].length;g++)a[h][g]=s[h][g]-c[h][g]}return t(a)}}),t.jStat=t,t})})(Xn)),Xn.exports}var Fs=Ls();const W=Wr(Fs);var pr={},It;function Ps(){return It||(It=1,(function(e){(function(n){n(typeof DO_NOT_EXPORT_BESSEL>"u"?e:{})})(function(n){n.version="1.0.2";var t=Math;function r(o,i){for(var u=0,l=0;u<o.length;++u)l=i*l+o[u];return l}function s(o,i,u,l,d){if(i===0)return u;if(i===1)return l;for(var v=2/o,p=l,m=1;m<i;++m)p=l*m*v+d*u,u=l,l=p;return p}function c(o,i,u,l,d){return function(p,m){if(l){if(p===0)return l==1?-1/0:1/0;if(p<0)return NaN}if(m===0)return o(p);if(m===1)return i(p);if(m<0)return NaN;m|=0;var E=o(p),w=i(p);return s(p,m,E,w,d)}}var a=(function(){var o=.636619772,i=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),u=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),d=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function v(I){var R=0,y=0,M=0,D=I*I;if(I<8)y=r(i,D),M=r(u,D),R=y/M;else{var P=I-.785398164;D=64/D,y=r(l,D),M=r(d,D),R=t.sqrt(o/I)*(t.cos(P)*y-t.sin(P)*M*8/I)}return R}var p=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),m=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),E=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),w=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function N(I){var R=0,y=0,M=0,D=I*I,P=t.abs(I)-2.356194491;return Math.abs(I)<8?(y=I*r(p,D),M=r(m,D),R=y/M):(D=64/D,y=r(E,D),M=r(w,D),R=t.sqrt(o/t.abs(I))*(t.cos(P)*y-t.sin(P)*M*8/t.abs(I)),I<0&&(R=-R)),R}return function I(R,y){if(y=Math.round(y),!isFinite(R))return isNaN(R)?R:0;if(y<0)return(y%2?-1:1)*I(R,-y);if(R<0)return(y%2?-1:1)*I(-R,y);if(y===0)return v(R);if(y===1)return N(R);if(R===0)return 0;var M=0;if(R>y)M=s(R,y,v(R),N(R),-1);else{for(var D=2*t.floor((y+t.floor(t.sqrt(40*y)))/2),P=!1,z=0,G=0,S=1,_=0,ue=2/R,ge=D;ge>0;ge--)_=ge*ue*S-z,z=S,S=_,t.abs(S)>1e10&&(S*=1e-10,z*=1e-10,M*=1e-10,G*=1e-10),P&&(G+=S),P=!P,ge==y&&(M=z);G=2*G-S,M/=G}return M}})(),h=(function(){var o=.636619772,i=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),u=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),d=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function v(I){var R=0,y=0,M=0,D=I*I,P=I-.785398164;return I<8?(y=r(i,D),M=r(u,D),R=y/M+o*a(I,0)*t.log(I)):(D=64/D,y=r(l,D),M=r(d,D),R=t.sqrt(o/I)*(t.sin(P)*y+t.cos(P)*M*8/I)),R}var p=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),m=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),E=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),w=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function N(I){var R=0,y=0,M=0,D=I*I,P=I-2.356194491;return I<8?(y=I*r(p,D),M=r(m,D),R=y/M+o*(a(I,1)*t.log(I)-1/I)):(D=64/D,y=r(E,D),M=r(w,D),R=t.sqrt(o/I)*(t.sin(P)*y+t.cos(P)*M*8/I)),R}return c(v,N,"BESSELY",1,-1)})(),g=(function(){var o=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),i=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function u(p){return p<=3.75?r(o,p*p/(3.75*3.75)):t.exp(t.abs(p))/t.sqrt(t.abs(p))*r(i,3.75/t.abs(p))}var l=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),d=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function v(p){return p<3.75?p*r(l,p*p/(3.75*3.75)):(p<0?-1:1)*t.exp(t.abs(p))/t.sqrt(t.abs(p))*r(d,3.75/t.abs(p))}return function p(m,E){if(E=Math.round(E),E===0)return u(m);if(E===1)return v(m);if(E<0)return NaN;if(t.abs(m)===0)return 0;if(m==1/0)return 1/0;var w=0,N,I=2/t.abs(m),R=0,y=1,M=0,D=2*t.round((E+t.round(t.sqrt(40*E)))/2);for(N=D;N>0;N--)M=N*I*y+R,R=y,y=M,t.abs(y)>1e10&&(y*=1e-10,R*=1e-10,w*=1e-10),N==E&&(w=R);return w*=p(m,0)/y,m<0&&E%2?-w:w}})(),f=(function(){var o=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),i=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function u(p){return p<=2?-t.log(p/2)*g(p,0)+r(o,p*p/4):t.exp(-p)/t.sqrt(p)*r(i,2/p)}var l=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),d=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function v(p){return p<=2?t.log(p/2)*g(p,1)+1/p*r(l,p*p/4):t.exp(-p)/t.sqrt(p)*r(d,2/p)}return c(u,v,"BESSELK",2,1)})();n.besselj=a,n.bessely=h,n.besseli=g,n.besselk=f})})(pr)),pr}var Vs=Ps();const nr=Wr(Vs),Sr=new Error("#NULL!"),Fe=new Error("#DIV/0!"),C=new Error("#VALUE!"),yn=new Error("#REF!"),rr=new Error("#NAME?"),V=new Error("#NUM!"),ee=new Error("#N/A"),Xr=new Error("#ERROR!"),ro=new Error("#GETTING_DATA");var qs=Object.freeze({__proto__:null,data:ro,div0:Fe,error:Xr,na:ee,name:rr,nil:Sr,num:V,ref:yn,value:C});let nn=!1;function Us(){nn=!0}function $s(){nn=!1}function to(e){e<60&&(e+=1);const t=Math.floor(e-25569)*86400,r=new Date(t*1e3),s=e-Math.floor(e)+1e-7;let c=Math.floor(86400*s);const a=c%60;c-=a;const h=Math.floor(c/3600),g=Math.floor(c/60)%60;let f=r.getUTCDate(),o=r.getUTCMonth();return e>=60&&e<61&&(f=29,o=1),new Date(r.getUTCFullYear(),o,f,h,g,a)}function je(e){const n=new Date(1900,0,1),t=e>-22038912e5?2:1;return Math.ceil((e-n)/864e5)+t}var xs=Object.freeze({__proto__:null,dateToSerial:je,get returnSerial(){return nn},serialToDate:to,useDate:$s,useSerial:Us});const zs="=",Hs=[">",">=","<","<=","=","<>"],oo="operator",so="literal",Ys=[oo,so],Kn=oo,un=so;function be(e,n){if(Ys.indexOf(n)===-1)throw new Error("Unsupported token type: "+n);return{value:e,type:n}}function Bs(e){return typeof e!="string"||/^\d+(\.\d+)?$/.test(e)&&(e=e.indexOf(".")===-1?parseInt(e,10):parseFloat(e)),e}function Gs(e){const n=e.length,t=[];let r=0,s="",c="";for(;r<n;){const a=e.charAt(r);switch(a){case">":case"<":case"=":c=c+a,s.length>0&&(t.push(s),s="");break;default:c.length>0&&(t.push(c),c=""),s=s+a;break}r++}return s.length>0&&t.push(s),c.length>0&&t.push(c),t}function ks(e){let n="";const t=[];for(let r=0;r<e.length;r++){const s=e[r];r===0&&Hs.indexOf(s)>=0?t.push(be(s,Kn)):n+=s}return n.length>0&&t.push(be(Bs(n),un)),t.length>0&&t[0].type!==Kn&&t.unshift(be(zs,Kn)),t}function Ws(e){const n=[];let t;for(let r=0;r<e.length;r++){const s=e[r];switch(s.type){case Kn:t=s.value;break;case un:n.push(s.value);break}}return Ss(n,t)}function Ss(e,n){let t=!1;switch(n){case">":t=e[0]>e[1];break;case">=":t=e[0]>=e[1];break;case"<":t=e[0]<e[1];break;case"<=":t=e[0]<=e[1];break;case"=":t=e[0]==e[1];break;case"<>":t=e[0]!=e[1];break}return t}function Tn(e){return ks(Gs(e))}const Mn=Ws;function tr(e){const n=[];return Ve(e,t=>{n.push(t)}),n}function Ve(e,n){let t=-1;const r=e.length;for(;++t<r&&n(e[t],t,e)!==!1;);return e}function Kr(e){let n=e.length,t;for(;n--;)if(t=e[n],typeof t!="number"){if(t===!0){e[n]=1;continue}if(t===!1){e[n]=0;continue}if(typeof t=="string"){const r=A(t);e[n]=r instanceof Error?0:r}}return e}function io(e,n){if(!e)return C;(!e.every(s=>Array.isArray(s))||e.length===0)&&(e=[[...e]]),e.map((s,c)=>{s.map((a,h)=>{a||(e[c][h]=0)})});const t=e.reduce((s,c,a)=>c.length>e[s].length?a:s,0),r=e[t].length;return e.map(s=>[...s,...Array(r-s.length).fill(0)])}function H(){let e;if(arguments.length===1){const n=arguments[0];e=Ks(n)?tr.apply(null,arguments):[n]}else e=Array.from(arguments);for(;!Zs(e);)e=Gr(e);return e}function Gr(e){return!e||!e.reduce?[e]:e.reduce((n,t)=>{const r=Array.isArray(n),s=Array.isArray(t);return r&&s?n.concat(t):r?(n.push(t),n):s?[n].concat(t):[n,t]})}function Xs(e,n){return n=n||1,!e||typeof e.slice!="function"?e:e.slice(0,e.length-n)}function Ks(e){return e!=null&&typeof e.length=="number"&&typeof e!="string"}function Zs(e){if(!e)return!1;for(let n=0;n<e.length;++n)if(Array.isArray(e[n]))return!1;return!0}function Te(e,n){return n=n||1,!e||typeof e.slice!="function"?e:e.slice(n)}function Zn(e){return e?e[0].map((n,t)=>e.map(r=>r[t])):C}function ke(e,n){let t=null;return Ve(e,(r,s)=>{if(r[0]===n)return t=s,!1}),t==null?C:t}function ce(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function U(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function fo(e){return Math.round(e*1e14)/1e14}function rn(){return H.apply(null,arguments).filter(n=>typeof n=="number")}function Zr(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const n=e.toUpperCase();if(n==="TRUE")return!0;if(n==="FALSE")return!1}return e instanceof Date&&!isNaN(e)?!0:C}function he(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const n=parseFloat(e);return n<0||n>=2958466?V:to(n)}return typeof e=="string"&&(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),!isNaN(e))?e:C}function uo(e){let n=e.length,t;for(;n--;){if(t=he(e[n]),t===C)return t;e[n]=t}return e}function A(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),!isNaN(e)&&e!==""?parseFloat(e):C)}function K(e){let n;if(!e||(n=e.length)===0)return C;let t;for(;n--;){if(e[n]instanceof Error)return e[n];if(t=A(e[n]),t instanceof Error)return t;e[n]=t}return e}function Me(e){return e instanceof Error?e:e==null?"":e.toString()}function or(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function sr(){const e=tr(arguments),n=K(H(e.shift()));if(n instanceof Error)return n;const t=e,r=t.length/2;for(let c=0;c<r;c++)t[c*2]=H(t[c*2]);let s=[];for(let c=0;c<n.length;c++){let a=!1;for(let h=0;h<r;h++){const g=t[h*2][c],f=t[h*2+1],o=f===void 0||f==="*";let i=!1;if(o)i=!0;else{const u=Tn(f+""),l=[be(g,un)].concat(u);i=Mn(l)}if(!i){a=!1;break}a=!0}a&&s.push(n[c])}return s}function wn(e){return e!=null}const lo={};lo.TYPE=e=>{switch(e){case Sr:return 1;case Fe:return 2;case C:return 3;case yn:return 4;case rr:return 5;case V:return 6;case ee:return 7;case ro:return 8}return ee};function Qs(e){return e===null}function co(e){return[C,yn,Fe,V,rr,Sr].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function ir(e){return co(e)||e===ee}function Js(e){return!(Math.floor(Math.abs(e))&1)}function ao(e){return e===!0||e===!1}function bs(e){return e===ee}function _s(e){return typeof e!="string"}function fr(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function js(e){return!!(Math.floor(Math.abs(e))&1)}function ho(e){return typeof e=="string"}function ei(e){return fr(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:ir(e)?e:0}function ni(){return ee}function ri(e){if(fr(e))return 1;if(ho(e))return 2;if(ao(e))return 4;if(ir(e))return 16;if(Array.isArray(e))return 64}function ti(){if(arguments.length<2)return ee;const e=arguments[0];return e<1||e>254||arguments.length<e+1?C:arguments[e]}function oi(e,n){if(arguments.length!==2)return ee;if(n<0)return V;if(!(e instanceof Array)||typeof n!="number")return C;if(e.length!==0)return W.col(e,n)}function si(e){return arguments.length!==1?ee:e instanceof Array?e.length===0?0:W.cols(e):C}function ii(e,n,t,r){return go(e,Zn(n),t,r)}function fi(e,n,t){const r=ce(e,n,t);if(r)return r;if(!Array.isArray(e))return C;const s=e.length>0&&!Array.isArray(e[0]);return s&&!t?(t=n,n=1):(t=t||1,n=n||1),t<0||n<0?C:s&&n===1&&t<=e.length?e[t-1]:n<=e.length&&t<=e[n-1].length?e[n-1][t-1]:yn}function ui(e,n,t){n=H(n),t=t?H(t):n;const r=typeof e=="number";let s=ee;for(let c=0;c<n.length;c++){if(n[c]===e)return t[c];if(r&&n[c]<=e||typeof n[c]=="string"&&n[c].localeCompare(e)<0)s=t[c];else if(r&&n[c]>e)return s}return s}function li(e,n,t){if(!e&&e!==0||!n||(arguments.length===2&&(t=1),n=H(n),!(n instanceof Array))||t!==-1&&t!==0&&t!==1)return ee;let r,s;for(let c=0;c<n.length;c++)if(t===1){if(n[c]===e)return c+1;n[c]<e&&(s?n[c]>s&&(r=c+1,s=n[c]):(r=c+1,s=n[c]))}else if(t===0){if(typeof e=="string"&&typeof n[c]=="string"){const a=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\[/g,"\\[").replace(/\]/g,"\\]");if(new RegExp("^"+a+"$").test(n[c].toLowerCase()))return c+1}else if(n[c]===e)return c+1}else if(t===-1){if(n[c]===e)return c+1;n[c]>e&&(s?n[c]<s&&(r=c+1,s=n[c]):(r=c+1,s=n[c]))}return r||ee}function ci(e){return arguments.length!==1?ee:e instanceof Array?e.length===0?0:W.rows(e):C}function ai(e,n=1,t=1,r=!1){if(!e||!Array.isArray(e))return ee;if(e.length===0)return 0;if(n=A(n),!n||n<1||(t=A(t),t!==1&&t!==-1))return C;if(r=Zr(r),typeof r!="boolean")return rr;const s=h=>h.sort((g,f)=>(g=Me(g[n-1]),f=Me(f[n-1]),t===1?g<f?t*-1:t:g>f?t:t*-1)),c=io(e),a=r?Zn(c):c;return n>=1&&n<=a[0].length?r?Zn(s(a)):s(a):C}function hi(e){if(!e)return ee;const n=io(e);return Zn(n)}function Qr(){const e=[];for(let n=0;n<arguments.length;++n){let t=!1;const r=arguments[n];for(let s=0;s<e.length&&(t=e[s]===r,!t);++s);t||e.push(r)}return e}function go(e,n,t,r){if(!n||!t)return ee;r=!(r===0||r===!1);let s=ee,c=!1;const a=typeof e=="number",h=typeof e=="string"?e.toLowerCase():e;for(let g=0;g<n.length;g++){const f=n[g],o=typeof f[0]=="string"?f[0].toLowerCase():f[0];if(o===h){s=t<f.length+1?f[t-1]:yn;break}else!c&&(a&&r&&o<=e||r&&typeof o=="string"&&o.localeCompare(e)<0)&&(s=t<f.length+1?f[t-1]:yn);a&&o>e&&(c=!0)}return s}function vo(e){return e=A(e),e===0?C:e instanceof Error?e:String.fromCharCode(e)}function gi(e){if(U(e))return e;e=e||"";const n=/[\0-\x1F]/g;return e.replace(n,"")}function po(e){if(U(e))return e;e=e||"";let n=e.charCodeAt(0);return isNaN(n)&&(n=C),n}function wo(){const e=H(arguments),n=ce.apply(void 0,e);if(n)return n;let t=0;for(;(t=e.indexOf(!0))>-1;)e[t]="TRUE";let r=0;for(;(r=e.indexOf(!1))>-1;)e[r]="FALSE";return e.join("")}const di=wo;function vi(e,n=2){if(e=A(e),isNaN(e))return C;e=Oo(e,n);const t={style:"currency",currency:"USD",minimumFractionDigits:n>=0?n:0,maximumFractionDigits:n>=0?n:0},r=e.toLocaleString("en-US",t);return e<0?"$("+r.slice(2)+")":r}function pi(e,n){if(arguments.length!==2)return ee;const t=ce(e,n);return t||(e=Me(e),n=Me(n),e===n)}function wi(e,n,t){if(arguments.length<2)return ee;e=Me(e),n=Me(n),t=t===void 0?0:t;const r=n.indexOf(e,t-1);return r===-1?C:r+1}function mo(e,n=2,t=!1){if(e=A(e),isNaN(e)||(n=A(n),isNaN(n)))return C;if(n<0){const r=Math.pow(10,-n);e=Math.round(e/r)*r}else e=e.toFixed(n);if(t)e=e.toString().replace(/,/g,"");else{const r=e.toString().split(".");r[0]=r[0].replace(/\B(?=(\d{3})+$)/g,","),e=r.join(".")}return e}function mi(e,n){const t=ce(e,n);return t||(e=Me(e),n=n===void 0?1:n,n=A(n),n instanceof Error||typeof e!="string"?C:e.substring(0,n))}function Ei(e){return arguments.length===0?Xr:e instanceof Error?e:Array.isArray(e)?C:Me(e).length}function Ni(e){return arguments.length!==1?C:(e=Me(e),U(e)?e:e.toLowerCase())}function Ii(e,n,t){if(n==null)return C;if(n=A(n),t=A(t),U(n,t)||typeof e!="string")return t;const r=n-1,s=r+t;return e.substring(r,s)}function Ai(e,n,t){return e=wn(e)?e:"",typeof e=="number"?e:typeof e!="string"?ee:(n=typeof n>"u"?".":n,t=typeof t>"u"?",":t,Number(e.replace(n,".").replace(t,"")))}function Ri(e){return U(e)?e:isNaN(e)&&typeof e=="number"?C:(e=Me(e),e.replace(/\w\S*/g,n=>n.charAt(0).toUpperCase()+n.substr(1).toLowerCase()))}function yi(e,n,t,r){return n=A(n),t=A(t),U(n,t)||typeof e!="string"||typeof r!="string"?C:e.substr(0,n-1)+r+e.substr(n-1+t)}function Ge(e,n){const t=ce(e,n);return t||(e=Me(e),n=A(n),n instanceof Error?n:new Array(n+1).join(e))}function Ti(e,n){const t=ce(e,n);return t||(e=Me(e),n=n===void 0?1:n,n=A(n),n instanceof Error?n:e.substring(e.length-n))}function Mi(e,n,t){let r;return typeof e!="string"||typeof n!="string"?C:(t=t===void 0?0:t,r=n.toLowerCase().indexOf(e.toLowerCase(),t-1)+1,r===0?C:r)}function Ci(e,n,t,r){if(arguments.length<3)return ee;if(!e||!n)return e;if(r===void 0)return e.split(n).join(t);{if(r=Math.floor(Number(r)),Number.isNaN(r)||r<=0)return C;let s=0,c=0;for(;s>-1&&e.indexOf(n,s)>-1;)if(s=e.indexOf(n,s+1),c++,s>-1&&c===r)return e.substring(0,s)+t+e.substring(s+n.length);return e}}function He(e){return e instanceof Error||typeof e=="string"?e:""}function Di(e,n){if(e===void 0||e instanceof Error||n instanceof Error)return ee;if(e instanceof Date)return e.toISOString().slice(0,10);if(n==null)return"";if(typeof n=="number")return String(n);if(typeof n!="string")return C;const t=n.startsWith("$")?"$":"",r=n.endsWith("%");n=n.replace(/%/g,"").replace(/\$/g,"");const s=n.includes(".")?n.split(".")[1].match(/0/g).length:0,c=!n.includes(",");return r&&(e=e*100),e=mo(e,s,c),e.startsWith("-")?(e=e.replace("-",""),e="-"+t+e):e=t+e,r&&(e=e+"%"),e}function Oi(e,n,...t){if(typeof n!="boolean"&&(n=Zr(n)),arguments.length<3)return ee;e=e!=null?e:"";let r=H(t),s=n?r.filter(c=>c):r;if(Array.isArray(e)){e=H(e);let c=s.map(h=>[h]),a=0;for(let h=0;h<c.length-1;h++)c[h].push(e[a]),a++,a===e.length&&(a=0);return s=H(c),s.join("")}return s.join(e)}function Li(e){return e=Me(e),e instanceof Error?e:e.replace(/\s+/g," ").trim()}const Fi=vo,Pi=po;function Vi(e){return e=Me(e),e instanceof Error?e:e.toUpperCase()}function qi(e){const n=ce(e);if(n)return n;if(typeof e=="number")return e;if(wn(e)||(e=""),typeof e!="string")return C;const t=/(%)$/.test(e)||/^(%)/.test(e);if(e=e.replace(/^[^0-9-]{0,3}/,""),e=e.replace(/[^0-9]{0,3}$/,""),e=e.replace(/[ ,]/g,""),e==="")return 0;let r=Number(e);return isNaN(r)?C:(r=r||0,t&&(r=r*.01),r)}const Ui=2.5066282746310002;function $i(){const n=H(arguments).filter(wn);if(n.length===0)return V;const t=K(n);return t instanceof Error?t:W.sum(W(t).subtract(W.mean(t)).abs()[0])/t.length}function hn(){const n=H(arguments).filter(wn);if(n.length===0)return Fe;const t=ce.apply(void 0,n);if(t)return t;const r=rn(n),s=r.length;let c=0,a=0,h;for(let g=0;g<s;g++)c+=r[g],a+=1;return h=c/a,isNaN(h)&&(h=V),h}function Jr(){const n=H(arguments).filter(wn);if(n.length===0)return Fe;const t=ce.apply(void 0,n);if(t)return t;const r=n,s=r.length;let c=0,a=0,h;for(let g=0;g<s;g++){const f=r[g];typeof f=="number"&&(c+=f),f===!0&&c++,f!==null&&a++}return h=c/a,isNaN(h)&&(h=V),h}function xi(e,n,t){if(arguments.length<=1)return ee;t=t||e;const s=H(t).filter(wn);if(t=K(s),e=H(e),t instanceof Error)return t;let c=0,a=0;const h=n===void 0||n==="*",g=h?null:Tn(n+"");for(let f=0;f<e.length;f++){const o=e[f];if(h)a+=t[f],c++;else{const i=[be(o,un)].concat(g);Mn(i)&&(a+=t[f],c++)}}return a/c}function zi(){const e=sr(...arguments),t=e.reduce((r,s)=>r+s,0)/e.length;return isNaN(t)?0:t}const Vn={};Vn.DIST=function(e,n,t,r,s,c){return arguments.length<4||(s=s===void 0?0:s,c=c===void 0?1:c,e=A(e),n=A(n),t=A(t),s=A(s),c=A(c),U(e,n,t,s,c))?C:(e=(e-s)/(c-s),r?W.beta.cdf(e,n,t):W.beta.pdf(e,n,t))};Vn.INV=(e,n,t,r,s)=>(r=r===void 0?0:r,s=s===void 0?1:s,e=A(e),n=A(n),t=A(t),r=A(r),s=A(s),U(e,n,t,r,s)?C:W.beta.inv(e,n,t)*(s-r)+r);const Cn={};Cn.DIST=(e,n,t,r)=>(e=A(e),n=A(n),t=A(t),r=A(r),U(e,n,t,r)?C:r?W.binomial.cdf(e,n,t):W.binomial.pdf(e,n,t));Cn.DIST.RANGE=(e,n,t,r)=>{if(r=r===void 0?t:r,e=A(e),n=A(n),t=A(t),r=A(r),U(e,n,t,r))return C;let s=0;for(let c=t;c<=r;c++)s+=An(e,c)*Math.pow(n,c)*Math.pow(1-n,e-c);return s};Cn.INV=(e,n,t)=>{if(e=A(e),n=A(n),t=A(t),U(e,n,t))return C;let r=0;for(;r<=e;){if(W.binomial.cdf(r,e,n)>=t)return r;r++}};const Se={};Se.DIST=(e,n,t)=>(e=A(e),n=A(n),U(e,n)?C:t?W.chisquare.cdf(e,n):W.chisquare.pdf(e,n));Se.DIST.RT=(e,n)=>!e|!n?ee:e<1||n>Math.pow(10,10)?V:typeof e!="number"||typeof n!="number"?C:1-W.chisquare.cdf(e,n);Se.INV=(e,n)=>(e=A(e),n=A(n),U(e,n)?C:W.chisquare.inv(e,n));Se.INV.RT=(e,n)=>!e|!n?ee:e<0||e>1||n<1||n>Math.pow(10,10)?V:typeof e!="number"||typeof n!="number"?C:W.chisquare.inv(1-e,n);Se.TEST=function(e,n){if(arguments.length!==2)return ee;if(!(e instanceof Array)||!(n instanceof Array)||e.length!==n.length||e[0]&&n[0]&&e[0].length!==n[0].length)return C;const t=e.length;let r,s,c;for(s=0;s<t;s++)e[s]instanceof Array||(r=e[s],e[s]=[],e[s].push(r)),n[s]instanceof Array||(r=n[s],n[s]=[],n[s].push(r));const a=e[0].length,h=a===1?t-1:(t-1)*(a-1);let g=0;const f=Math.PI;for(s=0;s<t;s++)for(c=0;c<a;c++)g+=Math.pow(e[s][c]-n[s][c],2)/n[s][c];function o(i,u){let l=Math.exp(-.5*i);u%2===1&&(l=l*Math.sqrt(2*i/f));let d=u;for(;d>=2;)l=l*i/d,d=d-2;let v=l,p=u;for(;v>1e-10*l;)p=p+2,v=v*i/p,l=l+v;return 1-l}return Math.round(o(g,h)*1e6)/1e6};const br={};br.NORM=(e,n,t)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:W.normalci(1,e,n,t)[1]-1);br.T=(e,n,t)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:W.tci(1,e,n,t)[1]-1);function Hi(e,n){return e=K(H(e)),n=K(H(n)),U(e,n)?C:W.corrcoeff(e,n)}function Ln(){const e=H(arguments);return rn(e).length}function Fn(){const e=H(arguments);return e.length-Eo(e)}function Eo(){const e=H(arguments);let n=0,t;for(let r=0;r<e.length;r++)t=e[r],(t==null||t==="")&&n++;return n}function Yi(e,n){if(e=H(e),n===void 0||n==="*")return e.length;let r=0;const s=Tn(n+"");for(let c=0;c<e.length;c++){const a=e[c],h=[be(a,un)].concat(s);Mn(h)&&r++}return r}function Bi(){const e=tr(arguments),n=new Array(H(e[0]).length);for(let r=0;r<n.length;r++)n[r]=!0;for(let r=0;r<e.length;r+=2){const s=H(e[r]),c=e[r+1];if(!(c===void 0||c==="*")){const h=Tn(c+"");for(let g=0;g<s.length;g++){const f=s[g],o=[be(f,un)].concat(h);n[g]=n[g]&&Mn(o)}}}let t=0;for(let r=0;r<n.length;r++)n[r]&&t++;return t}const Dn={};Dn.P=(e,n)=>{if(e=K(H(e)),n=K(H(n)),U(e,n))return C;const t=W.mean(e),r=W.mean(n);let s=0;const c=e.length;for(let a=0;a<c;a++)s+=(e[a]-t)*(n[a]-r);return s/c};Dn.S=(e,n)=>(e=K(H(e)),n=K(H(n)),U(e,n)?C:W.covariance(e,n));function Gi(){const e=K(H(arguments));if(e instanceof Error)return e;const n=W.mean(e);let t=0;for(let r=0;r<e.length;r++)t+=Math.pow(e[r]-n,2);return t}const _r={};_r.DIST=(e,n,t)=>(e=A(e),n=A(n),U(e,n)?C:t?W.exponential.cdf(e,n):W.exponential.pdf(e,n));const Xe={};Xe.DIST=(e,n,t,r)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:r?W.centralF.cdf(e,n,t):W.centralF.pdf(e,n,t));Xe.DIST.RT=function(e,n,t){return arguments.length!==3?ee:e<0||n<1||t<1?V:typeof e!="number"||typeof n!="number"||typeof t!="number"?C:1-W.centralF.cdf(e,n,t)};Xe.INV=(e,n,t)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:e<=0||e>1?V:W.centralF.inv(e,n,t));Xe.INV.RT=function(e,n,t){return arguments.length!==3?ee:e<0||e>1||n<1||n>Math.pow(10,10)||t<1||t>Math.pow(10,10)?V:typeof e!="number"||typeof n!="number"||typeof t!="number"?C:W.centralF.inv(1-e,n,t)};Xe.TEST=(e,n)=>{if(!e||!n||!(e instanceof Array)||!(n instanceof Array))return ee;if(e.length<2||n.length<2)return Fe;const t=(h,g)=>{let f=0;for(let o=0;o<h.length;o++)f+=Math.pow(h[o]-g,2);return f},r=en(e)/e.length,s=en(n)/n.length,c=t(e,r)/(e.length-1),a=t(n,s)/(n.length-1);return c/a};function ki(e){return e=A(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2}function Wi(e){if(e=A(e),e instanceof Error)return e;const n=Math.exp(2*e);return(n-1)/(n+1)}function No(e,n,t){if(e=A(e),n=K(H(n)),t=K(H(t)),U(e,n,t))return C;const r=W.mean(t),s=W.mean(n),c=t.length;let a=0,h=0;for(let o=0;o<c;o++)a+=(t[o]-r)*(n[o]-s),h+=Math.pow(t[o]-r,2);const g=a/h;return s-g*r+g*e}function Si(e,n){if(e=K(H(e)),n=K(H(n)),U(e,n))return C;const t=e.length,r=n.length,s=[];for(let c=0;c<=r;c++){s[c]=0;for(let a=0;a<t;a++)c===0?e[a]<=n[0]&&(s[0]+=1):c<r?e[a]>n[c-1]&&e[a]<=n[c]&&(s[c]+=1):c===r&&e[a]>n[r-1]&&(s[r]+=1)}return s}function qn(e){return e=A(e),e instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?V:W.gammafn(e)}qn.DIST=function(e,n,t,r){return arguments.length!==4?ee:e<0||n<=0||t<=0||typeof e!="number"||typeof n!="number"||typeof t!="number"?C:r?W.gamma.cdf(e,n,t,!0):W.gamma.pdf(e,n,t,!1)};qn.INV=function(e,n,t){return arguments.length!==3?ee:e<0||e>1||n<=0||t<=0?V:typeof e!="number"||typeof n!="number"||typeof t!="number"?C:W.gamma.inv(e,n,t)};function jr(e){return e=A(e),e instanceof Error?e:W.gammaln(e)}jr.PRECISE=function(e){return arguments.length!==1?ee:e<=0?V:typeof e!="number"?C:W.gammaln(e)};function Xi(e){return e=A(e),e instanceof Error?e:W.normal.cdf(e,0,1)-.5}function Ki(){const e=K(H(arguments));return e instanceof Error?e:W.geomean(e)}function Zi(e,n,t,r){if(e=K(H(e)),e instanceof Error)return e;let s;if(n===void 0)for(n=[],s=1;s<=e.length;s++)n.push(s);if(t===void 0&&(t=n),n=K(H(n)),t=K(H(t)),U(n,t))return C;r===void 0&&(r=!0);const c=e.length;let a=0,h=0,g=0,f=0;for(s=0;s<c;s++){const l=n[s],d=Math.log(e[s]);a+=l,h+=d,g+=l*d,f+=l*l}a/=c,h/=c,g/=c,f/=c;let o,i;r?(o=(g-a*h)/(f-a*a),i=h-o*a):(o=g/f,i=0);const u=[];for(s=0;s<t.length;s++)u.push(Math.exp(i+o*t[s]));return u}function Qi(){const e=K(H(arguments));if(e instanceof Error)return e;const n=e.length;let t=0;for(let r=0;r<n;r++)t+=1/e[r];return n/t}const et={};et.DIST=(e,n,t,r,s)=>{if(e=A(e),n=A(n),t=A(t),r=A(r),U(e,n,t,r))return C;function c(h,g,f,o){return An(f,h)*An(o-f,g-h)/An(o,g)}function a(h,g,f,o){let i=0;for(let u=0;u<=h;u++)i+=c(u,g,f,o);return i}return s?a(e,n,t,r):c(e,n,t,r)};function Ji(e,n){return e=K(e),n=K(n),U(e,n)?C:e.length!==n.length?ee:No(0,e,n)}function bi(){const e=K(H(arguments));if(e instanceof Error)return e;const n=W.mean(e),t=e.length;let r=0;for(let s=0;s<t;s++)r+=Math.pow(e[s]-n,4);return r=r/Math.pow(W.stdev(e,!0),4),t*(t+1)/((t-1)*(t-2)*(t-3))*r-3*(t-1)*(t-1)/((t-2)*(t-3))}function Io(e,n){const t=ce.apply(void 0,e);return t||(U(n)?n:(e=rn(H(e)),n=A(n),n<0||e.length<n?C:e.sort((r,s)=>s-r)[n-1]))}function nt(e,n){if(e=K(H(e)),n=K(H(n)),U(e,n))return C;const t=W.mean(e),r=W.mean(n),s=n.length;let c=0,a=0;for(let f=0;f<s;f++)c+=(n[f]-r)*(e[f]-t),a+=Math.pow(n[f]-r,2);const h=c/a,g=t-h*r;return[h,g]}function _i(e,n){if(e=K(H(e)),n=K(H(n)),U(e,n)||e.length!==n.length)return C;for(let r=0;r<e.length;r++)e[r]=Math.log(e[r]);const t=nt(e,n);return t[0]=Math.round(Math.exp(t[0])*1e6)/1e6,t[1]=Math.round(Math.exp(t[1])*1e6)/1e6,t}const On={};On.DIST=(e,n,t,r)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:r?W.lognormal.cdf(e,n,t):W.lognormal.pdf(e,n,t));On.INV=(e,n,t)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:W.lognormal.inv(e,n,t));function Qn(){const e=H(arguments),n=ce.apply(void 0,e);if(n)return n;const t=rn(e);return t.length===0?0:Math.max.apply(Math,t)}function ji(){const e=H(arguments),n=ce.apply(void 0,e);if(n)return n;let t=Kr(e);return t=t.map(r=>r==null?0:r),t.length===0?0:Math.max.apply(Math,t)}function ef(){const e=sr(...arguments);return e.length===0?0:Math.max.apply(Math,e)}function Ao(){const e=H(arguments),n=ce.apply(void 0,e);if(n)return n;const t=Kr(e);let r=W.median(t);return isNaN(r)&&(r=V),r}function Jn(){const e=H(arguments),n=ce.apply(void 0,e);if(n)return n;const t=rn(e);return t.length===0?0:Math.min.apply(Math,t)}function nf(){const e=H(arguments),n=ce.apply(void 0,e);if(n)return n;let t=Kr(e);return t=t.map(r=>r==null?0:r),t.length===0?0:Math.min.apply(Math,t)}function rf(){const e=sr(...arguments);return e.length===0?0:Math.min.apply(Math,e)}const gn={};gn.MULT=function(){const e=K(H(arguments));if(e instanceof Error)return e;const n=e.length,t={};let r=[],s=0,c;for(let a=0;a<n;a++)c=e[a],t[c]=t[c]?t[c]+1:1,t[c]>s&&(s=t[c],r=[]),t[c]===s&&(r[r.length]=c);return r};gn.SNGL=function(){const e=K(H(arguments));return e instanceof Error?e:gn.MULT(e).sort((n,t)=>n-t)[0]};const rt={};rt.DIST=(e,n,t,r)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:r?W.negbin.cdf(e,n,t):W.negbin.pdf(e,n,t));const Ke={};Ke.DIST=(e,n,t,r)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:t<=0?V:r?W.normal.cdf(e,n,t):W.normal.pdf(e,n,t));Ke.INV=(e,n,t)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:W.normal.inv(e,n,t));Ke.S={};Ke.S.DIST=(e,n)=>(e=A(e),e instanceof Error?C:n?W.normal.cdf(e,0,1):W.normal.pdf(e,0,1));Ke.S.INV=e=>(e=A(e),e instanceof Error?C:W.normal.inv(e,0,1));function Ro(e,n){if(n=K(H(n)),e=K(H(e)),U(n,e))return C;const t=W.mean(e),r=W.mean(n),s=e.length;let c=0,a=0,h=0;for(let g=0;g<s;g++)c+=(e[g]-t)*(n[g]-r),a+=Math.pow(e[g]-t,2),h+=Math.pow(n[g]-r,2);return c/Math.sqrt(a*h)}const Be={};Be.EXC=(e,n)=>{if(e=K(H(e)),n=A(n),U(e,n))return C;e=e.sort((c,a)=>c-a);const t=e.length;if(n<1/(t+1)||n>1-1/(t+1))return V;const r=n*(t+1)-1,s=Math.floor(r);return fo(r===s?e[r]:e[s]+(r-s)*(e[s+1]-e[s]))};Be.INC=(e,n)=>{if(e=K(H(e)),n=A(n),U(e,n))return C;e=e.sort((c,a)=>c-a);const t=e.length,r=n*(t-1),s=Math.floor(r);return fo(r===s?e[r]:e[s]+(r-s)*(e[s+1]-e[s]))};const Un={};Un.EXC=(e,n,t)=>{if(t=t===void 0?3:t,e=K(H(e)),n=A(n),t=A(t),U(e,n,t))return C;e=e.sort((o,i)=>o-i);const r=Qr.apply(null,e),s=e.length,c=r.length,a=Math.pow(10,t);let h=0,g=!1,f=0;for(;!g&&f<c;)n===r[f]?(h=(e.indexOf(r[f])+1)/(s+1),g=!0):n>=r[f]&&(n<r[f+1]||f===c-1)&&(h=(e.indexOf(r[f])+1+(n-r[f])/(r[f+1]-r[f]))/(s+1),g=!0),f++;return Math.floor(h*a)/a};Un.INC=(e,n,t)=>{if(t=t===void 0?3:t,e=K(H(e)),n=A(n),t=A(t),U(e,n,t))return C;e=e.sort((o,i)=>o-i);const r=Qr.apply(null,e),s=e.length,c=r.length,a=Math.pow(10,t);let h=0,g=!1,f=0;for(;!g&&f<c;)n===r[f]?(h=e.indexOf(r[f])/(s-1),g=!0):n>=r[f]&&(n<r[f+1]||f===c-1)&&(h=(e.indexOf(r[f])+(n-r[f])/(r[f+1]-r[f]))/(s-1),g=!0),f++;return Math.floor(h*a)/a};function tf(e,n){return e=A(e),n=A(n),U(e,n)?C:_e(e)/_e(e-n)}function of(e,n){return e=A(e),n=A(n),U(e,n)?C:Math.pow(e,n)}function sf(e){return e=A(e),e instanceof Error?C:Math.exp(-.5*e*e)/Ui}const tt={};tt.DIST=(e,n,t)=>(e=A(e),n=A(n),U(e,n)?C:t?W.poisson.cdf(e,n):W.poisson.pdf(e,n));function ff(e,n,t,r){if(t===void 0)return 0;if(r=r===void 0?t:r,e=K(H(e)),n=K(H(n)),t=A(t),r=A(r),U(e,n,t,r))return C;if(t===r)return e.indexOf(t)>=0?n[e.indexOf(t)]:0;const s=e.sort((h,g)=>h-g),c=s.length;let a=0;for(let h=0;h<c;h++)s[h]>=t&&s[h]<=r&&(a+=n[e.indexOf(s[h])]);return a}const dn={};dn.EXC=(e,n)=>{if(e=K(rn(H(e))),n=A(n),U(e,n))return C;switch(n){case 1:return Be.EXC(e,.25);case 2:return Be.EXC(e,.5);case 3:return Be.EXC(e,.75);default:return V}};dn.INC=(e,n)=>{if(e=K(rn(H(e))),n=A(n),U(e,n))return C;switch(n){case 1:return Be.INC(e,.25);case 2:return Be.INC(e,.5);case 3:return Be.INC(e,.75);default:return V}};const $n={};$n.AVG=(e,n,t)=>{if(e=A(e),n=K(H(n)),U(e,n))return C;n=H(n),t=t||!1;const r=t?(a,h)=>a-h:(a,h)=>h-a;n=n.sort(r);const s=n.length;let c=0;for(let a=0;a<s;a++)n[a]===e&&c++;return c>1?(2*n.indexOf(e)+c+1)/2:n.indexOf(e)+1};$n.EQ=(e,n,t)=>{if(e=A(e),n=K(H(n)),U(e,n))return C;t=t||!1;const r=t?(s,c)=>s-c:(s,c)=>c-s;return n=n.sort(r),n.indexOf(e)+1};function uf(e,n){if(arguments.length!==2)return ee;if(n<0)return V;if(!(e instanceof Array)||typeof n!="number")return C;if(e.length!==0)return W.row(e,n)}function lf(e,n){return e=K(H(e)),n=K(H(n)),U(e,n)?C:Math.pow(Ro(e,n),2)}function ot(){const e=K(H(arguments));if(e instanceof Error)return e;const n=W.mean(e),t=e.length;let r=0;for(let s=0;s<t;s++)r+=Math.pow(e[s]-n,3);return t*r/((t-1)*(t-2)*Math.pow(W.stdev(e,!0),3))}ot.P=function(){const e=K(H(arguments));if(e instanceof Error)return e;const n=W.mean(e),t=e.length;let r=0,s=0;for(let c=0;c<t;c++)s+=Math.pow(e[c]-n,3),r+=Math.pow(e[c]-n,2);return s=s/t,r=r/t,s/Math.pow(r,3/2)};function cf(e,n){if(e=K(H(e)),n=K(H(n)),U(e,n))return C;const t=W.mean(n),r=W.mean(e),s=n.length;let c=0,a=0;for(let h=0;h<s;h++)c+=(n[h]-t)*(e[h]-r),a+=Math.pow(n[h]-t,2);return c/a}function yo(e,n){return e=K(H(e)),n=A(n),U(e,n)?e:e.sort((t,r)=>t-r)[n-1]}function af(e,n,t){return e=A(e),n=A(n),t=A(t),U(e,n,t)?C:(e-n)/t}const ze={};ze.P=function(){const e=$e.P.apply(this,arguments);let n=Math.sqrt(e);return isNaN(n)&&(n=V),n};ze.S=function(){const e=$e.S.apply(this,arguments);return Math.sqrt(e)};function hf(){const e=To.apply(this,arguments);return Math.sqrt(e)}function gf(){const e=Mo.apply(this,arguments);let n=Math.sqrt(e);return isNaN(n)&&(n=V),n}function df(e,n){if(e=K(H(e)),n=K(H(n)),U(e,n))return C;const t=W.mean(n),r=W.mean(e),s=n.length;let c=0,a=0,h=0;for(let g=0;g<s;g++)c+=Math.pow(e[g]-r,2),a+=(n[g]-t)*(e[g]-r),h+=Math.pow(n[g]-t,2);return Math.sqrt((c-a*a/h)/(s-2))}He.DIST=(e,n,t)=>t!==1&&t!==2?V:t===1?He.DIST.RT(e,n):He.DIST["2T"](e,n);He.DIST["2T"]=function(e,n){return arguments.length!==2?ee:e<0||n<1?V:typeof e!="number"||typeof n!="number"?C:(1-W.studentt.cdf(e,n))*2};He.DIST.RT=function(e,n){return arguments.length!==2?ee:e<0||n<1?V:typeof e!="number"||typeof n!="number"?C:1-W.studentt.cdf(e,n)};He.INV=(e,n)=>(e=A(e),n=A(n),U(e,n)?C:W.studentt.inv(e,n));He.INV["2T"]=(e,n)=>(e=A(e),n=A(n),e<=0||e>1||n<1?V:U(e,n)?C:Math.abs(W.studentt.inv(e/2,n)));He.TEST=(e,n)=>{if(e=K(H(e)),n=K(H(n)),U(e,n))return C;const t=W.mean(e),r=W.mean(n);let s=0,c=0,a;for(a=0;a<e.length;a++)s+=Math.pow(e[a]-t,2);for(a=0;a<n.length;a++)c+=Math.pow(n[a]-r,2);s=s/(e.length-1),c=c/(n.length-1);const h=Math.abs(t-r)/Math.sqrt(s/e.length+c/n.length);return He.DIST["2T"](h,e.length+n.length-2)};function vf(e,n,t){if(e=K(H(e)),n=K(H(n)),t=K(H(t)),U(e,n,t))return C;const r=nt(e,n),s=r[0],c=r[1],a=[];return t.forEach(h=>{a.push(s*h+c)}),a}function pf(e,n){if(e=K(H(e)),n=A(n),U(e,n))return C;const t=vn(e.length*n,2)/2;return W.mean(Xs(Te(e.sort((r,s)=>r-s),t),t))}const $e={};$e.P=function(){const e=rn(H(arguments)),n=e.length;let t=0;const r=hn(e);let s;for(let c=0;c<n;c++)t+=Math.pow(e[c]-r,2);return s=t/n,isNaN(s)&&(s=V),s};$e.S=function(){const e=rn(H(arguments)),n=e.length;let t=0;const r=hn(e);for(let s=0;s<n;s++)t+=Math.pow(e[s]-r,2);return t/(n-1)};function To(){const e=H(arguments),n=e.length;let t=0,r=0;const s=Jr(e);for(let c=0;c<n;c++){const a=e[c];typeof a=="number"?t+=Math.pow(a-s,2):a===!0?t+=Math.pow(1-s,2):t+=Math.pow(0-s,2),a!==null&&r++}return t/(r-1)}function Mo(){const e=H(arguments),n=e.length;let t=0,r=0;const s=Jr(e);let c;for(let a=0;a<n;a++){const h=e[a];typeof h=="number"?t+=Math.pow(h-s,2):h===!0?t+=Math.pow(1-s,2):t+=Math.pow(0-s,2),h!==null&&r++}return c=t/r,isNaN(c)&&(c=V),c}const st={};st.DIST=(e,n,t,r)=>(e=A(e),n=A(n),t=A(t),U(e,n,t)?C:r?1-Math.exp(-Math.pow(e/t,n)):Math.pow(e,n-1)*Math.exp(-Math.pow(e/t,n))*n/Math.pow(t,n));const it={};it.TEST=(e,n,t)=>{if(e=K(H(e)),n=A(n),U(e,n))return C;t=t||ze.S(e);const r=e.length;return 1-Ke.S.DIST((hn(e)-n)/(t/Math.sqrt(r)),!0)};function wf(e){return e=A(e),e instanceof Error?e:Math.abs(e)}function mf(e){if(e=A(e),e instanceof Error)return e;let n=Math.acos(e);return isNaN(n)&&(n=V),n}function Ef(e){if(e=A(e),e instanceof Error)return e;let n=Math.log(e+Math.sqrt(e*e-1));return isNaN(n)&&(n=V),n}function Nf(e){return e=A(e),e instanceof Error?e:Math.atan(1/e)}function If(e){if(e=A(e),e instanceof Error)return e;let n=.5*Math.log((e+1)/(e-1));return isNaN(n)&&(n=V),n}function Af(e,n,t,r){if(e=A(e),n=A(e),U(e,n))return C;switch(e){case 1:return hn(t);case 2:return Ln(t);case 3:return Fn(t);case 4:return Qn(t);case 5:return Jn(t);case 6:return bn(t);case 7:return ze.S(t);case 8:return ze.P(t);case 9:return en(t);case 10:return $e.S(t);case 11:return $e.P(t);case 12:return Ao(t);case 13:return gn.SNGL(t);case 14:return Io(t,r);case 15:return yo(t,r);case 16:return Be.INC(t,r);case 17:return dn.INC(t,r);case 18:return Be.EXC(t,r);case 19:return dn.EXC(t,r)}}function Rf(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return C;let n=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,t=>{n+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),n}function yf(e){if(e=A(e),e instanceof Error)return e;let n=Math.asin(e);return isNaN(n)&&(n=V),n}function Tf(e){return e=A(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))}function Mf(e){return e=A(e),e instanceof Error?e:Math.atan(e)}function Cf(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||Math.atan2(e,n)}function Df(e){if(e=A(e),e instanceof Error)return e;let n=Math.log((1+e)/(1-e))/2;return isNaN(n)&&(n=V),n}function Of(e,n,t){e=A(e),n=A(n),t=A(t);const r=ce(e,n,t);if(r)return r;if(n===0)return V;const s=e.toString(n);return new Array(Math.max(t+1-s.length,0)).join("0")+s}function sn(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||(n===0?0:e>0&&n<0?V:Math.ceil(e/n)*n)}sn.MATH=(e,n,t=0)=>{n===void 0&&(n=e>0?1:-1),e=A(e),n=A(n),t=A(t);const r=ce(e,n,t);return r||(n===0?0:(n=Math.abs(n),t===0||e>0?Math.ceil(e/n)*n:Math.floor(e/n)*n))};sn.PRECISE=(e,n)=>sn.MATH(e,n);function An(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||(e<n?V:_e(e)/(_e(n)*_e(e-n)))}function Lf(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||(e<n?V:e===0&&n===0?1:An(e+n-1,e-1))}function Ff(e){return e=A(e),e instanceof Error?e:Math.cos(e)}function Pf(e){return e=A(e),e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2}function Vf(e){return e=A(e),e instanceof Error?e:e===0?Fe:1/Math.tan(e)}function qf(e){if(e=A(e),e instanceof Error)return e;if(e===0)return Fe;const n=Math.exp(2*e);return(n+1)/(n-1)}function Uf(e){return e=A(e),e instanceof Error?e:e===0?Fe:1/Math.sin(e)}function $f(e){return e=A(e),e instanceof Error?e:e===0?Fe:2/(Math.exp(e)-Math.exp(-e))}function xf(e,n){if(arguments.length<2)return ee;e=e||"0",n=A(n);const t=ce(e,n);if(t)return t;if(n===0)return V;const r=parseInt(e,n);return isNaN(r)?V:r}function zf(e){return e=A(e),e instanceof Error?e:e*180/Math.PI}function Hf(e){return e=A(e),e instanceof Error?e:sn.MATH(e,-2,-1)}function Yf(e){return arguments.length<1?ee:arguments.length>1?Xr:(e=A(e),e instanceof Error||(e=Math.exp(e)),e)}const Wn=[];function _e(e){if(e=A(e),e instanceof Error)return e;const n=Math.floor(e);return n===0||n===1?1:(Wn[n]>0||(Wn[n]=_e(n-1)*n),Wn[n])}function Co(e){if(e=A(e),e instanceof Error)return e;const n=Math.floor(e);return n<=0?1:n*Co(n-2)}function vn(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||(n?e>0&&n<0?V:Math.floor(e/n)*n:Fe)}vn.MATH=(e,n=1,t=0)=>{e=A(e),n=A(n),t=A(t);const r=ce(e,n,t);return r||(n===0?0:(n=Math.abs(n),t===0||e>0?Math.floor(e/n)*n:Math.ceil(e/n)*n))};vn.PRECISE=(e,n)=>vn.MATH(e,n);function Bf(){const e=K(H(arguments));if(e instanceof Error)return e;const n=e.length,t=e[0];let r=t<0?-t:t;for(let s=1;s<n;s++){const c=e[s];let a=c<0?-c:c;for(;r&&a;)r>a?r%=a:a%=r;r+=a}return r}function Gf(e){return e=A(e),e instanceof Error?e:Math.floor(e)}const kf={CEILING:sn};function Wf(){const e=K(H(arguments));if(e instanceof Error)return e;for(var n,t,r,s,c=1;(r=e.pop())!==void 0;){if(r===0)return 0;for(;r>1;){if(r%2){for(n=3,t=Math.floor(Math.sqrt(r));n<=t&&r%n;n+=2);s=n<=t?n:r}else s=2;for(r/=s,c*=s,n=e.length;n;e[--n]%s===0&&(e[n]/=s)===1&&e.splice(n,1));}}return c}function Sf(e){return e=A(e),e instanceof Error?e:e===0?V:Math.log(e)}function Xf(e,n){e=A(e),n=n?A(n):10;const t=ce(e,n);return t||(e===0||n===0?V:Math.log(e)/Math.log(n))}function Kf(e){return e=A(e),e instanceof Error?e:e===0?V:Math.log(e)/Math.log(10)}function Zf(e,n){return!Array.isArray(e)||!Array.isArray(n)||e.some(r=>!r.length)||n.some(r=>!r.length)||Gr(e).some(r=>typeof r!="number")||Gr(n).some(r=>typeof r!="number")||e[0].length!==n.length?C:Array(e.length).fill(0).map(()=>Array(n[0].length).fill(0)).map((r,s)=>r.map((c,a)=>e[s].reduce((h,g,f)=>h+g*n[f][a],0)))}function Qf(e,n){e=A(e),n=A(n);const t=ce(e,n);if(t)return t;if(n===0)return Fe;let r=Math.abs(e%n);return r=e<0?n-r:r,n>0?r:-r}function Jf(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||(e*n===0?0:e*n<0?V:Math.round(e/n)*n)}function bf(){const e=K(H(arguments));if(e instanceof Error)return e;let n=0,t=1;for(let r=0;r<e.length;r++)n+=e[r],t*=_e(e[r]);return _e(n)/t}function _f(e){return arguments.length>1?ee:(e=parseInt(e),!e||e<=0?C:Array(e).fill(0).map(()=>Array(e).fill(0)).map((n,t)=>(n[t]=1,n)))}function jf(e){if(e=A(e),e instanceof Error)return e;let n=Math.ceil(Math.abs(e));return n=n&1?n:n+1,e>=0?n:-n}function eu(){return Math.PI}function Do(e,n){e=A(e),n=A(n);const t=ce(e,n);if(t)return t;if(e===0&&n===0)return V;const r=Math.pow(e,n);return isNaN(r)?V:r}function bn(){const n=H(arguments).filter(s=>s!=null);if(n.length===0)return 0;const t=K(n);if(t instanceof Error)return t;let r=1;for(let s=0;s<t.length;s++)r*=t[s];return r}function nu(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||parseInt(e/n,10)}function ru(e){return e=A(e),e instanceof Error?e:e*Math.PI/180}function tu(){return Math.random()}function ou(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||e+Math.ceil((n-e+1)*Math.random())-1}function su(e){if(e=A(e),e instanceof Error)return e;const n=String(e).split(""),t=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let r="",s=3;for(;s--;)r=(t[+n.pop()+s*10]||"")+r;return new Array(+n.join("")+1).join("M")+r}function Oo(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||+(Math.round(+(e+"e"+n))+"e"+n*-1)}function iu(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,n))/Math.pow(10,n)}function fu(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,n))/Math.pow(10,n)}function uu(e){return e=A(e),e instanceof Error?e:1/Math.cos(e)}function lu(e){return e=A(e),e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))}function cu(e,n,t,r){if(e=A(e),n=A(n),t=A(t),r=K(r),U(e,n,t,r))return C;let s=r[0]*Math.pow(e,n);for(let c=1;c<r.length;c++)s+=r[c]*Math.pow(e,n+c*t);return s}function au(e){return e=A(e),e instanceof Error?e:e<0?-1:e===0?0:1}function hu(e){return e=A(e),e instanceof Error?e:Math.sin(e)}function gu(e){return e=A(e),e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2}function du(e){return e=A(e),e instanceof Error?e:e<0?V:Math.sqrt(e)}function vu(e){return e=A(e),e instanceof Error?e:Math.sqrt(e*Math.PI)}function pu(e,n){if(e=A(e),e instanceof Error)return e;switch(e){case 1:return hn(n);case 2:return Ln(n);case 3:return Fn(n);case 4:return Qn(n);case 5:return Jn(n);case 6:return bn(n);case 7:return ze.S(n);case 8:return ze.P(n);case 9:return en(n);case 10:return $e.S(n);case 11:return $e.P(n);case 101:return hn(n);case 102:return Ln(n);case 103:return Fn(n);case 104:return Qn(n);case 105:return Jn(n);case 106:return bn(n);case 107:return ze.S(n);case 108:return ze.P(n);case 109:return en(n);case 110:return $e.S(n);case 111:return $e.P(n)}}function en(){let e=0;return Ve(tr(arguments),n=>{if(e instanceof Error)return!1;if(n instanceof Error)e=n;else if(typeof n=="number")e+=n;else if(typeof n=="string"){const t=parseFloat(n);!isNaN(t)&&(e+=t)}else if(Array.isArray(n)){const t=en.apply(null,n);t instanceof Error?e=t:e+=t}}),e}function wu(e,n,t){if(e=H(e),t=t?H(t):e,e instanceof Error)return e;if(n==null||n instanceof Error)return 0;let r=0;const s=n==="*",c=s?null:Tn(n+"");for(let a=0;a<e.length;a++){const h=e[a],g=t[a];if(s)r+=h;else{const f=[be(h,un)].concat(c);r+=Mn(f)?g:0}}return r}function mu(){const e=sr(...arguments);return en(e)}function Eu(){if(!arguments||arguments.length===0)return C;const e=arguments.length+1;let n=0,t,r,s,c;for(let a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(let h=0;h<arguments[0][a].length;h++){for(t=1,r=1;r<e;r++){const g=arguments[r-1][a][h];if(g instanceof Error)return g;if(c=A(g),c instanceof Error)return c;t*=c}n+=t}else{for(t=1,r=1;r<e;r++){const h=arguments[r-1][a];if(h instanceof Error)return h;if(s=A(h),s instanceof Error)return s;t*=s}n+=t}return n}function Nu(){const e=K(H(arguments));if(e instanceof Error)return e;let n=0;const t=e.length;for(let r=0;r<t;r++)n+=fr(e[r])?e[r]*e[r]:0;return n}function Iu(e,n){if(e=K(H(e)),n=K(H(n)),U(e,n))return C;let t=0;for(let r=0;r<e.length;r++)t+=e[r]*e[r]-n[r]*n[r];return t}function Au(e,n){if(e=K(H(e)),n=K(H(n)),U(e,n))return C;let t=0;e=K(H(e)),n=K(H(n));for(let r=0;r<e.length;r++)t+=e[r]*e[r]+n[r]*n[r];return t}function Ru(e,n){if(e=K(H(e)),n=K(H(n)),U(e,n))return C;let t=0;e=H(e),n=H(n);for(let r=0;r<e.length;r++)t+=Math.pow(e[r]-n[r],2);return t}function yu(e){return e=A(e),e instanceof Error?e:Math.tan(e)}function Tu(e){if(e=A(e),e instanceof Error)return e;const n=Math.exp(2*e);return(n-1)/(n+1)}function Mu(e,n){e=A(e),n=A(n);const t=ce(e,n);return t||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,n))/Math.pow(10,n)}function Cu(e,n){if(arguments.length!==2)return ee;e=A(e),n=A(n);const t=ce(e,n);return t||e+n}function Du(e,n){if(arguments.length!==2)return ee;e=A(e),n=A(n);const t=ce(e,n);return t||(n===0?Fe:e/n)}function Ou(e,n){return arguments.length!==2?ee:e instanceof Error?e:n instanceof Error?n:(e===null&&(e=void 0),n===null&&(n=void 0),e===n)}function Lu(e,n){if(arguments.length!==2)return ee;if(e instanceof Error)return e;if(n instanceof Error)return n;or(e,n)?(e=Me(e),n=Me(n)):(e=A(e),n=A(n));const t=ce(e,n);return t||e>n}function Fu(e,n){if(arguments.length!==2)return ee;or(e,n)?(e=Me(e),n=Me(n)):(e=A(e),n=A(n));const t=ce(e,n);return t||e>=n}function Pu(e,n){if(arguments.length!==2)return ee;or(e,n)?(e=Me(e),n=Me(n)):(e=A(e),n=A(n));const t=ce(e,n);return t||e<n}function Vu(e,n){if(arguments.length!==2)return ee;or(e,n)?(e=Me(e),n=Me(n)):(e=A(e),n=A(n));const t=ce(e,n);return t||e<=n}function qu(e,n){if(arguments.length!==2)return ee;e=A(e),n=A(n);const t=ce(e,n);return t||e-n}function Uu(e,n){if(arguments.length!==2)return ee;e=A(e),n=A(n);const t=ce(e,n);return t||e*n}function $u(e,n){return arguments.length!==2?ee:e instanceof Error?e:n instanceof Error?n:(e===null&&(e=void 0),n===null&&(n=void 0),e!==n)}function xu(e,n){return arguments.length!==2?ee:Do(e,n)}var zu=Object.freeze({__proto__:null,ADD:Cu,DIVIDE:Du,EQ:Ou,GT:Lu,GTE:Fu,LT:Pu,LTE:Vu,MINUS:qu,MULTIPLY:Uu,NE:$u,POW:xu});const Hu=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Yu=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],_n=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Bu(e,n,t){let r;return e=A(e),n=A(n),t=A(t),U(e,n,t)?r=C:(r=new Date(e,n-1,t),r.getFullYear()<0&&(r=V)),nn?je(r):r}function on(e,n,t){t=t.toUpperCase(),e=he(e),n=he(n);const r=e.getFullYear(),s=e.getMonth(),c=e.getDate(),a=n.getFullYear(),h=n.getMonth(),g=n.getDate();let f;switch(t){case"Y":f=Math.floor(ft(e,n));break;case"D":f=an(n,e);break;case"M":f=h-s+12*(a-r),g<c&&f--;break;case"MD":c<=g?f=g-c:(h===0?(e.setFullYear(a-1),e.setMonth(12)):(e.setFullYear(a),e.setMonth(h-1)),f=an(n,e));break;case"YM":f=h-s+12*(a-r),g<c&&f--,f=f%12;break;case"YD":h>s||h===s&&g<c?e.setFullYear(a):e.setFullYear(a-1),f=an(n,e);break}return f}function Gu(e){if(typeof e!="string")return C;const n=Date.parse(e);if(isNaN(n))return C;const t=new Date(e);return nn?je(t):t}function ku(e){const n=he(e);return n instanceof Error?n:n.getDate()}function jn(e){const n=new Date(e);return n.setHours(0,0,0,0),n}function an(e,n){return e=he(e),n=he(n),e instanceof Error?e:n instanceof Error?n:je(jn(e))-je(jn(n))}function fn(e,n,t){if(t=Zr(t||"false"),e=he(e),n=he(n),e instanceof Error)return e;if(n instanceof Error)return n;if(t instanceof Error)return t;const r=e.getMonth();let s=n.getMonth(),c,a;if(t)c=e.getDate()===31?30:e.getDate(),a=n.getDate()===31?30:n.getDate();else{const h=new Date(e.getFullYear(),r+1,0).getDate(),g=new Date(n.getFullYear(),s+1,0).getDate();c=e.getDate()===h?30:e.getDate(),n.getDate()===g?c<30?(s++,a=1):a=30:a=n.getDate()}return 360*(n.getFullYear()-e.getFullYear())+30*(s-r)+(a-c)}function Wu(e,n){if(e=he(e),e instanceof Error)return e;if(isNaN(n))return C;let t=e.getDate();e.setDate(1),n=parseInt(n,10),e.setMonth(e.getMonth()+n);let r=e.getMonth();if(t>28){let s=[31,28,31,30,31,30,31,31,30,31,30,31][r],c=e.getFullYear();r===1&&(c%4===0&&c%100!==0||c%400===0)&&(s=29),t=Math.min(t,s)}return e.setDate(t),nn?je(e):e}function Su(e,n){if(e=he(e),e instanceof Error)return e;if(isNaN(n))return C;n=parseInt(n,10);const t=new Date(e.getFullYear(),e.getMonth()+n+1,0);return nn?je(t):t}function Xu(e){return e=he(e),e instanceof Error?e:e.getHours()}function Lo(e){if(e=he(e),e instanceof Error)return e;e=jn(e),e.setDate(e.getDate()+4-(e.getDay()||7));const n=new Date(e.getFullYear(),0,1);return Math.ceil(((e-n)/864e5+1)/7)}function Ku(e){return e=he(e),e instanceof Error?e:e.getMinutes()}function Zu(e){return e=he(e),e instanceof Error?e:e.getMonth()+1}function ur(e,n,t){return ur.INTL(e,n,1,t)}ur.INTL=(e,n,t,r)=>{if(e=he(e),e instanceof Error)return e;if(n=he(n),n instanceof Error)return n;let s=!1;const c=[],a=[1,2,3,4,5,6,0],h=new RegExp("^[0|1]{7}$");if(t===void 0)t=_n[1];else if(typeof t=="string"&&h.test(t)){s=!0,t=t.split("");for(let i=0;i<t.length;i++)t[i]==="1"&&c.push(a[i])}else t=_n[t];if(!(t instanceof Array))return C;r===void 0?r=[]:r instanceof Array||(r=[r]);for(let i=0;i<r.length;i++){const u=he(r[i]);if(u instanceof Error)return u;r[i]=u}const g=Math.round((n-e)/(1e3*60*60*24))+1;let f=g;const o=e;for(let i=0;i<g;i++){const u=new Date().getTimezoneOffset()>0?o.getUTCDay():o.getDay();let l=s?c.includes(u):u===t[0]||u===t[1];for(let d=0;d<r.length;d++){const v=r[d];if(v.getDate()===o.getDate()&&v.getMonth()===o.getMonth()&&v.getFullYear()===o.getFullYear()){l=!0;break}}l&&f--,o.setDate(o.getDate()+1)}return f};function Qu(){return nn?je(new Date):new Date}function Ju(e){return e=he(e),e instanceof Error?e:e.getSeconds()}function bu(e,n,t){return e=A(e),n=A(n),t=A(t),U(e,n,t)?C:e<0||n<0||t<0?V:(3600*e+60*n+t)/86400}function _u(e){return e=he(e),e instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400}function ju(){const e=jn(new Date);return nn?je(e):e}function el(e,n){if(e=he(e),e instanceof Error)return e;n===void 0&&(n=1);const t=e.getDay();return Yu[n][t]}function nl(e,n){if(e=he(e),e instanceof Error)return e;if(n===void 0&&(n=1),n===21)return Lo(e);const t=Hu[n];let r=new Date(e.getFullYear(),0,1);const s=r.getDay()<t?1:0;return r-=Math.abs(r.getDay()-t)*24*60*60*1e3,Math.floor((e-r)/(1e3*60*60*24)/7+1)+s}function lr(e,n,t){return lr.INTL(e,n,1,t)}lr.INTL=(e,n,t,r)=>{if(e=he(e),e instanceof Error)return e;if(n=A(n),n instanceof Error)return n;if(t===void 0?t=_n[1]:t=_n[t],!(t instanceof Array))return C;r===void 0?r=[]:r instanceof Array||(r=[r]);for(let a=0;a<r.length;a++){const h=he(r[a]);if(h instanceof Error)return h;r[a]=h}let s=0;const c=Math.sign(n);for(;s<n*c;){e.setDate(e.getDate()+c);const a=e.getDay();if(!(a===t[0]||a===t[1])){for(let h=0;h<r.length;h++){const g=r[h];if(g.getDate()===e.getDate()&&g.getMonth()===e.getMonth()&&g.getFullYear()===e.getFullYear()){s--;break}}s++}}return e.getFullYear()<1900?C:e};function rl(e){return e=he(e),e instanceof Error?e:e.getFullYear()}function wr(e){return new Date(e,1,29).getMonth()===1}function Sn(e,n){return Math.ceil((n-e)/1e3/60/60/24)}function ft(e,n,t){if(e=he(e),e instanceof Error)return e;if(n=he(n),n instanceof Error)return n;t=t||0;let r=e.getDate();const s=e.getMonth()+1,c=e.getFullYear();let a=n.getDate();const h=n.getMonth()+1,g=n.getFullYear();switch(t){case 0:return r===31&&a===31?(r=30,a=30):r===31?r=30:r===30&&a===31&&(a=30),(a+h*30+g*360-(r+s*30+c*360))/360;case 1:{const f=(d,v)=>{const p=d.getFullYear(),m=new Date(p,2,1);if(wr(p)&&d<m&&v>=m)return!0;const E=v.getFullYear(),w=new Date(E,2,1);return wr(E)&&v>=w&&d<w};let o=365;if(c===g||c+1===g&&(s>h||s===h&&r>=a))return(c===g&&wr(c)||f(e,n)||h===1&&a===29)&&(o=366),Sn(e,n)/o;const i=g-c+1,l=(new Date(g+1,0,1)-new Date(c,0,1))/1e3/60/60/24/i;return Sn(e,n)/l}case 2:return Sn(e,n)/360;case 3:return Sn(e,n)/365;case 4:return(a+h*30+g*360-(r+s*30+c*360))/360}}function ut(e){return/^[01]{1,10}$/.test(e)}function tl(e,n){return e=A(e),n=A(n),U(e,n)?C:nr.besseli(e,n)}function ol(e,n){return e=A(e),n=A(n),U(e,n)?C:nr.besselj(e,n)}function sl(e,n){return e=A(e),n=A(n),U(e,n)?C:nr.besselk(e,n)}function il(e,n){return e=A(e),n=A(n),U(e,n)?C:nr.bessely(e,n)}function fl(e){if(!ut(e))return V;const n=parseInt(e,2),t=e.toString();return t.length===10&&t.substring(0,1)==="1"?parseInt(t.substring(1),2)-512:n}function ul(e,n){if(!ut(e))return V;const t=e.toString();if(t.length===10&&t.substring(0,1)==="1")return(0xfffffffe00+parseInt(t.substring(1),2)).toString(16);const r=parseInt(e,2).toString(16);return n===void 0?r:isNaN(n)?C:n<0?V:(n=Math.floor(n),n>=r.length?Ge("0",n-r.length)+r:V)}function ll(e,n){if(!ut(e))return V;const t=e.toString();if(t.length===10&&t.substring(0,1)==="1")return(1073741312+parseInt(t.substring(1),2)).toString(8);const r=parseInt(e,2).toString(8);return n===void 0?r:isNaN(n)?C:n<0?V:(n=Math.floor(n),n>=r.length?Ge("0",n-r.length)+r:V)}function cl(e,n){return e=A(e),n=A(n),U(e,n)?C:e<0||n<0||Math.floor(e)!==e||Math.floor(n)!==n||e>0xffffffffffff||n>0xffffffffffff?V:e&n}function al(e,n){return e=A(e),n=A(n),U(e,n)?C:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(n)>53?V:n>=0?e<<n:e>>-n}function hl(e,n){return e=A(e),n=A(n),U(e,n)?C:e<0||n<0||Math.floor(e)!==e||Math.floor(n)!==n||e>0xffffffffffff||n>0xffffffffffff?V:e|n}function gl(e,n){return e=A(e),n=A(n),U(e,n)?C:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(n)>53?V:n>=0?e>>n:e<<-n}function dl(e,n){return e=A(e),n=A(n),U(e,n)?C:e<0||n<0||Math.floor(e)!==e||Math.floor(n)!==n||e>0xffffffffffff||n>0xffffffffffff?V:e^n}function qe(e,n,t){if(e=A(e),n=A(n),U(e,n))return e;if(t=t===void 0?"i":t,t!=="i"&&t!=="j")return C;if(e===0&&n===0)return 0;if(e===0)return n===1?t:n.toString()+t;if(n===0)return e.toString();{const r=n>0?"+":"";return e.toString()+r+(n===1?t:n.toString()+t)}}function vl(e,n,t){if(e=A(e),e instanceof Error)return e;const r=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m3",["m^3"],"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},c={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let a=null,h=null,g=n,f=t,o=1,i=1,u;for(let l=0;l<r.length;l++)u=r[l][2]===null?[]:r[l][2],(r[l][1]===g||u.indexOf(g)>=0)&&(a=r[l]),(r[l][1]===f||u.indexOf(f)>=0)&&(h=r[l]);if(a===null){const l=s[n.substring(0,2)];let d=c[n.substring(0,1)];n.substring(0,2)==="da"&&(d=["dekao",10,"da"]),l?(o=l[2],g=n.substring(2)):d&&(o=d[1],g=n.substring(d[2].length));for(let v=0;v<r.length;v++)u=r[v][2]===null?[]:r[v][2],(r[v][1]===g||u.indexOf(g)>=0)&&(a=r[v])}if(h===null){const l=s[t.substring(0,2)];let d=c[t.substring(0,1)];t.substring(0,2)==="da"&&(d=["dekao",10,"da"]),l?(i=l[2],f=t.substring(2)):d&&(i=d[1],f=t.substring(d[2].length));for(let v=0;v<r.length;v++)u=r[v][2]===null?[]:r[v][2],(r[v][1]===f||u.indexOf(f)>=0)&&(h=r[v])}return a===null||h===null||a[3]!==h[3]?ee:e*a[6]*o/(h[6]*i)}function pl(e,n){if(e=A(e),e instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return V;if(e<0)return"1"+Ge("0",9-(512+e).toString(2).length)+(512+e).toString(2);const t=parseInt(e,10).toString(2);return typeof n>"u"?t:isNaN(n)?C:n<0?V:(n=Math.floor(n),n>=t.length?Ge("0",n-t.length)+t:V)}function wl(e,n){if(e=A(e),e instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return V;if(e<0)return(1099511627776+e).toString(16);const t=parseInt(e,10).toString(16);return typeof n>"u"?t:isNaN(n)?C:n<0?V:(n=Math.floor(n),n>=t.length?Ge("0",n-t.length)+t:V)}function ml(e,n){if(e=A(e),e instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return V;if(e<0)return(1073741824+e).toString(8);const t=parseInt(e,10).toString(8);return typeof n>"u"?t:isNaN(n)?C:n<0?V:(n=Math.floor(n),n>=t.length?Ge("0",n-t.length)+t:V)}function El(e,n){return n=n===void 0?0:n,e=A(e),n=A(n),U(e,n)?C:e===n?1:0}function Fo(e,n){return n=n===void 0?0:n,e=A(e),n=A(n),U(e,n)?C:W.erf(e)}function Po(e){return isNaN(e)?C:W.erfc(e)}function Nl(e,n){return n=n||0,e=A(e),U(n,e)?e:e>=n?1:0}function Il(e,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return V;const t=e.length===10&&e.substring(0,1).toLowerCase()==="f",r=t?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<-512||r>511)return V;if(t)return"1"+Ge("0",9-(512+r).toString(2).length)+(512+r).toString(2);const s=r.toString(2);return n===void 0?s:isNaN(n)?C:n<0?V:(n=Math.floor(n),n>=s.length?Ge("0",n-s.length)+s:V)}function Al(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return V;const n=parseInt(e,16);return n>=549755813888?n-1099511627776:n}function Rl(e,n){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return V;const t=parseInt(e,16);if(t>536870911&&t<0xffe0000000)return V;if(t>=0xffe0000000)return(t-0xffc0000000).toString(8);const r=t.toString(8);return n===void 0?r:isNaN(n)?C:n<0?V:(n=Math.floor(n),n>=r.length?Ge("0",n-r.length)+r:V)}function lt(e){const n=Ie(e),t=Ne(e);return U(n,t)?C:Math.sqrt(Math.pow(n,2)+Math.pow(t,2))}function Ne(e){if(e===void 0||e===!0||e===!1)return C;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;e=e+"",e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");let n=e.indexOf("+"),t=e.indexOf("-");n===0&&(n=e.indexOf("+",1)),t===0&&(t=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),s=r==="i"||r==="j";return n>=0||t>=0?s?n>=0?isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?V:Number(e.substring(n+1,e.length-1)):isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?V:-Number(e.substring(t+1,e.length-1)):V:s?isNaN(e.substring(0,e.length-1))?V:e.substring(0,e.length-1):isNaN(e)?V:0}function ct(e){const n=Ie(e),t=Ne(e);return U(n,t)?C:n===0&&t===0?Fe:n===0&&t>0?Math.PI/2:n===0&&t<0?-Math.PI/2:t===0&&n>0?0:t===0&&n<0?-Math.PI:n>0?Math.atan(t/n):n<0&&t>=0?Math.atan(t/n)+Math.PI:Math.atan(t/n)-Math.PI}function yl(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",t!==0?qe(n,-t,r):e}function cr(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",qe(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,-Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,r)}function Vo(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",qe(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,r)}function Tl(e){const n=Ie(e),t=Ne(e);return U(n,t)?C:mn(cr(e),ar(e))}function mn(e,n){const t=Ie(e),r=Ne(e),s=Ie(n),c=Ne(n);if(U(t,r,s,c))return C;const a=e.substring(e.length-1),h=n.substring(n.length-1);let g="i";if((a==="j"||h==="j")&&(g="j"),s===0&&c===0)return V;const f=s*s+c*c;return qe((t*s+r*c)/f,(r*s-t*c)/f,g)}function Ml(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);r=r==="i"||r==="j"?r:"i";const s=Math.exp(n);return qe(s*Math.cos(t),s*Math.sin(t),r)}function Cl(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",qe(Math.log(Math.sqrt(n*n+t*t)),Math.atan(t/n),r)}function Dl(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",qe(Math.log(Math.sqrt(n*n+t*t))/Math.log(10),Math.atan(t/n)/Math.log(10),r)}function Ol(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",qe(Math.log(Math.sqrt(n*n+t*t))/Math.log(2),Math.atan(t/n)/Math.log(2),r)}function Ll(e,n){n=A(n);const t=Ie(e),r=Ne(e);if(U(n,t,r))return C;let s=e.substring(e.length-1);s=s==="i"||s==="j"?s:"i";const c=Math.pow(lt(e),n),a=ct(e);return qe(c*Math.cos(n*a),c*Math.sin(n*a),s)}function Fl(){let e=arguments[0];if(!arguments.length)return C;for(let n=1;n<arguments.length;n++){const t=Ie(e),r=Ne(e),s=Ie(arguments[n]),c=Ne(arguments[n]);if(U(t,r,s,c))return C;e=qe(t*s-r*c,t*c+r*s)}return e}function Ie(e){if(e===void 0||e===!0||e===!1)return C;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;e=e+"";let n=e.indexOf("+"),t=e.indexOf("-");n===0&&(n=e.indexOf("+",1)),t===0&&(t=e.indexOf("-",1));const r=e.substring(e.length-1,e.length),s=r==="i"||r==="j";return n>=0||t>=0?s?n>=0?isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?V:Number(e.substring(0,n)):isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?V:Number(e.substring(0,t)):V:s?isNaN(e.substring(0,e.length-1))?V:0:isNaN(e)?V:e}function Pl(e){if(e===!0||e===!1)return C;const n=Ie(e),t=Ne(e);return U(n,t)?C:mn("1",cr(e))}function Vl(e){const n=Ie(e),t=Ne(e);return U(n,t)?C:mn("1",Vo(e))}function ar(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",qe(Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,r)}function qo(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);return r=r==="i"||r==="j"?r:"i",qe(Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,r)}function ql(e){const n=Ie(e),t=Ne(e);if(U(n,t))return C;let r=e.substring(e.length-1);r=r==="i"||r==="j"?r:"i";const s=Math.sqrt(lt(e)),c=ct(e);return qe(s*Math.cos(c/2),s*Math.sin(c/2),r)}function Ul(e){if(e===!0||e===!1)return C;const n=Ie(e),t=Ne(e);return U(n,t)?V:mn("1",ar(e))}function $l(e){if(e===!0||e===!1)return C;const n=Ie(e),t=Ne(e);return U(n,t)?V:mn("1",qo(e))}function xl(e,n){const t=Ie(e),r=Ne(e),s=Ie(n),c=Ne(n);if(U(t,r,s,c))return C;const a=e.substring(e.length-1),h=n.substring(n.length-1);let g="i";return(a==="j"||h==="j")&&(g="j"),qe(t-s,r-c,g)}function zl(){if(!arguments.length)return C;const e=H(arguments);let n=0,t=0;for(const r of e){const s=+Ie(r),c=+Ne(r);if(U(s,c))return C;n+=s,t+=c}return qe(n,t,"i")}function Hl(e){if(e===!0||e===!1)return C;const n=Ie(e),t=Ne(e);return U(n,t)?C:mn(ar(e),cr(e))}function Yl(e,n){if(!/^[0-7]{1,10}$/.test(e))return V;const t=e.length===10&&e.substring(0,1)==="7",r=t?parseInt(e,8)-1073741824:parseInt(e,8);if(r<-512||r>511)return V;if(t)return"1"+Ge("0",9-(512+r).toString(2).length)+(512+r).toString(2);const s=r.toString(2);return typeof n>"u"?s:isNaN(n)?C:n<0?V:(n=Math.floor(n),n>=s.length?Ge("0",n-s.length)+s:V)}function Bl(e){if(!/^[0-7]{1,10}$/.test(e))return V;const n=parseInt(e,8);return n>=536870912?n-1073741824:n}function Gl(e,n){if(!/^[0-7]{1,10}$/.test(e))return V;const t=parseInt(e,8);if(t>=536870912)return"ff"+(t+3221225472).toString(16);const r=t.toString(16);return n===void 0?r:isNaN(n)?C:n<0?V:(n=Math.floor(n),n>=r.length?Ge("0",n-r.length)+r:V)}const kl=Vn.DIST,Wl=Vn.INV,Sl=Cn.DIST,Xl=sn.MATH,Kl=sn.PRECISE,Zl=Se.DIST,Ql=Se.DIST.RT,Jl=Se.INV,bl=Se.INV.RT,_l=Se.TEST,jl=Dn.P,ec=Dn.P,nc=Dn.S,rc=Cn.INV,tc=Po.PRECISE,oc=Fo.PRECISE,sc=_r.DIST,ic=Xe.DIST,fc=Xe.DIST.RT,uc=Xe.INV,lc=Xe.INV.RT,cc=vn.MATH,ac=vn.PRECISE,hc=Xe.TEST,gc=qn.DIST,dc=qn.INV,vc=jr.PRECISE,pc=et.DIST,wc=On.INV,mc=On.DIST,Ec=On.INV,Nc=gn.MULT,Ic=gn.SNGL,Ac=rt.DIST,Rc=ur.INTL,yc=Ke.DIST,Tc=Ke.INV,Mc=Ke.S.DIST,Cc=Ke.S.INV,Dc=Be.EXC,Oc=Be.INC,Lc=Un.EXC,Fc=Un.INC,Pc=tt.DIST,Vc=dn.EXC,qc=dn.INC,Uc=$n.AVG,$c=$n.EQ,xc=ot.P,zc=ze.P,Hc=ze.S,Yc=He.DIST,Bc=He.DIST.RT,Gc=He.INV,kc=He.TEST,Wc=$e.P,Sc=$e.S,Xc=st.DIST,Kc=lr.INTL,Zc=it.TEST;function at(e){const n=[];return Ve(e,t=>{t&&n.push(t)}),n}function We(e,n){const t={};for(let c=1;c<e[0].length;++c)t[c]=!0;let r=n[0].length;for(let c=1;c<n.length;++c)n[c].length>r&&(r=n[c].length);for(let c=1;c<e.length;++c)for(let a=1;a<e[c].length;++a){let h=!1,g=!1;for(let f=0;f<n.length;++f){const o=n[f];if(o.length<r)continue;const i=o[0];if(e[c][0]===i){g=!0;for(let u=1;u<o.length;++u)if(!h)if(o[u]===void 0||o[u]==="*")h=!0;else{const d=Tn(o[u]+""),v=[be(e[c][a],un)].concat(d);h=Mn(v)}}}g&&(t[a]=t[a]&&h)}const s=[];for(let c=0;c<e[0].length;++c)t[c]&&s.push(c-1);return s}function Qc(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);let c=0;return Ve(r,a=>{c+=s[a]}),r.length===0?Fe:c/r.length}function Jc(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);const c=[];return Ve(r,a=>{c.push(s[a])}),Ln(c)}function bc(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);const c=[];return Ve(r,a=>{c.push(s[a])}),Fn(c)}function _c(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const c=ke(e,n);s=Te(e[c])}else s=Te(e[n]);return r.length===0?C:r.length>1?V:s[r[0]]}function jc(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);let c=s[r[0]];return Ve(r,a=>{c<s[a]&&(c=s[a])}),c}function ea(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);let c=s[r[0]];return Ve(r,a=>{c>s[a]&&(c=s[a])}),c}function na(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const h=ke(e,n);s=Te(e[h])}else s=Te(e[n]);let c=[];Ve(r,h=>{c.push(s[h])}),c=at(c);let a=1;return Ve(c,h=>{a*=h}),a}function ra(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);let c=[];return Ve(r,a=>{c.push(s[a])}),c=at(c),ze.S(c)}function ta(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);let c=[];return Ve(r,a=>{c.push(s[a])}),c=at(c),ze.P(c)}function oa(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);const c=[];return Ve(r,a=>{c.push(s[a])}),en(c)}function sa(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);const c=[];return Ve(r,a=>{c.push(s[a])}),$e.S(c)}function ia(e,n,t){if(isNaN(n)&&typeof n!="string")return C;const r=We(e,t);let s=[];if(typeof n=="string"){const a=ke(e,n);s=Te(e[a])}else s=Te(e[n]);const c=[];return Ve(r,a=>{c.push(s[a])}),$e.P(c)}function mr(e){return e&&e.getTime&&!isNaN(e.getTime())}function Er(e){return e instanceof Date?e:new Date(e)}function fa(e,n,t){let r=he(n);for(r.setFullYear(e.getFullYear()),r<e&&r.setFullYear(r.getFullYear()+1);r>e;)r.setMonth(r.getMonth()+-12/t);return r}function Uo(e){return e=A(e),[1,2,4].indexOf(e)===-1?V:e}function $o(e){return e=A(e),[0,1,2,3,4].indexOf(e)===-1?V:e}function ua(e,n,t,r,s,c,a){return e=Er(e),n=Er(n),t=Er(t),c=Uo(c),a=$o(a),ce(c,a)?V:!mr(e)||!mr(n)||!mr(t)?C:r<=0||s<=0||t<=e?V:(s=s||0,a=a||0,s*r*ft(e,t,a))}function la(e,n,t,r){if(r=$o(r),t=Uo(t),e=he(e),n=he(n),ce(e,n))return C;if(ce(t,r)||e>=n)return V;if(r===1){let c=fa(e,n,t),a=he(c);return a.setMonth(a.getMonth()+12/t),on(c,a,"D")}let s;switch(r){case 0:case 2:case 4:s=360;break;case 3:s=365;break;default:return V}return s/t}function ca(e,n,t,r,s,c){if(e=A(e),n=A(n),t=A(t),U(e,n,t))return C;if(e<=0||n<=0||t<=0||r<1||s<1||r>s||c!==0&&c!==1)return V;const a=xn(e,n,t,0,c);let h=0;r===1&&(c===0&&(h=-t),r++);for(let g=r;g<=s;g++)h+=c===1?pn(e,g-2,a,t,1)-a:pn(e,g-1,a,t,0);return h*=e,h}function aa(e,n,t,r,s,c){if(e=A(e),n=A(n),t=A(t),U(e,n,t))return C;if(e<=0||n<=0||t<=0||r<1||s<1||r>s||c!==0&&c!==1)return V;const a=xn(e,n,t,0,c);let h=0;r===1&&(h=c===0?a+t*e:a,r++);for(let g=r;g<=s;g++)h+=c>0?a-(pn(e,g-2,a,t,1)-a)*e:a-pn(e,g-1,a,t,0)*e;return h}function ha(e,n,t,r,s){if(s=s===void 0?12:s,e=A(e),n=A(n),t=A(t),r=A(r),s=A(s),U(e,n,t,r,s))return C;if(e<0||n<0||t<0||r<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(s)===-1||r>t)return V;if(n>=e)return 0;const c=(1-Math.pow(n/e,1/t)).toFixed(3),a=e*c*s/12;let h=a,g=0;const f=r===t?t-1:r;for(let o=2;o<=f;o++)g=(e-h)*c,h+=g;return r===1?a:r===t?(e-h)*c:g}function ga(e,n,t,r,s){if(s=s===void 0?2:s,e=A(e),n=A(n),t=A(t),r=A(r),s=A(s),U(e,n,t,r,s))return C;if(e<0||n<0||t<0||r<0||s<=0||r>t)return V;if(n>=e)return 0;let c=0,a=0;for(let h=1;h<=r;h++)a=Math.min((e-c)*(s/t),e-n-c),c+=a;return a}function da(e,n,t,r,s){if(e=he(e),n=he(n),t=A(t),r=A(r),s=A(s),s=s||0,U(e,n,t,r,s))return C;if(t<=0||r<=0)return V;if(e>=n)return C;let c,a;switch(s){case 0:c=360,a=fn(e,n,!1);break;case 1:c=365,a=on(e,n,"D");break;case 2:c=360,a=on(e,n,"D");break;case 3:c=365,a=on(e,n,"D");break;case 4:c=360,a=fn(e,n,!0);break;default:return V}return(r-t)/r*c/a}function va(e,n){if(e=A(e),n=A(n),U(e,n))return C;if(n<0)return V;if(n>=0&&n<1)return Fe;n=parseInt(n,10);let t=parseInt(e,10);t+=e%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n;const r=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1);return t=Math.round(t*r)/r,t}function pa(e,n){if(e=A(e),n=A(n),U(e,n))return C;if(n<0)return V;if(n>=0&&n<1)return Fe;n=parseInt(n,10);let t=parseInt(e,10);return t+=e%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n,t}function wa(e,n){return e=A(e),n=A(n),U(e,n)?C:e<=0||n<1?V:(n=parseInt(n,10),Math.pow(1+e/n,n)-1)}function pn(e,n,t,r,s){if(r=r||0,s=s||0,e=A(e),n=A(n),t=A(t),r=A(r),s=A(s),U(e,n,t,r,s))return C;let c;if(e===0)c=r+t*n;else{const a=Math.pow(1+e,n);c=s===1?r*a+t*(1+e)*(a-1)/e:r*a+t*(a-1)/e}return-c}function ma(e,n){if(e=A(e),n=K(H(n)),U(e,n))return C;const t=n.length;let r=e;for(let s=0;s<t;s++)r*=1+n[s];return r}function xo(e,n,t,r,s,c){if(s=s||0,c=c||0,e=A(e),n=A(n),t=A(t),r=A(r),s=A(s),c=A(c),U(e,n,t,r,s,c))return C;const a=xn(e,t,r,s,c);return(n===1?c===1?0:-r:c===1?pn(e,n-2,a,r,1)-a:pn(e,n-1,a,r,0))*e}function Ea(e,n){if(n=typeof n=="number"?n:typeof n>"u"?.1:A(n),e=H(e).filter(wn),e=K(e),U(e,n))return C;const t=new Float64Array(e.length);let r=!1,s=!1;for(let f=0;f<e.length;f++)t[f]=e[f],t[f]>0&&(r=!0),t[f]<0&&(s=!0);if(!r||!s)return V;const c=f=>{f<=-1&&(f=-.999999999);let o=t[0];const i=1+f;let u=1;for(let l=1;l<t.length;l++)u*=i,o+=t[l]/u;return o},a=new Map,h=function(f){const o=Math.round(f*1e10)/1e10;if(a.has(o))return a.get(o);const i=c(o);return a.set(o,i),i};return function(){let i=n,u=i,l=0;for(;l<1e3;){const E=h(i);if(Math.abs(E)<1e-10)return i;if(l>0&&Math.abs(i-u)<1e-10*10)break;const w=Math.max(1e-4,Math.abs(i*1e-4)),N=(h(i+w)-E)/w;if(Math.abs(N)<1e-10)break;u=i;const I=E/N,R=Math.max(.1,Math.abs(i)*.5);Math.abs(I)>R?i-=Math.sign(I)*R:i-=I,i<=-1&&(i=-.99999999),i>1e3&&(i=1e3),l++}let d=h(i);if(Math.abs(d)<1e-10)return i;let v,p;if(d>0){for(v=i,p=i+.1;h(p)>0&&p<1e3;)p=p*2+.1;if(p>=1e3)return i}else{for(p=i,v=Math.max(-.99999999,i-.1);h(v)<0&&v>-.99999999;)v=Math.max(-.99999999,v-.1);if(v<=-.99999999)return i}let m;for(let E=0;E<1e3;E++){m=(v+p)/2;const w=h(m);if(Math.abs(w)<1e-10||Math.abs(p-v)<1e-10)return m;w*h(v)<0?p=m:v=m}return m}()}function Na(e,n,t,r){return e=A(e),n=A(n),t=A(t),r=A(r),U(e,n,t,r)?C:r*e*(n/t-1)}function Ia(e,n,t){if(e=K(H(e)),n=A(n),t=A(t),U(e,n,t))return C;const r=e.length,s=[],c=[];for(let g=0;g<r;g++)e[g]<0?s.push(e[g]):c.push(e[g]);const a=-kr(t,c)*Math.pow(1+t,r-1),h=kr(n,s)*(1+n);return Math.pow(a/h,1/(r-1))-1}function Aa(e,n){return e=A(e),n=A(n),U(e,n)?C:e<=0||n<1?V:(n=parseInt(n,10),(Math.pow(e+1,1/n)-1)*n)}function Ra(e,n,t,r,s){if(s=s===void 0?0:s,r=r===void 0?0:r,e=A(e),n=A(n),t=A(t),r=A(r),s=A(s),U(e,n,t,r,s))return C;if(e===0)return-(t+r)/n;{const c=n*(1+e*s)-r*e,a=t*e+n*(1+e*s);return Math.log(c/a)/Math.log(1+e)}}function kr(){const e=K(H(arguments));if(e instanceof Error)return e;const n=e[0];let t=0;for(let r=1;r<e.length;r++)t+=e[r]/Math.pow(1+n,r);return t}function ya(e,n,t){return e=A(e),n=A(n),t=A(t),U(e,n,t)?C:e<=0?V:(Math.log(t)-Math.log(n))/Math.log(1+e)}function xn(e,n,t,r,s){if(r=r||0,s=s||0,e=A(e),n=A(n),t=A(t),r=A(r),s=A(s),U(e,n,t,r,s))return C;let c;if(e===0)c=(t+r)/n;else{const a=Math.pow(1+e,n);c=s===1?(r*e/(a-1)+t*e/(1-1/a))/(1+e):r*e/(a-1)+t*e/(1-1/a)}return-c}function Ta(e,n,t,r,s,c){return s=s||0,c=c||0,e=A(e),t=A(t),r=A(r),s=A(s),c=A(c),U(e,t,r,s,c)?C:xn(e,t,r,s,c)-xo(e,n,t,r,s,c)}function Ma(e,n,t,r,s){if(e=he(e),n=he(n),t=A(t),r=A(r),s=A(s),s=s||0,U(e,n,t,r,s))return C;if(t<=0||r<=0)return V;if(e>=n)return C;let c,a;switch(s){case 0:c=360,a=fn(e,n,!1);break;case 1:c=365,a=on(e,n,"D");break;case 2:c=360,a=on(e,n,"D");break;case 3:c=365,a=on(e,n,"D");break;case 4:c=360,a=fn(e,n,!0);break;default:return V}return r-t*r*a/c}function Ca(e,n,t,r,s){return r=r||0,s=s||0,e=A(e),n=A(n),t=A(t),r=A(r),s=A(s),U(e,n,t,r,s)?C:e===0?-t*n-r:((1-Math.pow(1+e,n))/e*t*(1+e*s)-r)/Math.pow(1+e,n)}function Da(e,n,t,r,s,c){if(c=c===void 0?.1:c,r=r===void 0?0:r,s=s===void 0?0:s,e=A(e),n=A(n),t=A(t),r=A(r),s=A(s),c=A(c),U(e,n,t,r,s,c))return C;const a=1e-10,h=100;let g=c;s=s?1:0;for(let f=0;f<h;f++){if(g<=-1)return V;let o,i;if(Math.abs(g)<a?o=t*(1+e*g)+n*(1+g*s)*e+r:(i=Math.pow(1+g,e),o=t*i+n*(1/g+s)*(i-1)+r),Math.abs(o)<a)return g;let u;if(Math.abs(g)<a)u=t*e+n*s*e;else{i=Math.pow(1+g,e);const l=e*Math.pow(1+g,e-1);u=t*l+n*(1/g+s)*l+n*(-1/(g*g))*(i-1)}g-=o/u}return g}function Oa(e,n,t){return e=A(e),n=A(n),t=A(t),U(e,n,t)?C:e===0||n===0?V:Math.pow(t/n,1/e)-1}function La(e,n,t){return e=A(e),n=A(n),t=A(t),U(e,n,t)?C:t===0?V:(e-n)/t}function Fa(e,n,t,r){return e=A(e),n=A(n),t=A(t),r=A(r),U(e,n,t,r)?C:t===0||r<1||r>t?V:(r=parseInt(r,10),(e-n)*(t-r+1)*2/(t*(t+1)))}function Pa(e,n,t){return e=he(e),n=he(n),t=A(t),U(e,n,t)?C:t<=0||e>n||n-e>365*24*60*60*1e3?V:365*t/(360-t*fn(e,n,!1))}function Va(e,n,t){return e=he(e),n=he(n),t=A(t),U(e,n,t)?C:t<=0||e>n||n-e>365*24*60*60*1e3?V:100*(1-t*fn(e,n,!1)/360)}function qa(e,n,t){return e=he(e),n=he(n),t=A(t),U(e,n,t)?C:t<=0||e>n||n-e>365*24*60*60*1e3?V:(100-t)*360/(t*fn(e,n,!1))}function Ua(e,n,t){if(e=K(H(e)),n=uo(H(n)),t=A(t),U(e,n,t))return C;const r=(l,d,v)=>{const p=v+1;let m=l[0];for(let E=1;E<l.length;E++)m+=l[E]/Math.pow(p,an(d[E],d[0])/365);return m},s=(l,d,v)=>{const p=v+1;let m=0;for(let E=1;E<l.length;E++){const w=an(d[E],d[0])/365;m-=w*l[E]/Math.pow(p,w+1)}return m};let c=!1,a=!1;for(let l=0;l<e.length;l++)e[l]>0&&(c=!0),e[l]<0&&(a=!0);if(!c||!a)return V;t=t||.1;let h=t;const g=1e-10;let f,o,i,u=!0;do i=r(e,n,h),f=h-i/s(e,n,h),o=Math.abs(f-h),h=f,u=o>g&&Math.abs(i)>g;while(u);return h}function $a(e,n,t){if(e=A(e),n=K(H(n)),t=uo(H(t)),U(e,n,t))return C;let r=0;for(let s=0;s<n.length;s++)r+=n[s]/Math.pow(1+e,an(t[s],t[0])/365);return r}function xa(){const e=H(arguments);let n=C;for(let t=0;t<e.length;t++){if(e[t]instanceof Error)return e[t];e[t]===void 0||e[t]===null||typeof e[t]=="string"||(n===C&&(n=!0),e[t]||(n=!1))}return n}function za(){return!1}function Ha(e,n,t){return e instanceof Error?e:(n=arguments.length>=2?n:!0,n==null&&(n=0),t=arguments.length===3?t:!1,t==null&&(t=0),e?n:t)}function Ya(){for(let e=0;e<arguments.length/2;e++)if(arguments[e*2])return arguments[e*2+1];return ee}function Ba(e,n){return ir(e)?n:e}function Ga(e,n){return e===ee?n:e}function ka(e){return typeof e=="string"?C:e instanceof Error?e:!e}function Wa(){const e=H(arguments);let n=C;for(let t=0;t<e.length;t++){if(e[t]instanceof Error)return e[t];e[t]===void 0||e[t]===null||typeof e[t]=="string"||(n===C&&(n=!1),e[t]&&(n=!0))}return n}function Sa(){return!0}function Xa(){const e=H(arguments);let n=C;for(let t=0;t<e.length;t++){if(e[t]instanceof Error)return e[t];e[t]===void 0||e[t]===null||typeof e[t]=="string"||(n===C&&(n=0),e[t]&&n++)}return n===C?n:!!(Math.floor(Math.abs(n))&1)}function Ka(){let e;if(arguments.length>0){const n=arguments[0],t=arguments.length-1,r=Math.floor(t/2);let s=!1;const c=t%2!==0,a=t%2===0?null:arguments[arguments.length-1];if(r){for(let h=0;h<r;h++)if(n===arguments[h*2+1]){e=arguments[h*2+2],s=!0;break}}s||(e=c?a:ee)}else e=C;return e}const Za={errors:qs,symbols:zu,date:xs},zo=Object.freeze(Object.defineProperty({__proto__:null,ABS:wf,ACCRINT:ua,ACOS:mf,ACOSH:Ef,ACOT:Nf,ACOTH:If,AGGREGATE:Af,AND:xa,ARABIC:Rf,ASIN:yf,ASINH:Tf,ATAN:Mf,ATAN2:Cf,ATANH:Df,AVEDEV:$i,AVERAGE:hn,AVERAGEA:Jr,AVERAGEIF:xi,AVERAGEIFS:zi,BASE:Of,BESSELI:tl,BESSELJ:ol,BESSELK:sl,BESSELY:il,BETA:Vn,BETADIST:kl,BETAINV:Wl,BIN2DEC:fl,BIN2HEX:ul,BIN2OCT:ll,BINOM:Cn,BINOMDIST:Sl,BITAND:cl,BITLSHIFT:al,BITOR:hl,BITRSHIFT:gl,BITXOR:dl,CEILING:sn,CEILINGMATH:Xl,CEILINGPRECISE:Kl,CHAR:vo,CHIDIST:Zl,CHIDISTRT:Ql,CHIINV:Jl,CHIINVRT:bl,CHISQ:Se,CHITEST:_l,CHOOSE:ti,CLEAN:gi,CODE:po,COLUMN:oi,COLUMNS:si,COMBIN:An,COMBINA:Lf,COMPLEX:qe,CONCAT:di,CONCATENATE:wo,CONFIDENCE:br,CONVERT:vl,CORREL:Hi,COS:Ff,COSH:Pf,COT:Vf,COTH:qf,COUNT:Ln,COUNTA:Fn,COUNTBLANK:Eo,COUNTIF:Yi,COUNTIFS:Bi,COUPDAYS:la,COVAR:jl,COVARIANCE:Dn,COVARIANCEP:ec,COVARIANCES:nc,CRITBINOM:rc,CSC:Uf,CSCH:$f,CUMIPMT:ca,CUMPRINC:aa,DATE:Bu,DATEDIF:on,DATEVALUE:Gu,DAVERAGE:Qc,DAY:ku,DAYS:an,DAYS360:fn,DB:ha,DCOUNT:Jc,DCOUNTA:bc,DDB:ga,DEC2BIN:pl,DEC2HEX:wl,DEC2OCT:ml,DECIMAL:xf,DEGREES:zf,DELTA:El,DEVSQ:Gi,DGET:_c,DISC:da,DMAX:jc,DMIN:ea,DOLLAR:vi,DOLLARDE:va,DOLLARFR:pa,DPRODUCT:na,DSTDEV:ra,DSTDEVP:ta,DSUM:oa,DVAR:sa,DVARP:ia,EDATE:Wu,EFFECT:wa,EOMONTH:Su,ERF:Fo,ERFC:Po,ERFCPRECISE:tc,ERFPRECISE:oc,ERROR:lo,EVEN:Hf,EXACT:pi,EXP:Yf,EXPON:_r,EXPONDIST:sc,F:Xe,FACT:_e,FACTDOUBLE:Co,FALSE:za,FDIST:ic,FDISTRT:fc,FIND:wi,FINV:uc,FINVRT:lc,FISHER:ki,FISHERINV:Wi,FIXED:mo,FLOOR:vn,FLOORMATH:cc,FLOORPRECISE:ac,FORECAST:No,FREQUENCY:Si,FTEST:hc,FV:pn,FVSCHEDULE:ma,GAMMA:qn,GAMMADIST:gc,GAMMAINV:dc,GAMMALN:jr,GAMMALNPRECISE:vc,GAUSS:Xi,GCD:Bf,GEOMEAN:Ki,GESTEP:Nl,GROWTH:Zi,HARMEAN:Qi,HEX2BIN:Il,HEX2DEC:Al,HEX2OCT:Rl,HLOOKUP:ii,HOUR:Xu,HYPGEOM:et,HYPGEOMDIST:pc,IF:Ha,IFERROR:Ba,IFNA:Ga,IFS:Ya,IMABS:lt,IMAGINARY:Ne,IMARGUMENT:ct,IMCONJUGATE:yl,IMCOS:cr,IMCOSH:Vo,IMCOT:Tl,IMCSC:Ul,IMCSCH:$l,IMDIV:mn,IMEXP:Ml,IMLN:Cl,IMLOG10:Dl,IMLOG2:Ol,IMPOWER:Ll,IMPRODUCT:Fl,IMREAL:Ie,IMSEC:Pl,IMSECH:Vl,IMSIN:ar,IMSINH:qo,IMSQRT:ql,IMSUB:xl,IMSUM:zl,IMTAN:Hl,INDEX:fi,INT:Gf,INTERCEPT:Ji,IPMT:xo,IRR:Ea,ISBLANK:Qs,ISERR:co,ISERROR:ir,ISEVEN:Js,ISLOGICAL:ao,ISNA:bs,ISNONTEXT:_s,ISNUMBER:fr,ISO:kf,ISODD:js,ISOWEEKNUM:Lo,ISPMT:Na,ISTEXT:ho,KURT:bi,LARGE:Io,LCM:Wf,LEFT:mi,LEN:Ei,LINEST:nt,LN:Sf,LOG:Xf,LOG10:Kf,LOGEST:_i,LOGINV:wc,LOGNORM:On,LOGNORMDIST:mc,LOGNORMINV:Ec,LOOKUP:ui,LOWER:Ni,MATCH:li,MAX:Qn,MAXA:ji,MAXIFS:ef,MEDIAN:Ao,MID:Ii,MIN:Jn,MINA:nf,MINIFS:rf,MINUTE:Ku,MIRR:Ia,MMULT:Zf,MOD:Qf,MODE:gn,MODEMULT:Nc,MODESNGL:Ic,MONTH:Zu,MROUND:Jf,MULTINOMIAL:bf,MUNIT:_f,N:ei,NA:ni,NEGBINOM:rt,NEGBINOMDIST:Ac,NETWORKDAYS:ur,NETWORKDAYSINTL:Rc,NOMINAL:Aa,NORM:Ke,NORMDIST:yc,NORMINV:Tc,NORMSDIST:Mc,NORMSINV:Cc,NOT:ka,NOW:Qu,NPER:Ra,NPV:kr,NUMBERVALUE:Ai,OCT2BIN:Yl,OCT2DEC:Bl,OCT2HEX:Gl,ODD:jf,OR:Wa,PDURATION:ya,PEARSON:Ro,PERCENTILE:Be,PERCENTILEEXC:Dc,PERCENTILEINC:Oc,PERCENTRANK:Un,PERCENTRANKEXC:Lc,PERCENTRANKINC:Fc,PERMUT:tf,PERMUTATIONA:of,PHI:sf,PI:eu,PMT:xn,POISSON:tt,POISSONDIST:Pc,POWER:Do,PPMT:Ta,PRICEDISC:Ma,PROB:ff,PRODUCT:bn,PROPER:Ri,PV:Ca,QUARTILE:dn,QUARTILEEXC:Vc,QUARTILEINC:qc,QUOTIENT:nu,RADIANS:ru,RAND:tu,RANDBETWEEN:ou,RANK:$n,RANKAVG:Uc,RANKEQ:$c,RATE:Da,REPLACE:yi,REPT:Ge,RIGHT:Ti,ROMAN:su,ROUND:Oo,ROUNDDOWN:iu,ROUNDUP:fu,ROW:uf,ROWS:ci,RRI:Oa,RSQ:lf,SEARCH:Mi,SEC:uu,SECH:lu,SECOND:Ju,SERIESSUM:cu,SIGN:au,SIN:hu,SINH:gu,SKEW:ot,SKEWP:xc,SLN:La,SLOPE:cf,SMALL:yo,SORT:ai,SQRT:du,SQRTPI:vu,STANDARDIZE:af,STDEV:ze,STDEVA:hf,STDEVP:zc,STDEVPA:gf,STDEVS:Hc,STEYX:df,SUBSTITUTE:Ci,SUBTOTAL:pu,SUM:en,SUMIF:wu,SUMIFS:mu,SUMPRODUCT:Eu,SUMSQ:Nu,SUMX2MY2:Iu,SUMX2PY2:Au,SUMXMY2:Ru,SWITCH:Ka,SYD:Fa,T:He,TAN:yu,TANH:Tu,TBILLEQ:Pa,TBILLPRICE:Va,TBILLYIELD:qa,TDIST:Yc,TDISTRT:Bc,TEXT:Di,TEXTJOIN:Oi,TIME:bu,TIMEVALUE:_u,TINV:Gc,TODAY:ju,TRANSPOSE:hi,TREND:vf,TRIM:Li,TRIMMEAN:pf,TRUE:Sa,TRUNC:Mu,TTEST:kc,TYPE:ri,UNICHAR:Fi,UNICODE:Pi,UNIQUE:Qr,UPPER:Vi,VALUE:qi,VAR:$e,VARA:To,VARP:Wc,VARPA:Mo,VARS:Sc,VLOOKUP:go,WEEKDAY:el,WEEKNUM:nl,WEIBULL:st,WEIBULLDIST:Xc,WORKDAY:lr,WORKDAYINTL:Kc,XIRR:Ua,XNPV:$a,XOR:Xa,YEAR:rl,YEARFRAC:ft,Z:it,ZTEST:Zc,utils:Za},Symbol.toStringTag,{value:"Module"}));var Nr,At;function hr(){return At||(At=1,Nr=function(n){for(var t=n+1,r="",s,c=10;t>0&&c--;)s=(t-1)%26,r=String.fromCharCode(s+65)+r,t=(t-s-1)/26;return r}),Nr}var Ir,Rt;function gr(){return Rt||(Rt=1,Ir=function(n){for(var t=0,r=n.replace(/[0-9]+$/,""),s=r.length;s--;)t+=Math.pow(26,r.length-s-1)*(r.charCodeAt(s)-64);return t-1}),Ir}var Ar,yt;function zn(){return yt||(yt=1,Ar=function(n){this.setValue=function(t){n=t},this.calc=function(){return n}}),Ar}var Rr,Tt;function Ho(){return Tt||(Tt=1,Rr=function(n){var t=n.match(/^'(.*)'$/);return t?t[1]:n}),Rr}var yr,Mt;function ht(){if(Mt)return yr;Mt=1;const e=gr(),n=hr(),t=Ho();return yr=function(s,c){this.parse=function(){var a,h,g;if(s.indexOf("!")!=-1){var f=s.split("!");h=t(f[0]),a=f[1]}else h=c.sheet_name,a=s;g=c.wb.Sheets[h];var o=a.split(":"),i=parseInt(o[0].replace(/^[A-Z]+/,""),10)||0,u=o[1].replace(/^[A-Z]+/,""),l;u===""&&g["!ref"]&&(u=(g["!ref"].includes(":")?g["!ref"].split(":")[1]:g["!ref"]).replace(/^[A-Z]+/,"")),l=parseInt(u==""?"500000":u,10);var d=e(o[0]),v=e(o[1]);return{sheet_name:h,sheet:g,min_row:i,min_col:d,max_row:l,max_col:v}},this.calc=function(){for(var a=this.parse(),h=a.sheet_name,g=a.sheet,f=a.min_row,o=a.min_col,i=a.max_row,u=a.max_col,l=[],d=f;d<=i;d++){var v=[];l.push(v);for(var p=o;p<=u;p++){var m=n(p)+d,E=h+"!"+m,w=c.formula_ref[E];if(w){if(w.status==="new")c.exec_formula(w);else if(w.status==="working"){if(w.cell.f.includes(c.name))throw new Error("Circular ref");c.exec_formula(w)}g[m].t==="e"?v.push(new Error(g[m].w)):v.push(g[m].v)}else g[m]?g[m].t==="e"?v.push(new Error(g[m].w)):v.push(g[m].v):v.push(null)}}return l}},yr}var Tr,Ct;function Yo(){if(Ct)return Tr;Ct=1;const e=Ho();return Tr=function(t,r){var s=this;this.name="RefValue",this.str_expression=t,this.formula=r,s.parseRef=function(){var c,a,h,g;if(t.indexOf("!")!=-1){var f=t.split("!");a=e(f[0]),c=r.wb.Sheets[a],h=f[1]}else c=r.sheet,a=r.sheet_name,h=t;if(!c)throw Error("Sheet "+a+" not found.");return g=a+"!"+h,{sheet:c,sheet_name:a,cell_name:h,cell_full_name:g}},this.calc=function(){var c=s.parseRef(),a=c.sheet,h=c.cell_name,g=c.cell_full_name,f=a[h];if(!f)return null;var o=r.formula_ref[g];if(o){if(o.status==="new"){if(r.exec_formula(o),f.t==="e")throw console.log("ref is an error with new formula",g,f.w),new Error(f.w);return f.v}else if(o.status==="working"){if(f.f.includes(r.name))throw new Error("Circular ref");return r.exec_formula(o),this.calc()}else if(o.status==="done"){if(f.t==="e")throw console.log("ref is an error after formula eval",g,f.w),new Error(f.w);return f.v}}else{if(f.t==="e")throw console.log("ref is an error with no formula",h),new Error(f.w);return f.v}}},Tr}var Mr,Dt;function Qa(){return Dt||(Dt=1,Mr=function(n){this.calc=function(){return n()}}),Mr}var Cr,Ot;function Bo(){if(Ot)return Cr;Ot=1;const e=zn(),n=Yo(),t=Qa(),r=ht();let s,c;function a(h,g){if(!(g.wb.Workbook&&g.wb.Workbook.Names))return null;if(c!==g.wb)return c=g.wb,s=null,a(h,g);if(s)return s[h];const f=Object.values(g.wb.Workbook.Names);if(f.length!==0)return s={},f.forEach(({Name:o,Ref:i})=>{o.includes(".")||(s[o]=i)}),a(h,g)}return Cr=function h(g,f){if(!isNaN(g))return new e(+g);if(g==="TRUE")return new e(1);if(g==="FALSE")return new e(0);if(typeof g!="string")return g;if(g=g.trim().replace(/\$/g,""),g.match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new r(g,f);if(g.match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new r(g,f);if(g.match(/^[A-Z]+:[A-Z]+$/))return new r(g,f);if(g.match(/^[^!]+![A-Z]+:[A-Z]+$/))return new r(g,f);if(g.match(/^[A-Z]+[0-9]+$/))return new n(g,f);if(g.match(/^[^!]+![A-Z]+[0-9]+$/))return new n(g,f);if(g.match(/%$/)){var o=h(g.substr(0,g.length-1),f);return new t(()=>o.calc()/100)}return a(g,f)?h(a(g,f),f):g},Cr}var Dr,Lt;function Hn(){if(Lt)return Dr;Lt=1;const e=new Error("#NULL!"),n=new Error("#DIV/0!"),t=new Error("#VALUE!"),r=new Error("#REF!"),s=new Error("#NAME?"),c=new Error("#NUM!"),a=new Error("#N/A"),h=new Error("#ERROR!"),g=new Error("#GETTING_DATA"),f=new Error("#CALC!"),o={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#CALC!":0};function i(u){return o[u]}return Dr={nil:e,div0:n,value:t,ref:r,name:s,num:c,na:a,error:h,data:g,calc:f,getErrorValueByMessage:i},Dr}var Or,Ft;function Go(){if(Ft)return Or;Ft=1;const e=Hn();return Or=function(t){return function(){for(var r=!1,s=[],c=[],a=[],h=0,g=arguments.length;h<g;h++){var f=arguments[h],o=Array.isArray(f);o&&(r=!0);var i=o?f.map(R=>Array.isArray(R)?R:[R]):[[f]];s[h]=i,c[h]=i.length,a[h]=i[0].length}for(var u=Math.max.apply(null,c),l=Math.max.apply(null,a),d=[],v=0;v<u;v++){d[v]=[];for(var p=0;p<l;p++){for(var m=!1,E=[],h=0,g=s.length;h<g;h++){var w=s[h],N=c[h]===1?0:v,I=a[h]===1?0:p;if(N in w)if(w=w[N],I in w)w=w[I];else{m=!0;break}else{m=!0;break}E[h]=w}d[v][p]=m?e.na:t.apply(null,E)}}return r?d:d[0][0]}},Or}var Lr,Pt;function Ja(){if(Pt)return Lr;Pt=1;const e=zn();ht();const n=Bo(),t=1440*60*1e3,r=gr(),s=hr(),c=Go(),{getErrorValueByMessage:a}=Hn();var h=0;function g(f){return Array.isArray(f)&&(f.length===0||Array.isArray(f[0]))}return Lr=function(o){var i=this;i.id=++h,i.args=[],i.name="Expression",i.update_cell_value=u,i.formula=o;function u(){try{if(o.cell.v=i.calc(),o.cell.t=v(o.cell.v),g(o.cell.v)){const y=o.cell.v;o.cell.v=void 0;let D=o.name.match(/([A-Z]+)([0-9]+)/),P=r(D[1]),z=+D[2];for(let G=0;G<y.length;G++){const S=z+G;for(let _=0;_<y[G].length;_++){const ue=y[G][_],ge=_+P,Y=s(ge)+S;let j=o.sheet[Y];j||(j={},o.sheet[Y]=j),d(j,ue)}}}}catch(y){if(!l(o.cell,y))throw y}finally{o.status="done"}}function l(y,M){const D=M||{};y.t="e";const P=a(D.message);return P!==void 0?(y.w=D.message,y.v=P,!0):!1}function d(y,M){if(M instanceof Error)l(y,M);else{const D=v(M);y.v=M,D&&(y.t=D)}}function v(y){if(typeof y=="string")return"s";if(typeof y=="number")return"n";if(y instanceof Error)return"e"}function p(y){return y==null||y===""}function m(y){if(typeof y.calc!="function")throw new Error("Undefined "+y)}function E(y,M,D){for(var P=0;P<M.length;P++)if(M[P]===y)try{if(P===0&&y==="+"){m(M[P+1]);let z=M[P+1].calc();M.splice(P,2,new e(z))}else{m(M[P-1]),m(M[P+1]);let z=M[P-1].calc(),G=M[P+1].calc();if(z instanceof Error)throw z;if(G instanceof Error)throw G;let S=D(z,G);M.splice(P-1,3,new e(S)),P--}}catch(z){throw z}}function w(y){return Array.isArray(y)?y.map(w):-y}function N(y){for(var M=y.length;M--;)if(y[M]==="-"){m(y[M+1]);var D=y[M+1].calc();if(M>0&&typeof y[M-1]!="string"){if(y.splice(M,1,"+"),D instanceof Date){D=Date.parse(D),m(y[M-1]);var P=y[M-1].calc();P instanceof Date&&(P=Date.parse(P)/t,D=D/t,y.splice(M-1,1,new e(P)))}y.splice(M+1,1,new e(w(D)))}else{if(typeof D=="string")throw new Error("#VALUE!");y.splice(M,2,new e(w(D)))}}}function I(y,M){for(var D=0;D<y.length-2;D++)if(y[D]==="^"&&y[D+1]==="-")try{m(y[D-1]),m(y[D+2]);let P=y[D-1].calc(),z=y[D+2].calc();Array.isArray(P)&&(P=P[getCurrentCellIndex()-1][0]),Array.isArray(z)&&(z=z[getCurrentCellIndex()-1][0]);let G=M(P,z);y.splice(D-1,4,new e(G)),D--}catch(P){throw P}}i.calc=function(){let y=i.args.concat();if(I(y,function(M,D){return Math.pow(+M,0-D)}),E("^",y,c(function(M,D){return Math.pow(+M,+D)})),N(y),E("/",y,c(function(M,D){if(D==0)throw Error("#DIV/0!");return+M/+D})),E("*",y,c(function(M,D){return+M*+D})),E("+",y,c(function(M,D){return M instanceof Date&&typeof D=="number"&&(D=D*t),+M+ +D})),E("&",y,c(function(M,D){var P="";return M!==null&&(P+=M),D!==null&&(P+=D),P})),E("<",y,c(function(M,D){return M<D})),E(">",y,c(function(M,D){return M>D})),E(">=",y,c(function(M,D){return M>=D})),E("<=",y,c(function(M,D){return M<=D})),E("<>",y,c(function(M,D){return M instanceof Date&&D instanceof Date?M.getTime()!==D.getTime():p(M)&&p(D)?!1:M!==D})),E("=",y,c(function(M,D){return M instanceof Date&&D instanceof Date?M.getTime()===D.getTime():p(M)&&p(D)||M==null&&D===0||M===0&&D==null||typeof M=="string"&&typeof D=="string"&&M.toLowerCase()===D.toLowerCase()?!0:M===D})),y.length==1)return typeof y[0].calc!="function"?y[0]:y[0].calc()};var R;i.push=function(y){if(y){var M=n(y,o);M==="="&&(R==">"||R=="<")||R=="<"&&M===">"?i.args[i.args.length-1]+=M:i.args.push(M),R=M}}},Lr}var Fr,Vt;function ba(){if(Vt)return Fr;Vt=1;const{getErrorValueByMessage:e}=Hn();return Fr=function(t){var r=this;r.name="UserFn",r.args=[],r.calc=function(){var s;try{if(s=t.apply(r,r.args.map(c=>c.calc())),s instanceof Error)throw s}catch(c){const a=e(c.message);if(t.name==="is_blank"&&a!==void 0)s=0;else if(t.name==="iserror"&&a!==void 0)s=!0;else throw c}return s},r.push=function(s){r.args.push(s)}},Fr}var Pr,qt;function _a(){return qt||(qt=1,Pr=function(n,t){var r=this;r.name="UserRawFn",r.args=[],r.calc=function(){try{return n.apply(r,r.args)}catch(s){throw s}},r.push=function(s){r.args.push(s)}}),Pr}var Vr,Ut;function ja(){if(Ut)return Vr;Ut=1;const e=Ja(),n=zn(),t=ba(),r=_a(),s={"*":"multiply","+":"plus","-":"minus","/":"divide","^":"power","&":"concat","<":"lt",">":"gt","=":"eq"};return Vr=function(a,h){a.status="working";var g=h.xlsx_Fx||{},f=h.xlsx_raw_Fx||{},o,i=a.cell.f;i[0]=="="&&(i=i.substr(1));var u=o=new e(a),l="",d=!1,v=[{exp:u}];function p(M){M==='"'?(u.push(new n(l)),d=!0,l="",R=I):l+=M}function m(M){M==="'"&&(R=I),l+=M}function E(){var M,D=l.trim(),P=g[D],z=f[D];if(z)P=new r(z,a);else if(P)P=new t(P,a);else if(D)throw new Error('"'+a.sheet_name+'"!'+a.name+": Function "+l+" not found");M=new e(a),v.push({exp:M,special:P}),u=M,l=""}function w(){var M,D=v.pop();u=D.exp,u.push(l),M=u,l="",u=v[v.length-1].exp,D.special?(D.special.push(M),u.push(D.special)):u.push(M)}function N(M){d||u.push(l),d=!1,u.push(M),l=""}function I(M){M==='"'?(R=p,l=""):M==="'"?(R=m,l="'"):M==="("?E():M===")"?w():s[M]?N(M):M===","&&v[v.length-1].special?(d=!1,v[v.length-1].exp.push(l),v[v.length-1].special.push(v[v.length-1].exp),v[v.length-1].exp=u=new e(a),l=""):M!==" "&&(l+=M)}for(var R=I,y=0;y<i.length;y++)R(i[y]);return o.push(l),o},Vr}var qr,$t;function e0(){if($t)return qr;$t=1;const e=Hn();function n(r){if(typeof r=="boolean"||r instanceof Error)return r;if(typeof r=="number")return r!==0;if(typeof r=="string"){const s=r.toUpperCase();if(s==="TRUE")return!0;if(s==="FALSE")return!1}return r instanceof Date&&!isNaN(r)?!0:e.value}function t(r,s,c){if(!r||!s||!c||s<0||c<0||!Array.isArray(r)||!r.length)return r;for(let a=0;a<r.length;a++)if(!(r[a]instanceof Array))return r;for(let a=0;a<r.length;a++)if(r[a].length<s)for(let h=r[a].length;h<s;h++)r[a].push("");if(r.length<c)for(let a=r.length;a<c;a++){r.push([]);for(let h=0;h<s;h++)r[a].push("")}return r}return qr={addEmptyValuesToArray:t,parseBool:n},qr}var Ur,xt;function n0(){if(xt)return Ur;xt=1;const e=e0(),n=Hn();let t={FLOOR:Math.floor,"_xlfn.FLOOR.MATH":Math.floor,"FLOOR.MATH":Math.floor,ABS:Math.abs,SQRT:Math.sqrt,VLOOKUP:j,MAX:ge,SUM:ue,MIN:Y,CONCATENATE:_,PMT:S,COUNTA:G,IRR:z,"NORM.INV":P,"_xlfn.NORM.INV":P,STDEV:D,AVERAGE:M,EXP:y,LN:Math.log,"_xlfn.VAR.P":R,"VAR.P":R,"_xlfn.COVARIANCE.P":N,"COVARIANCE.P":N,TRIM:E,LEN:m,ISBLANK:w,HLOOKUP:p,INDEX:v,MATCH:d,SUMPRODUCT:f,ISNUMBER:g,TODAY:h,ISERROR:ne,TIME:re,DAY:B,MONTH:Q,YEAR:q,RIGHT:ae,LEFT:se,IFS:ie,ROUND:a,CORREL:c,SUMIF:s,CHOOSE:r,SUBSTITUTE:ve,CEILING:X,FILTER:de(pe),DATEDIF:k,EOMONTH:oe};function r(T){return arguments[T]}function s(){let T=arguments[1],O=0;return[].slice.call(arguments)[0][0].forEach((L,$)=>{L!==null&&(L=L.toString(),L.replace(/\'/g,"")===T&&(isNaN([].slice.call(arguments)[2][0][$])||(O+=[].slice.call(arguments)[2][0][$])))}),O}function c(T,O){if(T=I(T),O=I(O),T.length!==O.length)return"N/D";for(var L=1/(T.length-1),$=ue.apply(this,T)/T.length,F=ue.apply(this,O)/O.length,x=0,b=0,Ae=0,we=0;we<T.length;we++)x+=(T[we]-$)*(O[we]-F),b+=Math.pow(T[we],2),Ae+=Math.pow(O[we],2);return b=Math.sqrt(b/L),Ae=Math.sqrt(Ae/L),x/(L*b*Ae)}function a(T,O){if(arguments.length===0)throw new Error("Err:511");if(arguments.length===1)return Math.round(T);let L=Math.pow(10,O);return Math.round(L*T)/L}function h(){var T=new Date;return T.setHours(0,0,0,0),T}function g(T){return!isNaN(T)}function f(){var T=function(Ce){return Ce===void 0||Ce===""||Ce===null||isNaN(Ce)?0:parseFloat(Ce)},O=function(Ce){for(var Yn=function(cn=[]){return cn.length},Bn=function(cn=[]){return cn[0]&&cn[0].length},vr=Yn(Ce[0]),Qe=Bn(Ce[0]),ln=1;ln<Ce.length;ln++)if(Yn(Ce[ln])!==vr||Bn(Ce[ln])!==Qe)return!1;return!0};if(!arguments||arguments.length===0||!arguments[0]||!O(arguments))throw Error("#VALUE!");for(var L=0;L<arguments.length;L++){var $=arguments[L];if(Array.isArray($))for(var F=0;F<$.length;F++){var x=$[F];if(Array.isArray(x))for(var Ee=0;Ee<x.length;Ee++){var b=x[Ee];if(b instanceof Error)throw b}else{var b=x;if(b instanceof Error)throw b}}else{var b=$;if(b instanceof Error)throw b}}for(var Ae=arguments.length+1,we=0,xe,Ee,Ue,Ze,L=0;L<arguments[0].length;L++)if(arguments[0][L]instanceof Array)for(var F=0;F<arguments[0][L].length;F++){for(xe=1,Ee=1;Ee<Ae;Ee++)Ze=T(arguments[Ee-1][L][F]),xe*=Ze;we+=xe}else{for(xe=1,Ee=1;Ee<Ae;Ee++)Ue=T(arguments[Ee-1][L]),xe*=Ue;we+=xe}return we}function o(T,O){for(var L,$,F=0;F<T.length;F++){if(T[F]===O)return F+1;T[F]<O&&($?T[F]>$&&(L=F+1,$=T[F]):(L=F+1,$=T[F]))}if(!L)throw Error("#N/A");return L}function i(T,O){for(var L=0;L<T.length;L++)if(O=O.replace(/\?/g,"."),Array.isArray(T[L])){if(T[L].length===1&&typeof T[L][0]=="string"&&T[L][0].toLowerCase()===O.toLowerCase())return L+1}else if(typeof T[L]=="string"&&T[L].toLowerCase()===O.toLowerCase())return L+1;throw Error("#N/A")}function u(T,O){for(var L=0;L<T.length;L++)if(Array.isArray(T[L])){if(T[L].length===1&&T[L][0]===O)return L+1}else if(T[L]===O)return L+1;throw Error("#N/A")}function l(T,O){for(var L,$,F=0;F<T.length;F++)if(Array.isArray(T[F])&&T[F].length>0){if(T[F][0]===O)return F+1;T[F][0]>O&&($?T[F][0]<$&&(L=F+1,$=T[F][0]):(L=F+1,$=T[F][0]))}else{if(T[F]===O)return F+1;T[F]>O&&($?T[F]<$&&(L=F+1,$=T[F]):(L=F+1,$=T[F]))}if(!L)throw Error("#N/A");return L}function d(T,O,L){if(Array.isArray(O)&&O.length===1&&Array.isArray(O[0])&&(O=O[0]),!T&&!O||(arguments.length===2&&(L=1),!(O instanceof Array)))throw Error("#N/A");if(L===0)return typeof T=="string"?i(O,T):u(O,T);if(L===1)return o(O,T);if(L===-1)return l(O,T);throw Error("#N/A")}function v(T,O,L){if(O<=T.length){var $=T[O-1];if(Array.isArray($))if(L){if(L<=$.length)return $[L-1]}else return $;else return T[O]}throw Error("#REF!")}function p(T,O,L,$){if(typeof T>"u"||w(T))throw Error("#N/A");L=L||0;let F=O[0],x,b;if(typeof T=="string"){for(b=T.toLowerCase(),x=0;x<F.length;x++)if($&&F[x]===b||F[x].toLowerCase().indexOf(b)!==-1)return L<O.length+1?O[L-1][x]:O[0][x]}else for(b=T,x=0;x<F.length;x++)if($&&F[x]===b||F[x]===b)return L<O.length+1?O[L-1][x]:O[0][x];throw Error("#N/A")}function m(T){return(""+T).length}function E(T){return(""+T).trim()}function w(T){return!T}function N(T,O){if(T=I(T),O=I(O),T.length!=O.length)return"N/D";for(var L=1/T.length,$=ue.apply(this,T)/T.length,F=ue.apply(this,O)/O.length,x=0,b=0;b<T.length;b++)x+=(T[b]-$)*(O[b]-F);return x*L}function I(T){for(var O=[],L=0;L<T.length;L++){var $=T[L];if(Array.isArray($)){for(var F=$,x=F.length;x--;)if(typeof F[x]=="number")O.push(F[x]);else if(Array.isArray(F[x]))for(var b=F[x].length;b--;)typeof F[x][b]=="number"&&O.push(F[x][b])}else typeof $=="number"&&O.push($)}return O}function R(){for(var T=M.apply(this,arguments),O=0,L=0,$=0;$<arguments.length;$++){var F=arguments[$];if(Array.isArray(F))for(var x=F,b=x.length;b--;)for(var Ae=x[b].length;Ae--;)x[b][Ae]!==null&&x[b][Ae]!==void 0&&(O+=Math.pow(x[b][Ae]-T,2),L++);else O+=Math.pow(F-T,2),L++}return O/L}function y(T){return Math.pow(Math.E,T)}function M(){var T=G.apply(this,arguments);if(T==0)throw Error("#DIV/0!");return ue.apply(this,arguments)/T}function D(){var T=I(arguments);function O(F){return F.reduce(function(x,b){return x+b})/F.length}var L=O(T),$=T.map(function(F){return(F-L)*(F-L)});return Math.sqrt($.reduce(function(F,x){return F+x})/(T.length-1))}function P(T,O,L){if(T<0||T>1)throw"The probality p must be bigger than 0 and smaller than 1";if(L<0)throw"The standard deviation sigma must be positive";if(T==0)return-1/0;if(T==1)return 1/0;if(L==0)return O;var $,F,x;return $=T-.5,Math.abs($)<=.425?(F=.180625-$*$,x=$*(((((((F*2509.0809287301227+33430.57558358813)*F+67265.7709270087)*F+45921.95393154987)*F+13731.69376550946)*F+1971.5909503065513)*F+133.14166789178438)*F+3.3871328727963665)/(((((((F*5226.495278852854+28729.085735721943)*F+39307.89580009271)*F+21213.794301586597)*F+5394.196021424751)*F+687.1870074920579)*F+42.31333070160091)*F+1)):($>0?F=1-T:F=T,F=Math.sqrt(-Math.log(F)),F<=5?(F+=-1.6,x=(((((((F*.0007745450142783414+.022723844989269184)*F+.2417807251774506)*F+1.2704582524523684)*F+3.6478483247632045)*F+5.769497221460691)*F+4.630337846156546)*F+1.4234371107496835)/(((((((F*10507500716444169e-25+.0005475938084995345)*F+.015198666563616457)*F+.14810397642748008)*F+.6897673349851)*F+1.6763848301838038)*F+2.053191626637759)*F+1)):(F+=-5,x=(((((((F*20103343992922881e-23+27115555687434876e-21)*F+.0012426609473880784)*F+.026532189526576124)*F+.29656057182850487)*F+1.7848265399172913)*F+5.463784911164114)*F+6.657904643501103)/(((((((F*20442631033899397e-31+1421511758316446e-22)*F+18463183175100548e-21)*F+.0007868691311456133)*F+.014875361290850615)*F+.1369298809227358)*F+.599832206555888)*F+1)),$<0&&(x=-x)),O+L*x}function z(T,O){var L=-2,$=1,F=0;do{for(var x=(L+$)/2,b=0,Ae=0;Ae<T.length;Ae++){var we=T[Ae];b+=we[0]/Math.pow(1+x,Ae)}b>0?(L===$&&($+=Math.abs(x)),L=x):$=x,F++}while(Math.abs(b)>1e-6&&F<1e5);return x}function G(){for(var T=0,O=arguments.length;O--;){var L=arguments[O];if(Array.isArray(L))for(var $=L,F=$.length;F--;)for(var x=$[F].length;x--;)$[F][x]!==null&&$[F][x]!==void 0&&T++;else L!=null&&T++}return T}function S(T,O,L,$,F){if(F=F||0,$=$||0,T!=0){var x=Math.pow(1+T,O);return-(T*($+x*L))/((-1+x)*(1+T*F))}else if(O!=0)return-($+L)/O;return 0}function _(){for(var T="",O=0;O<arguments.length;O++){var L=arguments[O];L!=null&&(T+=L)}return T}function ue(){for(var T=0,O=arguments.length;O--;){var L=arguments[O];if(Array.isArray(L))for(var $=L,F=$.length;F--;)for(var x=$[F].length;x--;)isNaN($[F][x])||(T+=+$[F][x]);else T+=+L}return T}function ge(){for(var T=null,O=arguments.length;O--;){var L=arguments[O];if(Array.isArray(L))for(var $=L,F=$.length;F--;){var x=$[F];if(Array.isArray(x))for(var b=x.length;b--;)(T==null||x[b]!=null&&T<x[b])&&(T=x[b]);else(T==null||x!=null&&T<x)&&(T=x)}else!isNaN(L)&&(T==null||L!=null&&T<L)&&(T=L)}return T}function Y(){for(var T=null,O=arguments.length;O--;){var L=arguments[O];if(Array.isArray(L))for(var $=L,F=$.length;F--;){var x=$[F];if(Array.isArray(x))for(var b=x.length;b--;)(T==null||x[b]!=null&&T>x[b])&&(T=x[b]);else(T==null||x!=null&&T>x)&&(T=x)}else!isNaN(L)&&(T==null||L!=null&&T>L)&&(T=L)}return T}function j(T,O,L,$=!0){for(var F=null,x=0;x<O.length;x++)if(O[x][0]<T)F=O[x][L-1];else if(O[x][0]==T)return O[x][L-1];if($&&F)return F;throw Error("#N/A")}function ne(){return!1}function re(T,O,L){return((T*60+O)*60+L)*1e3/864e5}function B(T){if(!T.getDate)throw Error("#VALUE!");var O=T.getUTCDate();if(isNaN(O))throw Error("#VALUE!");return O}function Q(T){if(!T.getMonth)throw Error("#VALUE!");var O=T.getUTCMonth();if(isNaN(O))throw Error("#VALUE!");return O+1}function q(T){if(!T.getFullYear)throw Error("#VALUE!");var O=T.getUTCFullYear();if(isNaN(O))throw Error("#VALUE!");return O}function k(T,O,L){if(T=new Date(T),O=new Date(O),!T||!O||T=="Invalid Date"||O=="Invalid Date")throw Error("#VALUE!");switch(L=L.replace(/[^DMY]/ig,""),L){case"M":return O.getMonth()-T.getMonth()+12*(O.getFullYear()-T.getFullYear());case"Y":return Math.abs(O.getUTCFullYear()-T.getUTCFullYear());case"D":default:var $=Math.abs(O-T);return Math.ceil($/(1e3*3600*24))}}function oe(T,O){if(T=new Date(T),!T||T=="Invalid Date")throw Error("#VALUE!");O=O||0;var L=new Date(T.getUTCFullYear(),T.getUTCMonth()+O+1,0);return L.setUTCHours(0),L.setUTCMinutes(0),L.setUTCSeconds(0),L}function ae(T,O){if(O=O===void 0?1:parseFloat(O),isNaN(O))throw Error("#VALUE!");return T==null?T="":T=""+T,T.substring(T.length-O)}function se(T,O){if(O=O===void 0?1:parseFloat(O),isNaN(O))throw Error("#VALUE!");return T==null?T="":T=""+T,T.substring(0,O)}function ie(){for(var T=0;T+1<arguments.length;T+=2){var O=arguments[T],L=arguments[T+1];if(O)return L}throw Error("#N/A")}function J(T){return T.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function ve(T,O,L,$){if($<=0)throw Error("#VALUE!");if(!T||!O||!L&&L!=="")return T;if($===void 0)return T.replace(new RegExp(J(O),"g"),L);for(var F=0,x=0;T.indexOf(O,F)>0;)if(F=T.indexOf(O,F+1),x++,x===$)return T.substring(0,F)+L+T.substring(F+O.length)}function X(T,O){return Math.ceil(T/O)*O}function pe(T,O,L){if(!T||!O||!(T instanceof Array)||!(O instanceof Array)||T.length===0||O.length===0)return n.na;for(let we=0;we<T.length;we++)if(!(T[we]instanceof Array)||T[we].length===0||T[we].length!==T[0].length)return n.na;for(let we=0;we<O.length;we++)if(!(O[we]instanceof Array)||O[we].length===0||O[we].length!==O[0].length)return n.na;const $=T[0].length,F=T.length,x=O[0].length,b=O.length;if($!==x&&F!==b||F>1&&$>1&&($===x&&b!==1||F===b&&x!==1)||F>1&&$===1&&(x!==1||b!==1&&b!==F))return n.na;const Ae=[];for(let we=0;we<F;we++){const xe=[];for(let Ee=0;Ee<$;Ee++){const Ue=me(O,we,Ee)||me(O,0,Ee)||me(O,we,0),Ze=e.parseBool(Ue);if(Ze===!0)xe.push(T[we][Ee]);else if(Ze instanceof Error)return e.addEmptyValuesToArray([[Ze]],$,F)}xe.length>0&&Ae.push(xe)}return Ae.length===0?L!=null?e.addEmptyValuesToArray([[L]],$,F):e.addEmptyValuesToArray([[n.calc]],$,F):e.addEmptyValuesToArray(Ae,$,F)}function me(T,O,L){if(T[O])return T[O][L]===!1?"FALSE":T[O][L]}function de(T){return function(){const O=T.apply(this,arguments);if(O instanceof Error)throw O;return O}}return Ur=t,Ur}var $r,zt;function r0(){if(zt)return $r;zt=1;const e=hr(),n=gr(),t=Go(),r=zn(),s=ht(),c=Yo();function a(d,v,p,m,E){if(m=(m||new r(1)).calc(),E=(E||new r(1)).calc(),d.args.length===1&&d.args[0].name==="RefValue"){var w=d.args[0],N=w.parseRef(),I=n(N.cell_name)+p.calc(),R=e(I),y=+N.cell_name.replace(/^[A-Z]+/g,"")+v.calc(),M=N.sheet_name+"!"+R+y;if(m===1&&E===1)return new c(M,w.formula).calc();var D=e(I+E-1),P=y+m-1,z=D+P,G=M+":"+z;return new s(G,w.formula).calc()}}function h(d){if(d.args.length===0){var v=+d.formula.name.replace(/^[A-Z]+/g,"");return v}else if(d.args.length===1&&d.args[0].name==="RefValue"){var p=d.args[0],m=p.parseRef(),v=+m.cell_name.replace(/^[A-Z]+/g,"");return v}else if(d.args.length===1&&d.args[0]instanceof s){for(var E=d.args[0].parse(),w=E.min_row,N=E.max_row,I=[],R=w;R<=N;R++)I.push(R);return I}}function g(d){if(d.args.length===0){var v=n(d.formula.name);return v+1}else if(d.args.length===1&&d.args[0].name==="RefValue"){var p=d.args[0],m=p.parseRef(),v=n(m.cell_name);return v+1}else if(d.args.length===1&&d.args[0]instanceof s){for(var E=d.args[0].parse(),w=E.min_col,N=E.max_col,I=[],R=w;R<=N;R++)I.push(R+1);return I}}function f(d,v){try{var p=d.calc();return typeof p=="number"&&(isNaN(p)||p===1/0||p===-1/0)?v.calc():p}catch(m){return v.calc()}}function o(d,v,p){var m,E,w;try{m=d.calc()}catch(N){m=N}try{E=v.calc()}catch(N){E=N}try{w=typeof p>"u"?!1:p.calc()}catch(N){w=N}return t(function(N,I,R){return N instanceof Error?N:N?I:R})(m,E,w)}function i(){for(var d=0;d<arguments.length;d++)if(!arguments[d].calc())return!1;return!0}function u(){for(var d=0;d<arguments.length;d++)if(arguments[d].calc())return!0;return!1}function l(d){let p=d.args[0].calc(),E=d.formula.name.match(/([A-Z]+)([0-9]+)/),w=d.formula.sheet,N=n(E[1]),I=+E[2];for(let R=0;R<p.length;R++){let y=p[R];for(let M=0;M<y.length;M++){let D=N+R,P=I+M,z=y[M];w[e(D)+P].v=z}}return p[0][0]}return $r={OFFSET:a,ROW:h,COLUMN:g,IFERROR:f,IF:o,AND:i,OR:u,TRANSPOSE:l},$r}var xr,Ht;function t0(){if(Ht)return xr;Ht=1;const e=ja();let n={},t={};s(n0()),r(r0());function r(g,f){for(var o in g)t[o]=g[o]}function s(g,f){f=f||{};var o=f.prefix||"";for(var i in g){var u=g[i];typeof u=="function"?(f.override||!n[o+i])&&(n[o+i]=u):typeof u=="object"&&s(u,c(f,{prefix:i+"."}))}}function c(g,f){var o=JSON.parse(JSON.stringify(g));for(var i in f)o[i]=f[i];return o}function a(g){return e(g,{xlsx_Fx:n,xlsx_raw_Fx:t})}function h(g){a(g).update_cell_value()}return h.set_fx=function(f,o){n[f]=o},h.exec_fx=function(f,o){return n[f].apply(this,o)},h.localizeFunctions=function(g){for(let f in g){let o=g[f];n[o]&&(n[f]=n[o]),t[o]&&(t[f]=t[o])}},h.import_functions=s,h.import_raw_functions=r,h.build_expression=a,h.xlsx_Fx=n,xr=h,xr}var zr,Yt;function ko(){return Yt||(Yt=1,zr=function(n,t){let r={},s=[];for(let c in n.Sheets){let a=n.Sheets[c];for(let h in a)if(a[h]&&a[h].f){let g=r[c+"!"+h]={formula_ref:r,wb:n,sheet:a,sheet_name:c,cell:a[h],name:h,status:"new",exec_formula:t};s.push(g)}}return s}),zr}var Hr,Bt;function o0(){if(Bt)return Hr;Bt=1;const e=zn(),n=Bo(),t=ko();class r{constructor(c,a){this.workbook=c,this.expressions=[],this.exec_formula=a,this.variables={},this.formulas=t(c,a);for(let h=this.formulas.length-1;h>=0;h--){let g=a.build_expression(this.formulas[h]);this.expressions.push(g)}this.calcNames()}setVar(c,a){let h=this.variables[c];h?h.setValue(a):this.expressions.forEach(g=>{this.setVarOfExpression(g,c,a)})}getVars(){let c={};for(let a in this.variables)c[a]=this.variables[a].calc();return c}calcNames(){!this.workbook||!this.workbook.Workbook||!this.workbook.Workbook.Names||this.workbook.Workbook.Names.forEach(c=>{let a=this.getRef(c.Ref);this.variables[c.Name]=a,this.expressions.forEach(h=>{this.setVarOfExpression(h,c.Name)})})}getRef(c){if(!this.formulas.length)throw new Error("No formula found.");let g={formula_ref:this.formulas[0].formula_ref,wb:this.workbook,exec_formula:this.exec_formula};return n(c,g)}setVarOfExpression(c,a,h){for(let g=0;g<c.args.length;g++){let f=c.args[g];f===a?c.args[g]=this.variables[a]||(this.variables[a]=new e(h)):typeof f=="object"&&(f.name==="Expression"||f.name==="UserFn")&&this.setVarOfExpression(f,a,h)}}execute(){this.expressions.forEach(c=>{c.update_cell_value()})}}return Hr=r,Hr}var Yr,Gt;function s0(){if(Gt)return Yr;Gt=1;const e=hr(),n=gr(),t=t0(),r=ko(),s=o0();var c=function(a,h){for(var g=r(a,t),f=g.length-1;f>=0;f--)try{if(g[f].status==="done")continue;t(g[f])}catch(o){if(!h||!h.continue_after_error)throw o;h.log_error&&console.log("error executing formula","sheet",g[f].sheet_name,"cell",g[f].name,o)}};return c.calculator=function(h){return new s(h,t)},c.set_fx=t.set_fx,c.exec_fx=t.exec_fx,c.col_str_2_int=n,c.int_2_col_str=e,c.import_functions=t.import_functions,c.import_raw_functions=t.import_raw_functions,c.xlsx_Fx=t.xlsx_Fx,c.localizeFunctions=t.localizeFunctions,c.XLSX_CALC=c,Yr=c,Yr}var i0=s0();const er=Wr(i0);function f0(e,n=50,t=50){var s;const r={SheetNames:[],Sheets:{}};for(const c of e.sheets){r.SheetNames.push(c.name);const a={};for(const h of c.rows)if(!(h.index>n))for(const g of h.cells){const f=/^[A-Z]+/.exec(g.address);if(!f)continue;const o=f[0];let i=0;for(let l=0;l<o.length;l++)i=i*26+(o.charCodeAt(l)-64);if(i>t)continue;const u={};if(g.value!==""){const l=Number(g.value);u.v=Number.isNaN(l)?g.value:l}g.formula&&(u.f=g.formula),a[g.address]=u}r.Sheets[c.name]=a}er.import_functions(zo);try{er(r,{continue_after_error:!0})}catch(c){Zt.addError(c)}for(const c of e.sheets){const a=r.Sheets[c.name];for(const h of c.rows)if(!(h.index>n)){for(const g of h.cells)if(g.formula&&g.value===""){const f=(s=a[g.address])==null?void 0:s.v;g.value=f!=null?String(f):"This formula is not supported in web preview. Please download to open in your preferred software for the best results."}}}}function u0({selectionRect:e,sheet:n,getRowByVisualIndex:t}){const[r,s]=Z.useState(null);return Z.useEffect(()=>{if(!e){s(null);return}if(e.r1===e.r2&&e.c1===e.c2){s(null);return}const c=setTimeout(()=>{const{r1:a,c1:h,r2:g,c2:f}=e;let o=0,i=0,u=0,l=!1;for(let d=a;d<=g;d+=1){const v=t(d);for(let p=h;p<=f;p+=1){const m=v==null?void 0:v.cells.find(w=>Re(w.address)===p);if(!m||m.value===""||m.value==null)continue;o++;const E=Number(m.value);!Number.isNaN(E)&&m.dataType!==ds.CELL_DATA_TYPE_STRING?(u++,i+=E):l=!0}}s({count:o,avg:l||u===0?null:i/u,sum:l||u===0?null:i})},1e3);return()=>clearTimeout(c)},[e,n,t]),r}function l0(e){"use forget";const n=Pn.c(11),{selectionRect:t,sheet:r,getRowByVisualIndex:s}=e,c=Xt();let a;n[0]!==s||n[1]!==t||n[2]!==r?(a={selectionRect:t,sheet:r,getRowByVisualIndex:s},n[0]=s,n[1]=t,n[2]=r,n[3]=a):a=n[3],u0(a);const h=null;let g,f;n[4]!==c||n[5]!==h?(g="text-token-text-secondary ms-3 text-xs whitespace-nowrap",f=h,n[4]=c,n[5]=h,n[6]=g,n[7]=f):(g=n[6],f=n[7]);let o;return n[8]!==g||n[9]!==f?(o=le.jsx("div",{className:g,children:f}),n[8]=g,n[9]=f,n[10]=o):o=n[10],o}function c0(e){"use forget";const n=Pn.c(18),{workbook:t,activeSheetIdx:r,onSheetClick:s,accentStroke:c,selectionRect:a,sheet:h,getRowByVisualIndex:g}=e;let f;if(n[0]!==c||n[1]!==r||n[2]!==s||n[3]!==t.sheets){let l;n[5]!==c||n[6]!==r||n[7]!==s?(l=(d,v)=>le.jsx("button",{onClick:()=>s(v),className:Qt("border-t-2 px-3 pt-2 pb-3 text-xs font-medium whitespace-nowrap",v===r?"text-token-text-primary font-bold":"text-token-text-secondary hover:text-token-text-primary border-transparent"),style:v===r?{borderTopColor:c}:void 0,children:d.name},d.name),n[5]=c,n[6]=r,n[7]=s,n[8]=l):l=n[8],f=t.sheets.map(l),n[0]=c,n[1]=r,n[2]=s,n[3]=t.sheets,n[4]=f}else f=n[4];let o;n[9]!==f?(o=le.jsx("div",{className:"flex-1 overflow-x-auto",children:le.jsx("div",{className:"flex flex-row",children:f})}),n[9]=f,n[10]=o):o=n[10];let i;n[11]!==g||n[12]!==a||n[13]!==h?(i=le.jsx(l0,{selectionRect:a,sheet:h,getRowByVisualIndex:g}),n[11]=g,n[12]=a,n[13]=h,n[14]=i):i=n[14];let u;return n[15]!==o||n[16]!==i?(u=le.jsxs("div",{className:"bg-token-bg-tertiary border-token-border-heavy flex flex-row items-center border-t p-2 ps-12 pt-0 pb-0",children:[o,i]}),n[15]=o,n[16]=i,n[17]=u):u=n[17],u}function a0(e){"use forget";const n=Pn.c(29),{addressLabel:t,inputFocused:r,selectedValue:s,refColors:c,onFxFocus:a,onFxBlur:h,onFxChange:g,canEdit:f,zoom:o,onZoomChange:i}=e,u=f===void 0?!1:f;let l;n[0]!==t?(l=le.jsx("div",{className:"text-token-text-secondary w-24 px-2 text-center text-xs font-medium",children:t}),n[0]=t,n[1]=l):l=n[1];let d;n[2]!==r||n[3]!==c||n[4]!==s?(d=r&&le.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center px-3 py-1 text-xs whitespace-pre",children:s.split(no).map((D,P)=>c[D]?le.jsx("span",{style:{color:c[D]},className:"font-normal",children:D},P):D)}),n[2]=r,n[3]=c,n[4]=s,n[5]=d):d=n[5];const v=!u;let p;n[6]!==g?(p=D=>g==null?void 0:g(D.target.value),n[6]=g,n[7]=p):p=n[7];let m;n[8]!==h||n[9]!==a||n[10]!==s||n[11]!==v||n[12]!==p?(m=le.jsx("input",{type:"text",readOnly:v,value:s,className:"bg-token-bg-primary border-token-border-heavy w-full rounded-md border px-3 py-1 text-xs",onFocus:a,onBlur:h,onKeyDown:g0,onChange:p}),n[8]=h,n[9]=a,n[10]=s,n[11]=v,n[12]=p,n[13]=m):m=n[13];let E;n[14]!==d||n[15]!==m?(E=le.jsxs("div",{className:"relative w-full",children:[d,m]}),n[14]=d,n[15]=m,n[16]=E):E=n[16];let w;n[17]===Symbol.for("react.memo_cache_sentinel")?(w=[.25,.5,.75,1,1.5,2,3,4].map(h0),n[17]=w):w=n[17];let N;n[18]!==o?(N=Math.round(o*100),n[18]=o,n[19]=N):N=n[19];const I="".concat(N,"%");let R;n[20]!==i?(R=D=>i(Number(D)),n[20]=i,n[21]=R):R=n[21];let y;n[22]!==I||n[23]!==R?(y=le.jsx(ps,{options:w,value:void 0,placeholder:I,onValueChange:R,triggerClassName:"text-xs w-16 h-6 border border-token-border-heavy"}),n[22]=I,n[23]=R,n[24]=y):y=n[24];let M;return n[25]!==y||n[26]!==l||n[27]!==E?(M=le.jsxs("div",{className:"bg-token-bg-tertiary flex flex-row items-center gap-2 p-2 text-sm",children:[l,E,y]}),n[25]=y,n[26]=l,n[27]=E,n[28]=M):M=n[28],M}function h0(e){return{label:"".concat(e*100,"%"),value:e.toString()}}function g0(e){e.key==="Enter"&&(e.preventDefault(),e.currentTarget.blur())}function d0(e){e=Math.max(1,e);let n="";for(;e>0;){const t=(e-1)%26;n=String.fromCharCode(65+t)+n,e=Math.floor((e-1)/26)}return n}function kt(e,n,t){var m;const r=e.startsWith("$"),s=r?1:0;let c=s;for(;c<e.length&&/[A-Za-z]/.test((m=e[c])!=null?m:"");)c++;const a=e.slice(s,c);let h=!1,g=c;e[g]==="$"&&(h=!0,g++);const f=e.slice(g),o=Re(a),i=parseInt(f,10)||0,u=r?o:Math.max(1,o+n),l=h?i:Math.max(1,i+t),d=d0(u),v=(r?"$":"")+d,p=(h?"$":"")+String(l);return v+p}function Wt(e){var c;let n=0;e[n]==="$"&&n++;const t=n;for(;n<e.length&&/[A-Za-z]/.test((c=e[n])!=null?c:"");)n++;const r=e.slice(t,n);e[n]==="$"&&n++;const s=e.slice(n);return{col:Re(r),row:parseInt(s,10)||0}}const v0=/((?:'[^']+'|[A-Za-z0-9_.]+)!)?(\$?[A-Za-z]{1,3}\$?\d{1,7})(?::(\$?[A-Za-z]{1,3}\$?\d{1,7}))?/g;function Wo(e,n,t){if(!e||!n||!t)return e;const{col:r,row:s}=Wt(n),{col:c,row:a}=Wt(t),h=c-r,g=a-s;return h===0&&g===0?e:e.replace(v0,(f,o,i,u)=>{const l=o?String(o):"",d=kt(String(i),h,g);if(!u)return"".concat(l).concat(d);const v=kt(String(u),h,g);return"".concat(l).concat(d,":").concat(v)})}function p0(){return Z.useMemo(()=>{var r;const e=s=>{const c=s.match(/^rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*[\d.]+)?\)$/i);if(c)return[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)];const a=s.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i);if(a){const h=a[1];if(h.length===3){const i=parseInt(h[0]+h[0],16),u=parseInt(h[1]+h[1],16),l=parseInt(h[2]+h[2],16);return[i,u,l]}const g=parseInt(h.slice(0,2),16),f=parseInt(h.slice(2,4),16),o=parseInt(h.slice(4,6),16);return[g,f,o]}return null},n=typeof document<"u"?getComputedStyle(document.documentElement).getPropertyValue("--theme-submit-btn-bg").trim():"",t=(r=e(n))!=null?r:[175,82,222];return{accentFill:"rgba(".concat(t[0],", ").concat(t[1],", ").concat(t[2],", 0.15)"),accentStroke:"rgba(".concat(t[0],", ").concat(t[1],", ").concat(t[2],", 1)")}},[])}function w0(e){const{setOpenFilterMenu:n}=e;return Z.useCallback(()=>n(null),[n])}function m0(e,n){return Z.useMemo(()=>{const r=Array(500).fill(_t);for(const s of e){const c=as(s.width);for(let a=s.min-1;a<s.max;a++)r[a]=c}for(const[s,c]of Object.entries(n)){const a=Number(s);Number.isFinite(a)&&a>=0&&a<r.length&&typeof c=="number"&&!Number.isNaN(c)&&(r[a]=c)}return r},[e,n])}function E0(e){const{rowIndexRemap:n,sheetRows:t}=e;return Z.useCallback(r=>{var c;const s=(c=n[r])!=null?c:r;return t.find(a=>a.index-1===s)},[n,t])}function N0(e){const{overlayCanvasRef:n,containerRef:t,selectionStartRef:r,selectionEndRef:s,viewColWidths:c,rowHeights:a,zoom:h,accentFill:g,accentStroke:f,sheet:o,resizeGuide:i,copyOutlineRectRef:u,copyDashOffsetRef:l}=e;return Z.useCallback(()=>{var B,Q;const v=n.current,p=t.current;if(!v||!p)return;const m=v.getContext("2d");if(!m)return;const E=p.clientWidth,w=p.clientHeight,N=window.devicePixelRatio;v.width=E*N,v.height=w*N,v.style.width="".concat(E,"px"),v.style.height="".concat(w,"px"),m.setTransform(N,0,0,N,0,0),m.clearRect(0,0,E,w);const I=r.current,R=s.current;let y=0,M=0,D=0,P=0;if(I&&R&&(y=Math.min(I.row,R.row),M=Math.max(I.row,R.row),D=Math.min(I.col,R.col),P=Math.max(I.col,R.col)),I&&R&&I.row===R.row&&I.col===R.col){const k=((B=o.mergedCells)!=null?B:[]).find(oe=>{const ae=Re(oe.startAddress),se=De(oe.startAddress),ie=Re(oe.endAddress),J=De(oe.endAddress),ve=Math.min(ae,ie),X=Math.max(ae,ie),pe=Math.min(se,J),me=Math.max(se,J);return I.col>=ve&&I.col<=X&&I.row>=pe&&I.row<=me});if(k){const oe=Re(k.startAddress),ae=De(k.startAddress),se=Re(k.endAddress),ie=De(k.endAddress);D=Math.min(oe,se),P=Math.max(oe,se),y=Math.min(ae,ie),M=Math.max(ae,ie)}}const z=[0];for(let q=0;q<c.length;q++)z[q+1]=z[q]+c[q];const G=[0];for(let q=0;q<a.length;q++)G[q+1]=G[q]+a[q];m.save(),m.scale(h,h);const S=I&&R?Le+z[D]-p.scrollLeft:0,_=I&&R?Oe+G[y]-p.scrollTop:0,ue=I&&R?z[P+1]-z[D]:0,ge=I&&R?G[M+1]-G[y]:0,Y=I?Le+z[I.col]-p.scrollLeft:0,j=I?Oe+G[I.row]-p.scrollTop:0,ne=I?c[I.col]:0,re=I?a[I.row]:0;if(I&&R){m.save(),m.fillStyle=g;const q=S+ue,k=_+ge,oe=Y+ne,ae=j+re;j>_&&m.fillRect(S,_,ue,j-_),ae<k&&m.fillRect(S,ae,ue,k-ae),Y>S&&m.fillRect(S,j,Y-S,re),oe<q&&m.fillRect(oe,j,q-oe,re),m.restore()}if(I&&R){m.save(),m.fillStyle=g;for(let q=D;q<=P;q++){const k=Le+z[q]-p.scrollLeft,oe=c[q];m.fillRect(k,0,oe,Oe),m.strokeStyle=f,m.lineWidth=2/h,m.beginPath(),m.moveTo(k,Oe),m.lineTo(k+oe,Oe),m.stroke()}for(let q=y;q<=M;q++){const k=Oe+G[q]-p.scrollTop,oe=a[q];m.fillRect(0,k,Le,oe),m.strokeStyle=f,m.lineWidth=2/h,m.beginPath(),m.moveTo(Le,k),m.lineTo(Le,k+oe),m.stroke()}m.restore()}if(m.restore(),I&&R&&(m.save(),m.strokeStyle=f,m.lineWidth=1,m.strokeRect(S,_,ue,ge),m.restore()),u.current){let{r1:q,c1:k,r2:oe,c2:ae}=u.current;if(q===oe&&k===ae){const T=((Q=o.mergedCells)!=null?Q:[]).find(O=>{const L=Re(O.startAddress),$=De(O.startAddress),F=Re(O.endAddress),x=De(O.endAddress),b=Math.min(L,F),Ae=Math.max(L,F),we=Math.min($,x),xe=Math.max($,x);return k>=b&&k<=Ae&&q>=we&&q<=xe});if(T){const O=Re(T.startAddress),L=De(T.startAddress),$=Re(T.endAddress),F=De(T.endAddress);k=Math.min(O,$),ae=Math.max(O,$),q=Math.min(L,F),oe=Math.max(L,F)}}const se=[0];for(let de=0;de<c.length;de++)se[de+1]=se[de]+c[de];const ie=[0];for(let de=0;de<a.length;de++)ie[de+1]=ie[de]+a[de];const J=v.getContext("2d");if(!J)return;J.save(),J.scale(h,h);const ve=Le+se[k]-p.scrollLeft,X=Oe+ie[q]-p.scrollTop,pe=se[ae+1]-se[k],me=ie[oe+1]-ie[q];J.strokeStyle=f,J.lineWidth=2/h,J.setLineDash([8,4]),J.lineDashOffset=-l.current,J.strokeRect(ve,X,pe,me),J.restore()}if(i){const q=v.getContext("2d");if(!q)return;q.save(),q.scale(h,h),q.strokeStyle=f,q.lineWidth=2/h,q.setLineDash([6,4]),i.type==="col"?(q.beginPath(),q.moveTo(i.pos,0),q.lineTo(i.pos,w/h),q.stroke()):(q.beginPath(),q.moveTo(0,i.pos),q.lineTo(E/h,i.pos),q.stroke()),q.restore()}},[n,t,r,s,c,a,h,g,f,o,i,u,l])}function I0(e){const{canvasRef:n,containerRef:t,sheet:r,viewColWidths:s,rowHeights:c,selRow:a,selCol:h,zoom:g,styleInfos:f,refColors:o,formulaRefs:i,inputFocused:u,workbook:l,themeMap:d,showFormulas:v,rowIndexRemap:p,unsupportedCellsRef:m}=e;return Z.useCallback(()=>{const w=n.current,N=t.current;if(!w||!N)return;const I=w.getContext("2d");if(!I)return;const R=N.clientWidth,y=N.clientHeight;w.width=R*window.devicePixelRatio,w.height=y*window.devicePixelRatio,w.style.width="".concat(R,"px"),w.style.height="".concat(y,"px"),I.setTransform(window.devicePixelRatio,0,0,window.devicePixelRatio,0,0),hs(I,r,s,c,N.scrollLeft,N.scrollTop,R,y,a,h,g,f,o,new Set(i),m.current,u,l,d,v,p)},[n,t,r,s,c,a,h,g,f,o,i,u,l,d,v,p,m])}function dr(e){var s,c,a;const n=e.split(":"),t=(s=n[0])!=null?s:"A1",r=(a=(c=n[1])!=null?c:n[0])!=null?a:"A1";return{c1:Re(t),r1:De(t),c2:Re(r),r2:De(r)}}function A0(e,n,t,r,s){return Z.useMemo(()=>{var f,o,i,u;const a=e.defaultRowHeight&&e.defaultRowHeight!==0?e.defaultRowHeight:jt,h=Array(500).fill(Br(a));for(const l of e.rows)(l.customHeight||l.height!==0)&&l.height!=null&&(h[l.index-1]=Br(l.height));for(const[l,d]of Object.entries(n)){const v=Number(l);Number.isFinite(v)&&v>=0&&v<h.length&&typeof d=="number"&&!Number.isNaN(d)&&(h[v]=d)}if(e.tables&&Object.keys(t).length>0){const l=new Map;for(const d of e.rows)l.set(d.index-1,d);for(const d of e.tables){if(!(d!=null&&d.ref))continue;const{c1:v,r1:p,c2:m,r2:E}=dr(d.ref),w=Math.min(v,m),N=Math.max(v,m),I=Math.min(p,E),R=Math.max(0,Math.min(1,(f=d.headerRowCount)!=null?f:1)),y=Math.max(0,Math.min(1,(o=d.totalsRowCount)!=null?o:d.totalsRowShown?1:0)),M=I+R,D=Math.max(I,Math.max(p,E)-y);if(M>D)continue;const P=new Map;for(let z=w;z<=N;z++){const G="".concat(e.name,":").concat((i=d.id)!=null?i:0,":").concat(z),S=t[G];S&&S.size>0&&P.set(z,S)}if(P.size!==0)for(let z=M;z<=D;z++){const G=(u=s[z])!=null?u:z,S=l.get(G);if(!S)continue;let _=!0;for(const[ue,ge]of P.entries()){const Y=S.cells.find(ne=>Re(ne.address)===ue),j=Y?Rn(Y,r):"";if(!ge.has(j)){_=!1;break}}_||(h[z]=0)}}}const g=h.reduce((l,d)=>l+d,0);return{heights:h,total:g}},[e,n,t,r,s])}function R0(e,n,t){return Z.useMemo(()=>{var h,g,f,o,i,u;const s=Array.from({length:500},(l,d)=>d),c=(h=e.tables)!=null?h:[];if(c.length===0)return s;const a=new Map;for(const l of e.rows)a.set(l.index-1,l);for(const l of c){if(!(l!=null&&l.ref))continue;const d="".concat(e.name,":").concat((g=l.id)!=null?g:0),v=n[d];if(!v)continue;const{r1:p,r2:m}=dr(l.ref),E=Math.min(p,m),w=Math.max(p,m),N=Math.max(0,Math.min(1,(f=l.headerRowCount)!=null?f:1)),I=Math.max(0,Math.min(1,(o=l.totalsRowCount)!=null?o:l.totalsRowShown?1:0)),R=E+N,y=Math.max(E,w-I);if(R>y)continue;const M=[];for(let D=R;D<=y;D++){const P=a.get(D),z=P==null?void 0:P.cells.find(_=>_&&typeof _.address=="string"&&_.address.length>0),G=z?Rn(z,t):"",S=G===""?null:Number(G);M.push({actual:D,keyStr:G,keyNum:Number.isFinite(S)?S:null})}M.sort((D,P)=>{if(D.keyNum!=null&&P.keyNum!=null)return v.dir==="asc"?D.keyNum-P.keyNum:P.keyNum-D.keyNum;const z=D.keyStr.toLowerCase(),G=P.keyStr.toLowerCase(),S=z.localeCompare(G);return v.dir==="asc"?S:-S});for(let D=0;D<M.length;D++){const P=R+D,z=(u=(i=M[D])==null?void 0:i.actual)!=null?u:P;P>=0&&P<s.length&&(s[P]=z)}}return s},[e,n,t])}function y0(e){return Z.useMemo(()=>gs(e),[e])}function T0(e){return Z.useMemo(()=>ms(e),[e])}function M0(e,n,t,r){return Z.useMemo(()=>{if(!e){const h=n.reduce((g,f)=>g+f,0);return{widths:n,total:h}}const s=new Set;for(const h of t)for(const g of h.cells)(g.formula&&g.formula!==""||typeof g.sharedFormulaSi=="number")&&s.add(Re(g.address));const c=n.slice();s.forEach(h=>{h in r||h>=0&&h<c.length&&(c[h]=c[h]*2)});const a=c.reduce((h,g)=>h+g,0);return{widths:c,total:a}},[e,n,t,r])}const C0=Jt(()=>Kt(()=>import("./e23v0up48ofc1v2q.js").then(e=>e._),__vite__mapDeps([0,1])),{loading:e=>bt(e)}),D0=Jt(()=>Kt(()=>import("./bimaydywrdin6h6p.js").then(e=>e._),__vite__mapDeps([2,1])),{loading:e=>bt(e)});function O0(e){"use forget";var se,ie,J,ve;const n=Pn.c(70),{btn:t,isOpen:r,onOpen:s,onClose:c,zoom:a,values:h,selectedValues:g,onToggleValue:f,onSelectAll:o,onSort:i,filterSortTitle:u,filterHeaderLabel:l,noDiscreteValuesLabel:d,selectAllLabel:v,sortAZLabel:p,sortZALabel:m}=e;let E;n[0]===Symbol.for("react.memo_cache_sentinel")?(E={placement:"bottom-end",middleware:[ss(6),is(),fs({padding:8})],whileElementsMounted:os},n[0]=E):E=n[0];const{refs:w,floatingStyles:N,update:I}=us(E);let R;n[1]!==w?(R=X=>{w.setReference(X)},n[1]=w,n[2]=R):R=n[2];const y=R;let M;n[3]!==w?(M=X=>{w.setFloating(X)},n[3]=w,n[4]=M):M=n[4];const D=M;let P;n[5]!==r||n[6]!==I?(P=()=>{r&&(I==null||I())},n[5]=r,n[6]=I,n[7]=P):P=n[7];let z;n[8]!==t.height||n[9]!==t.left||n[10]!==t.top||n[11]!==t.width||n[12]!==r||n[13]!==I||n[14]!==a?(z=[r,I,t.left,t.top,t.width,t.height,a],n[8]=t.height,n[9]=t.left,n[10]=t.top,n[11]=t.width,n[12]=r,n[13]=I,n[14]=a,n[15]=z):z=n[15],Z.useEffect(P,z);let G;n[16]!==r||n[17]!==c||n[18]!==((se=w.floating)==null?void 0:se.current)||n[19]!==((ie=w.reference)==null?void 0:ie.current)?(G=()=>{if(!r)return;const X=me=>{var L,$;const de=me.target;if(!(de instanceof Node))return;const T=(L=w.reference)==null?void 0:L.current,O=($=w.floating)==null?void 0:$.current;T&&T.contains(de)||O&&O.contains(de)||c()},pe=me=>{me.key==="Escape"&&c()};return window.addEventListener("pointerdown",X,{capture:!0}),window.addEventListener("keydown",pe),()=>{window.removeEventListener("pointerdown",X,!0),window.removeEventListener("keydown",pe)}},n[16]=r,n[17]=c,n[18]=(J=w.floating)==null?void 0:J.current,n[19]=(ve=w.reference)==null?void 0:ve.current,n[20]=G):G=n[20];let S;n[21]!==r||n[22]!==c||n[23]!==w.floating||n[24]!==w.reference?(S=[r,c,w.floating,w.reference],n[21]=r,n[22]=c,n[23]=w.floating,n[24]=w.reference,n[25]=S):S=n[25],Z.useEffect(G,S);const _=t.left*a,ue=t.top*a,ge=t.width*a,Y=t.height*a;let j;n[26]!==ge||n[27]!==Y||n[28]!==_||n[29]!==ue?(j={left:_,top:ue,width:ge,height:Y},n[26]=ge,n[27]=Y,n[28]=_,n[29]=ue,n[30]=j):j=n[30];let ne;n[31]===Symbol.for("react.memo_cache_sentinel")?(ne=Qt("hover:bg-token-bg-secondary inline-flex items-center gap-0.5 rounded-[2px] border text-[10px] leading-none","border-token-border-heavy bg-white"),n[31]=ne):ne=n[31];let re;n[32]!==r||n[33]!==c||n[34]!==s?(re=X=>{X.preventDefault(),X.stopPropagation(),r?c():s()},n[32]=r,n[33]=c,n[34]=s,n[35]=re):re=n[35];let B;n[36]!==t.isFiltered?(B=t.isFiltered&&le.jsx("svg",{"aria-hidden":"true",width:"10",height:"10",viewBox:"0 0 24 24",fill:"currentColor",children:le.jsx("path",{d:"M3 4h18l-7 8v6l-4 2v-8L3 4z"})}),n[36]=t.isFiltered,n[37]=B):B=n[37];let Q;n[38]!==t.isSorted||n[39]!==t.sortDir?(Q=t.isSorted&&(t.sortDir==="asc"?le.jsx(C0,{className:"size-3"}):le.jsx(D0,{className:"size-3"})),n[38]=t.isSorted,n[39]=t.sortDir,n[40]=Q):Q=n[40];let q;n[41]!==t.isFiltered||n[42]!==t.isSorted?(q=!t.isFiltered&&!t.isSorted&&le.jsx("svg",{"aria-hidden":"true",width:"10",height:"10",viewBox:"0 0 24 24",fill:"currentColor",children:le.jsx("path",{d:"M7 10l5 5 5-5z"})}),n[41]=t.isFiltered,n[42]=t.isSorted,n[43]=q):q=n[43];let k;n[44]!==u||n[45]!==y||n[46]!==re||n[47]!==B||n[48]!==Q||n[49]!==q?(k=le.jsx("div",{className:"flex h-full items-center justify-end px-1",children:le.jsxs("button",{type:"button",ref:y,"data-walnut-filter-button":"true",className:ne,title:u,onClick:re,children:[B,Q,q]})}),n[44]=u,n[45]=y,n[46]=re,n[47]=B,n[48]=Q,n[49]=q,n[50]=k):k=n[50];let oe;n[51]!==l||n[52]!==N||n[53]!==r||n[54]!==d||n[55]!==c||n[56]!==o||n[57]!==i||n[58]!==f||n[59]!==v||n[60]!==g||n[61]!==D||n[62]!==p||n[63]!==m||n[64]!==h?(oe=r&&ts.createPortal(le.jsxs("div",{ref:D,"data-walnut-filter-menu":"true",className:"mt-1 w-56 rounded-md border bg-white text-xs shadow-lg",style:En(tn({},N),{zIndex:1e3,pointerEvents:"auto"}),onMouseDown:P0,onMouseUp:F0,onClick:L0,children:[le.jsxs("div",{className:"flex items-center justify-between border-b p-2 font-medium",children:[le.jsx("span",{children:l}),le.jsx("button",{type:"button",className:"text-token-text-secondary hover:text-token-text-primary text-[11px]",onClick:X=>{X.preventDefault(),X.stopPropagation(),o()},children:v})]}),le.jsxs("div",{className:"max-h-48 space-y-1 overflow-auto p-2",children:[h.map(X=>{const pe=g?g.has(X):!0;return le.jsxs("label",{className:"flex items-center gap-2",children:[le.jsx("input",{type:"checkbox",checked:pe,onChange:()=>f(X)}),le.jsx("span",{className:"truncate",title:X,children:X})]},X)}),h.length===0&&le.jsx("div",{className:"text-token-text-secondary",children:d})]}),le.jsx("div",{className:"flex items-center gap-2 border-t p-2",children:le.jsxs("div",{className:"ms-auto flex items-center gap-2",children:[le.jsx("button",{type:"button",className:"flex-1 rounded border px-2 py-1",onClick:X=>{X.preventDefault(),X.stopPropagation(),i("asc"),c()},children:p}),le.jsx("button",{type:"button",className:"flex-1 rounded border px-2 py-1",onClick:X=>{X.preventDefault(),X.stopPropagation(),i("desc"),c()},children:m})]})})]}),document.body),n[51]=l,n[52]=N,n[53]=r,n[54]=d,n[55]=c,n[56]=o,n[57]=i,n[58]=f,n[59]=v,n[60]=g,n[61]=D,n[62]=p,n[63]=m,n[64]=h,n[65]=oe):oe=n[65];let ae;return n[66]!==j||n[67]!==k||n[68]!==oe?(ae=le.jsxs("div",{className:"absolute",style:j,children:[k,oe]}),n[66]=j,n[67]=k,n[68]=oe,n[69]=ae):ae=n[69],ae}function L0(e){e.stopPropagation()}function F0(e){e.stopPropagation()}function P0(e){e.stopPropagation()}function St(e,n,t,r){var N,I,R,y,M,D,P;const s=((N=e.tables)!=null?N:[]).find(z=>{var G;return((G=z.id)!=null?G:0)===r});if(!(s!=null&&s.autoFilter))return[];const{c1:c,r1:a,c2:h,r2:g}=dr((I=s.ref)!=null?I:"A1"),f=t-Math.min(c,h),o=((R=s.autoFilter.columns)!=null?R:[]).find(z=>z.colId===f&&z.type==="filters"),i=(M=(y=o==null?void 0:o.filters)==null?void 0:y.values)!=null?M:[];if(i.length>0)return i.slice(0,200);if(!s.ref)return[];const u=Math.min(a,g),l=Math.max(a,g),d=Math.max(0,Math.min(1,(D=s.headerRowCount)!=null?D:1)),v=Math.max(0,Math.min(1,(P=s.totalsRowCount)!=null?P:s.totalsRowShown?1:0)),p=u+d,m=Math.max(u,l-v);if(p>m)return[];const E=new Set;for(let z=p;z<=m;z++){const G=e.rows.find(ue=>ue.index-1===z);if(!G)continue;const S=G.cells.find(ue=>Re(ue.address)===t),_=S?Rn(S,n):"";if(E.add(_),E.size>2e3)break}const w=Array.from(E);return w.sort((z,G)=>z.localeCompare(G)),w.slice(0,200)}function V0(e,n,t,r,s,c){const a="".concat(n,":").concat(t,":").concat(r);e(h=>{const g=tn({},h),f=h[a],o=new Set(f?Array.from(f):Array.from(s));return o.has(c)?o.delete(c):o.add(c),o.size===s.length?delete g[a]:g[a]=o,g})}const In={filter:Nn({id:"walnut.spreadsheet.filter.header",defaultMessage:"Filter"}),noDiscreteValues:Nn({id:"walnut.spreadsheet.filter.no_values",defaultMessage:"No discrete values"}),sortAZ:Nn({id:"walnut.spreadsheet.filter.sort_az",defaultMessage:"Sort AZ"}),sortZA:Nn({id:"walnut.spreadsheet.filter.sort_za",defaultMessage:"Sort ZA"}),filterSort:Nn({id:"walnut.spreadsheet.filter.sort_title",defaultMessage:"Filter & sort"}),selectAll:Nn({id:"walnut.spreadsheet.filter.select_all",defaultMessage:"Select all"})};function q0(e){return Z.useMemo(()=>{const n=[0];for(let t=0;t<e.length;t++)n[t+1]=n[t]+e[t];return n},[e])}function U0(e,n,t,r,s,c,a){return Z.useMemo(()=>{var g,f,o,i,u;const h=[];for(const l of(g=e.tables)!=null?g:[]){if(!l.ref)continue;const{c1:d,r1:v,c2:p,r2:m}=dr(l.ref),E=Math.min(d,p),w=Math.max(d,p),N=Math.min(v,m);if(Math.max(0,Math.min(1,(f=l.headerRowCount)!=null?f:1))===0)continue;const R=N,y=Oe+s[R],M=t[R];for(let D=E;D<=w;D++){const P=Le+r[D],z=n[D],G="".concat(e.name,":").concat(l.id,":").concat(D),S=!!((o=c[G])!=null&&o.size),_="".concat(e.name,":").concat((i=l.id)!=null?i:0),ue=a[_],ge=!!(ue&&ue.colIdx===D),Y=ge?ue==null?void 0:ue.dir:void 0;h.push({key:G,left:P,top:y,width:z,height:M,tableId:(u=l.id)!=null?u:0,colIdx:D,isFiltered:S,isSorted:ge,sortDir:Y})}}return h},[e,n,t,r,s,c,a])}function $0(e){return Z.useMemo(()=>{const n=[0];for(let t=0;t<e.length;t++)n[t+1]=n[t]+e[t];return n},[e])}function x0(e){"use forget";const n=Pn.c(27),{sheet:t,viewColWidths:r,rowHeights:s,zoom:c,styleInfos:a,activeFilters:h,setActiveFilters:g,activeSortByTable:f,setActiveSortByTable:o,openFilterMenu:i,setOpenFilterMenu:u,onClose:l}=e,d=Xt(),v=q0(r),p=$0(s),m=U0(t,r,s,v,p,h,f);let E;if(n[0]!==h||n[1]!==d||n[2]!==l||n[3]!==(i==null?void 0:i.colIdx)||n[4]!==(i==null?void 0:i.tableId)||n[5]!==m||n[6]!==g||n[7]!==o||n[8]!==u||n[9]!==t||n[10]!==a||n[11]!==c){let N;n[13]!==h||n[14]!==d||n[15]!==l||n[16]!==(i==null?void 0:i.colIdx)||n[17]!==(i==null?void 0:i.tableId)||n[18]!==g||n[19]!==o||n[20]!==u||n[21]!==t||n[22]!==a||n[23]!==c?(N=I=>{const R=(i==null?void 0:i.tableId)===I.tableId&&(i==null?void 0:i.colIdx)===I.colIdx;return le.jsx(O0,{btn:I,isOpen:R,onOpen:()=>u({tableId:I.tableId,colIdx:I.colIdx}),onClose:l,zoom:c,values:St(t,a,I.colIdx,I.tableId),selectedValues:h["".concat(t.name,":").concat(I.tableId,":").concat(I.colIdx)],onToggleValue:y=>{const M=St(t,a,I.colIdx,I.tableId);V0(g,t.name,I.tableId,I.colIdx,M,y)},onSelectAll:()=>{const y="".concat(t.name,":").concat(I.tableId,":").concat(I.colIdx);g(M=>{const D=tn({},M);return delete D[y],D})},onSort:y=>{const M="".concat(t.name,":").concat(I.tableId);o(D=>En(tn({},D),{[M]:{colIdx:I.colIdx,dir:y}}))},filterSortTitle:d.formatMessage(In.filterSort),filterHeaderLabel:d.formatMessage(In.filter),noDiscreteValuesLabel:d.formatMessage(In.noDiscreteValues),selectAllLabel:d.formatMessage(In.selectAll),sortAZLabel:d.formatMessage(In.sortAZ),sortZALabel:d.formatMessage(In.sortZA)},I.key)},n[13]=h,n[14]=d,n[15]=l,n[16]=i==null?void 0:i.colIdx,n[17]=i==null?void 0:i.tableId,n[18]=g,n[19]=o,n[20]=u,n[21]=t,n[22]=a,n[23]=c,n[24]=N):N=n[24],E=m.map(N),n[0]=h,n[1]=d,n[2]=l,n[3]=i==null?void 0:i.colIdx,n[4]=i==null?void 0:i.tableId,n[5]=m,n[6]=g,n[7]=o,n[8]=u,n[9]=t,n[10]=a,n[11]=c,n[12]=E}else E=n[12];let w;return n[25]!==E?(w=le.jsx(le.Fragment,{children:E}),n[25]=E,n[26]=w):w=n[26],w}function z0(e){Z.useEffect(()=>{var t;const n={SheetNames:[],Sheets:{}};for(const r of e.sheets){const s=eo(r);n.SheetNames.push(r.name);const c={};for(const a of r.rows)for(const h of a.cells){const g={};if(h.value!==""){const f=Number(h.value);g.v=Number.isNaN(f)?h.value:f}if(h.formula)g.f=h.formula;else if(h.sharedFormulaSi){const f=s.get(h.sharedFormulaSi);f&&(g.f=Wo(f.base,f.anchor,h.address))}c[h.address]=g}n.Sheets[r.name]=c}er.import_functions(zo);try{er(n,{continue_after_error:!0})}catch(r){Zt.addError(r)}for(const r of e.sheets){const s=n.Sheets[r.name];for(const c of r.rows)for(const a of c.cells){const h=!!a.sharedFormulaSi;if((a.formula||h)&&a.value===""){const g=(t=s[a.address])==null?void 0:t.v;g!=null?a.value=String(g):a.value="This formula is not supported in web preview. Please download the original file to view it fully."}}}},[e])}function H0(e){let n="";for(e+=1;e;){const t=(e-1)%26;n=String.fromCharCode(65+t)+n,e=Math.floor((e-t)/26)}return n}function Y0(e){const n=e.match(/[A-Z]+/);if(!n)return 0;let t=0;for(const r of n[0])t=t*26+(r.charCodeAt(0)-64);return t-1}function B0(e){const n=e.match(/\d+/);return n?parseInt(n[0],10)-1:0}function G0(e,n){return"".concat(H0(e)).concat(n+1)}function k0({cols:e,rows:n,selected:t,setSelected:r,enabled:s=!0}){Z.useEffect(()=>{if(!s)return;function c(a){let h=Y0(t.address),g=B0(t.address);const{key:f,shiftKey:o}=a;let i=!1;switch(f){case"ArrowLeft":h>0&&(h-=1,i=!0);break;case"ArrowRight":h<e-1&&(h+=1,i=!0);break;case"ArrowUp":g>0&&(g-=1,i=!0);break;case"ArrowDown":g<n-1&&(g+=1,i=!0);break;case"Tab":a.preventDefault(),(o?h>0:h<e-1)&&(h+=o?-1:1,i=!0);break;case"Enter":a.preventDefault(),(o?g>0:g<n-1)&&(g+=o?-1:1,i=!0);break;default:return}if(i){const u=G0(h,g);r(g,u)}}return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[e,n,t.address,r,s])}const W0=Es().domain(Array.from({length:12},(e,n)=>n.toString())).range(Ns);function j0({workbook:e,selectedSheetIdx:n,isEditing:t,setIsEditing:r}){const{focusedWalnutId:s,setSelectedSheetIdx:c}=vs(),[a,h]=Z.useState(n),[g,f]=Z.useState({}),[o,i]=Z.useState(!1),[u,l]=Z.useState([]),d=Z.useRef(new Set),[v,p]=Z.useState({}),m=e.sheets[a],E=y0(e),w=T0(e.theme),[N,I]=Z.useState(!1);z0(e);const[R,y]=Z.useState({}),[M,D]=Z.useState({}),P=Z.useRef(null),[z,G]=Z.useState(null),S=m0(m.columns,R),{widths:_,total:ue}=M0(N,S,m.rows,R),[ge,Y]=Z.useState({}),[j,ne]=Z.useState(0),[re,B]=Z.useState(""),Q=Z.useRef(null),q=Z.useRef(null),k=Z.useRef(null),oe=Z.useRef(null),ae=Z.useRef(null),se=Z.useRef(null),ie=Z.useRef(0),[J,ve]=Z.useState(1),[X,pe]=Z.useState("A1"),me=Z.useRef(null),de=Z.useRef(null),[T,O]=Z.useState(null),[L,$]=Z.useState(!1),F=()=>{const fe=Q.current,te=oe.current;if(!fe||!te)return;const ye=-fe.scrollLeft,Je=-fe.scrollTop;te.style.transform="translate(".concat(ye,"px, ").concat(Je,"px)")},[x,b]=Z.useState(null),[Ae,we]=Z.useState({}),xe=w0({setOpenFilterMenu:b}),Ee=Re(X),Ue=De(X),Ze=R0(m,ge,E),{heights:Ce,total:Yn}=A0(m,M,Ae,E,Ze);function Bn(){if(i(!0),!re.startsWith("="))return;const fe=As(re);l(fe),p(Object.fromEntries(fe.map((te,ye)=>[te,W0(ye.toString())])))}function vr(){if(t)try{const fe=Gn(j),te=fe==null?void 0:fe.cells.find(ye=>ye.address===X);if(te){const ye=re;if(/^\s*=/.test(ye)){const Pe=ye.replace(/^\s*=\s*/,"");te.formula=Pe,typeof te.sharedFormulaSi=="number"&&(te.sharedFormulaSi=void 0),te.value="",f0(e),B("= ".concat(Pe))}else te.formula="",typeof te.sharedFormulaSi=="number"&&(te.sharedFormulaSi=void 0),te.value=ye,B(ye);Qe()}}catch(fe){}i(!1),l([]),p({})}Z.useEffect(()=>{i(!1),l([])},[X,m]),Z.useEffect(()=>{const fe=te=>{te.ctrlKey&&(te.key==="`"||te.code==="Backquote")&&(te.preventDefault(),te.stopPropagation(),I(ye=>!ye))};return window.addEventListener("keydown",fe),()=>window.removeEventListener("keydown",fe)},[]);const Qe=I0({canvasRef:q,containerRef:Q,sheet:m,viewColWidths:_,rowHeights:Ce,selRow:Ue,selCol:Ee,zoom:J,styleInfos:E,refColors:v,formulaRefs:u,inputFocused:o,workbook:e,themeMap:w,showFormulas:N,rowIndexRemap:Ze,unsupportedCellsRef:d}),ln=Z.useRef(T),cn=Z.useRef(Ue),gt=Z.useRef(Ee),dt=Z.useRef(m),vt=Z.useRef(E);Z.useEffect(()=>{ln.current=T},[T]),Z.useEffect(()=>{cn.current=Ue},[Ue]),Z.useEffect(()=>{gt.current=Ee},[Ee]),Z.useEffect(()=>{dt.current=m},[m]),Z.useEffect(()=>{vt.current=E},[E]);const Gn=E0({rowIndexRemap:Ze,sheetRows:m.rows}),{accentFill:So,accentStroke:pt}=p0(),wt=N0({overlayCanvasRef:k,containerRef:Q,selectionStartRef:me,selectionEndRef:de,viewColWidths:_,rowHeights:Ce,zoom:J,accentFill:So,accentStroke:pt,sheet:m,resizeGuide:z,copyOutlineRectRef:ae,copyDashOffsetRef:ie}),Ye=Z.useCallback(()=>{wt()},[wt]);ls(()=>{Qe(),Ye(),F()}),Z.useEffect(()=>{const fe=me.current,te=de.current;!!!(fe&&te&&(fe.row!==te.row||fe.col!==te.col))&&Ue>=0&&Ee>=0&&(me.current={row:Ue,col:Ee},de.current={row:Ue,col:Ee},O({r1:Ue,c1:Ee,r2:Ue,c2:Ee}),Ye())},[Ue,Ee,Ye]),Z.useEffect(()=>{Ye()},[J,_,Ce,Ye]),Z.useEffect(()=>{const fe=Ds({containerRef:Q,selectionRectRef:ln,sheetRef:dt,styleInfosRef:vt,selRowRef:cn,selColRef:gt,selectionStartRef:me,selectionEndRef:de,copyOutlineRectRef:ae,copyAnimReqRef:se,copyDashOffsetRef:ie,redrawSelectionOverlay:Ye});return window.addEventListener("copy",fe,!0),()=>window.removeEventListener("copy",fe,!0)},[Ye]),Z.useEffect(()=>{const fe=te=>{if(te.key==="Escape")try{se.current!=null&&(cancelAnimationFrame(se.current),se.current=null),ae.current=null,Ye()}catch(ye){}};return window.addEventListener("keydown",fe),()=>{window.removeEventListener("keydown",fe)}},[Ye]),Z.useEffect(()=>()=>{se.current!=null&&(cancelAnimationFrame(se.current),se.current=null)},[]),Z.useEffect(()=>{const fe=Q.current;if(!fe)return;const te=()=>{Qe(),Ye(),F()},ye=()=>{Qe(),Ye(),F()};return fe.addEventListener("scroll",te),window.addEventListener("resize",ye),()=>{fe.removeEventListener("scroll",te),window.removeEventListener("resize",ye)}},[Qe,Ye]);function Xo(fe){Rs(fe,{containerRef:Q,canvasRef:q,zoom:J,viewColWidths:_,rowHeights:Ce,selectionStartRef:me,selectionEndRef:de,setSelectionRect:te=>O(te),setIsDragging:te=>$(te),redrawSelectionOverlay:Ye,setResizeGuide:G,resizingRef:P,setColSizeOverrides:y,setRowSizeOverrides:D,redraw:Qe,setSelectedAddr:pe,setSelectedRow:ne,sheet:m})}function Ko(fe){fe.ctrlKey&&ve(te=>Math.min(4,Math.max(.5,te-fe.deltaY*.001)))}k0({cols:_.length,rows:Ce.length,selected:{address:X},setSelected:(fe,te)=>{ne(fe),pe(te)},enabled:!0}),Z.useEffect(()=>{var ye;const fe=Gn(j),te=fe==null?void 0:fe.cells.find(Je=>Je.address===X);if(te)if(te.formula&&te.formula!=="")B("= ".concat(te.formula));else if(te.sharedFormulaSi&&((ye=m.sharedFormulas)!=null&&ye.length)){const Pe=eo(m).get(te.sharedFormulaSi);B(Pe?"= ".concat(Wo(Pe.base,Pe.anchor,te.address)):Rn(te,E))}else B(Rn(te,E));Qe()},[j,X,Qe,m,E,Gn]);function Zo(fe){var ye,Je;const te=Q.current;if(te){f(kn=>En(tn({},kn),{[a]:{left:te.scrollLeft,top:te.scrollTop}}));const Pe=g[a];te.scrollLeft=(ye=Pe==null?void 0:Pe.left)!=null?ye:0,te.scrollTop=(Je=Pe==null?void 0:Pe.top)!=null?Je:0,F()}h(fe),s&&c(s,fe)}const Qo=ue+Le,Jo=Yn+Oe,bo=Z.useMemo(()=>{if(L&&T){const{r1:fe,c1:te,r2:ye,c2:Je}=T,Pe=Math.abs(ye-fe)+1,kn=Math.abs(Je-te)+1;if(Pe>1||kn>1)return"".concat(Pe,"R x ").concat(kn,"C")}return X},[L,T,X]);return le.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[le.jsx(a0,{addressLabel:bo,inputFocused:o,selectedValue:re,refColors:v,onFxFocus:Bn,onFxBlur:vr,onFxChange:fe=>B(fe),canEdit:t,zoom:J,onZoomChange:fe=>ve(fe)}),le.jsxs("div",{ref:Q,className:"relative flex-1 overflow-auto",tabIndex:-1,onWheel:Ko,onMouseMove:fe=>Is(fe,Q,P,J,_,Ce),children:[le.jsxs("div",{className:"relative sticky start-0 top-0",children:[le.jsx("canvas",{ref:q,className:"absolute inset-0",onMouseDown:Xo}),le.jsx("canvas",{ref:k,className:"pointer-events-none absolute inset-0 z-10"}),le.jsx("div",{className:"absolute inset-0 z-20",ref:oe,onMouseDown:fe=>{fe.stopPropagation()},children:le.jsx(x0,{sheet:m,viewColWidths:_,rowHeights:Ce,zoom:J,styleInfos:E,activeFilters:Ae,setActiveFilters:we,activeSortByTable:ge,setActiveSortByTable:Y,openFilterMenu:x,setOpenFilterMenu:b,onClose:xe})})]}),le.jsx("div",{style:{width:Qo*J,height:Jo*J}})]}),le.jsx(c0,{workbook:e,activeSheetIdx:a,onSheetClick:Zo,accentStroke:pt,selectionRect:T,sheet:m,getRowByVisualIndex:Gn}),!1]})}export{j0 as SpreadsheetRenderer};
//# sourceMappingURL=eals7d9xn15i0piz.js.map
