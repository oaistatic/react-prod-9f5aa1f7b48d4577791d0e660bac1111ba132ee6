const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/cldslipf5oxqsdou.js","assets/i8clt0mfz495j7ii.js","assets/j0yo6uv6652vva62.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css"])))=>i.map(i=>d[i]);
var U=Object.defineProperty,q=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var E=(e,r,t)=>r in e?U(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,v=(e,r)=>{for(var t in r||(r={}))Q.call(r,t)&&E(e,t,r[t]);if(M)for(var t of M(r))X.call(r,t)&&E(e,t,r[t]);return e},N=(e,r)=>q(e,J(r));import{_ as O,e as z,j as o,M as Y,h as Z,r as d,A as tt,a4 as et}from"./i8clt0mfz495j7ii.js";import{o as L,L as rt,$ as ot,O as W,d as nt,pz as st,u as k,h as at,hH as F,mM as it,dj as ct,P as mt,aK as pt,mN as G,cN as B,cJ as dt,cE as lt}from"./ghewn7l2ynbm32fm.js";import{m as P}from"./nc6572sivljsjb83.js";import{R as ut}from"./b4m3iyvkh53qge6q.js";import{kh as ht,ki as gt,ci as ft,aC as C,aD as R}from"./j0yo6uv6652vva62.js";import{C as K}from"./jjnmzijnee6e9nx1.js";import{a as xt}from"./kj8h59p17s2tn6gp.js";import{a as Pt}from"./agji492j2wlm3ws1.js";import{b as kt,g as Tt,T as yt,W as vt,c as Ct}from"./ou9nacxkrsdx0eej.js";import{u as bt}from"./ivhm4b1s5w1b1cuw.js";import{useSetupBaseWhamKeyboardActions as jt}from"./hem935dboxz5ici0.js";import{l as A,v as _t}from"./g5lgy1otfli5p2x7.js";import"./hlon4mihnqp86jji.js";import"./b6hyii2315xk7j19.js";import"./olrcssu7duieo6m7.js";import"./fgm9uzc3b50cz4e0.js";import"./d30gyor263984jzn.js";import"./kgnykbdth8mb50na.js";import"./g8i6bixylsxyemsr.js";import"./o108mlelkx5ejfzn.js";import"./fv135gy2k0pewip3.js";import"./fn0h0oidnzmutllx.js";import"./fb2095ktsebx1zzy.js";import"./eyao241335injypy.js";import"./ktw3b87sujui39wx.js";import"./nrrhfi0a0bbsg9w2.js";import"./hht3m8p9e0s4tqnx.js";import"./fvjpw0lui4wq7vv3.js";import"./mpzbsmypy64alaao.js";import"./bc51ukj7a2qfpnc3.js";import"./hhl3vz1yrrpnwu4u.js";import"./f6ek1vdaohim72xh.js";import"./mh1u90j45tiq86ol.js";import"./jo0yr7ku7v9ac6ge.js";import"./kq8d654gegx6snmr.js";import"./zul7780usssm7kro.js";import"./i84uy1p9ly5pjwpt.js";import"./o6tyvbjf9zh9qku3.js";import"./lptwpbjabrvjmhsj.js";import"./gf67njbmurwfkel2.js";import"./dntm9op0tz5bndrs.js";import"./fzrn137102spawew.js";import"./eflwd0j5c3pxruh8.js";import"./l2r1du6tfxyv7jaj.js";import"./ln88gzx578175chd.js";import"./c80gqv0732s10rnu.js";import"./fr2n5yqcoayleu1k.js";import"./ghnvrdqxofgwprfv.js";import"./g69peh4qbpo7a7d7.js";import"./mqebxepg7t6q2tie.js";import"./abaiei0at0999ntu.js";import"./cgpsp6f7jvechnd8.js";import"./i94vqq9eycryltby.js";import"./hf1acpjenvjtaqkn.js";import"./ozgq3nk5vhninx80.js";import"./pn83wqr6w775mq4b.js";import"./chs4g5r39qlnqw6r.js";import"./nzsqhqpna1ee8hwf.js";import"./eh21clr7cewe9q6y.js";import"./gutjuo0v1j4y19t1.js";import"./gzhyo73bmtx9f3d9.js";import"./o56jrqjpjpipvc65.js";import"./hfx63ilakvlo6bm4.js";import"./1u88i8jf4mwk3mc5.js";import"./ieykhlrsk25lij4e.js";import"./i03gut32e8jn5ajq.js";import"./h1em0bjkpkjv8ykw.js";import"./e26n6uhwwtwdmiki.js";import"./mjq17q47489shd3e.js";import"./hxdh3tr5l8kut4ed.js";import"./hu1bt0oauegdhua6.js";const wt=L(()=>O(()=>import("./cldslipf5oxqsdou.js").then(e=>e._),__vite__mapDeps([0,1])),{loading:e=>rt(e)}),St=({title:e})=>{const t=z().formatMessage({id:"5tCuOj",defaultMessage:"Try ChatGPT"});return o.jsxs("div",{className:"flex justify-between print:hidden",children:[o.jsxs("div",{className:"flex flex-col justify-start",children:[o.jsx("p",{className:"text-token-text-primary text-lg font-medium",children:e}),o.jsx("div",{className:"text-token-text-tertiary text-sm",children:o.jsx(Y,{id:"FqymvQ",defaultMessage:"Content may be unverified or unsafe. <reportLink>Report</reportLink>",values:{reportLink:s=>o.jsx("a",{href:"https://openai.com/form/report-content/",target:"_blank",rel:"noopener noreferrer",className:"underline",children:s})}})})]}),o.jsxs("div",{className:"flex cursor-pointer flex-row items-center gap-x-4 rounded-md p-2",children:[o.jsx(wt,{className:"icon text-token-text-secondary hover:bg-token-main-surface-secondary",onClick:()=>print()}),o.jsx(ot,{className:nt("btn btn-secondary bg-black text-white hover:opacity-70"),onClick:()=>{window.open(window.location.origin+"/?utm_src=deep-research-sharing","_blank")},icon:W,label:t,children:t})]})]})};function It({postWithProfile:e,title:r,children:t}){return o.jsx(ht.Provider,{value:{postId:e.post.id},children:o.jsx(st,{children:o.jsx("div",{className:"bg-token-main-surface-secondary min-h-screen w-full pb-8",children:o.jsxs("div",{className:"mx-auto max-w-3xl",children:[o.jsx("div",{className:"px-2 py-6",children:!!r&&o.jsx(St,{title:r})}),o.jsx("div",{className:"border-token-border-xlight bg-token-main-surface-primary flex flex-col rounded-xl border-b pt-4 shadow-md print:border-none print:pt-2 print:shadow-none",children:o.jsxs("div",{className:"p-14 pt-8",children:[o.jsx("a",{href:window.location.origin+"/?utm_src=deep-research-sharing",target:"_blank",rel:"noopener noreferrer",children:o.jsxs("div",{className:"flex items-center gap-3 pb-4",children:[o.jsx(W,{className:"text-token-text-primary h-8 w-8"}),o.jsx(gt,{})]})}),t]})})]})})})})}function Mt(e){if(e.post.attachments[0].kind!=="codex")throw new Error("Post attachment is not a codex");const r=e.post.attachments[0];return{task:r.task,fetchedTurns:r.turns,current_user_turn:r.current_user_turn,current_assistant_turn:r.current_assistant_turn,current_diff_task_turn:r.current_diff_task_turn,exampleTaskInfo:r.example_task_info}}function Et({postWithProfile:e}){var S;jt();const r=A(h=>h.addTurnToTaskMap),{task:t,fetchedTurns:s,current_user_turn:n,current_assistant_turn:a,current_diff_task_turn:c,exampleTaskInfo:p}=Mt(e),l=k(),i=z(),m=Z(),u=ft.useCurrentImage()!=null,T=at(l,"2818336692"),[x,y]=d.useState([]),b=d.useCallback(()=>{y([])},[]),{focusedAssistantTurn:g,setFocusedAssistantTurnId:j}=kt({taskId:t.id,task:t,currentUserTurn:n!=null?n:null,currentAssistantTurn:a!=null?a:null}),_=d.useMemo(()=>_t(g),[g]),D=d.useMemo(()=>({comments:x,setComments:y,clearComments:b,readonlyComments:_}),[x,y,b,_]),f=A(({getTurnsForTask:h})=>t?h(t.id):[]),w=d.useMemo(()=>{var h;return Tt({focusedAssistantTurn:g,pastTurns:f,currentDiffTaskTurnId:(h=c==null?void 0:c.id)!=null?h:null})},[g,c==null?void 0:c.id,f]),V=d.useMemo(()=>({setFocusedAssistantTurnId:j,focusedAssistantTurn:g,currentDiffTaskTurn:w,taskId:t==null?void 0:t.id,task:t,pastTurns:f,canFollowUp:!1}),[g,w,t,f,j]);return d.useEffect(()=>{var h;Object.values((h=s==null?void 0:s.turn_mapping)!=null?h:{}).forEach(H=>{var I;r((I=t==null?void 0:t.id)!=null?I:"",H.turn)})},[s,r,t]),bt([{key:"newTask",action:()=>{m("/codex",{state:{focusComposer:!0}})},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.newTask",defaultMessage:"New task"}),group:R.Chat,keyboardBinding:[C.Mod,C.Shift,"o"]},{key:"closeTask",action:()=>{m("/codex")},actionMessageDescriptor:i.formatMessage({id:"wham.keyboardActions.closeTask",defaultMessage:"Close task"}),group:R.Chat,keyboardBinding:[C.Escape],enabled:!u}]),!t||!f?null:o.jsx(F.Provider,{value:{postWithProfile:e,setIsReportModalOpen:()=>{}},children:o.jsx(it,{children:o.jsx(yt,{value:D,children:o.jsx(vt,{value:V,children:o.jsx(Ct,{permissions:"read",turnId:(S=a==null?void 0:a.id)!=null?S:"",showForkButton:T,loadingTurnMapping:!1,isSharedExampleTask:!!p})})})})})}const Nt=L(()=>O(()=>import("./j0yo6uv6652vva62.js").then(e=>e.zb),__vite__mapDeps([2,1,3,4,5])).then(e=>e.PostSharingErrorModal)),rr=tt(function(){const r=et();return r.kind==="forbidden"?o.jsx(zt,{chatPageProps:r.chatPageProps,reason:"workspace"}):o.jsx(Rt,{loaderData:r})});function Rt({loaderData:e}){var a,c,p,l;const r=k();d.useEffect(()=>{var i,m;mt.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:e.postWithProfile.post.id,primary_attachment_type:(m=(i=e.postWithProfile.post.attachments)==null?void 0:i[0])==null?void 0:m.kind,referrer:e.referrer})},[e]);const{session:t}=pt(r),s=d.useMemo(()=>{var m,u;const i=G(r);return B.initThread({clientThreadId:i.id,conversationMode:{kind:dt.PrimaryAssistant},userId:(m=t==null?void 0:t.user)==null?void 0:m.id,accountId:(u=t==null?void 0:t.account)==null?void 0:u.id}),i},[r,(a=t==null?void 0:t.account)==null?void 0:a.id,(c=t==null?void 0:t.user)==null?void 0:c.id]),n=(p=e.postWithProfile.post.attachments)==null?void 0:p[0];if(n.kind==="deep_research"){const i=n.messages,m=lt(i),u=(l=m==null?void 0:m.metadata)==null?void 0:l.async_task_title;return m?o.jsx(It,{postWithProfile:e.postWithProfile,title:u,children:o.jsx(ut,{messages:i,conversation:s})}):null}return n.kind==="codex"?o.jsx(Et,{postWithProfile:e.postWithProfile}):o.jsx(Lt,{postWithProfile:e.postWithProfile,chatPageProps:e.chatPageProps})}function $(e){return{url:"https://ogimg.chatgpt.com/?postId=".concat(e),size:[1200,630]}}function At(e,r){var s,n,a,c,p,l,i;if(!e.attachments||e.attachments.length===0)return{url:P.src};const t=e.attachments[0];switch(t.kind){case"media_generation":{const m=(n=(s=t.encodings)==null?void 0:s.md)!=null&&n.path?{url:t.encodings.md.path,size:[t.width,t.height]}:void 0,u=(c=(a=t.encodings)==null?void 0:a.unfurl)!=null&&c.path?{url:t.encodings.unfurl.path,size:[1200,630]}:void 0,T=(l=(p=t.encodings)==null?void 0:p.thumbnail)!=null&&l.path?{url:t.encodings.thumbnail.path}:void 0,x={url:t.url,size:[t.width,t.height]};return r&&m!=null?m:(i=u!=null?u:T)!=null?i:x}case"message_slice":return $(e.id);default:return{url:P.src}}}function Ot(e){var s,n,a;const r=(s=e.text)==null?void 0:s.trim();if(r)return r;const t=(n=e.attachments)==null?void 0:n[0];return(t==null?void 0:t.kind)==="media_generation"&&((a=t.title)!=null&&a.trim())?t.title.trim():"Shared Content"}const or=({data:e})=>{const r=e,t={name:"robots",content:"noindex,nofollow"};if(!r||r.kind==="forbidden"){const i="Privately Shared Content";return[{title:"ChatGPT - ".concat(i)},t,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:i},{property:"og:type",content:"website"},{property:"og:image",content:P.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:P.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:i}]}const{post:s}=r.postWithProfile,n=r.enforceRenderedOgImg?$(s.id):At(s,r.preferIntrinsicAspectRatioForOgImage),a=Ot(s),c=s.permalink,p=new Date(s.posted_at*1e3).toISOString();return[{title:"ChatGPT - ".concat(a)},t,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:c},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:n.url},{property:"og:image:secure_url",content:n.url},...n.size?[{property:"og:image:width",content:n.size[0]},{property:"og:image:height",content:n.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:p},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:n.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function zt({chatPageProps:e,reason:r}){const t=k();return d.useEffect(()=>{ct(t,Nt,{reason:r})},[]),o.jsx(K,v({},e))}function Lt({postWithProfile:e,chatPageProps:r}){const t=k(),[s,n]=d.useState(!1),[a]=d.useState(()=>G(t)),c=a.id,p=Pt(e.post.attachments);if(p){const{threadResponse:l}=p;B.updateThreadFromServer(c,l,{skipIfExisting:!0,continuingFromSharedPostId:e.post.id,forkFromSharedPost:!0})}return o.jsxs(F.Provider,{value:{postWithProfile:e,setIsReportModalOpen:n},children:[s&&o.jsx(xt,{post:e.post,onClose:()=>n(!1)}),o.jsx(K,N(v({},r),{clientThreadId:c}))]})}export{rr as default,or as meta};
//# sourceMappingURL=bnlxhx4n0mzzqwpw.js.map
