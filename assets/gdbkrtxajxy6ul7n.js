const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j0yo6uv6652vva62.js","assets/i8clt0mfz495j7ii.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/c8sj5q0wb2w4qlno.js"])))=>i.map(i=>d[i]);
var se=Object.defineProperty,te=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var X=(n,s,a)=>s in n?se(n,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[s]=a,C=(n,s)=>{for(var a in s||(s={}))ae.call(s,a)&&X(n,a,s[a]);if(Q)for(var a of Q(s))ie.call(s,a)&&X(n,a,s[a]);return n},f=(n,s)=>te(n,ce(s));import{e as le,r as d,j as e,M as y,_ as I}from"./i8clt0mfz495j7ii.js";import{u as re,ba as de,hD as ue,lG as _e,eG as pe,mQ as ge,ez as xe,eI as Ce,eK as fe,es as ye,n$ as me,b0 as H,lJ as m,aS as J,aU as w,o0 as he,nO as Y,aL as ke,o as L,w as ve,C as be,aR as Ne,d as Z,$ as ee,L as M}from"./ghewn7l2ynbm32fm.js";import{bo as Se,ba as je}from"./j0yo6uv6652vva62.js";const Oe=L(()=>I(()=>import("./j0yo6uv6652vva62.js").then(n=>n.yq),__vite__mapDeps([0,1,2,3,4])),{loading:n=>M(n)}),Te=L(()=>I(()=>import("./j0yo6uv6652vva62.js").then(n=>n.yx),__vite__mapDeps([0,1,2,3,4])),{loading:n=>M(n)}),we=L(()=>I(()=>import("./c8sj5q0wb2w4qlno.js").then(n=>n._),__vite__mapDeps([5,1])),{loading:n=>M(n)});function Ee({onClose:n,onContinue:s}){const a=re(),A=de(),h=le(),{openSettings:E}=Se(),u=ue(),[k,ne]=d.useState(!1),{availableConnectors:_,isLoading:R}=_e(),v=pe(a),{mutateAsync:P,isPending:G,isSuccess:b}=ge(),{connectedTypes:N}=xe(),{platformConnectors:D,isLoading:U}=Ce(!0),{connectorLinks:z,isLoading:F}=fe({fetchValidLinksOnly:!0}),{connectionInstanceData:p,refetch:S,isLoading:V}=ye({skip:!v.length}),g=d.useMemo(()=>{const o=new Set(v);return new Set(p==null?void 0:p.connection_statuses.filter(r=>o.has(r.user_connection_details.connection_type)))},[p,v]),B=d.useMemo(()=>{const o=new Set(_.map(t=>t.type)),r=new Set(g.values().map(t=>"".concat(t.user_connection_details.connection_type))),i=new Set(me().filter(t=>o.has(t)||r.has(t)));return Array.from(i).slice(0,5)},[_,g]),j=d.useMemo(()=>{var r;const o=[];if(R||U||F||V)return Array.from({length:5},(i,t)=>({icon:e.jsx(H,{}),label:"",key:"loading-"+t,connected:!1,onClick:void 0,loading:void 0}));for(const i of B){const t=_.find(c=>c.type===i);if(t){const c=N.has(t.type);o.push({icon:e.jsx(je,{connector:t,size:"small"}),label:t.name,key:t.type,connected:c,onClick:c?void 0:()=>{u({connectorId:t.id,noRedirect:!0})},loading:void 0})}const l=[...g].find(c=>i===m.notion_sync_connector?c.user_connection_details.connection_instance_id.startsWith("ks--merge"):c.user_connection_details.connection_type===i);if(l){const c=["partially_activated","activated","activating"].includes(l.user_connection_details.activation_status),x={icon:e.jsx("img",{src:A&&l.connection_display_info.icon_dark_url?l.connection_display_info.icon_dark_url:(r=l.connection_display_info.icon_url)!=null?r:"",alt:l.connection_display_info.display_name,className:"icon-lg"}),label:l.connection_display_info.display_name,key:l.user_connection_details.connection_type,connected:c,loading:void 0};i===m.notion_sync_connector?o.push(f(C({},x),{connected:c||!!N.has(w.NOTION_CONNECTOR),onClick:c?void 0:()=>{u({connectorId:J[w.NOTION_CONNECTOR],noRedirect:!0,syncOnly:!0})}})):i===m.slack_sync_connector?o.push(f(C({},x),{connected:c||k,label:"Slack",onClick:c||k?void 0:async()=>{const{success:T}=await he({connectorType:"slack",connectionId:l.user_connection_details.connection_instance_id,location:"user_nux_modal",intl:h});T&&(ne(!0),setTimeout(()=>{S()},1e3))}})):i===m.gdrive_sync_connector?o.push(f(C({},x),{connected:c||b,loading:G,label:"Google Drive",onClick:c||b?void 0:async()=>{var q,K;const T=(q=D.get(Y))==null?void 0:q.id,$=(K=z.get(Y))==null?void 0:K.find(oe=>oe.connector_id===T);$?(await P({link:$}),setTimeout(()=>{S()},1e3)):u({connectorId:J[w.GDRIVE_ACTION_CONNECTOR],noRedirect:!0,syncOnly:!0})}})):o.push(x)}}return o.push({icon:e.jsx(Te,{className:"icon-lg"}),label:h.formatMessage({id:"+rj0FA",defaultMessage:"More apps"}),key:"more-apps",onClick:()=>{E(ke.Connectors)}}),o},[R,U,F,V,h,B,_,g,N,u,A,k,S,b,G,D,z,P,E]),O=d.useMemo(()=>j.filter(o=>o.connected),[j]),W=d.useCallback(()=>{ve.setItem("oai/apps/connectors/glauxOnboarding",new Date().getTime()),n(!1),s()},[s,n]);return e.jsxs(be,{className:"max-w-[480px] pb-8",hideSeparator:!0,isOpen:!0,onClose:()=>n(!1),showCloseButton:!1,testId:"modal-glaux-nux",type:"success",children:[e.jsx("div",{className:"flex justify-end pb-6",children:e.jsx(Ne,{onClick:()=>n(!1)})}),e.jsxs("div",{className:"flex flex-col px-8",children:[e.jsx("div",{className:"text-center text-2xl font-semibold",children:e.jsx(y,{id:"uXSq7y",defaultMessage:"Enable internal knowledge"})}),e.jsx("div",{className:"text-token-text-secondary mt-2 text-center",children:e.jsx(y,{id:"KyWNjA",defaultMessage:"Connect these apps for the best experience"})}),e.jsx("div",{className:"grid grid-cols-3 gap-2 py-10",children:j.map(o=>e.jsxs("div",{className:Z("border-token-border-secondary flex grow flex-col gap-2 rounded-xl border p-3",o.onClick?"hover:bg-token-bg-tertiary cursor-pointer":""),onClick:o.onClick,children:[e.jsxs("div",{className:"flex w-full items-center justify-between gap-2",children:[e.jsx("div",{className:"h-6 w-6",children:o.icon}),typeof o.connected=="boolean"?e.jsx("div",{className:"bg-token-bg-tertiary h-5 w-5 rounded-full",children:e.jsx("div",{className:Z("flex h-full w-full items-center justify-center rounded-full",o.connected?"bg-blue-400":"bg-token-bg-tertiary"),children:o.loading?e.jsx(H,{}):o.connected?e.jsx(we,{className:"icon-xs fill-white"}):e.jsx(Oe,{className:"icon-xs"})})}):null]}),e.jsx("div",{className:"text-token-text-secondary mt-3 line-clamp-1 text-sm",children:o.label})]},o.key))}),e.jsx("div",{className:"flex flex-col gap-3",children:O.length<5&&O.length>0?e.jsx(ee,{onClick:W,size:"large",children:e.jsx(y,{id:"vec4yt",defaultMessage:"Continue with limited apps"})}):e.jsx(ee,{disabled:O.length<5,onClick:W,size:"large",children:e.jsx(y,{id:"MCrtpI",defaultMessage:"Continue"})})})]})]})}export{Ee as GlauxNuxModal};
//# sourceMappingURL=gdbkrtxajxy6ul7n.js.map
