const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jyroje0qaxw6h3z1.js","assets/i8clt0mfz495j7ii.js","assets/frf0wu8ouyfyu06j.js"])))=>i.map(i=>d[i]);
var Lt=Object.defineProperty,Jt=Object.defineProperties;var Qt=Object.getOwnPropertyDescriptors;var Ot=Object.getOwnPropertySymbols;var Xt=Object.prototype.hasOwnProperty,Yt=Object.prototype.propertyIsEnumerable;var St=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e);var Tt=(e,t,n)=>t in e?Lt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_=(e,t)=>{for(var n in t||(t={}))Xt.call(t,n)&&Tt(e,n,t[n]);if(Ot)for(var n of Ot(t))Yt.call(t,n)&&Tt(e,n,t[n]);return e},M=(e,t)=>Jt(e,Qt(t));var Y=function(e,t){this[0]=e,this[1]=t},xt=(e,t,n)=>{var d=(i,r,c,u)=>{try{var m=n[i](r),o=(r=m.value)instanceof Y,z=m.done;Promise.resolve(o?r[0]:r).then(y=>o?d(i==="return"?i:"next",r[1]?{done:y.done,value:y.value}:y,c,u):c({value:y,done:z})).catch(y=>d("throw",y,c,u))}catch(y){u(y)}},s=i=>a[i]=r=>new Promise((c,u)=>d(i,r,c,u)),a={};return n=n.apply(e,t),a[St("asyncIterator")]=()=>a,s("next"),s("throw"),s("return"),a};var ot=(e,t,n)=>(t=e[St("asyncIterator")])?t.call(e):(e=e[St("iterator")](),t={},n=(d,s)=>(s=e[d])&&(t[d]=a=>new Promise((i,r,c)=>(a=s.call(e,a),c=a.done,Promise.resolve(a.value).then(u=>i({value:u,done:c}),r)))),n("next"),n("return"),t);import{c as qt,r as f,e as Zt,j as h,_ as Mt}from"./i8clt0mfz495j7ii.js";import{o as Vt,d as $t,L as zt,bR as Ft,hy as Gt,cF as mt,cG as vt,u as Ht,h as ht,i as Kt,oG as Rt,pF as te}from"./ghewn7l2ynbm32fm.js";import{kC as Wt,kD as Ut,dV as bt,kE as Ct,dW as jt,kF as ee,kG as ne,kH as oe,ci as ie,kI as se,kJ as It}from"./j0yo6uv6652vva62.js";import{I as ae,P as re,a as ce,b as le,c as de,d as ue}from"./eb6zep29zccfypdc.js";const fe=Vt(()=>Mt(()=>import("./jyroje0qaxw6h3z1.js").then(e=>e._),__vite__mapDeps([0,1])),{loading:e=>zt(e)}),_e=Vt(()=>Mt(()=>import("./frf0wu8ouyfyu06j.js").then(e=>e._),__vite__mapDeps([2,1])),{loading:e=>zt(e)});function pe(e){"use forget";const t=qt.c(58),{images:n,initialIndex:d,className:s,aspect:a,objectPosition:i,showDots:r,showArrows:c,imageClassName:u,allowLoop:m,onClick:o}=e,z=d===void 0?0:d,y=s===void 0?"":s,C=a===void 0?"aspect-[16/9]":a,F=i===void 0?"object-cover":i,W=r===void 0?!0:r,j=c===void 0?!0:c,V=u===void 0?"":u,R=m===void 0?!0:m,[l,U]=f.useState(z),[Z,D]=f.useState(!1),[A,G]=f.useState(!1),E=f.useRef(null),S=Zt();let N;t[0]===Symbol.for("react.memo_cache_sentinel")?(N={active:!1,startX:0,lastX:0,dx:0,width:1,lastTime:0,velocity:0,captured:!1,programmaticTargetIndex:null},t[0]=N):N=t[0];const w=f.useRef(N),p=n.length;let v;t[1]!==R||t[2]!==p?(v=(b,P)=>{const X=P===void 0?"smooth":P,et=E.current;if(!et)return;const gt=R?ge(b,0,p-1):Et(b,0,p-1),yt=w.current.width||et.clientWidth||1;w.current.programmaticTargetIndex=gt,et.scrollTo({left:gt*yt,behavior:X}),U(gt)},t[1]=R,t[2]=p,t[3]=v):v=t[3];const T=v;let I,Q;t[4]!==j?(I=()=>{if(!j)return;G(!0);const b=window.setTimeout(()=>G(!1),2e3);return()=>window.clearTimeout(b)},Q=[j],t[4]=j,t[5]=I,t[6]=Q):(I=t[5],Q=t[6]),f.useEffect(I,Q);const B=Z,O=Z||A;let $;t[7]!==T?($=b=>{T(b,"smooth")},t[7]=T,t[8]=$):$=t[8];const x=$;let q;t[9]!==x||t[10]!==l?(q=()=>x(l+1),t[9]=x,t[10]=l,t[11]=q):q=t[11];const K=q;let tt;t[12]!==x||t[13]!==l?(tt=()=>x(l-1),t[12]=x,t[13]=l,t[14]=tt):tt=t[14];const _t=tt;let ct,nt;t[15]===Symbol.for("react.memo_cache_sentinel")?(ct=()=>{const b=E.current;if(!b)return;const P=new ResizeObserver(X=>{for(const et of X)w.current.width=et.contentRect.width||b.clientWidth||1});return P.observe(b),w.current.width=b.clientWidth||1,()=>P.disconnect()},nt=[],t[15]=ct,t[16]=nt):(ct=t[15],nt=t[16]),f.useEffect(ct,nt);let L,k;t[17]!==l||t[18]!==p?(L=()=>{const b=E.current;if(!b)return;const P=()=>{const X=w.current.width||b.clientWidth||1,et=b.scrollLeft||0,gt=et/X,yt=w.current.programmaticTargetIndex;if(yt!=null){const Bt=yt*X;Math.abs(et-Bt)<=2&&(w.current.programmaticTargetIndex=null);return}let wt=l;gt>l+.5?wt=Et(l+1,0,p-1):gt<l-.5&&(wt=Et(l-1,0,p-1)),wt!==l&&U(wt)};return b.addEventListener("scroll",P,{passive:!0}),()=>b.removeEventListener("scroll",P)},k=[p,l],t[17]=l,t[18]=p,t[19]=L,t[20]=k):(L=t[19],k=t[20]),f.useEffect(L,k);const J="select-none ".concat(y," relative");let lt,dt;t[21]===Symbol.for("react.memo_cache_sentinel")?(lt=()=>D(!0),dt=()=>D(!1),t[21]=lt,t[22]=dt):(lt=t[21],dt=t[22]);const pt="relative w-full ".concat(C," overflow-clip");let it;if(t[23]!==V||t[24]!==n||t[25]!==S||t[26]!==F||t[27]!==o){let b;t[29]!==V||t[30]!==S||t[31]!==F||t[32]!==o?(b=(P,X)=>{var et;return h.jsx("div",{onClick:()=>o==null?void 0:o(P,X),className:"relative h-full w-full shrink-0 grow-0 basis-full snap-center",children:P.content?P.content:h.jsx("img",{src:P.src,alt:(et=P.alt)!=null?et:S.formatMessage({id:"wHCsqa",defaultMessage:"Slide {index}"},{index:X+1}),className:"h-full w-full ".concat(F," ").concat(V)})},X)},t[29]=V,t[30]=S,t[31]=F,t[32]=o,t[33]=b):b=t[33],it=n.map(b),t[23]=V,t[24]=n,t[25]=S,t[26]=F,t[27]=o,t[28]=it}else it=t[28];let st;t[34]!==it?(st=h.jsx("div",{ref:E,className:"no-scrollbar flex h-full w-full touch-pan-x snap-x snap-mandatory overflow-x-scroll scroll-smooth",children:it}),t[34]=it,t[35]=st):st=t[35];let at;t[36]!==n.length||t[37]!==S||t[38]!==B||t[39]!==K||t[40]!==_t||t[41]!==O||t[42]!==j?(at=j&&n.length>1&&h.jsxs(h.Fragment,{children:[h.jsx(Dt,{ariaLabel:S.formatMessage({id:"l9pylv",defaultMessage:"Previous slide"}),onClick:_t,side:"start",visible:B,children:h.jsx(_e,{className:"icon-md"})}),h.jsx(Dt,{ariaLabel:S.formatMessage({id:"L0pbQh",defaultMessage:"Next slide"}),onClick:K,side:"end",visible:O,children:h.jsx(fe,{className:"icon-md"})})]}),t[36]=n.length,t[37]=S,t[38]=B,t[39]=K,t[40]=_t,t[41]=O,t[42]=j,t[43]=at):at=t[43];let rt;t[44]!==pt||t[45]!==st||t[46]!==at?(rt=h.jsxs("div",{className:pt,children:[st,at]}),t[44]=pt,t[45]=st,t[46]=at,t[47]=rt):rt=t[47];let g;t[48]!==x||t[49]!==n||t[50]!==l||t[51]!==S||t[52]!==W?(g=W&&n.length>1&&n.length<=20&&h.jsx("div",{className:"absolute start-0 end-0 bottom-3 flex items-center justify-center gap-2",children:n.map((b,P)=>h.jsx("button",{onClick:()=>x(P),"aria-label":S.formatMessage({id:"PUV+4+",defaultMessage:"Go to slide {index}"},{index:P+1}),className:"h-1.5 w-1.5 rounded-full transition-opacity ".concat(P===l?"bg-black":"bg-gray-400 opacity-60 dark:bg-gray-600")},P))}),t[48]=x,t[49]=n,t[50]=l,t[51]=S,t[52]=W,t[53]=g):g=t[53];let H;return t[54]!==J||t[55]!==rt||t[56]!==g?(H=h.jsxs("div",{className:J,"aria-roledescription":"carousel",onMouseEnter:lt,onMouseLeave:dt,children:[rt,g]}),t[54]=J,t[55]=rt,t[56]=g,t[57]=H):H=t[57],H}const Et=(e,t,n)=>Math.min(Math.max(e,t),n),ge=(e,t,n)=>e>n?t:e<t?n:e;function Dt(e){"use forget";const t=qt.c(8),{ariaLabel:n,onClick:d,side:s,visible:a,children:i}=e,r=s==="start"?"start-3":"end-3",c=a?"opacity-90 pointer-events-auto":"opacity-0 pointer-events-none";let u;t[0]!==r||t[1]!==c?(u=$t("btn-secondary border-token-border-default active:bg-token-bg-tertiary hover:bg-token-bg-primary absolute top-1/2 flex h-8 w-8 -translate-y-1/2 items-center justify-center rounded-full bg-clip-padding backdrop-blur transition-opacity duration-300 hover:shadow-[0px_4px_16px_0px_rgba(0,0,0,0.05)] active:opacity-100!",c,r),t[0]=r,t[1]=c,t[2]=u):u=t[2];let m;return t[3]!==n||t[4]!==i||t[5]!==d||t[6]!==u?(m=h.jsx("button",{"aria-label":n,onClick:d,className:u,children:i}),t[3]=n,t[4]=i,t[5]=d,t[6]=u,t[7]=m):m=t[7],m}const ut=new Map;async function he({productLookupKey:e}){const t=bt("".concat(vt,"/search/product_info_variants"),{method:"POST",headers:_({},mt({isAuthOptional:!0})),body:{product_lookup_key:e}});let n;try{for(var d=ot(t),s,a,i;s=!(a=await d.next()).done;s=!1){const r=a.value;"data"in r&&(n=r.data)}}catch(a){i=[a]}finally{try{s&&(a=d.return)&&await a.call(d)}finally{if(i)throw i[0]}}return n}const Pt=new Map;function me({clientThreadId:e,messageId:t,product:n,isInitialLoad:d}){var U,Z,D,A;const s=(U=Ft(e))!=null?U:e,a=Gt(),i=At({conversationId:s,messageId:t,productQuery:n.title}),r=[s,t,n.title].join(":"),[c,u]=f.useState((Z=ut.get(r))==null?void 0:Z.productReviews),[m,o]=f.useState((D=ut.get(r))==null?void 0:D.productRationale),[z,y]=f.useState((A=ut.get(r))==null?void 0:A.__debug),[C,F]=f.useState(Pt.get(i)),[W,j]=f.useState(!1),[V,R]=f.useState(!0),l=f.useRef(null);return f.useEffect(()=>{async function G({profiler:N,conversationId:w,messageId:p,productQuery:v,productLookupKey:T,updatePartial:I}){try{for(var Q=ot(ve({conversationId:w,messageId:p,productQuery:v,productLookupKey:T,persistConversationToUser:a.showDebugConversationTurns})),B,O,$;B=!(O=await Q.next()).done;B=!1){const x=O.value;switch(x.type){case"product_reviews":{u(x),I({productReviews:x}),N.logTimingOnce("time_to_first_review"),j(!1);break}case"product_rationale":{o(x),I({productRationale:x}),N.logTimingOnce("time_to_rationale"),j(!1);break}case"__debug":{I({__debug:x}),y(x);break}}}}catch(O){$=[O]}finally{try{B&&(O=Q.return)&&await O.call(Q)}finally{if($)throw $[0]}}j(!1)}async function E({profiler:N,productQuery:w,productLookupKey:p,updatePartial:v}){try{for(var T=ot(be({productQuery:w,productLookupKey:p})),I,Q,B;I=!(Q=await T.next()).done;I=!1){const O=Q.value;switch(O.type){case"product_entity":{if(i===l.current){const $=M(_({},O),{product:M(_({},O.product),{product_lookup_key:M(_({},O.product.product_lookup_key),{variant_options_query:p==null?void 0:p.variant_options_query})})});v({productEntity:$}),F($),R(!1),N.logTimingOnce("time_to_product_entity")}break}case"__debug":{v({__debug:O}),y(O);break}}}}catch(Q){B=[Q]}finally{try{I&&(Q=T.return)&&await Q.call(T)}finally{if(B)throw B[0]}}}async function S({conversationId:N,messageId:w,productQuery:p,productLookupKey:v}){var B;const T=new Wt(Ut.ProductSidebar,{context:{version:"v2"}});let I={};function Q(O){I=_(_({},I),O)}try{d&&j(!0),await Promise.allSettled([G({profiler:T,conversationId:N,messageId:w,productQuery:p,productLookupKey:v,updatePartial:Q}),E({profiler:T,productQuery:p,productLookupKey:v,updatePartial:Q})])}finally{d&&T.logTimingOnce("sidebar_loaded"),i===l.current&&(l.current=null,R(!1));const{productReviews:O,productRationale:$,__debug:x}=I;(O||$||x)&&ut.set(r,_(_(_(_({},(B=ut.get(r))!=null?B:{}),O&&{productReviews:O}),$&&{productRationale:$}),x&&{__debug:x})),I.productEntity!==void 0&&Pt.set(At({conversationId:N,messageId:w,productQuery:p}),I.productEntity)}}(async function(){const w=ut.get(r);w&&(w.productReviews&&u(w.productReviews),w.productRationale&&o(w.productRationale),w.__debug&&y(w.__debug));const p=Pt.get(i);if(p){F(p),R(!1);return}s&&t&&l.current!==i&&(l.current=i,await S({conversationId:s,messageId:t,productQuery:n.title,productLookupKey:n.product_lookup_key}))})()},[t,n.title,i,s,d]),{productInfo:{productReviews:c,productRationale:m,productEntity:C,__debug:z},isLoadingReviewsOrRationale:W,isLoadingProductEntity:V,isCached:ut.has(r)}}function ve(a){return xt(this,arguments,function*({conversationId:e,messageId:t,productQuery:n,productLookupKey:d,persistConversationToUser:s}){var c;const i=bt("".concat(vt,"/sidebar/conversation"),{method:"POST",headers:M(_({},mt({isAuthOptional:!0})),{"Content-Type":"application/json"}),body:_({conversation_id:e,message_id:t,supported_encodings:[Ct.V1],category:"product",product_params:_({product_query:n},d?{product_lookup_key:d}:{})},s?{debug_params:{persist_conversation_to_user:s}}:{})});let r=!1;try{for(var u=ot(jt(i)),m,o,z;m=!(o=yield new Y(u.next())).done;m=!1){const y=o.value;if(!("data"in y))continue;const{type:C,data:F}=y.data;if(!r&&C==="__debug")r=!0,yield{type:"__debug",data:{conversation_link:"/c/".concat(F.conversation_id)}};else if(C==="message"){const j=(c=F.metadata)==null?void 0:c.content_references;if(!j)continue;for(const V of j){const R=V;if(!(d!=null&&d.variant_options_query&&R.type==="product_entity"&&!R.product.variants))switch(R.type){case"product_reviews":case"product_rationale":yield R;break;default:continue}}}}}catch(o){z=[o]}finally{try{m&&(o=u.return)&&(yield new Y(o.call(u)))}finally{if(z)throw z[0]}}})}function be(n){return xt(this,arguments,function*({productQuery:e,productLookupKey:t}){const d=bt("".concat(vt,"/search/product_update"),{method:"POST",headers:M(_({},mt({isAuthOptional:!0})),{"Content-Type":"application/json"}),body:_({product_query:e},t?{product_lookup_key:t}:{})});try{for(var s=ot(d),a,i,r;a=!(i=yield new Y(s.next())).done;a=!1){const c=i.value;"data"in c&&(yield c.data)}}catch(i){r=[i]}finally{try{a&&(i=s.return)&&(yield new Y(i.call(s)))}finally{if(r)throw r[0]}}})}function At({conversationId:e,messageId:t,productQuery:n}){return[e,t,n].join(":")}const ft=new Map,kt=new Map;function ye({clientThreadId:e,messageId:t,product:n,isInitialLoad:d}){var A,G,E,S;const s=(A=Ft(e))!=null?A:e,a=Ht(),i=ht(a,"966859370"),r=ht(a,"1146160621"),c=s==e,u=Nt({conversationId:s,messageId:t,productQuery:n.title,product:n}),m=[s,t,n.title].join(":"),[o,z]=f.useState((G=ft.get(m))==null?void 0:G.productReviews),[y,C]=f.useState((E=ft.get(m))==null?void 0:E.productRationale),[F,W]=f.useState((S=ft.get(m))==null?void 0:S.__debug),[j,V]=f.useState(kt.get(u)),[R,l]=f.useState(!1),[U,Z]=f.useState(!0),D=f.useRef(null);return f.useEffect(()=>{async function N(){const{chatReq:p,turnstileToken:v,proofToken:T}=await ee(a,void 0);return ne(p,v,T,null)}async function w({conversationId:p,isClientThread:v,messageId:T,isGenericEndpoint:I,productQuery:Q,productLookupKey:B,sentinelHeaders:O,isProductInfoVariantsEndpointEnabled:$}){var nt;const x=new Wt(Ut.ProductSidebar,{context:{version:"v1"}}),q={};try{d&&l(!0);const L=we({conversationId:p,isClientThread:v,messageId:T,isGenericEndpoint:I,productQuery:Q,productLookupKey:B,sentinelHeaders:O,isProductInfoVariantsEndpointEnabled:$});try{for(var K=ot(L),tt,_t,ct;tt=!(_t=await K.next()).done;tt=!1){const k=_t.value;switch(k.type){case"product_reviews":{z(k),q.productReviews=k,x.logTimingOnce("time_to_first_review");break}case"product_rationale":{C(k),q.productRationale=k,x.logTimingOnce("time_to_rationale");break}case"product_entity":{if(u===D.current){const J=M(_({},k),{product:M(_({},k.product),{product_lookup_key:M(_({},k.product.product_lookup_key),{variant_options_query:B==null?void 0:B.variant_options_query})})});q.productEntity=J,V(J),x.logTimingOnce("time_to_product_entity"),Z(!1)}break}case"__debug":{q.__debug=k,W(k);break}}(k.type==="product_reviews"||k.type==="product_rationale")&&l(!1)}}catch(_t){ct=[_t]}finally{try{tt&&(_t=K.return)&&await _t.call(K)}finally{if(ct)throw ct[0]}}}finally{d&&x.logTimingOnce("sidebar_loaded"),u===D.current&&(D.current=null,Z(!1),l(!1));const{productReviews:L,productRationale:k,__debug:J}=q;(L||k||J)&&ft.set(m,_(_(_(_({},(nt=ft.get(m))!=null?nt:{}),L&&{productReviews:L}),k&&{productRationale:k}),J&&{__debug:J})),q.productEntity!==void 0&&kt.set(Nt({conversationId:p,messageId:T,productQuery:Q,product:q.productEntity.product}),q.productEntity)}}(async function(){const v=ft.get(m);v&&(v.productReviews&&z(v.productReviews),v.productRationale&&C(v.productRationale),v.__debug&&W(v.__debug));const T=kt.get(u);if(T){V(T),Z(!1);return}s&&t&&D.current!==u&&(D.current=u,await w({conversationId:s,isClientThread:c,messageId:t,isGenericEndpoint:i,productQuery:n.title,productLookupKey:n.product_lookup_key,sentinelHeaders:i?await N():null,isProductInfoVariantsEndpointEnabled:r}))})()},[t,n.title,u,s,d]),{productInfo:{productReviews:o,productRationale:y,productEntity:j,__debug:F},isLoadingReviewsOrRationale:R,isLoadingProductEntity:U,isCached:ft.has(m)}}function we(c){return xt(this,arguments,function*({conversationId:e,isClientThread:t,messageId:n,isGenericEndpoint:d,productQuery:s,productLookupKey:a,sentinelHeaders:i,isProductInfoVariantsEndpointEnabled:r}){var C;const u=!!(a!=null&&a.variant_options_query);if(r&&u){const D=bt("".concat(vt,"/search/product_info_variants"),{method:"POST",headers:_({},mt({isAuthOptional:!0})),body:{product_lookup_key:a}});try{for(var m=ot(D),o,z,y;o=!(z=yield new Y(m.next())).done;o=!1){const A=z.value;"data"in A&&(yield A.data)}}catch(z){y=[z]}finally{try{o&&(z=m.return)&&(yield new Y(z.call(m)))}finally{if(y)throw y[0]}}}else if(d){const D=bt("".concat(vt,"/sidebar/conversation"),{method:"POST",headers:M(_(_({},mt({isAuthOptional:!0})),i!=null?i:{}),{"Content-Type":"application/json"}),body:{conversation_id:e,message_id:n,supported_encodings:[Ct.V1],is_client_thread:t,category:"product",product_params:_({product_query:s},a?{product_lookup_key:a}:{})}});let A=!1;try{for(var F=ot(jt(D)),W,j,V;W=!(j=yield new Y(F.next())).done;W=!1){const G=j.value;if(!("data"in G))continue;const{type:E,data:S}=G.data;if(!A&&E==="__debug")A=!0,yield{type:"__debug",data:{conversation_link:"/c/".concat(S.conversation_id)}};else if(E==="message"){const w=(C=S.metadata)==null?void 0:C.content_references;if(!w)continue;for(const p of w){const v=p;if(!(a!=null&&a.variant_options_query&&v.type=="product_entity"&&!v.product.variants))switch(v.type){case"product_reviews":case"product_rationale":case"product_entity":yield v;break;default:continue}}}}}catch(j){V=[j]}finally{try{W&&(j=F.return)&&(yield new Y(j.call(F)))}finally{if(V)throw V[0]}}}else{const D=bt("".concat(vt,"/search/product_info"),{method:"POST",headers:M(_({},mt({isAuthOptional:!0})),{"Content-Type":"application/json"}),body:_({conversation_id:e,is_client_thread:t,message_id:n,product_query:s,supported_encodings:[Ct.V1]},a?{product_lookup_key:a}:{})}),A=jt(D);try{for(var R=ot(A),l,U,Z;l=!(U=yield new Y(R.next())).done;l=!1){const G=U.value;"data"in G&&(yield G.data)}}catch(U){Z=[U]}finally{try{l&&(U=R.return)&&(yield new Y(U.call(R)))}finally{if(Z)throw Z[0]}}}})}function Nt({conversationId:e,messageId:t,productQuery:n,product:d}){var s;return[e,t,n,JSON.stringify((s=d.product_lookup_key)==null?void 0:s.variant_options_query)].join(":")}function je({product:e,setUpdatedProduct:t,clientThreadId:n,messageId:d,contentReferenceStartIndex:s,productIndex:a,analyticsMetadata:i,offsetTopMargin:r=!1}){var _t,ct,nt,L,k,J,lt,dt,pt,it,st,at,rt;const c=Ht(),u=Kt(c),m=oe(i),[o,z]=f.useState(e),y=((_t=o.product_lookup_key)==null?void 0:_t.variant_options_query)==null,[C,F]=f.useState(null),[W,j]=f.useState(!1),{showDebugConversationTurns:V}=Gt(),R=ie.useStore(),l=f.useRef(!1),U=ht(c,"3375735072"),Z=ht(c,"232003972"),D=ht(c,"4170238021"),A=ht(c,"966859370"),G=A?me:ye,E=se({namespace:"shopping_checkout"});f.useEffect(()=>{E==null||E.reset()},[e.id,E]);const{productInfo:S,isLoadingReviewsOrRationale:N,isLoadingProductEntity:w,isCached:p}=G({clientThreadId:n,messageId:d,product:o,isInitialLoad:y}),v=f.useRef(!1);f.useEffect(()=>{var H,b;const g=(H=S.productEntity)==null?void 0:H.product;g&&(!A&&((b=o.product_lookup_key)!=null&&b.variant_options_query)&&g.variants,l.current||z(P=>M(_({},g),{title:P.title}))),S.productEntity&&!v.current&&(v.current=!0,m("Product Sidebar Entity Loaded","product_sidebar_entity_loaded","product_entity"))},[S.productEntity,m]),f.useEffect(()=>{m("Product Detail Shown","product_detail_shown","product_entity",{product_id:e.id,product_url:e.url})},[]),f.useEffect(()=>{o&&t(o)},[o,t]),f.useEffect(()=>{var H;if(!A)return;async function g(){E==null||E.startBlock("offer_variant_reload");const b=await he({productLookupKey:o.product_lookup_key}),P=b==null?void 0:b.product;P&&P.variants&&(z(X=>M(_({},P),{title:X.title})),l.current=!0),E==null||E.endBlock("offer_variant_reload")}(H=o.product_lookup_key)!=null&&H.variant_options_query&&g()},[(ct=o.product_lookup_key)==null?void 0:ct.variant_options_query]);const T=f.useRef([]),I=f.useRef([]),Q=(L=(nt=o==null?void 0:o.offers)!=null?nt:e.offers)!=null?L:[];for(const g of Q)T.current.some(H=>H.merchant_name===g.merchant_name)||T.current.push(g);const B=(J=(k=o==null?void 0:o.image_urls)!=null?k:e.image_urls)!=null?J:[];for(const g of B)I.current.includes(g)||I.current.push(g);const O=o.num_reviews,$=o.rating,x=o.rating_grouped_citation,q=(lt=o==null?void 0:o.variants)!=null?lt:[],K=U?o.image_urls:(dt=I.current)!=null?dt:[],tt=K==null?void 0:K.map(g=>({url:g,content_url:g,thumbnail_url:g,title:e.title,content_size:{width:0,height:0},thumbnail_size:{width:0,height:0}}));return h.jsxs("div",{className:$t("bg-token-bg-primary flex w-full flex-col",r?u?"mt-[calc(var(--threadFlyOut-leading-height,var(--header-height))*-1)] min-h-screen":"mt-[calc(var(--threadFlyOut-leading-height,53px)*-1)] min-h-screen":"mt-0"),children:[D?h.jsx(pe,{images:(pt=K==null?void 0:K.map(g=>({src:g})))!=null?pt:[],aspect:"aspect-square",objectPosition:"object-contain",imageClassName:"mix-blend-darken dark:mix-blend-lighten cursor-zoom-in",onClick:g=>{R.setCurrentImage({image:{url:g.src,content_url:g.src,thumbnail_url:g.src,title:e.title,content_size:{width:0,height:0},thumbnail_size:{width:0,height:0}},source:It.ImageGroup,analyticsMetadata:i,contentReferenceStartIndex:s,productIndex:a,imageResults:tt!=null?tt:[]})}}):h.jsx(ae,{imageUrls:K,title:e.title,onImageClick:g=>{R.setCurrentImage({image:{url:g,content_url:g,thumbnail_url:g,title:e.title,content_size:{width:0,height:0},thumbnail_size:{width:0,height:0}},source:It.ImageGroup,analyticsMetadata:i,contentReferenceStartIndex:s,productIndex:a,imageResults:tt!=null?tt:[]})}}),h.jsxs("div",{className:"border-token-border-light flex flex-col border-t px-6 pt-4",children:[h.jsx("h2",{className:"text-xl",children:e.title}),O!=null&&O>0&&$!=null&&Z&&h.jsx(re,{rating:$,numReviews:O,ratingGroupedCitation:x,trackContentReferenceEvent:m,analyticsMetadata:i})]}),U&&!w&&(q==null?void 0:q.length)>0&&h.jsx("div",{className:"px-6 pt-4",children:h.jsx(ce,{options:q,showErrors:W,updateOption:(g,H,b)=>xe({optionGroupId:g,selectedId:H,variant_index:b,statefulProduct:o,setStatefulProduct:z,trackContentReferenceEvent:m,productIndex:a,productId:e.id})})}),C&&h.jsx("div",{className:"text-token-interactive-label-danger-secondary-default text-center",children:C}),h.jsx(le,{className:"border-token-border-light -mx-3 flex flex-col px-6 pt-4",offers:U?(it=o.offers)!=null?it:[]:(st=T.current)!=null?st:[],profiler:E,contentReferenceStartIndex:s,productIndex:a,product:o,trackContentReferenceEvent:m,analyticsMetadata:i,imageUrls:U?(at=o.image_urls)!=null?at:[]:(rt=I.current)!=null?rt:[],isLoading:U?w:!1,onOpenCheckout:()=>j(!0)}),N?h.jsxs("div",{className:"flex flex-col gap-4 px-6 py-6",children:[h.jsx(Rt,{index:0,width:50,heightSize:"sm"}),h.jsxs(te,{children:[h.jsx(Rt,{index:1,width:100,heightSize:"sm"}),h.jsx(Rt,{index:2,width:100,heightSize:"sm"}),h.jsx(Rt,{index:3,width:30,heightSize:"sm"})]})]}):h.jsxs("div",{className:"bg-token-bg-primary flex flex-col pt-4",children:[h.jsx(de,{contentReference:S.productRationale,trackContentReferenceEvent:m,disableAnimation:p}),h.jsx(ue,{contentReference:S.productReviews,trackContentReferenceEvent:m,disableAnimation:p})]}),!1]})}function xe({optionGroupId:e,selectedId:t,variant_index:n,statefulProduct:d,setStatefulProduct:s,trackContentReferenceEvent:a,productIndex:i,productId:r}){var u,m,o,z;const c=(u=d.variants)==null?void 0:u.find(y=>y.id===e);a("product_detail","product_detail","product_entity",{product_index:i,product_id:r,action:"variant_selected",section:"product_detail",section_location:"sidebar",variant_name:(m=c==null?void 0:c.label)!=null?m:"",variant_value:(z=(o=c==null?void 0:c.options.find(y=>y.id===t))==null?void 0:o.label)!=null?z:"",variant_index:n}),s(y=>{var j,V;const C=(V=(j=y.variants)==null?void 0:j.map(R=>R.id===e?M(_({},R),{options:R.options.map(l=>M(_({},l),{selected:l.id===t})),selected_option_id:t}):R))!=null?V:y.variants,W=(C==null?void 0:C.every(R=>R.selected_option_id))?C==null?void 0:C.reduce((R,l)=>(l.selected_option_id&&(R[l.id]=l.selected_option_id),R),{}):null;return M(_({},y),{variants:C,product_lookup_key:M(_({},y.product_lookup_key),{variant_options_query:W,last_variant_selection_group_id:e})})})}export{je as P};
//# sourceMappingURL=odg6tnre74z3nvyt.js.map
