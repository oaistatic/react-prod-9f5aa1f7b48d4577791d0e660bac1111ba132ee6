var M=Object.defineProperty,T=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var S=(e,t,n)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,b=(e,t)=>{for(var n in t||(t={}))A.call(t,n)&&S(e,n,t[n]);if(m)for(var n of m(t))k.call(t,n)&&S(e,n,t[n]);return e},h=(e,t)=>T(e,_(t));import{e as w,f as B,j as x}from"./i8clt0mfz495j7ii.js";import{nK as o}from"./ghewn7l2ynbm32fm.js";import{bP as D,bO as g,bR as C}from"./j0yo6uv6652vva62.js";const P=.75;function F({messages:e}){const t=w(),[n,s]=e,a=I(n,s);let l=g.Running,i=d.creatingPlan,r;switch(a.status){case"running":a.numTotalSubAgents>0&&a.numCompletedSubAgents/a.numTotalSubAgents>=P?i=d.almostDone:(i=d.running,r={numTasks:a.numTotalSubAgents});break;case"done":l=g.Finished,i=void 0;break;case"stopped":l=g.Stopped,i=d.cancelled;break}const u=i?t.formatMessage(i,r):null;return x.jsx(D,{highlightedCommand:u,status:l,showWorkUserSetting:!1})}function I(e,t){var r,u,p,c,f;const n=(f=(u=(r=t==null?void 0:t.metadata)==null?void 0:r.parallel_browse)==null?void 0:u.frontend_info.sub_agent_infos)!=null?f:(c=(p=e.metadata)==null?void 0:p.parallel_browse)==null?void 0:c.frontend_info.sub_agent_infos;let s,a=0,l=0;n!=null&&(s=O(n),a=s.length,l=s.filter(E).length);let i="planning";return C(e)?i="stopped":t!=null&&(i=l===a?"done":"running"),{status:i,subAgentInfos:s,numTotalSubAgents:a,numCompletedSubAgents:l}}function O(e){const t=Object.values(e).reduce((s,a)=>{const l=a.task_index;return s[l]==null&&(s[l]=[]),s[l].push(a),s},{});return Object.values(t).map(s=>h(b({},s[0]),{status:j(s)})).sort((s,a)=>s.task_index-a.task_index)}function j(e){const t=e.map(s=>s.status),n=[o.Starting,o.Running,o.Done,o.Error,o.Timeout,o.Cancelled];for(const s of n)if(t.some(a=>a===s))return s;return o.Starting}function E(e){return e.status===o.Done||e.status===o.Timeout||e.status===o.Error||e.status===o.Cancelled}const d=B({creatingPlan:{id:"parallelBrowsingMessage.creatingPlanV2",defaultMessage:"Making a research plan"},running:{id:"parallelBrowsingMessage.running_2",defaultMessage:"Visiting {numTasks, plural, one {# site} other {# sites}}"},almostDone:{id:"parallelBrowsingMessage.almostDone",defaultMessage:"Almost done"},cancelled:{id:"parallelBrowsingMessage.cancelledV2",defaultMessage:"Stopped doing research"},done:{id:"parallelBrowsingMessage.done",defaultMessage:"Finished research"}});export{F as default};
//# sourceMappingURL=nd0t140p2o58s8iq.js.map
