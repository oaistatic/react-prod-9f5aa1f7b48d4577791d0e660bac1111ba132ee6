const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/d3y46a2mpr2sbz7s.js","assets/i8clt0mfz495j7ii.js","assets/3j20em1lilnrpdcm.js","assets/gsas8pb1acnf7jnd.js","assets/mtsfsh7z74bmo6ig.js","assets/f2itj05whsmn3kgs.js","assets/j0yo6uv6652vva62.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/gr73ffwzttzymtep.js","assets/e6eptpe9toj61kmv.js","assets/j2k7r2f0maz0c5g5.js","assets/88dcy8w0nw3pooi2.js","assets/om87g1p3w7uzy3ym.js","assets/hv1mawgxcoyab644.js","assets/f510v2yorm9a64cn.js","assets/frf0wu8ouyfyu06j.js","assets/ewkru1hsxkjpuxt5.js","assets/bgxcag65uz54fc39.js","assets/op4cc948p930ctfd.js"])))=>i.map(i=>d[i]);
var Hs=Object.freeze,Ys=Object.defineProperty,Xn=Object.defineProperties;var Zn=Object.getOwnPropertyDescriptors;var Ks=Object.getOwnPropertySymbols;var eo=Object.prototype.hasOwnProperty,to=Object.prototype.propertyIsEnumerable;var Ht=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),so=t=>{throw TypeError(t)};var Js=(t,e,n)=>e in t?Ys(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Y=(t,e)=>{for(var n in e||(e={}))eo.call(e,n)&&Js(t,n,e[n]);if(Ks)for(var n of Ks(e))to.call(e,n)&&Js(t,n,e[n]);return t},fe=(t,e)=>Xn(t,Zn(e));var ht=(t,e)=>Hs(Ys(t,"raw",{value:Hs(e||t.slice())}));var ps=function(t,e){this[0]=t,this[1]=e},Ss=(t,e,n)=>{var o=(i,l,c,f)=>{try{var m=n[i](l),h=(l=m.value)instanceof ps,x=m.done;Promise.resolve(h?l[0]:l).then(u=>h?o(i==="return"?i:"next",l[1]?{done:u.done,value:u.value}:u,c,f):c({value:u,done:x})).catch(u=>o("throw",u,c,f))}catch(u){f(u)}},a=i=>r[i]=l=>new Promise((c,f)=>o(i,l,c,f)),r={};return n=n.apply(t,e),r[Ht("asyncIterator")]=()=>r,a("next"),a("throw"),a("return"),r},Ms=t=>{var e=t[Ht("asyncIterator")],n=!1,o,a={};return e==null?(e=t[Ht("iterator")](),o=r=>a[r]=i=>e[r](i)):(e=e.call(t),o=r=>a[r]=i=>{if(n){if(n=!1,r==="throw")throw i;return i}return n=!0,{done:!1,value:new ps(new Promise(l=>{var c=e[r](i);c instanceof Object||so("Object expected"),l(c)}),1)}}),a[Ht("iterator")]=()=>a,o("next"),"throw"in e?o("throw"):a.throw=r=>{throw r},"return"in e&&o("return"),a},Qs=(t,e,n)=>(e=t[Ht("asyncIterator")])?e.call(t):(t=t[Ht("iterator")](),e={},n=(o,a)=>(a=t[o])&&(e[o]=r=>new Promise((i,l,c)=>(r=a.call(t,r),c=r.done,Promise.resolve(r.value).then(f=>i({value:f,done:c}),l)))),n("next"),n("return"),e);import{e as Qt,j as s,f as bs,r as W,_ as V,c as de,M as Q,v as no,d as Kt,m as oo}from"./i8clt0mfz495j7ii.js";import{o as X,$ as Qe,F as Xt,L as ee,eu as kn,eK as wn,eI as $s,T as Xs,M as He,aR as jn,h as vs,bN as as,bO as Ls,bQ as Zs,bP as io,J as ao,jT as ro,rD as lo,cn as co,co as uo,d6 as mo,P as Se,bb as ve,bc as ke,u as Zt,a4 as fo,iJ as Os,mh as go,d as _t,bs as Bs,tF as po,tG as ho,bL as en,l3 as xo,gV as _o,gh as bt,s as yo,fa as bo,dd as xs,f5 as vo,eo as ko,e4 as Ts,kZ as wo,dj as Rs,tH as Cn,bR as Vs,el as jo,a as Ne,iN as Co,E as Eo,d1 as No,aV as tn,eh as En,d_ as So,aW as Mo,gF as To,ff as Io,fw as Ao,cH as Lo,cK as Oo,nL as sn,hr as Ro,hD as Do,hB as nn,gj as on,hC as an,R as Po,cj as Wo,aT as Fo,gZ as $o,bX as rn,bT as Bo,aM as Vo}from"./ghewn7l2ynbm32fm.js";import{ba as Ds,ad as Uo,ae as zo,wb as Go,dp as Yt,aH as qo,m5 as Ho,aF as Ko,fJ as Us,d6 as Jo,wc as ln,wd as Yo,we as Qo,nE as Xo,aP as Zo,nB as ei,nD as ns,h7 as Nn,bV as ti,l9 as si,bO as Jt,bX as hs,m as ni,bP as cn,wf as oi,lN as ii}from"./j0yo6uv6652vva62.js";import{g as ai}from"./j6x345c1lr8o2ob6.js";import{L as Ps}from"./icuos2x1zai4tnyd.js";import{p as Sn,h as yt,g as zs,a as Mn,b as Tn,J as D,c as In,i as Ge,d as ri,e as li,f as ci,j as di,k as ui,l as mi,m as dn}from"./fe8pomto0j6jsca5.js";import{c as fi,g as gi}from"./f1fdbkaiwy5lnpwz.js";import{a as un,b as pi,i as hi}from"./drmwaklva7v056il.js";import{M as Is,E as xi}from"./ns51nblw8ziscsgd.js";import{A as An,C as _i}from"./t1g128396k0dnr32.js";const yi=X(()=>V(()=>import("./d3y46a2mpr2sbz7s.js").then(t=>t._),__vite__mapDeps([0,1])),{loading:t=>ee(t)});var hn;const bi=Xt.div(hn||(hn=ht(["h-px bg-token-border-default"])));var xn;const Ye=Xt.div(xn||(xn=ht(["text-sm font-medium py-3 leading-6"])));var _n;const vi=Xt.div(_n||(_n=ht(["my-4 p-5 w-full rounded-2xl popover bg-token-main-surface-primary shadow-lg border border-token-border-default"]))),As=":",ki=({to:t,cc:e,bcc:n,subject:o,body:a,onClick:r,isDraft:i=!0,isCanceled:l=!1})=>{const c=Qt(),f=[];return t&&f.push(s.jsx("div",{children:s.jsxs("div",{className:"flex",children:[s.jsxs(Ye,{className:"text-token-text-tertiary me-1",children:[c.formatMessage(xt.draftToFieldLabel),As]}),s.jsx(Ye,{children:t})]})},"to")),e&&f.push(s.jsx("div",{children:s.jsxs("div",{className:"flex",children:[s.jsxs(Ye,{className:"text-token-text-tertiary me-1",children:[c.formatMessage(xt.draftCcFieldLabel),As]}),s.jsx(Ye,{children:e})]})},"cc")),n&&f.push(s.jsx("div",{children:s.jsxs("div",{className:"flex",children:[s.jsxs(Ye,{className:"text-token-text-tertiary me-1",children:[c.formatMessage(xt.draftBccFieldLabel),As]}),s.jsx(Ye,{children:n})]})},"bcc")),o&&f.push(s.jsx(Ye,{children:o},"subject")),a&&f.push(s.jsx(Ye,{className:"whitespace-pre-line",children:a},"body")),s.jsxs(vi,{children:[s.jsxs("div",{className:"mb-4 flex items-center",children:[s.jsx(yi,{className:"icon-sm me-4"}),s.jsx("div",{className:"font-semibold",children:i?c.formatMessage(xt.draftMessageLabel):c.formatMessage(xt.sentMessageLabel)})]}),f.map((m,h)=>s.jsxs(W.Fragment,{children:[s.jsx(bi,{}),m]},h)),i&&!l&&s.jsx("div",{className:"mt-2 flex justify-end gap-4",children:s.jsx(Qe,{color:"primary",className:"py-2",onClick:r,children:c.formatMessage(xt.sendButton)})}),l&&s.jsx("div",{className:"mt-2 flex justify-end gap-4",children:s.jsx(Qe,{color:"primary",className:"py-2",disabled:!0,children:c.formatMessage(xt.canceledButton)})})]})},xt=bs({draftMessageLabel:{id:"emailView.draftMessageLabel",defaultMessage:"Draft Message"},sentMessageLabel:{id:"emailView.sentMessageLabel",defaultMessage:"Sent Message"},sendButton:{id:"emailView.sendButton",defaultMessage:"Send"},draftToFieldLabel:{id:"emailView.draftToLabel",defaultMessage:"To"},draftCcFieldLabel:{id:"emailView.draftCcLabel",defaultMessage:"Cc"},draftBccFieldLabel:{id:"emailView.draftBccLabel",defaultMessage:"Bcc"},canceledButton:{id:"emailView.canceledButton",defaultMessage:"Canceled"}}),wi=t=>{"use forget";const e=de.c(19),{clientThreadId:n,action:o,messages:a,onRequestCompletion:r,handleUserAction:i,rememberAnswer:l,toolCallSafetySummary:c}=t;let f;e[0]!==a?(f=Sn(a),e[0]=a,e[1]=f):f=e[1];const{assistantMessage:m}=f,h=kn();let x;e[2]!==c?(x=c!=null&&c.sensitive_data?Object.keys(c.sensitive_data).some(ji):!1,e[2]=c,e[3]=x):x=e[3];const u=x,y=(c==null?void 0:c.danger_level)==="HIGH"||u;let v;return e[4]!==o.allow||e[5]!==o.always_allow||e[6]!==o.deny||e[7]!==o.name||e[8]!==o.type||e[9]!==h||e[10]!==m||e[11]!==n||e[12]!==i||e[13]!==y||e[14]!==a||e[15]!==r||e[16]!==l||e[17]!==c?(v=o.type==="deny"?s.jsx(Qe,{className:"flex-1",color:y?"primary":"secondary",size:"medium",onClick:g=>{i({clientThreadId:n,sourceEvent:g,onRequestCompletion:r,assistantMessage:m,allMessages:a,actionData:fe(Y({type:"deny"},o.deny),{remember_answer:l}),activeSystemHint:h})},children:s.jsx(Q,Y({},o.name==="decline"?os.decline:os.deny))}):o.type==="allow"?s.jsx(Qe,{className:"flex-1",color:y?"secondary":"primary",size:"medium",onClick:g=>{i({clientThreadId:n,sourceEvent:g,onRequestCompletion:r,assistantMessage:m,allMessages:a,actionData:fe(Y({type:"allow"},o.allow),{remember_answer:l}),activeSystemHint:h})},children:c!=null&&c.action_name?c.action_name:s.jsx(Q,Y({},o.name==="allow"?os.allow:os.confirm))}):o.type==="always_allow"?s.jsx(Qe,{className:"flex-1",color:"secondary",size:"medium",onClick:g=>{i({clientThreadId:n,sourceEvent:g,onRequestCompletion:r,assistantMessage:m,allMessages:a,actionData:Y({type:"always_allow"},o.always_allow),activeSystemHint:h})},children:s.jsx(Q,Y({},os.alwaysAllow))}):null,e[4]=o.allow,e[5]=o.always_allow,e[6]=o.deny,e[7]=o.name,e[8]=o.type,e[9]=h,e[10]=m,e[11]=n,e[12]=i,e[13]=y,e[14]=a,e[15]=r,e[16]=l,e[17]=c,e[18]=v):v=e[18],v},os=bs({alwaysAllow:{id:"jitPluginMessage.alwaysAllow",defaultMessage:"Always Allow"},allow:{id:"jitPluginMessage.allow",defaultMessage:"Allow"},decline:{id:"jitPluginMessage.decline",defaultMessage:"Decline"},confirm:{id:"jitPluginMessage.confirm",defaultMessage:"Confirm"},deny:{id:"jitPluginMessage.deny",defaultMessage:"Deny"}});function ji(t){return t==="Suspicious Content"}const Ci=X(()=>V(()=>import("./3j20em1lilnrpdcm.js").then(t=>t._),__vite__mapDeps([2,1])),{loading:t=>ee(t)}),Ei=X(()=>V(()=>import("./gsas8pb1acnf7jnd.js").then(t=>t._),__vite__mapDeps([3,1])),{loading:t=>ee(t)});function mn({functionName:t,params:e,toolCallSafetySummary:n,result:o,isWrite:a,messages:r,clientThreadId:i,jitPluginData:l,onRequestCompletion:c,rememberForThisConversation:f,isChatkitWidget:m}){var g,p,d,b;const h=wn(),x=$s(),{namespace:u,actionName:y}=Ni(t);if(m)return s.jsx("div",{className:"mb-4 grid max-w-xl rounded-xl",children:s.jsx("span",{style:{fontStyle:"italic"},children:s.jsx(Q,Y({},qe.widgetDisplayed))})});const v=((g=l==null?void 0:l.from_server)==null?void 0:g.type)!=="denied_by_user"?(p=l==null?void 0:l.from_server)==null?void 0:p.body.actions.map((I,C)=>s.jsx(wi,{clientThreadId:i,messages:r,onRequestCompletion:c,action:I,handleUserAction:yt,rememberAnswer:f,toolCallSafetySummary:n},C)):null;if(u==="api_tool"&&y==="call_tool"&&e&&"path"in e&&"args"in e&&typeof e.path=="string"&&(typeof e.args=="object"||typeof e.args=="string")&&e.args!=null){const[I,C,M]=e.path.split("/").filter(Boolean);if(I&&C&&M){const E=[...h.connectorLinks.values()].flat().find(N=>N.id===C),w=E&&x.platformConnectors.get(E.connector_id);return s.jsx(fn,{connector:{name:(d=w==null?void 0:w.name)!=null?d:I,logo_url:(b=w==null?void 0:w.logo_url)!=null?b:null},actionName:M,isWrite:a,params:typeof e.args=="object"?e.args:JSON.parse(e.args),toolCallSafetySummary:n,result:o,actionButtons:v})}}return s.jsx(fn,{connector:{name:u,logo_url:null},actionName:y,isWrite:a,params:e,result:o,actionButtons:v})}function Ni(t){const e=t.indexOf("."),n=e===-1?t:t.slice(0,e),o=e===-1?"":t.slice(e+1);return{namespace:n,actionName:o}}function fn({connector:t,actionName:e,params:n,result:o,isWrite:a,toolCallSafetySummary:r,actionButtons:i}){var w,N,O;const l=Qt(),[c,f]=W.useState(!1),[,m]=W.useState("request"),h=W.useId(),x=W.useId(),u=(w=r==null?void 0:r.title)!=null?w:"",y=(N=r==null?void 0:r.description)!=null?N:"",v=e,g=Object.entries((O=r==null?void 0:r.sensitive_data)!=null?O:{}).filter(([,L])=>L==null?!1:Array.isArray(L)),p=g.length>0,d=L=>L.join(", "),b=L=>{const z=d(L);return z.length<20?z:z.slice(0,20)+"..."},I=n!=null,C=o!=null,M=I||C,E=()=>{m(I?"request":"response"),f(!0)};return r?s.jsxs("div",{className:"mt-1 mb-4 w-full max-w-md",children:[s.jsxs("div",{className:"border-token-border-medium bg-token-bg-tertiary/20 flex flex-col gap-3 rounded-3xl border px-5 py-5 text-start",children:[s.jsx("div",{className:"flex items-center justify-between gap-2",children:s.jsxs("div",{className:"flex flex-1 items-center gap-2",children:[s.jsx(Ds,{connector:t,size:"xsmall"}),s.jsx("div",{className:"flex flex-1 flex-col gap-2",children:s.jsx("div",{className:"text-token-text-secondary text-sm tracking-wide",children:t.name})})]})}),s.jsxs("div",{className:"flex flex-col gap-2 px-1",children:[s.jsx("h2",{className:"text-token-text-primary text-lg font-semibold",children:u}),y&&s.jsxs("p",{className:"text-token-text-secondary text-sm",children:[y,M&&s.jsxs(s.Fragment,{children:[" ",s.jsx("button",{type:"button",onClick:E,className:"text-token-text-secondary font-regular underline",children:s.jsx(Q,Y({},qe.details))})]})]})]}),p&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col gap-2 px-1 py-2",children:[s.jsx("div",{className:"text-token-text-tertiary font-regular text-sm",children:l.formatMessage(qe.dataShared)}),s.jsx("dl",{className:"",children:g.map(([L,z])=>{const P=d(z),U=b(z),_=L==="Suspicious Content";return s.jsxs("div",{className:"flex flex-col gap-1 py-1 sm:flex-row sm:items-center sm:gap-4",children:[s.jsx("dt",{className:"font-regular text-start text-sm ".concat(_?"text-interactive-label-warning-secondary":"text-token-text-tertiary"),children:_?s.jsx(Xs,{side:"top",align:"start",label:l.formatMessage(qe.suspiciousContentTooltip),children:s.jsxs("span",{className:"inline-flex items-center gap-1",children:[s.jsx("span",{className:"text-token-text-error",children:L}),s.jsx(Ci,{"aria-hidden":"true",className:"interactive-label-warning-secondary icon-xs text-token-text-error"})]})}):L}),s.jsx("dd",{className:"text-token-text-primary text-sm font-normal sm:ms-auto sm:max-w-xs sm:truncate sm:text-end",children:s.jsx(Xs,{side:"top",align:"end",label:P?s.jsx("div",{className:"text-token-text-primary max-w-xs text-start text-sm break-words",children:P}):void 0,children:s.jsx("span",{className:"block truncate",children:U})})})]},L)})})]}),s.jsx("div",{className:"token-border-subtle mx-1 mt-1 h-0 border-t"})]}),i&&Array.isArray(i)&&i.length>0&&s.jsx("div",{className:"mt-3 mb-1 flex flex-wrap justify-end gap-3",children:i})]}),s.jsx("div",{className:"text-token-text-tertiary mt-3 text-center text-sm",children:s.jsx(Q,{id:"APIToolCallCard.toolCallSafetyWarning",defaultMessage:"Using tools comes with risks. <link>Learn more</link>",values:{link:L=>s.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:L},"link")}})}),M&&s.jsx(He.Root,{testId:"modal-api-tool-call-details",isOpen:c,onClose:f,children:s.jsx(He.Overlay,{children:s.jsx(He.Content,{size:"large",className:"max-w-2xl",ariaLabelledBy:h,ariaDescribedBy:y?x:void 0,children:s.jsxs("div",{className:"flex flex-col py-2",children:[s.jsx(He.Header,{hasSeparator:!0,title:s.jsx("span",{id:h,className:"px-2",children:s.jsx(Q,Y({},qe.details))}),closeButton:s.jsx(jn,{className:"me-2",onClick:()=>f(!1)})}),s.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[y&&s.jsx("p",{id:x,className:"text-token-text-secondary text-sm",children:y}),s.jsx("div",{className:"border-token-border-subtle bg-token-bg-secondary/40 flex flex-col overflow-hidden rounded-2xl border",children:s.jsxs("div",{className:"border-token-border-subtle flex flex-wrap items-center justify-between gap-3 py-1",children:[s.jsxs("div",{className:"border-token-border-subtle flex w-full items-center justify-between border-b px-4 py-3",children:[s.jsx("span",{className:"text-token-text-primary text-sm font-semibold",children:v}),a&&s.jsx("div",{className:"bg-token-bg-status-error/10 text-token-text-error inline-flex min-w-[60px] items-center justify-center rounded-full px-2 text-[10px] font-semibold tracking-wide uppercase",children:s.jsx(Q,{id:"APIToolCallCard.write",defaultMessage:"Write"})})]}),s.jsxs("div",{className:"mb-4 grid w-full gap-4 px-1",children:[n!=null&&s.jsx(is,{isInitialLevelExpanded:a,name:qe.request,params:n}),o!=null&&s.jsx(is,{name:qe.response,params:o})]})]})})]})]})})})})]}):s.jsxs("div",{className:"bg-token-bg-default mt-1 mb-4 grid max-w-xl gap-4 rounded-xl p-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ds,{connector:{name:t.name,logo_url:t.logo_url,logo_url_dark:void 0},size:"large"}),s.jsxs("div",{className:"flex flex-1 flex-col",children:[s.jsx("div",{className:"text-token-text-secondary text-xs",children:t.name}),s.jsx("div",{className:"text-token-text-primary text-sm",children:e})]}),a&&s.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:s.jsx(Q,{id:"APIToolCallCard.write",defaultMessage:"Write"})})]}),n!=null&&s.jsx(is,{isInitialLevelExpanded:a,name:qe.request,params:n}),o!=null&&s.jsx(is,{name:qe.response,params:o}),a&&s.jsxs("div",{className:"text-token-text-secondary text-sm",children:[s.jsx(Ei,{className:"icon-sm me-1 mb-0.5 inline-block"}),s.jsx(Q,{id:"APIToolCallCard.writeWarning",defaultMessage:"Write actions come with risks. <link>Learn more</link>",values:{link:L=>s.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:L},"link")}})]})]})}function is({name:t,afterName:e,params:n,isInitialLevelExpanded:o=!1}){const a=Qt();return s.jsxs("div",{className:"bg-token-bg-secondary/30 max-w-full min-w-0 space-y-3 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"text-token-text-secondary text-xs",children:typeof t=="string"?t:a.formatMessage(t)}),e]}),s.jsx(Uo,{buttonText:!0,className:"text-token-text-secondary text-xs",onCopy:()=>zo(typeof n=="string"?n:JSON.stringify(n))})]}),typeof n=="string"?s.jsx("div",{className:"text-token-text-primary line-clamp-3 font-mono text-sm",children:n}):s.jsx(Ps,{isInitialLevelExpanded:o,value:n})]})}const qe=bs({request:{id:"APIToolCallCard.request",defaultMessage:"Request"},response:{id:"APIToolCallCard.response",defaultMessage:"Response"},details:{id:"APIToolCallCard.details",defaultMessage:"Details"},noDetails:{id:"APIToolCallCard.noDetails",defaultMessage:"No additional details available."},dataShared:{id:"APIToolCallCard.dataShared",defaultMessage:"Sharing data includes:"},functionLabel:{id:"APIToolCallCard.function",defaultMessage:"Function"},allowForConversation:{id:"APIToolCallCard.allowForConversation",defaultMessage:"Allow for conversation"},suspiciousContentTooltip:{id:"APIToolCallCard.suspiciousContentTooltip",defaultMessage:"There is a suspicious piece of text being shared that looks like random or encrypted data. It could be risky, for example it could contain your personal information encrypted in some way. It may not be harmful though, for example if it is part of a legitimate link being shared. It is safe to deny the action."},widgetDisplayed:{id:"APIToolCallCard.widgetDisplayed",defaultMessage:"A widget was displayed"}}),Ln=async({ctx:t,chatSDK:e,clientThreadId:n,checkoutSession:o})=>{if(!vs(t,"2563418478"))return;const r=fi(o);return gi(as(t,n)).openCheckout(e,r)},Si=(t,{csp:e,domain:n,subdomain:o})=>"".concat(t.metadata.html_asset_pointer,"-").concat(JSON.stringify(e),"-").concat(n,"-").concat(o),Mi=({chatSDK:t,prompt:e,persistedSystemHintsStore:n,clientThreadId:o})=>{var i;const a=Ls.getRequestId(Zs(o));if(io(a))return null;if(!e)return ao.addError("No prompt provided to sendFollowUpMessage"),null;const r=Ls.getBranch(Zs(o)).findLast(({message:l})=>ro(l));return{completionType:mo.Next,promptMessage:{id:no(),author:{role:uo.User,name:"user"},content:{content_type:co.Text,parts:[e]},recipient:"all",metadata:{system_hints:lo(n),developer_mode_connector_ids:(i=r==null?void 0:r.message.metadata)==null?void 0:i.developer_mode_connector_ids,chatgpt_sdk_attribution:t.metadata.attribution_id,is_visually_hidden_from_conversation:!0}},eventSource:"mouse"}},On=new Set(["http:","https:"]),gn={"http:":80,"https:":443,"ws:":80,"wss:":443};function Rn(t){if(!t)return null;const e=t.trim();if(!e||e.includes("\\"))return null;try{return{url:new URL(e)}}catch(n){if(!/^[a-z][a-z0-9+.-]*:/.test(e))try{const o=e.startsWith("//")?"https:".concat(e):"https://".concat(e);return{url:new URL(o)}}catch(o){return null}return null}}function Dn(t){var x,u;const e=t.trim();if(!e)return null;const n=/^([a-z][a-z0-9+.-]*):$/i.exec(e);if(n)return{kind:"scheme",scheme:"".concat(n[1].toLowerCase(),":")};const o=/^(?:([a-z][a-z0-9+.+-]*):\/\/)?(\*|\*\.[^/:]+|[^/:]+)(?::(\*|\d+))?(\/.*)?$/i.exec(e);if(!o)return null;const a=o[1]?"".concat(o[1].toLowerCase(),":"):void 0,r=o[2],i=(x=o[3])!=null?x:null,l=(u=o[4])!=null?u:null,c=r.startsWith("*."),f=(c?r.slice(2):r).toLowerCase().replace(/\.$/,"");let m=null,h=!1;return i!==null&&(h=!0,m=i==="*"?"*":Number(i),m!=="*"&&(!Number.isFinite(m)||m<0))?null:{kind:"host",scheme:a,host:f,wildcard:c,portExplicit:h,port:m,path:l}}function _s(t){return t.toLowerCase().replace(/\.$/,"")}function Pn(t,e){const n=_s(t),o=_s(e);return n===o||n.endsWith("."+o)}function Ti(t,e,n){return n?Pn(t,e):_s(t)===_s(e)}function Ii(t,e){var o,a;if(e.port==="*")return!0;const n=t.port?Number(t.port):(o=gn[t.protocol])!=null?o:null;if(!e.portExplicit){const r=(a=gn[t.protocol])!=null?a:null;return n===r}return typeof e.port=="number"&&n===e.port}function Ai(t){var a,r;const e=(a=t.scheme)!=null?a:"https:";if(!On.has(e)||!t.host)return null;const n=typeof t.port=="number"?":".concat(t.port):"",o=(r=t.path)!=null?r:"";try{return new URL("".concat(e,"//").concat(t.host).concat(n).concat(o))}catch(i){return null}}function Li(t){var o,a;const e=Rn(t!=null?t:void 0);if(e&&On.has(e.url.protocol)&&!e.url.hostname.includes("*"))return e.url.toString();if(!t)return null;const n=Dn(t);return!n||n.kind==="scheme"?null:(a=(o=Ai(n))==null?void 0:o.toString())!=null?a:null}function Oi(t,e,n){var l;if(!t)return!1;const o=Rn(t);if(!o)return!1;const a=o.url;if(a.username||a.password)return!1;const r=[];(l=e==null?void 0:e.connectDomains)!=null&&l.length&&r.push(...e.connectDomains);const i=n==null?void 0:n.trim();return i&&r.push(i),r.length?r.some(c=>{const f=Dn(c);if(!f)return!1;if(f.kind==="scheme")return a.protocol===f.scheme;if(f.scheme)return!(a.protocol!==f.scheme||!Ti(a.hostname,f.host,f.wildcard)||!Ii(a,f));{const m=f.host;return!!Pn(a.hostname,m)}}):!1}const Oe=t=>{var e;return[{key:"attribution_id",value:t.attribution_id},{key:"name",value:(e=t.name)!=null?e:"unknown"}]},Ri={click:"app.interaction_click",scroll:"app.interaction_scroll"},Di=t=>{var e;return(e=t&&Ri[t])!=null?e:"app.interaction"},Pi=(t,e)=>{const n=Oe(e);switch(t.type){case"interaction":{if(t.label==="copy"){Bn(e);break}Se.logEventWithStatsig("Ecosystem app: Interaction","chatgpt_web_ecosystem_app_interaction",fe(Y({},e),{event_type:t.label})),ve.count(ke.ECOSYSTEM,Di(t.label),n);break}case"count":ve.count(ke.ECOSYSTEM,t.label,n,t.count);break;case"error":Se.logEventWithStatsig("Ecosystem app: Error","chatgpt_web_ecosystem_app_error",e),ve.count(ke.ECOSYSTEM,"app.error",n);break}},Wi=(t,e)=>{Se.logEventWithStatsig("Ecosystem app: Error","chatgpt_web_ecosystem_app_error",fe(Y({},t),{error:e})),ve.count(ke.ECOSYSTEM,"app.error",Oe(t))},Fi=t=>{Se.logEventWithStatsig("Ecosystem app: Link out","chatgpt_web_ecosystem_app_link_out",t),ve.count(ke.ECOSYSTEM,"app.link_out",Oe(t))},$i=(t,e)=>{Se.logEventWithStatsig("Ecosystem app: Error","chatgpt_web_ecosystem_app_error",fe(Y({},t),{error:e,was_fatal_error:!0})),ve.count(ke.ECOSYSTEM,"app.fatal_error",Oe(t))},Bi=t=>{Se.logEventWithStatsig("Ecosystem app: Security policy violation","chatgpt_web_ecosystem_security_policy_violation",fe(Y({},t),{blocked_uri:t.violation.blockedURI,violated_directive:t.violation.violatedDirective})),ve.count(ke.ECOSYSTEM,"app.security_policy_violation",Oe(t))},Wn=(t,e)=>{Se.logEventWithStatsig("Ecosystem app: Feedback submitted","chatgpt_web_ecosystem_feedback_submitted",fe(Y({},t),{rating:e})),ve.count(ke.ECOSYSTEM,"app.feedback",[...Oe(t),{key:"rating",value:e}])},Fn=t=>{Se.logEventWithStatsig("Ecosystem app: Feedback shown","chatgpt_web_ecosystem_feedback_shown",t),ve.count(ke.ECOSYSTEM,"app.feedback_shown",Oe(t))},$n=t=>{Se.logEventWithStatsig("Ecosystem app: Feedback dismissed","chatgpt_web_ecosystem_feedback_dismissed",t),ve.count(ke.ECOSYSTEM,"app.feedback_dismissed",Oe(t))},Vi=(t,e)=>{Se.logEventWithStatsig("Ecosystem app: Display mode changed","chatgpt_web_ecosystem_app_display_mode_changed",fe(Y({},t),{display_mode:e})),ve.count(ke.ECOSYSTEM,"app.change_display_mode",[...Oe(t),{key:"display_mode",value:e}])},Bn=t=>{Se.logEventWithStatsig("Ecosystem app: Content copied","chatgpt_web_ecosystem_app_copy",t),ve.count(ke.ECOSYSTEM,"app.copy",Oe(t))},Ui=(t,e)=>{Se.logEventWithStatsig("Ecosystem app: Navigation changed","chatgpt_web_ecosystem_app_navigation_changed",fe(Y({},t),{navigation_type:e.type})),ve.count(ke.ECOSYSTEM,"app.navigation",[...Oe(t),{key:"navigation_type",value:e.type}])},vt=Object.freeze(Object.defineProperty({__proto__:null,trackFatalWidgetError:$i,trackSandboxInstrument:Pi,trackSecurityPolicyViolation:Bi,trackWidgetCopy:Bn,trackWidgetDisplayMode:Vi,trackWidgetError:Wi,trackWidgetFeedback:Wn,trackWidgetFeedbackDismissed:$n,trackWidgetFeedbackShown:Fn,trackWidgetLinkOut:Fi,trackWidgetNavigation:Ui},Symbol.toStringTag,{value:"Module"})),zi=X(()=>V(()=>import("./mtsfsh7z74bmo6ig.js").then(t=>t._),__vite__mapDeps([4,1])),{loading:t=>ee(t)}),Gi=X(()=>V(()=>import("./f2itj05whsmn3kgs.js").then(t=>t._),__vite__mapDeps([5,1])),{loading:t=>ee(t)}),qi=X(()=>V(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yw),__vite__mapDeps([6,1,7,8,9])),{loading:t=>ee(t)}),Hi=t=>t.isError||!t.isComplete||t.distributionChannel===Os.ONLY_ME?!1:t.metadata.suggestion_message_id?!0:go(t.widgetId)()<.5,Vn=t=>{"use forget";const e=de.c(7),{chatSDK:n,logoUrl:o,mode:a,conversationId:r,withGutter:i,withMarginBottom:l}=t,c=i===void 0?!1:i,f=l===void 0?!1:l,m=Zt(),h=fo(m,"3422056536").get("is_enabled",!1);if(h&&a!=="inline"||!h&&a==="inline")return null;let x;return e[0]!==n||e[1]!==r||e[2]!==o||e[3]!==a||e[4]!==c||e[5]!==f?(x=s.jsx(Ki,{chatSDK:n,conversationId:r,logoUrl:o,mode:a,withGutter:c,withMarginBottom:f}),e[0]=n,e[1]=r,e[2]=o,e[3]=a,e[4]=c,e[5]=f,e[6]=x):x=e[6],x},Ki=t=>{"use forget";const e=de.c(25),{chatSDK:n,conversationId:o,logoUrl:a,mode:r,withGutter:i,withMarginBottom:l}=t,c=i===void 0?!1:i,f=l===void 0?!1:l,[m,h]=W.useState(!1),{widgetId:x,widgetType:u,metadata:y}=n;let v;e[0]!==o||e[1]!==y.attribution_id||e[2]!==y.suggestion_message_id||e[3]!==x||e[4]!==u?(v=y.attribution_id?{attribution_id:y.attribution_id,name:u,conversation_id:o!=null?o:"",message_id:x,suggestion_message_id:y.suggestion_message_id}:null,e[0]=o,e[1]=y.attribution_id,e[2]=y.suggestion_message_id,e[3]=x,e[4]=u,e[5]=v):v=e[5];const g=v;let p;e[6]!==g||e[7]!==n||e[8]!==m?(p=Hi(n)&&!m&&g,e[6]=g,e[7]=n,e[8]=m,e[9]=p):p=e[9];const d=p;let b,I;if(e[10]!==g||e[11]!==d?(b=()=>{d&&Fn(g)},I=[d,g],e[10]=g,e[11]=d,e[12]=b,e[13]=I):(b=e[12],I=e[13]),W.useEffect(b,I),!d)return null;let C;e[14]!==g?(C=()=>{h(!0),$n(g)},e[14]=g,e[15]=C):C=e[15];const M=C;let E;e[16]!==g?(E=O=>{Wn(g,O),g&&Go({rating:O,conversationId:g.conversation_id,messageId:g.message_id,suggestionMessageId:g.suggestion_message_id,attributionId:g.attribution_id,widgetType:g.name}),h(!0)},e[16]=g,e[17]=E):E=e[17];const w=E;let N;return e[18]!==M||e[19]!==w||e[20]!==a||e[21]!==r||e[22]!==c||e[23]!==f?(N=r==="inline"?s.jsx(Un,{onSubmit:w}):s.jsx(Ji,{logoUrl:a,withGutter:c,withMarginBottom:f,onSubmit:w,onDismiss:M}),e[18]=M,e[19]=w,e[20]=a,e[21]=r,e[22]=c,e[23]=f,e[24]=N):N=e[24],N},Ji=t=>{"use forget";const e=de.c(17),{logoUrl:n,withGutter:o,withMarginBottom:a,onDismiss:r,onSubmit:i}=t,l=a&&"mb-3",c=o&&"mx-4";let f;e[0]!==l||e[1]!==c?(f=_t("border-token-border-default flex items-center gap-2 rounded-lg border ps-3 pe-2",l,c),e[0]=l,e[1]=c,e[2]=f):f=e[2];let m;e[3]!==n?(m=n?s.jsx("img",{className:"h-5 w-5 rounded-lg",src:n,"aria-hidden":!0,alt:""}):s.jsx("div",{className:"loading-results-shimmer h-5 w-5 rounded-lg"}),e[3]=n,e[4]=m):m=e[4];let h;e[5]===Symbol.for("react.memo_cache_sentinel")?(h=s.jsx("span",{className:"text-token-text-primary ms-1",children:"Is this app helpful?"}),e[5]=h):h=e[5];let x;e[6]!==i?(x=s.jsx(Un,{onSubmit:i}),e[6]=i,e[7]=x):x=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx("div",{className:"border-token-border-default h-10 border-e"}),e[8]=u):u=e[8];let y;e[9]===Symbol.for("react.memo_cache_sentinel")?(y=s.jsx(qi,{}),e[9]=y):y=e[9];let v;e[10]!==r?(v=s.jsx(Yt,{className:"h-7! w-7!",onClick:r,icon:y,label:"Dismiss"}),e[10]=r,e[11]=v):v=e[11];let g;return e[12]!==f||e[13]!==m||e[14]!==x||e[15]!==v?(g=s.jsxs("div",{className:f,children:[m,h,x,u,v]}),e[12]=f,e[13]=m,e[14]=x,e[15]=v,e[16]=g):g=e[16],g},Un=t=>{"use forget";const e=de.c(9),{onSubmit:n}=t;let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx(zi,{}),e[0]=o):o=e[0];let a;e[1]!==n?(a=s.jsx(Yt,{className:"h-7! w-7!",icon:o,onClick:()=>n("thumbsUp"),label:"Thumbs up"}),e[1]=n,e[2]=a):a=e[2];let r;e[3]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsx(Gi,{}),e[3]=r):r=e[3];let i;e[4]!==n?(i=s.jsx(Yt,{className:"h-7! w-7!",icon:r,onClick:()=>n("thumbsDown"),label:"Thumbs down"}),e[4]=n,e[5]=i):i=e[5];let l;return e[6]!==a||e[7]!==i?(l=s.jsxs("div",{className:"-my-2 ms-auto flex items-center gap-3",children:[a,i]}),e[6]=a,e[7]=i,e[8]=l):l=e[8],l},Yi=t=>{"use forget";const e=de.c(20),{logoUrl:n,name:o,isLoading:a,onClick:r,conversationId:i,chatSDK:l,withGutter:c,withMarginBottom:f}=t,m=c===void 0?!1:c,x=(f===void 0?!1:f)&&"mb-4",u=m&&"px-4";let y;e[0]!==x||e[1]!==u?(y=_t("text-token-text-secondary dark:text-token-text-tertiary flex w-full items-center gap-2 max-sm:mt-1",x,u),e[0]=x,e[1]=u,e[2]=y):y=e[2];let v;e[3]!==a||e[4]!==n||e[5]!==o?(v=!n||a?s.jsx("div",{className:"loading-results-shimmer h-5 w-5 rounded-lg"}):n&&o&&s.jsx("img",{className:"h-5 w-5 rounded-lg",src:n,alt:o}),e[3]=a,e[4]=n,e[5]=o,e[6]=v):v=e[6];let g;e[7]!==o?(g=o?s.jsx("button",{className:"hover:text-token-text-primary group-hover:text-token-text-primary",children:o}):s.jsx("div",{className:"loading-results-shimmer h-5 w-16 rounded-md"}),e[7]=o,e[8]=g):g=e[8];let p;e[9]!==r||e[10]!==v||e[11]!==g?(p=s.jsxs("span",{className:"group inline-flex items-center gap-2",onClick:r,role:"button",children:[v,g]}),e[9]=r,e[10]=v,e[11]=g,e[12]=p):p=e[12];let d;e[13]!==l||e[14]!==i?(d=s.jsx("span",{className:"ms-auto",children:s.jsx(Vn,{mode:"inline",logoUrl:null,chatSDK:l,conversationId:i})}),e[13]=l,e[14]=i,e[15]=d):d=e[15];let b;return e[16]!==y||e[17]!==p||e[18]!==d?(b=s.jsxs("div",{className:y,children:[p,d]}),e[16]=y,e[17]=p,e[18]=d,e[19]=b):b=e[19],b},Qi=({title:t,logoUrl:e})=>s.jsxs("div",{className:"bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light my-2 flex w-fit items-center gap-2 rounded-xl px-4 py-2 pe-6",children:[e?s.jsx("img",{className:"h-5 w-5 rounded-md",src:e,alt:t!=null?t:""}):s.jsx("div",{className:"loading-results-shimmer h-5 w-5 rounded-md"}),s.jsx("div",{className:"text-token-text-primary text-base font-medium",children:t})]}),Xi=X(()=>V(()=>import("./gr73ffwzttzymtep.js").then(t=>t._),__vite__mapDeps([10,1])),{loading:t=>ee(t)}),Zi=t=>{"use forget";const e=de.c(5),{onClickRetry:n}=t;let o,a;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=s.jsx(Xi,{className:"icon"}),a=s.jsx(Q,{id:"DTbTrQ",defaultMessage:"Error loading app"}),e[0]=o,e[1]=a):(o=e[0],a=e[1]);let r;e[2]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsx(Q,{id:"thEh3U",defaultMessage:"Retry"}),e[2]=r):r=e[2];let i;return e[3]!==n?(i=s.jsx(qo,{type:"error",icon:o,title:a,content:null,primaryCtaText:r,primaryCtaColor:"secondary",onPrimaryCtaClick:n}),e[3]=n,e[4]=i):i=e[4],i},ea=X(()=>V(()=>import("./ghewn7l2ynbm32fm.js").then(t=>t.vJ),__vite__mapDeps([7,1,8])),{loading:t=>ee(t)}),Ws=44,ta=t=>{"use forget";const e=de.c(7),{safeAreaInsetTop:n,safeAreaInsetLeft:o,onClick:a}=t;let r;e[0]!==o||e[1]!==n?(r={height:Ws,width:Ws,marginTop:n,marginLeft:o},e[0]=o,e[1]=n,e[2]=r):r=e[2];let i;e[3]===Symbol.for("react.memo_cache_sentinel")?(i=s.jsx(ea,{}),e[3]=i):i=e[3];let l;return e[4]!==a||e[5]!==r?(l=s.jsx("button",{className:"bg-token-bg-primary text-token-text-primary shadow-short dark:shadow-long fixed start-4 top-0 z-10 aspect-square rounded-full p-3 transition-transform active:scale-115 active:opacity-75",onClick:a,style:r,children:i}),e[4]=a,e[5]=r,e[6]=l):l=e[6],l},sa=X(()=>V(()=>import("./e6eptpe9toj61kmv.js").then(t=>t._),__vite__mapDeps([11,1])),{loading:t=>ee(t)}),na=X(()=>V(()=>import("./ghewn7l2ynbm32fm.js").then(t=>t.vJ),__vite__mapDeps([7,1,8])),{loading:t=>ee(t)}),oa=X(()=>V(()=>import("./j2k7r2f0maz0c5g5.js").then(t=>t._),__vite__mapDeps([12,1])),{loading:t=>ee(t)}),ia=X(()=>V(()=>import("./88dcy8w0nw3pooi2.js").then(t=>t._),__vite__mapDeps([13,1])),{loading:t=>ee(t)}),zn=8,aa=t=>{"use forget";const e=de.c(34),{title:n,widgetDisplayName:o,widgetDomain:a,onClickBack:r,onClickClose:i,onClickForward:l,onClickOpenInApp:c,canGoBack:f,canGoForward:m,logo:h}=t,x=Qt();if(Bs()){let N;return e[0]!==i?(N=s.jsx(ta,{safeAreaInsetTop:zn,safeAreaInsetLeft:0,onClick:i}),e[0]=i,e[1]=N):N=e[1],N}let u;e[2]!==x?(u=x.formatMessage({id:"H0F9KU",defaultMessage:"Close"}),e[2]=x,e[3]=u):u=e[3];let y;e[4]===Symbol.for("react.memo_cache_sentinel")?(y=s.jsx(na,{className:"icon"}),e[4]=y):y=e[4];let v;e[5]!==i||e[6]!==u?(v=s.jsx(Yt,{label:u,className:"h-7! w-7!",onClick:i,icon:y}),e[5]=i,e[6]=u,e[7]=v):v=e[7];let g;e[8]!==f||e[9]!==m||e[10]!==x||e[11]!==r||e[12]!==l?(g=(f||m)&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Yt,{label:x.formatMessage({id:"y0H9Ps",defaultMessage:"Back"}),className:"h-7! w-7!",onClick:r,disabled:!f,icon:s.jsx(ia,{className:"icon"})}),s.jsx(Yt,{label:x.formatMessage({id:"4zGgS+",defaultMessage:"Forward"}),className:"h-7! w-7!",onClick:l,disabled:!m,icon:s.jsx(oa,{className:"icon"})})]}),e[8]=f,e[9]=m,e[10]=x,e[11]=r,e[12]=l,e[13]=g):g=e[13];let p;e[14]!==v||e[15]!==g?(p=s.jsxs("div",{className:"flex items-center justify-start gap-3",children:[v,g]}),e[14]=v,e[15]=g,e[16]=p):p=e[16];let d;e[17]!==n?(d=s.jsx("div",{className:"text-token-text-secondary flex items-center justify-center text-base",children:n}),e[17]=n,e[18]=d):d=e[18];const b=h?void 0:sa,I=!a;let C;e[19]!==h||e[20]!==o?(C=h&&s.jsx("img",{src:h,alt:o,className:"me-2 h-4 w-4"}),e[19]=h,e[20]=o,e[21]=C):C=e[21];let M;e[22]!==o?(M=s.jsx(Q,{id:"JvQEOX",defaultMessage:"Open in {app}",values:{app:o}}),e[22]=o,e[23]=M):M=e[23];let E;e[24]!==c||e[25]!==M||e[26]!==b||e[27]!==I||e[28]!==C?(E=s.jsx("div",{className:"flex items-center justify-end",children:s.jsxs(Qe,{icon:b,disabled:I,onClick:c,color:"secondary",children:[C,M]})}),e[24]=c,e[25]=M,e[26]=b,e[27]=I,e[28]=C,e[29]=E):E=e[29];let w;return e[30]!==E||e[31]!==p||e[32]!==d?(w=s.jsxs("div",{className:"border-token-border-secondary bg-token-bg-primary sm:bg-token-bg-primary z-10 grid h-(--header-height) grid-cols-[1fr_auto_1fr] border-b px-2",children:[p,d,E]}),e[30]=E,e[31]=p,e[32]=d,e[33]=w):w=e[33],w},Gn=()=>{let t="unknown";return Bs()?t="mobile":po()?t="tablet":ho()&&(t="desktop"),{device:{type:t},capabilities:{hover:en(_o),touch:en(xo)}}},ra=t=>t.concat().sort().map(e=>"".concat(e," *")).join("; "),la=(t,e)=>"?"+["","app=".concat(t),"locale=".concat(e),"deviceType=".concat(Gn().device.type)].filter(Boolean).join("&"),ca=t=>{if(t){const e=new URL(un);return e.hostname="".concat(t,".").concat(e.hostname),e.protocol=pi,e.origin}return un},da=t=>function(...n){return Ss(this,null,function*(){yield*Ms(t("streamCompletion",...n))})},ua=t=>{"use forget";const e=de.c(24),{host:n,features:o,isInert:a,title:r,ref:i,subdomain:l,iframeRef:c,api:f,locale:m}=t,h=n===void 0?"chatgpt":n,x=a===void 0?!1:a,[u]=W.useState(ma);let y;e[0]!==u?(y=async(U,..._)=>{var k;const S=_;return await bo(()=>!!u()),xs((k=u())==null?void 0:k[U],"Method ".concat(String(U)," not found"))(...S)},e[0]=u,e[1]=y):y=e[1];const v=bt(y);let g,p;e[2]!==v?(g=()=>new Proxy({},{get:(U,_)=>(...S)=>v(_,...S)}),p=[v],e[2]=v,e[3]=g,e[4]=p):(g=e[3],p=e[4]),W.useImperativeHandle(i,g,p);let d;e[5]!==f?(d=(U,..._)=>{const S=_,H=f[U];if(!H){console.warn("HostAPI method not found",U);return}return H(...S)},e[5]=f,e[6]=d):d=e[6];const b=bt(d);let I;e[7]!==b||e[8]!==u?(I=U=>U?(hi(U,{drawBoundingBoxes:(..._)=>b("drawBoundingBoxes",..._),notifyBackgroundColor:(..._)=>b("notifyBackgroundColor",..._),notifyIntrinsicHeight:(..._)=>b("notifyIntrinsicHeight",..._),sendInstrument:(..._)=>b("sendInstrument",..._),getDownloadURL:(..._)=>b("getDownloadURL",..._),callTool:(..._)=>b("callTool",..._),streamCompletion:da(b),callCompletion:(..._)=>b("callCompletion",..._),notifySecurityPolicyViolation:(..._)=>b("notifySecurityPolicyViolation",..._),notifyEnvironmentError:(..._)=>b("notifyEnvironmentError",..._),updateWidgetState:(..._)=>b("updateWidgetState",..._),sendFollowUpMessage:(..._)=>b("sendFollowUpMessage",..._),notifyNavigation:(..._)=>b("notifyNavigation",..._),notifyEscapeKey:(..._)=>b("notifyEscapeKey",..._),openExternal:(..._)=>b("openExternal",..._),requestModal:(..._)=>b("requestModal",..._),requestClose:(..._)=>b("requestClose",..._),requestDisplayMode:(..._)=>b("requestDisplayMode",..._),requestCheckout:(..._)=>b("requestCheckout",..._)},["runUserCode","runWidgetCode"]).then(_=>{u.set(_)}),()=>{u.set(null)}):u.set(null),e[7]=b,e[8]=u,e[9]=I):I=e[9];const C=bt(I);let M;e[10]!==l?(M=ca(l),e[10]=l,e[11]=M):M=e[11];const E=M,w="sandbox-".concat(E);let N;e[12]!==h||e[13]!==m?(N=la(h,m),e[12]=h,e[13]=m,e[14]=N):N=e[14];const O="".concat(E).concat(N),L=Ho(C,c);let z;e[15]!==o?(z=o!=null&&o.length?ra(o):void 0,e[15]=o,e[16]=z):z=e[16];let P;return e[17]!==x||e[18]!==O||e[19]!==L||e[20]!==z||e[21]!==w||e[22]!==r?(P=s.jsx(vo,{children:s.jsx("iframe",{title:r,inert:x,src:O,ref:L,sandbox:"allow-scripts allow-same-origin allow-forms",allow:z,className:"h-full w-full max-w-full"},w)}),e[17]=x,e[18]=O,e[19]=L,e[20]=z,e[21]=w,e[22]=r,e[23]=P):P=e[23],P};function ma(){return yo(null)}const fa=async(t,e)=>{const{trackFatalWidgetError:n}=await V(async()=>{const{trackFatalWidgetError:o}=await Promise.resolve().then(()=>vt);return{trackFatalWidgetError:o}},void 0);n(t,e)},ga=async(t,e)=>{const{trackWidgetError:n}=await V(async()=>{const{trackWidgetError:o}=await Promise.resolve().then(()=>vt);return{trackWidgetError:o}},void 0);n(t,e)},pa=async t=>{const{trackWidgetLinkOut:e}=await V(async()=>{const{trackWidgetLinkOut:n}=await Promise.resolve().then(()=>vt);return{trackWidgetLinkOut:n}},void 0);e(t)},ha=async(t,e)=>{const{trackSandboxInstrument:n}=await V(async()=>{const{trackSandboxInstrument:o}=await Promise.resolve().then(()=>vt);return{trackSandboxInstrument:o}},void 0);n(t,e)},xa=async t=>{const{trackSecurityPolicyViolation:e}=await V(async()=>{const{trackSecurityPolicyViolation:n}=await Promise.resolve().then(()=>vt);return{trackSecurityPolicyViolation:n}},void 0);e(t)},_a=async(t,e)=>{const{trackWidgetDisplayMode:n}=await V(async()=>{const{trackWidgetDisplayMode:o}=await Promise.resolve().then(()=>vt);return{trackWidgetDisplayMode:o}},void 0);n(t,e)},ya=async(t,e)=>{const{trackWidgetNavigation:n}=await V(async()=>{const{trackWidgetNavigation:o}=await Promise.resolve().then(()=>vt);return{trackWidgetNavigation:o}},void 0);n(t,e)},ba={insets:{top:0,bottom:0,left:0,right:0}},qn=({host:t,ref:e,iframeRef:n,html:o,accessToken:a,features:r,safeArea:i=ba,attributionId:l,conversationId:c,widgetId:f,widgetParent:m,suggestionMessageId:h,widgetType:x,csp:u,subdomain:y,viewParams:v,widgetState:g=null,toolInput:p=null,toolOutput:d=null,toolResponseMetadata:b=null,maxHeight:I,theme:C,title:M,api:E,locale:w,displayMode:N="inline",onReady:O,onError:L})=>{"use no forget";const z=W.useMemo(()=>{var k;return{attribution_id:(k=l!=null?l:m)!=null?k:"",name:x,conversation_id:c!=null?c:null,message_id:f||null,suggestion_message_id:h!=null?h:null}},[l,m,x,c,f,h]),P=W.useRef(null),U=W.useRef(null),_=bt(()=>{L==null||L()}),S=bt(()=>{O==null||O()}),H=bt(async k=>{var A;const F=(A=P.current)==null?void 0:A.runWidgetCode({html:k,widgetId:f,viewParams:v,widgetState:g,toolInput:p,toolOutput:d,toolResponseMetadata:b,features:r,maxHeight:I,theme:C,displayMode:N,safeArea:i,userAgent:Gn(),csp:u});if(F)try{for(var se=Qs(await F),ue,he,ge;ue=!(he=await se.next()).done;ue=!1){const te=he.value;te.type===Is.ENVIRONMENT_STATUS&&te.status===xi.RUNNING_CODE?S():te.type===Is.ERROR?(ga(z,te.error),U.current=te.error):te.type===Is.RUN_COMPLETE&&te.wasFatalError&&(fa(z,U.current),_())}}catch(he){ge=[he]}finally{try{ue&&(he=se.return)&&await he.call(se)}finally{if(ge)throw ge[0]}}});return W.useEffect(()=>{o&&H(o)},[o,H]),W.useEffect(()=>{var k;(k=P.current)==null||k.setWidgetProps({widgetId:f,widgetState:g,toolInput:p,toolOutput:d,toolResponseMetadata:b})},[f,g,p,d,b]),W.useEffect(()=>{var k;(k=P.current)==null||k.setAdditionalGlobals({additionalGlobals:{maxHeight:I}})},[I]),W.useEffect(()=>{var k;(k=P.current)==null||k.setAdditionalGlobals({additionalGlobals:{displayMode:N,view:{params:v,mode:N}}})},[N,v]),W.useEffect(()=>{var k;(k=P.current)==null||k.setTheme({theme:C})},[C]),W.useEffect(()=>{var k;(k=P.current)==null||k.setSafeArea({safeArea:i})},[i]),s.jsx(ua,{title:M,host:t,subdomain:y,features:r,api:fe(Y({},E),{notifyNavigation:k=>{var F;ya(z,k),(F=E.notifyNavigation)==null||F.call(E,k)},requestDisplayMode:k=>{var A,se;const{mode:F}=k;return F!==N&&_a(z,F),(se=(A=E.requestDisplayMode)==null?void 0:A.call(E,k))!=null?se:{mode:F}},openExternal:k=>{var F;pa(z),(F=E.openExternal)==null||F.call(E,k)},sendInstrument:k=>{ha(k,z)},notifySecurityPolicyViolation:k=>{var F;xa({attribution_id:(F=l!=null?l:m)!=null?F:"",name:x,conversation_id:c!=null?c:null,message_id:f||null,suggestion_message_id:void 0,violation:k})},streamCompletion:function(k){return Ss(this,null,function*(){const{completionStream:F}=yield new ps(V(async()=>{const{completionStream:A}=await import("./om87g1p3w7uzy3ym.js");return{completionStream:A}},__vite__mapDeps([14,7,1,8,6,9])));yield*Ms(F(k,xs(m),a))})},callCompletion:async function(k){const{callCompletion:F}=await V(async()=>{const{callCompletion:A}=await import("./om87g1p3w7uzy3ym.js");return{callCompletion:A}},__vite__mapDeps([14,7,1,8,6,9]));return await F(k,xs(m),a)}}),iframeRef:n,ref:Ko(P,e),locale:w})},va=t=>{"use forget";var f;const e=de.c(7),{clientThreadId:n,messages:o,isLastMessageInTurn:a,rememberForThisConversation:r,onRequestCompletion:i}=t;let l,c;if(e[0]!==n||e[1]!==a||e[2]!==o||e[3]!==i||e[4]!==r){c=Symbol.for("react.early_return_sentinel");e:{const{jitPluginData:m}=zs(o,a);if(!(m!=null&&m.from_server)||((f=m.from_server)==null?void 0:f.type)==="denied_by_user"){c=null;break e}const{from_server:h}=m,{body:x}=h,{domain:u,actions:y}=x;l=y.map((v,g)=>s.jsx(An,{clientThreadId:n,messages:o,onRequestCompletion:i,action:v,domain:u,handleUserAction:yt,rememberAnswer:r},g))}e[0]=n,e[1]=a,e[2]=o,e[3]=i,e[4]=r,e[5]=l,e[6]=c}else l=e[5],c=e[6];return c!==Symbol.for("react.early_return_sentinel")?c:l},ka=X(()=>V(()=>import("./gsas8pb1acnf7jnd.js").then(t=>t._),__vite__mapDeps([3,1])),{loading:t=>ee(t)}),wa=X(()=>V(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yA),__vite__mapDeps([6,1,7,8,9])),{loading:t=>ee(t)});function ja(t){"use forget";var w,N;const e=de.c(40),{messages:n,isLastMessageInTurn:o,clientThreadId:a,onRequestCompletion:r}=t,[i,l]=W.useState(!1);let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=s.jsx(Q,{id:"WidgetOverlay.alwaysAsk",defaultMessage:"Always ask"}),e[0]=c):c=e[0];const f=c;let m;e[1]===Symbol.for("react.memo_cache_sentinel")?(m=s.jsx(Q,{id:"WidgetOverlay.allowThisConversation",defaultMessage:"Allow for this conversation"}),e[1]=m):m=e[1];const h=m,x=wn(),u=$s();let y;e[2]!==o||e[3]!==n?(y=zs(n,o),e[2]=o,e[3]=n,e[4]=y):y=e[4];const{uiState:v}=y;let g;e[5]!==o||e[6]!==n?(g=Mn(n,o),e[5]=o,e[6]=n,e[7]=g):g=e[7];const p=g;let d,b,I,C;if(e[8]!==a||e[9]!==u||e[10]!==o||e[11]!==x.connectorLinks||e[12]!==n||e[13]!==p||e[14]!==r||e[15]!==i||e[16]!==v){const O=Tn(n,o),[L,z,P]=(w=O==null?void 0:O.path.split("/").filter(Boolean))!=null?w:[],U=[...x.connectorLinks.values()].flat().find(A=>A.id===z),_=U&&u.platformConnectors.get(U.connector_id);d=v===D.UserConfirmation,b="bg-token-bg-primary text-token-text-primary shadow-long pointer-events-auto grid w-[min(90%,40rem)] max-w-[min(100%,600px)] gap-4 rounded-2xl p-4 sm:rounded-3xl";const S=s.jsx("div",{className:"text-token-text-primary ms-3 font-medium",children:s.jsx(Q,{id:"VHhzt6",defaultMessage:"{connectorName} wants to perform an action",values:{connectorName:L}})});let H;e[21]!==p||e[22]!==i?(H=p?s.jsx("div",{className:"-mt-0.5 flex justify-start text-sm",children:s.jsx(ko,{size:"small",triggerButton:s.jsxs("button",{className:"bg-token-bg-primary hover:bg-token-bg-tertiary text-token-text-primary inline-flex items-center gap-1 rounded-lg px-2 py-1 ps-3 transition-colors",children:[i?h:f,s.jsx(wa,{strokeWidth:1,className:"icon-sm opacity-30","aria-hidden":!0})]}),children:s.jsxs(Ts.RadioGroup,{value:i?"allow":"ask",onValueChange:A=>l(A==="allow"),children:[s.jsx(Ts.RadioItem,{value:"ask",children:f}),s.jsx(Ts.RadioItem,{value:"allow",children:h})]})})}):null,e[21]=p,e[22]=i,e[23]=H):H=e[23];let k;e[24]!==S||e[25]!==H?(k=s.jsxs("div",{className:"flex flex-1 flex-col",children:[S,H]}),e[24]=S,e[25]=H,e[26]=k):k=e[26];let F;e[27]!==a||e[28]!==o||e[29]!==n||e[30]!==r||e[31]!==i?(F=s.jsx("div",{className:"flex items-center justify-center gap-2",children:s.jsx(va,{clientThreadId:a,messages:n,isLastMessageInTurn:o,rememberForThisConversation:i,onRequestCompletion:r})}),e[27]=a,e[28]=o,e[29]=n,e[30]=r,e[31]=i,e[32]=F):F=e[32],I=s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ds,{connector:{name:L,logo_url:(N=_==null?void 0:_.logo_url)!=null?N:null},size:"medium",className:"bg-primary shadow-xxs max-h-fit rounded-2xl border bg-clip-padding p-2"}),k,F]}),C=O!=null&&s.jsx(is,{name:P,afterName:d&&s.jsx("div",{className:"border-token-text-quartenary text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary items-center rounded-full border px-1 py-0.5 text-[8px] leading-3 font-semibold uppercase",children:s.jsx(Q,{id:"APIToolCallCard.write",defaultMessage:"Write"})}),params:typeof O.args=="object"?O.args:JSON.parse(O.args)}),e[8]=a,e[9]=u,e[10]=o,e[11]=x.connectorLinks,e[12]=n,e[13]=p,e[14]=r,e[15]=i,e[16]=v,e[17]=d,e[18]=b,e[19]=I,e[20]=C}else d=e[17],b=e[18],I=e[19],C=e[20];let M;e[33]!==d?(M=d&&s.jsxs("div",{className:"text-token-text-secondary text-xs",children:[s.jsx(ka,{className:"icon-sm me-2 mb-0.5 inline-block"}),s.jsx(Q,{id:"APIToolCallCard.writeWarning",defaultMessage:"Write actions come with risks. <link>Learn more</link>",values:{link:Ca}})]}),e[33]=d,e[34]=M):M=e[34];let E;return e[35]!==b||e[36]!==I||e[37]!==C||e[38]!==M?(E=s.jsxs("div",{className:b,children:[I,C,M]}),e[35]=b,e[36]=I,e[37]=C,e[38]=M,e[39]=E):E=e[39],E}function Ca(t){return s.jsx("a",{href:"https://platform.openai.com/docs/mcp#risks-and-safety",className:"underline underline-offset-2",target:"_blank",rel:"noopener noreferrer",children:t},"link")}const Ea=X(()=>V(()=>import("./hv1mawgxcoyab644.js"),__vite__mapDeps([15,1,7,8])).then(t=>t.ConfirmExternalLinkModal)),Na=X(()=>V(()=>import("./f510v2yorm9a64cn.js"),__vite__mapDeps([16,1,7,8])).then(t=>t.SafeLinkWarningModal)),Hn=({ctx:t,href:e,csp:n,domain:o})=>{if(e){if(Oi(e,n,o)){wo()?Rs(t,Ea,{url:e}):window.open(e,"_blank","noopener,noreferrer");return}Rs(t,Na,{urls:e})}},Sa=X(()=>V(()=>import("./frf0wu8ouyfyu06j.js").then(t=>t._),__vite__mapDeps([17,1])),{loading:t=>ee(t)}),Ma=t=>{"use forget";const e=de.c(65),{title:n,sendFollowUpMessage:o,conversation:a,chatSDK:r,clientThreadId:i,onClose:l,domain:c,html:f,attributionId:m,widgetId:h,widgetParent:x,suggestionMessageId:u,widgetType:y,features:v,toolInput:g,toolOutput:p,toolResponseMetadata:d,widgetState:b,subdomain:I,csp:C,locale:M,params:E}=t,w=Zt();let N;e[0]!==a?(N=Us(a),e[0]=a,e[1]=N):N=e[1];const O=N,[L,z]=W.useState(null),[P,U]=W.useState(!1),_=W.useRef(null),S=Cn();let H;e[2]!==n?(H=s.jsx(He.Title,{title:n}),e[2]=n,e[3]=H):H=e[3];let k;e[4]!==l?(k=s.jsx(jn,{onClick:l,iconSize:"lg"}),e[4]=l,e[5]=k):k=e[5];let F;e[6]!==P?(F=P&&s.jsx(Jo,{onClick:()=>{var j;return(j=_.current)==null?void 0:j.navigate({delta:-1})},children:s.jsx(Sa,{})}),e[6]=P,e[7]=F):F=e[7];let A;e[8]!==H||e[9]!==k||e[10]!==F?(A=s.jsx(He.Header,{textCenter:!1,title:H,closeButtonSide:"right",closeButton:k,backButton:F}),e[8]=H,e[9]=k,e[10]=F,e[11]=A):A=e[11];const se=L!=null?L:void 0;let ue;e[12]!==se?(ue={height:se},e[12]=se,e[13]=ue):ue=e[13];const he=S!=null?S:"light";let ge;e[14]!==i?(ge=Vs(i),e[14]=i,e[15]=ge):ge=e[15];let te;e[16]===Symbol.for("react.memo_cache_sentinel")?(te=j=>{z(j)},e[16]=te):te=e[16];let G;if(e[17]!==r||e[18]!==i||e[19]!==C||e[20]!==w||e[21]!==c||e[22]!==O||e[23]!==l||e[24]!==o||e[25]!==x){let j;e[27]!==r||e[28]!==i||e[29]!==w?(j=le=>Ln({ctx:w,chatSDK:r,clientThreadId:i,checkoutSession:le}),e[27]=r,e[28]=i,e[29]=w,e[30]=j):j=e[30];let xe;e[31]===Symbol.for("react.memo_cache_sentinel")?(xe=le=>{const{canGoBack:ie}=le;U(ie)},e[31]=xe):xe=e[31];let we;e[32]!==O||e[33]!==x?(we=(le,ie)=>O.callTool$(xs(x),le,ie),e[32]=O,e[33]=x,e[34]=we):we=e[34];let re;e[35]!==O?(re=(le,ie)=>O.setWidgetState$(le,ie),e[35]=O,e[36]=re):re=e[36],G={notifyIntrinsicHeight:te,openExternal(le){const{href:ie}=le;Hn({ctx:w,href:ie,csp:C,domain:c})},sendFollowUpMessage:o,requestClose:l,notifyEscapeKey:l,requestCheckout:j,notifyNavigation:xe,callTool:we,updateWidgetState:re},e[17]=r,e[18]=i,e[19]=C,e[20]=w,e[21]=c,e[22]=O,e[23]=l,e[24]=o,e[25]=x,e[26]=G}else G=e[26];let ae;e[37]!==m||e[38]!==C||e[39]!==v||e[40]!==f||e[41]!==M||e[42]!==E||e[43]!==I||e[44]!==u||e[45]!==G||e[46]!==he||e[47]!==ge||e[48]!==g||e[49]!==p||e[50]!==d||e[51]!==h||e[52]!==x||e[53]!==b||e[54]!==y?(ae=s.jsx(qn,{host:"chatgpt",html:f,ref:_,theme:he,attributionId:m,conversationId:ge,widgetId:h,widgetParent:x,suggestionMessageId:u,widgetType:y,subdomain:I,widgetState:b,toolInput:g,toolOutput:p,toolResponseMetadata:d,features:v,viewParams:E,displayMode:"modal",api:G,csp:C,locale:M}),e[37]=m,e[38]=C,e[39]=v,e[40]=f,e[41]=M,e[42]=E,e[43]=I,e[44]=u,e[45]=G,e[46]=he,e[47]=ge,e[48]=g,e[49]=p,e[50]=d,e[51]=h,e[52]=x,e[53]=b,e[54]=y,e[55]=ae):ae=e[55];let Z;e[56]!==ae||e[57]!==ue?(Z=s.jsx("div",{className:"max-h-full flex-shrink overflow-y-auto",style:ue,children:ae}),e[56]=ae,e[57]=ue,e[58]=Z):Z=e[58];let K;e[59]!==Z||e[60]!==A?(K=s.jsx(He.Overlay,{showBackground:!0,children:s.jsxs(He.Content,{className:"flex min-h-0 max-w-xl flex-col overflow-hidden",children:[A,Z]})}),e[59]=Z,e[60]=A,e[61]=K):K=e[61];let ne;return e[62]!==l||e[63]!==K?(ne=s.jsx(He.Root,{isOpen:!0,onClose:l,testId:"modal-kanzi-widget",children:K}),e[62]=l,e[63]=K,e[64]=ne):ne=e[64],ne},Ta=X(()=>V(()=>import("./ghewn7l2ynbm32fm.js").then(t=>t.vJ),__vite__mapDeps([7,1,8])),{loading:t=>ee(t)}),Ia=["midi","microphone"],Aa=t=>{"use forget";var Gs,qs;const e=de.c(249),{chatSDK:n,clientThreadId:o,onRequestCompletion:a,isLastMessageInTurn:r}=t,i=Zt();let l;e[0]!==i?(l=()=>En(i),e[0]=i,e[1]=l):l=e[1];const c=Ne(l);let f;e[2]!==i?(f=Eo(i),e[2]=i,e[3]=f):f=e[3];const{locale:m}=f;let h,x;e[4]!==o||e[5]!==i?(h=as(i,o),x=Us(h),e[4]=o,e[5]=i,e[6]=h,e[7]=x):(h=e[6],x=e[7]);const u=x,y=Yo(),[v,g]=W.useState(null),p=Qo(n),{refetch:d,isLoading:b,isError:I,html:C,domain:M,subdomain:E,name:w,logoUrl:N,csp:O,prefersBorder:L,hideWidgetFeedback:z}=p,{widgetParent:P,widgetType:U,metadata:_}=n,[S,H]=W.useState(null),k=W.useRef(null),F=W.useRef(null),A=No.useStore();let se;e[8]!==n||e[9]!==o||e[10]!==a||e[11]!==A?(se=$=>{const me=Mi(fe(Y({},$),{chatSDK:n,persistedSystemHintsStore:A,clientThreadId:o}));me!=null&&a(me)},e[8]=n,e[9]=o,e[10]=a,e[11]=A,e[12]=se):se=e[12];const ue=se;let he;e[13]!==u?(he=()=>u.title$(),e[13]=u,e[14]=he):he=e[14];const ge=Ne(he);let te;e[15]!==n||e[16]!==u?(te=()=>u.isPinned$(n),e[15]=n,e[16]=u,e[17]=te):te=e[17];const G=Ne(te);let ae;e[18]!==n||e[19]!==u?(ae=()=>u.isPinOrigin$(n),e[18]=n,e[19]=u,e[20]=ae):ae=e[20];const Z=Ne(ae);let K;e[21]!==n||e[22]!==u?(K=()=>u.isPinOrigin$(n)?u.displayMode$():"inline",e[21]=n,e[22]=u,e[23]=K):K=e[23];const ne=Ne(K),j=ne==="fullscreen",xe=ne==="pip";let we;e[24]!==u?(we=()=>u.maxWidgetHeight$(),e[24]=u,e[25]=we):we=e[25];const re=Ne(we);let le;e[26]!==n.widgetId||e[27]!==u?(le=()=>u.transitioningId$()===n.widgetId,e[26]=n.widgetId,e[27]=u,e[28]=le):le=e[28];const ie=Ne(le);let Re;e[29]!==n||e[30]!==u?(Re=()=>u.getLatestChatSDK$(n),e[29]=n,e[30]=u,e[31]=Re):Re=e[31];const es=Ne(Re),De=v!=null?v:n;let Xe;e[32]!==De||e[33]!==u?(Xe=u.getWidgetStateAndProps(De),e[32]=De,e[33]=u,e[34]=Xe):Xe=e[34];const{toolInput:Pe,toolOutput:ce,widgetState:je,toolResponseMetadata:_e}=Xe,kt=es.messages,ye=De.widgetId,Me=(Gs=_==null?void 0:_.attribution_id)!=null?Gs:P,[Ke,ks]=W.useState(0),[wt,Te]=W.useState(!1),[Ze,ts]=W.useState(!1),[jt,rs]=W.useState(!1),[Ct,ls]=W.useState(!1),Et=Cn(),Fe=n.distributionChannel===Os.OPENAI&&z;let et;e[35]!==ye||e[36]!==n||e[37]!==ne||e[38]!==S||e[39]!==Z||e[40]!==u||e[41]!==A||e[42]!==L?(et=($,me)=>{if($===ne)return{mode:$};$==="fullscreen"&&(Zo.setSidebarOpen(!1),A.setActiveSystemHint(null)),Z?u.transitioningId$.set(ye):u.transitioningId$.set(n.widgetId),$!=="inline"&&u.subscribeToNewMessages$(n,g);const ft=()=>{var gt,pt;(gt=F.current)==null||gt.focus(),$==="inline"?(pt=k.current)==null||pt.navigate({popToRoot:!0}):u.setPinnedWidgetHeight(S!=null?S:0),g(null),u.setDisplayMode$(n,$,me)};return L?(ei({forceFlushSync:!0,className:$==="inline"?[ns["pinned-widget"],ns["becoming-inline"]]:ne==="inline"?[ns["pinned-widget"],ns["becoming-pinned"]]:ns["pinned-widget"],update:ft}).finished.then(()=>{u.transitioningId$.set(null)}),{mode:$}):(ft(),u.transitioningId$.set(null),{mode:$})},e[35]=ye,e[36]=n,e[37]=ne,e[38]=S,e[39]=Z,e[40]=u,e[41]=A,e[42]=L,e[43]=et):et=e[43];const J=bt(et);let tt,st;e[44]!==G||e[45]!==J?(tt=()=>{if(G)return So(window,{keydown:$=>{$.key==="Escape"&&J("inline")}})},st=[G,J],e[44]=G,e[45]=J,e[46]=tt,e[47]=st):(tt=e[46],st=e[47]),W.useEffect(tt,st);let nt;e[48]!==d||e[49]!==Ke?(nt=()=>{d(),Te(!1),ts(!1),ks(Ke+1)},e[48]=d,e[49]=Ke,e[50]=nt):nt=e[50];const Nt=nt;let ot;e[51]!==J?(ot=()=>{Te(!0),J("inline")},e[51]=J,e[52]=ot):ot=e[52];const St=ot;let it;e[53]!==o||e[54]!==i?(it=Xo(as(i,o)),e[53]=o,e[54]=i,e[55]=it):it=e[55];const{height$:Mt,marginBottom$:Tt}=it;let at;e[56]!==Mt||e[57]!==Z||e[58]!==j||e[59]!==Tt?(at=()=>{var $,me;return j&&Z?16+(($=Mt())!=null?$:0)+((me=Tt())!=null?me:0):0},e[56]=Mt,e[57]=Z,e[58]=j,e[59]=Tt,e[60]=at):at=e[60];const It=Ne(at);let rt;e[61]!==j?(rt=()=>j&&Bs()?Ws+zn:0,e[61]=j,e[62]=rt):rt=e[62];const At=Ne(rt);let lt;e[63]!==At||e[64]!==It?(lt={insets:{top:At,bottom:It,left:0,right:0}},e[63]=At,e[64]=It,e[65]=lt):lt=e[65];const Lt=lt;if(y){let $;return e[66]!==N||e[67]!==w?($=s.jsx(Qi,{title:w,logoUrl:N}),e[66]=N,e[67]=w,e[68]=$):$=e[68],$}else if(G&&!Z&&!ie)return null;const cs=j?void 0:S?"".concat(Math.min(S,re!=null?re:1/0),"px"):"auto";let ct;e[69]!==o||e[70]!==Z||e[71]!==r||e[72]!==kt||e[73]!==a?(ct=In(kt,r||Z)&&s.jsx(ja,{messages:kt,isLastMessageInTurn:r||Z,clientThreadId:o,onRequestCompletion:a}),e[69]=o,e[70]=Z,e[71]=r,e[72]=kt,e[73]=a,e[74]=ct):ct=e[74];const We=ct,dt=b||!Ze||S==null;let ut;e[75]!==M?(ut=Li(M),e[75]=M,e[76]=ut):ut=e[76];const pe=ut;let mt;e[77]!==o?(mt=Vs(o),e[77]=o,e[78]=mt):mt=e[78];const Ce=mt,Ie=c?Ia:void 0,Ot=ie&&L&&"[view-transition-name:pinned-kanzi-widget]",Rt=!Z&&"relative mb-2";let $e;e[79]!==ne||e[80]!==j||e[81]!==xe||e[82]!==G||e[83]!==L||e[84]!==Ot||e[85]!==Rt?($e=_t("no-scrollbar",Ot,Rt,ne==="inline"&&_t("thread-sm:w-full",!G&&"mx-0 max-sm:-mx-(--thread-content-margin) max-sm:w-[100cqw] max-sm:overflow-hidden",L&&!G&&!j&&"max-sm:overflow-visible max-sm:px-4"),xe&&"thread-xl:top-4 fixed start-4 end-4 top-4 z-50 mx-auto max-w-(--thread-content-max-width) sm:start-0 sm:end-0 sm:top-(--header-height) sm:w-full",j?"fixed start-0 end-0 top-0 bottom-0 z-50 mx-auto flex w-auto flex-col overflow-hidden":"overflow-visible"),e[79]=ne,e[80]=j,e[81]=xe,e[82]=G,e[83]=L,e[84]=Ot,e[85]=Rt,e[86]=$e):$e=e[86];let T;e[87]!==re?(T={maxHeight:re},e[87]=re,e[88]=T):T=e[88];let B;e[89]!==j||e[90]!==G||e[91]!==J?(B=G&&!j&&s.jsx("button",{className:"absolute -start-2 -top-1.5 z-10 rounded-full bg-[#3a3a3a] p-1.25 text-white shadow-[0px_0px_0px_1px_var(--border-heavy),0px_4px_12px_rgba(0,0,0,0.12)] hover:bg-[#6a6a6a] md:-start-6",onClick:()=>J("inline"),children:s.jsx(Ta,{className:"h-4.5 w-4.5"})}),e[89]=j,e[90]=G,e[91]=J,e[92]=B):B=e[92];let R;e[93]!==jt||e[94]!==Ct||e[95]!==ge||e[96]!==j||e[97]!==N||e[98]!==w||e[99]!==J||e[100]!==pe?(R=j&&s.jsx(aa,{logo:N,onClickBack:()=>{var $;return($=k.current)==null?void 0:$.navigate({delta:-1})},onClickClose:()=>J("inline"),onClickForward:()=>{var $;return($=k.current)==null?void 0:$.navigate({delta:1})},canGoBack:jt,canGoForward:Ct,title:(qs=ge!=null?ge:w)!=null?qs:"",widgetDisplayName:w!=null?w:"",widgetDomain:pe!=null?pe:null,onClickOpenInApp:()=>{var $;($=k.current)==null||$.getCurrentPath().then(me=>{me==null||!pe||window.open(new URL(me.replace(/^\/+/,""),pe),"_blank")})}}),e[93]=jt,e[94]=Ct,e[95]=ge,e[96]=j,e[97]=N,e[98]=w,e[99]=J,e[100]=pe,e[101]=R):R=e[101];const q=j?"flex-1":"h-full",oe=!G&&L&&"border-token-border-light shadow-short rounded-2xl sm:rounded-3xl dark:shadow-[0px_0px_0px_1px_#414141,0px_4px_14px_rgba(0,0,0,0.24)]",Ee=!j&&(L||xe)&&"rounded-2xl sm:rounded-3xl",Be=xe&&"shadow-[0px_0px_0px_1px_var(--border-heavy),0px_6px_20px_rgba(0,0,0,0.1)] md:-mx-4";let Ae;e[102]!==q||e[103]!==oe||e[104]!==Ee||e[105]!==Be?(Ae=_t("relative overflow-hidden",q,oe,Ee,Be),e[102]=q,e[103]=oe,e[104]=Ee,e[105]=Be,e[106]=Ae):Ae=e[106];const Dt=dt?406:cs;let Ve;e[107]!==Dt?(Ve={height:Dt},e[107]=Dt,e[108]=Ve):Ve=e[108];let Ue;e[109]!==dt?(Ue=dt&&s.jsx(tn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"loading-results-shimmer absolute inset-0 sm:rounded-3xl"},"loading-results-shimmer"),e[109]=dt,e[110]=Ue):Ue=e[110];let ze;e[111]!==Ue?(ze=s.jsx(Mo,{initial:!1,children:Ue}),e[111]=Ue,e[112]=ze):ze=e[112];let Je;e[113]!==De||e[114]!==Ke||e[115]!==p?(Je=Ke||Si(De,p),e[113]=De,e[114]=Ke,e[115]=p,e[116]=Je):Je=e[116];const ws=Et!=null?Et:"light",js=ne!=null?ne:"inline";let ds;e[117]===Symbol.for("react.memo_cache_sentinel")?(ds=()=>ts(!0),e[117]=ds):ds=e[117];let Pt;if(e[118]!==ye||e[119]!==Me||e[120]!==n||e[121]!==o||e[122]!==h||e[123]!==O||e[124]!==i||e[125]!==M||e[126]!==Ie||e[127]!==C||e[128]!==u||e[129]!==m||e[130]!==_.suggestion_message_id||e[131]!==ue||e[132]!==J||e[133]!==E||e[134]!==Pe||e[135]!==ce||e[136]!==_e||e[137]!==P||e[138]!==je||e[139]!==U){let $;e[141]!==ye||e[142]!==Me||e[143]!==n||e[144]!==o||e[145]!==h||e[146]!==O||e[147]!==i||e[148]!==M||e[149]!==Ie||e[150]!==C||e[151]!==m||e[152]!==_.suggestion_message_id||e[153]!==ue||e[154]!==E||e[155]!==Pe||e[156]!==ce||e[157]!==_e||e[158]!==P||e[159]!==je||e[160]!==U?($=be=>{const{title:Le,params:ss}=be;vs(i,"4226530095")&&Rs(i,Ma,{sendFollowUpMessage:ue,conversation:h,chatSDK:n,features:Ie,clientThreadId:o,title:Le,params:ss,html:C,attributionId:Me,widgetId:ye,widgetParent:P,suggestionMessageId:_==null?void 0:_.suggestion_message_id,widgetType:U,toolInput:Pe,toolOutput:ce,widgetState:je,toolResponseMetadata:_e,subdomain:E,domain:M,csp:O,locale:m})},e[141]=ye,e[142]=Me,e[143]=n,e[144]=o,e[145]=h,e[146]=O,e[147]=i,e[148]=M,e[149]=Ie,e[150]=C,e[151]=m,e[152]=_.suggestion_message_id,e[153]=ue,e[154]=E,e[155]=Pe,e[156]=ce,e[157]=_e,e[158]=P,e[159]=je,e[160]=U,e[161]=$):$=e[161];let me;e[162]!==n||e[163]!==o||e[164]!==i?(me=be=>Ln({ctx:i,chatSDK:n,clientThreadId:o,checkoutSession:be}),e[162]=n,e[163]=o,e[164]=i,e[165]=me):me=e[165];let ft;e[166]!==J?(ft=()=>J("inline"),e[166]=J,e[167]=ft):ft=e[167];let gt;e[168]===Symbol.for("react.memo_cache_sentinel")?(gt=be=>{const{canGoBack:Le,canGoForward:ss}=be;rs(Le),ls(ss)},e[168]=gt):gt=e[168];let pt;e[169]!==u?(pt=(be,Le)=>u.setWidgetState$(be,Le),e[169]=u,e[170]=pt):pt=e[170];let fs;e[171]!==J?(fs=be=>{const{mode:Le,title:ss}=be;return J(Le,ss)},e[171]=J,e[172]=fs):fs=e[172];let gs;e[173]!==u||e[174]!==P?(gs=(be,Le)=>u.callTool$(P,be,Le),e[173]=u,e[174]=P,e[175]=gs):gs=e[175],Pt={openExternal(be){const{href:Le}=be;Hn({ctx:i,href:Le,csp:O,domain:M})},requestModal:$,requestClose:Ra,requestCheckout:me,notifyEscapeKey:ft,notifyNavigation:gt,notifyIntrinsicHeight:H,sendFollowUpMessage:ue,updateWidgetState:pt,requestDisplayMode:fs,callTool:gs},e[118]=ye,e[119]=Me,e[120]=n,e[121]=o,e[122]=h,e[123]=O,e[124]=i,e[125]=M,e[126]=Ie,e[127]=C,e[128]=u,e[129]=m,e[130]=_.suggestion_message_id,e[131]=ue,e[132]=J,e[133]=E,e[134]=Pe,e[135]=ce,e[136]=_e,e[137]=P,e[138]=je,e[139]=U,e[140]=Pt}else Pt=e[140];let Wt;e[176]!==ye||e[177]!==Me||e[178]!==Ce||e[179]!==O||e[180]!==Ie||e[181]!==St||e[182]!==C||e[183]!==m||e[184]!==re||e[185]!==_.suggestion_message_id||e[186]!==Lt||e[187]!==E||e[188]!==Je||e[189]!==ws||e[190]!==js||e[191]!==Pt||e[192]!==Pe||e[193]!==ce||e[194]!==_e||e[195]!==P||e[196]!==je||e[197]!==U?(Wt=s.jsx(qn,{iframeRef:F,ref:k,host:"chatgpt",title:U,locale:m,html:C,csp:O,features:Ie,subdomain:E,attributionId:Me,conversationId:Ce,widgetId:ye,suggestionMessageId:_.suggestion_message_id,widgetType:U,widgetParent:P,widgetState:je,toolInput:Pe,toolOutput:ce,toolResponseMetadata:_e,maxHeight:re,theme:ws,displayMode:js,safeArea:Lt,onReady:ds,onError:St,api:Pt},Je),e[176]=ye,e[177]=Me,e[178]=Ce,e[179]=O,e[180]=Ie,e[181]=St,e[182]=C,e[183]=m,e[184]=re,e[185]=_.suggestion_message_id,e[186]=Lt,e[187]=E,e[188]=Je,e[189]=ws,e[190]=js,e[191]=Pt,e[192]=Pe,e[193]=ce,e[194]=_e,e[195]=P,e[196]=je,e[197]=U,e[198]=Wt):Wt=e[198];let Ft;e[199]!==We?(Ft=!!We&&s.jsx("div",{className:"bg-token-bg-secondary/50 pointer-events-auto absolute inset-0 z-0 flex items-center justify-center rounded-none sm:rounded-3xl"}),e[199]=We,e[200]=Ft):Ft=e[200];let $t;e[201]!==Ae||e[202]!==Ve||e[203]!==ze||e[204]!==Wt||e[205]!==Ft?($t=s.jsxs("div",{className:Ae,style:Ve,children:[ze,Wt,Ft]}),e[201]=Ae,e[202]=Ve,e[203]=ze,e[204]=Wt,e[205]=Ft,e[206]=$t):$t=e[206];let Bt;e[207]!==We||e[208]!==j||e[209]!==Ze?(Bt=Ze&&We&&s.jsx(tn.div,{className:_t("pointer-events-none absolute inset-0 z-10 flex justify-center",j?"top-(--header-height) items-center":"items-start pt-10"),initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:.1,duration:.24},children:We}),e[207]=We,e[208]=j,e[209]=Ze,e[210]=Bt):Bt=e[210];let us;e[211]!==$e||e[212]!==T||e[213]!==B||e[214]!==R||e[215]!==$t||e[216]!==Bt?(us=s.jsxs("div",{className:$e,style:T,children:[B,R,$t,Bt]}),e[211]=$e,e[212]=T,e[213]=B,e[214]=R,e[215]=$t,e[216]=Bt,e[217]=us):us=e[217];const Cs=us,Es=I||wt,Ns=!G&&!I&&n.distributionChannel!==Os.OPENAI;let Vt;e[218]!==j?(Vt=j&&s.jsx("div",{className:"bg-token-bg-primary fixed start-0 end-0 top-0 bottom-0 z-10"}),e[218]=j,e[219]=Vt):Vt=e[219];let Ut;e[220]!==n||e[221]!==Ce||e[222]!==b||e[223]!==N||e[224]!==w||e[225]!==Ns||e[226]!==pe?(Ut=Ns&&s.jsx("div",{className:"mt-2 sm:mt-4",children:s.jsx(Yi,{withMarginBottom:!0,onClick:pe?()=>window.open(pe,"_blank","noopener,noreferrer"):void 0,isLoading:b,logoUrl:N,name:w,conversationId:Ce,chatSDK:n})}),e[220]=n,e[221]=Ce,e[222]=b,e[223]=N,e[224]=w,e[225]=Ns,e[226]=pe,e[227]=Ut):Ut=e[227];let zt;e[228]!==Nt||e[229]!==Es||e[230]!==I||e[231]!==Cs?(zt=Es?s.jsx("div",{className:_t(I&&"mt-2"),children:s.jsx(Zi,{onClickRetry:Nt})}):Cs,e[228]=Nt,e[229]=Es,e[230]=I,e[231]=Cs,e[232]=zt):zt=e[232];let Gt;e[233]!==Fe||e[234]!==j||e[235]!==L?(Gt=!j&&!L&&!Fe&&s.jsx("div",{className:"bg-token-border-default my-3 h-px w-full"}),e[233]=Fe,e[234]=j,e[235]=L,e[236]=Gt):Gt=e[236];let qt;e[237]!==n||e[238]!==Ce||e[239]!==Fe||e[240]!==G||e[241]!==N?(qt=!G&&!Fe&&s.jsx(Vn,{mode:"block",withMarginBottom:!0,conversationId:Ce,chatSDK:n,logoUrl:N}),e[237]=n,e[238]=Ce,e[239]=Fe,e[240]=G,e[241]=N,e[242]=qt):qt=e[242];let ms;return e[243]!==Vt||e[244]!==Ut||e[245]!==zt||e[246]!==Gt||e[247]!==qt?(ms=s.jsxs(s.Fragment,{children:[Vt,Ut,zt,Gt,qt]}),e[243]=Vt,e[244]=Ut,e[245]=zt,e[246]=Gt,e[247]=qt,e[248]=ms):ms=e[248],ms},La=t=>{"use forget";const e=de.c(15),{messages:n,clientThreadId:o,onRequestCompletion:a,isLastMessageInTurn:r}=t;let i;e[0]!==n?(i=ln(n),e[0]=n,e[1]=i):i=e[1];const l=i,c=Zt();let f,m;e[2]!==o||e[3]!==c?(f=as(c,o),m=Us(f),e[2]=o,e[3]=c,e[4]=f,e[5]=m):(f=e[4],m=e[5]);const h=m;let x;e[6]!==l||e[7]!==f||e[8]!==h?(x=()=>{if(!l.sessionId||h.isPinned$(l))return!0;const v=Co(f);for(let g=v.length-1;g>=0;g--){const{messages:p}=v[g];let d;try{d=ln(p)}catch(C){continue}if(d==null)continue;const{sessionId:b,invocationUuid:I}=d;if(b&&b===l.sessionId)return I===l.invocationUuid}return!0},e[6]=l,e[7]=f,e[8]=h,e[9]=x):x=e[9];const u=Ne(x);if(l.isError||!u)return null;let y;return e[10]!==l||e[11]!==o||e[12]!==r||e[13]!==a?(y=s.jsx(Aa,{clientThreadId:o,onRequestCompletion:a,isLastMessageInTurn:r,chatSDK:l}),e[10]=l,e[11]=o,e[12]=r,e[13]=a,e[14]=y):y=e[14],y},Oa=t=>{"use forget";const e=de.c(5),{messages:n,clientThreadId:o,onRequestCompletion:a,isLastMessageInTurn:r}=t,i=Zt();if(vs(i,"1037317296"))return null;let l;return e[0]!==o||e[1]!==r||e[2]!==n||e[3]!==a?(l=s.jsx(jo,{name:"ChatSDKContent",children:s.jsx(La,{messages:n,clientThreadId:o,onRequestCompletion:a,isLastMessageInTurn:r})}),e[0]=o,e[1]=r,e[2]=n,e[3]=a,e[4]=l):l=e[4],l};function Ra(){}const Da=X(()=>V(()=>import("./ewkru1hsxkjpuxt5.js").then(t=>t._),__vite__mapDeps([18,1])),{loading:t=>ee(t)}),Pa=X(()=>V(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yA),__vite__mapDeps([6,1,7,8,9])),{loading:t=>ee(t)});function Wa({messageMetadata:t}){const[e,n]=W.useState(!1);return s.jsxs("div",{className:"my-2 flex flex-col text-sm",children:[s.jsxs("div",{className:"flex flex-row items-center hover:cursor-pointer",onClick:()=>{n(!e)},children:[e?s.jsx(Pa,{className:"icon-sm"}):s.jsx(Da,{className:"icon-sm"}),s.jsx("div",{className:"font-semibold",children:t.display_message})]}),e&&s.jsx("pre",{children:JSON.stringify(t.data,null,2)})]})}function Fa({debugMessages:t}){return t.length===0?null:s.jsx("div",{children:t.map((e,n)=>{var a,r;const o=(r=(a=e.metadata)==null?void 0:a.jit_plugin_data)==null?void 0:r.from_server;return o&&o.type==="debug"?s.jsx(Wa,{messageMetadata:o.body},n):null})})}const Kn="openaiFileIdRefs",$a=["send_email","batch_modify_email","create_event","update_event","delete_event"];function Ba({name:t,params:e,result:n,privacyPolicyUrl:o,isPromptingForPermission:a}){var l;const i=((l=e==null?void 0:e[Kn])!=null?l:[]).map((c,f)=>{const m=c.name.startsWith("dalle-");let h=c.name;return m&&(h="".concat(h,".webp")),s.jsx(Nn,{file:h,fileId:c.id},f)});return s.jsxs("div",{className:"divide-token-border-default border-token-border-default mt-1 mb-4 divide-y overflow-hidden rounded-xl border",children:[t&&s.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary px-4 py-2 text-sm",children:s.jsx(Q,{id:"JITPluginMessage.params.toolCall",defaultMessage:"Tool call: {name}",values:{name:s.jsx("span",{className:"text-token-text-primary",children:t})}})}),e&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-token-bg-tertiary text-token-text-secondary flex justify-between px-4 py-2 text-sm",children:[a?s.jsx(Q,{id:"JITPluginMessage.params.sharing.present",defaultMessage:"The following will be shared:"}):s.jsx(Q,{id:"JITPluginMessage.params.sharing.past",defaultMessage:"The following was shared:"}),o&&s.jsx("a",{href:To(o),className:"text-token-text-primary",target:"_blank",rel:"noreferrer",children:s.jsx(Q,Y({},Ge.privacyPolicyLink))})]}),s.jsx("div",{className:"px-4 py-2",children:s.jsx(Ps,{value:e})}),i.length>0&&s.jsx("div",{className:"px-4 py-2",children:i})]}),n&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-token-bg-tertiary text-token-text-secondary flex justify-between px-4 py-2 text-sm",children:s.jsx(Q,{id:"JITPluginMessage.params.result",defaultMessage:"Result:"})}),s.jsx("div",{className:"px-4 py-2",children:s.jsx(Ps,{value:n})})]})]})}var yn;const Va=Xt.div(yn||(yn=ht(["h-px bg-token-border-default"])));var bn;const pn=Xt.div(bn||(bn=ht(["text-sm font-medium py-3 leading-6"])));var vn;const Ua=Xt.div(vn||(vn=ht(["my-4 p-5 w-full rounded-2xl popover bg-token-main-surface-primary shadow-lg border border-token-border-default"]))),za=":",Ga=({functionName:t,parameters:e,onClick:n,isDraft:o=!0,isCanceled:a=!1})=>{const r=Qt(),i=Object.entries(e).filter(([l,c])=>!c||l==="timezone_str"&&c===Intl.DateTimeFormat().resolvedOptions().timeZone?!1:c.length>0);return s.jsxs(Ua,{children:[s.jsx("div",{className:"mb-4 flex items-center font-semibold",children:s.jsx("div",{children:o?Fs(t):qa(t,r)})}),i.map(([l,c])=>s.jsxs("div",{children:[s.jsx(Va,{}),s.jsxs("div",{className:"flex",children:[s.jsxs(pn,{className:"text-token-text-tertiary me-1",children:[Fs(l),za]}),s.jsx(pn,{className:"whitespace-pre-line",children:Jn(c,r)})]})]},l)),o&&!a&&s.jsx("div",{className:"mt-2 flex justify-end gap-4",children:s.jsx(Qe,{color:"primary",className:"py-2",onClick:n,children:r.formatMessage(ys.approveButton)})}),a&&s.jsx("div",{className:"mt-2 flex justify-end gap-4",children:s.jsx(Qe,{color:"primary",className:"py-2",disabled:!0,children:r.formatMessage(ys.canceledButton)})})]})},qa=(t,e)=>{switch(t){case"create_event":return"Created Event ✅";default:return"".concat(Fs(t)," ").concat(e.formatMessage(ys.completedAction)," ✅")}},Fs=t=>{switch(t){case"timezone_str":return"Timezone";default:return t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}},Jn=(t,e)=>{if(Array.isArray(t))return t.map(a=>Jn(a,e)).join(e.formatMessage(ys.valueSeparator));if(typeof t=="object")return JSON.stringify(t);if(t.match(/^\s*\d{4}-\d{2}-\d{2}/)==null)return t;const o=new Date(t);return Number.isNaN(o.getTime())?t:e.formatDate(o,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})},ys=bs({approveButton:{id:"ParametersView.approveButton",defaultMessage:"Approve"},completedAction:{id:"ParametersView.completedAction",defaultMessage:"Completed"},canceledButton:{id:"ParametersView.canceledButton",defaultMessage:"Canceled"},valueSeparator:{id:"ParametersView.valueSeparator",defaultMessage:","}}),Yn="api_tool.list_resources",Qn="api_tool.search_tools",Ha="api_tool",Ka=new Set([Yn,Qn,Ha]),Ja=t=>Ka.has(t);function Ya(t,e,n,o,a,r=null){const i=Qa(e,o,a,r);return i?typeof i=="string"?i:t.formatMessage(i,n):null}function Qa(t,e,n,o=null){if(![D.Finished,D.Running,D.Stopped].includes(n)||!e)return t;switch(e){case Yn:{const a=o==null?void 0:o[n];return a!=null?a:n===D.Finished||n===D.Stopped?Kt({id:"OdEouq",defaultMessage:"Looked for available tools"}):Kt({id:"hSyoq0",defaultMessage:"Looking for available tools"})}case Qn:{const a=o==null?void 0:o[n];return a!=null?a:n===D.Finished||n===D.Stopped?Kt({id:"4et5qC",defaultMessage:"Searched tools"}):Kt({id:"V0IDh0",defaultMessage:"Searching tools"})}case"api_tool.call_tool":{const a=o==null?void 0:o[n];return a!=null?a:n===D.Finished||n===D.Stopped?Kt({id:"NTASw4",defaultMessage:"Called tool"}):Kt({id:"gc64KQ",defaultMessage:"Calling tool"})}}return t}const Xa=X(()=>V(()=>import("./bgxcag65uz54fc39.js").then(t=>t._),__vite__mapDeps([19,1])),{loading:t=>ee(t)}),Za=X(()=>V(()=>import("./op4cc948p930ctfd.js").then(t=>t._),__vite__mapDeps([20,1])),{loading:t=>ee(t)}),er=X(()=>V(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yA),__vite__mapDeps([6,1,7,8,9])),{loading:t=>ee(t)}),tr=(t,e)=>{const n=t.recipient==="api_tool.call_tool",o=["mcp://komi","mcp://kakao"],a=rn(t).toLowerCase(),r=n&&o.some(l=>a.includes(l));let i=!1;if(r&&e){const l=rn(e);if(l){let c;try{c=JSON.parse(l)}catch(f){}i=typeof c=="object"&&c!==null&&"widget"in c}}return{calledKakoMCP:r,displayedWidget:i}};function fr({messages:t,nextMessage:e,clientThreadId:n,isLastMessageInTurn:o,isLastTurnInConversation:a,connectorFixture:r,onRequestCompletion:i}){var Ze,ts,jt,rs,Ct,ls,Et,Fe,et,J,tt,st,nt,Nt,ot,St,it,Mt,Tt,at,It,rt,At,lt,Lt,cs,ct,We,dt,ut,pe,mt,Ce,Ie,Ot,Rt,$e;const l=Zt(),[c,f]=oo(),{assistantMessage:m,toolMessages:h,debugMessages:x}=Sn(t),u=(Ze=m.recipient)!=null?Ze:"",y=kn(),v=Io(n),{addSource:g}=ti(n),{uiState:p,jitPluginData:d,fileAttachments:b,invokedPlugin:I,lastConfirmActionJitPluginData:C}=zs(t,o),M=Qt(),E=Ao(),[w,N,O]=Lo(n,T=>{var R,q,oe;const B=(q=(R=m.metadata)==null?void 0:R.gizmo_id)!=null?q:T?Ls.getGizmoId(T):E;return[B,ii(T==null?void 0:T.mode,B),(oe=T==null?void 0:T.conversationOrigin)!=null?oe:null]}),L=h.length>0?h[h.length-1]:void 0,z=tr(m,L);if(z.calledKakoMCP&&!z.displayedWidget)return null;const P=z.displayedWidget,U=si(N)&&N.gizmo_id===w,_=(ts=Oo(w,U))==null?void 0:ts.data,[S,H]=W.useState(!1),[k,F]=W.useState(!1),A=sn(m.recipient);let se;if((A==null?void 0:A.functionName)!=null&&(_==null?void 0:_.tools)!=null){for(const T of _.tools)if(ri(T,A.functionName)){se=T;break}}const ue=(jt=sn(e==null?void 0:e.recipient))==null?void 0:jt.namespace,{connectorId:he,connectorToolStatus:ge,connectorStatusMessage:te,showConnectorConnect:G}=li(A==null?void 0:A.namespace,ue,h,a),ae=Ne(()=>En(l)),Z=$s(!0,Ro.JIT_PLUGIN),K=r!=null?r:Z.platformConnectors.get(he!=null?he:""),ne=Do();let j=((rs=d==null?void 0:d.from_server)==null?void 0:rs.type)!=="denied_by_user"?(Ct=d==null?void 0:d.from_server)==null?void 0:Ct.body.domain:(ls=se==null?void 0:se.metadata)==null?void 0:ls.domain,xe=null,we=null;if(!j&&(A!=null&&A.functionName)&&A.namespace==="kanzi_app"){const[T,B]=A.functionName.split("/");j=T.replace(/_/g," "),xe=s.jsx(Vo,{openNewTab:!0,className:"text-token-text-secondary pt-1 opacity-0 transition-opacity duration-200 group-hover/tool-message:opacity-100",href:"/kanzi/studio/c/".concat(B),children:s.jsx(Xa,{})})}ae&&u==="api_tool.call_tool"&&(we=s.jsx("button",{onClick:()=>ai(as(l,n)).focusMessage$(m.id),className:"text-token-text-secondary",children:s.jsx(Za,{})})),j?j.endsWith("__jit_plugin")&&(j=j.slice(0,-12)):j="connector";const re=(Et=se==null?void 0:se.metadata)==null?void 0:Et.privacy_policy_url;W.useEffect(()=>{var R,q;if(((R=ci(d==null?void 0:d.from_client))==null?void 0:R.type)==="oauth_success")return;const T=c.get("oauth_success"),B=c.get("system_hint");if(((q=d==null?void 0:d.from_server)==null?void 0:q.type)==="oauth_required"&&T){f(oe=>(oe.delete("oauth_success"),oe.delete("system_hint"),oe),{replace:!0});for(const oe of d.from_server.body.actions)if(oe.type==="oauth_redirect"){const Ee="jit_oauth_success:".concat(oe.oauth_redirect.target_message_id);if(sessionStorage.getItem(Ee))return;sessionStorage.setItem(Ee,"1"),yt({eventSource:"url",assistantMessage:m,onRequestCompletion:i,actionData:{type:"oauth_success",target_message_id:oe.oauth_redirect.target_message_id},clientThreadId:n,activeSystemHint:B||null});return}}},[N,m,t,n,i,d,a,c,f,y,g]),W.useEffect(()=>{var R;const T=c.get("link_success"),B=c.get("oauth_success");if((T||B)&&((R=d==null?void 0:d.from_server)==null?void 0:R.type)==="link_required"){f(q=>(q.delete("link_success"),q.delete("oauth_success"),q.delete("system_hint"),q),{replace:!0});for(const q of d.from_server.body.actions)if(q.type==="link_created"){yt({eventSource:"url",assistantMessage:m,onRequestCompletion:i,actionData:{type:"link_success",target_message_id:q.link_created.target_message_id},clientThreadId:n,activeSystemHint:y!=null?y:null});return}}},[c,f,m,n,i,d,y]);const le=l&&vs(l,"2792858552");let ie=Jt.Running,Re=j?Ge.running:Ge.starting,es={domain:j};if(p===D.Hidden)return null;if(p===D.OauthLogin||p===D.UserConfirmation||p===D.NoAuthLink){ie=Jt.Paused,Re=Ge.confirmingSimple;const T={gizmoName:(Fe=_==null?void 0:_.gizmo.display.name)!=null?Fe:"ChatGPT",domain:j};es=fe(Y({},T),{title:B=>s.jsxs("div",{className:"inline-flex items-center gap-1 text-sm",children:[B,s.jsx(er,{className:"icon-sm"})]}),subtitle:B=>s.jsx("div",{className:"text-xs",children:B})})}else p===D.Finished?(ie=Jt.Finished,Re=Ge.finished,es={domain:j}):p===D.Error?(ie=Jt.Error,Re=Ge.error):(p===D.Stopped||p===D.Denied)&&(ie=Jt.Stopped,Re=p===D.Denied?Ge.declined:Ge.stopped);const De=((et=d==null?void 0:d.from_server)==null?void 0:et.type)!=="denied_by_user"?(J=d==null?void 0:d.from_server)==null?void 0:J.body.actions.map((T,B)=>s.jsx(An,{clientThreadId:n,messages:t,onRequestCompletion:i,action:T,domain:j,handleUserAction:yt,rememberAnswer:S},B)):null;let Xe=null;((tt=m.metadata)!=null&&tt.tool_invoking_message||(st=m.metadata)!=null&&st.tool_invoked_message||(Nt=(nt=m.metadata)==null?void 0:nt.chatgpt_sdk)!=null&&Nt.tool_invoking_message||(St=(ot=m.metadata)==null?void 0:ot.chatgpt_sdk)!=null&&St.tool_invoked_message)&&(Xe={[D.Running]:(It=(at=(Mt=(it=m.metadata)==null?void 0:it.chatgpt_sdk)==null?void 0:Mt.tool_invoking_message)!=null?at:(Tt=m.metadata)==null?void 0:Tt.tool_invoking_message)!=null?It:void 0,[D.Finished]:(cs=(Lt=(At=(rt=m.metadata)==null?void 0:rt.chatgpt_sdk)==null?void 0:At.tool_invoked_message)!=null?Lt:(lt=m.metadata)==null?void 0:lt.tool_invoked_message)!=null?cs:void 0,[D.Stopped]:(pe=(ut=(We=(ct=m.metadata)==null?void 0:ct.chatgpt_sdk)==null?void 0:We.tool_invoked_message)!=null?ut:(dt=m.metadata)==null?void 0:dt.tool_invoked_message)!=null?pe:void 0});const Pe=Ya(M,Re,es,u,p,Xe);if(Ja(u)&&!o&&!ae)return null;const ce=Tn(t,o),je=di(t,o),_e=ui(t),kt=(mt=ce==null?void 0:ce[Kn])!=null?mt:[],ye=(!hs(t)||ae)&&(!!ce||!!_e||kt.length>0)&&(A==null?void 0:A.functionName)!=="list_resources"&&p!==D.Running,Me=In(t,o),Ke=Mn(t,o),ks=hs(t)&&p!==D.Denied&&!ae;let wt=s.jsx(s.Fragment,{});const Te=mi(t,o);if($a.includes(Te)&&(p===D.UserConfirmation||p===D.Finished||p===D.Stopped||p===D.Denied)){const T=p!==D.Finished,B=(p===D.Stopped||p===D.Denied)&&!a,R=(Ce=dn(d,I))!=null?Ce:dn(C,void 0),q=oe=>{var Ee,Be,Ae,Dt,Ve,Ue,ze;((Ee=d==null?void 0:d.from_server)==null?void 0:Ee.type)==="confirm_action"&&((Dt=(Ae=(Be=d==null?void 0:d.from_server)==null?void 0:Be.body)==null?void 0:Ae.actions)==null?void 0:Dt[0].type)==="allow"&&(yt({clientThreadId:n,assistantMessage:m,onRequestCompletion:i,sourceEvent:oe,actionData:fe(Y({type:"allow"},(ze=(Ue=(Ve=d==null?void 0:d.from_server)==null?void 0:Ve.body)==null?void 0:Ue.actions)==null?void 0:ze[0].allow),{remember_answer:S}),activeSystemHint:y}),Bo(n,Je=>{Je.scrollToMessageId=n}))};switch(Te){case"send_email":wt=s.jsx(ki,{to:R==null?void 0:R.to,cc:R==null?void 0:R.cc,bcc:R==null?void 0:R.bcc,subject:R==null?void 0:R.subject,body:R==null?void 0:R.body,onClick:p===D.UserConfirmation?q:()=>{},isDraft:T,isCanceled:B});break;default:wt=s.jsx(Ga,{functionName:Te!=null?Te:"",parameters:R!=null?R:{},onClick:p===D.UserConfirmation?q:()=>{},isDraft:T,isCanceled:B});break}}else(p===D.UserConfirmation||p===D.NoAuthLink||p===D.OauthLogin)&&De&&!je&&(wt=s.jsx(s.Fragment,{children:s.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[De,((Ie=d==null?void 0:d.from_server)==null?void 0:Ie.type)==="confirm_action"&&Ke?s.jsx("div",{className:"flex gap-2 text-sm",children:s.jsx(ni,{id:"dont-ask-again",label:s.jsx(Q,Y({},Ge.rememberForThisConversation)),checked:S,onChange:T=>H(T.target.checked)})}):null]})}));return d==null||d.from_server,he?s.jsxs(s.Fragment,{children:[te&&s.jsx(cn,{highlightedCommand:K?M.formatMessage(te,{domain:K.name}):s.jsx("br",{}),status:ge,showWorkUserSetting:!1}),G&&K&&s.jsx("div",{className:"mb-2 flex gap-2",children:s.jsx(_i,{connector:K,clientThreadId:n,hasWidget:hs(t),onConnect:()=>{var q;const T=Vs(n),B=T?new URL(Wo(T),window.location.origin):new URL(window.location.href);B.searchParams.set("oauth_success","true"),y&&B.searchParams.set("system_hint",y);const R=((q=d==null?void 0:d.from_server)==null?void 0:q.type)==="oauth_required"?"OAUTH":le?void 0:"NONE";ne({connectorId:K.id,redirectAfter:B.toString(),referrer:Fo.JitPluginMessage,authTypeOverride:R}),nn(K.id,an.ConnectorPromptAccept,fe(Y({},on({clientThreadId:T!=null?T:n})),{auth_type_override:R!=null?R:"",supports_mixed_auth:K.supported_auth.length>1?"true":"false"}))},onProceedWithoutConnecting:T=>{var R,q,oe,Ee;const B=(R=d==null?void 0:d.from_server)==null?void 0:R.type;if(B==="oauth_required"||B==="link_required"){for(const Be of(oe=(q=d==null?void 0:d.from_server)==null?void 0:q.body.actions)!=null?oe:[])if(Be.type==="deny"){const Ae=Be.deny.target_message_id;yt({eventSource:oi(T),assistantMessage:m,onRequestCompletion:i,actionData:{type:"deny",target_message_id:Ae},clientThreadId:n,activeSystemHint:y}),nn(K.id,an.ConnectorPromptReject,on({clientThreadId:v!=null?v:n})),(Ee=K==null?void 0:K.branding)!=null&&Ee.is_discoverable_app&&Po.safePost("/system_hints/suggestion_cooldown",{requestBody:{system_hint:"connector:".concat(K.id)}});return}}}})})]}):s.jsxs(s.Fragment,{children:[s.jsx(Fa,{debugMessages:x}),P?s.jsx(mn,{isWrite:p===D.UserConfirmation,functionName:(Ot=m.recipient)!=null?Ot:Te,params:ce,result:_e,toolCallSafetySummary:je,messages:t,clientThreadId:n,jitPluginData:d!=null?d:{},onRequestCompletion:i,rememberForThisConversation:S,isChatkitWidget:P}):!ks&&!0&&s.jsx("span",{className:"group/tool-message",children:s.jsx(cn,{highlightedCommand:Pe,status:ie,showWorkUserSetting:!1,accessory:xe,labelPrefix:we,forceExpanded:p===D.UserConfirmation,children:ye?(A==null?void 0:A.namespace)==="api_tool"?Me?null:s.jsx(mn,{isWrite:p===D.UserConfirmation,functionName:(Rt=m.recipient)!=null?Rt:Te,params:ce,result:_e,toolCallSafetySummary:je,messages:t,clientThreadId:n,jitPluginData:d!=null?d:{},onRequestCompletion:i,rememberForThisConversation:S,conversationOrigin:O}):s.jsx(Ba,{privacyPolicyUrl:re,name:($e=m.recipient)!=null?$e:Te,params:ce,result:_e,isPromptingForPermission:ie===Jt.Paused}):null})}),s.jsx("div",{className:"mt-1 flex flex-wrap gap-2 empty:hidden",children:b==null?void 0:b.map(T=>s.jsx(Nn,{file:T.name,fileId:T.id,width:"wide",alwaysShowData:!0,showDownloadButton:!0,downloadLink:T.download_url,contextConnectorInfo:$o(T.context_connector_info)},T.id))}),hs(t)&&p!==D.Denied&&s.jsx(Oa,{clientThreadId:n,messages:t,isLastMessageInTurn:o,onRequestCompletion:i}),!Me&&wt]})}export{fr as JITPluginMessage};
//# sourceMappingURL=iqrk783zq1vw1xti.js.map
