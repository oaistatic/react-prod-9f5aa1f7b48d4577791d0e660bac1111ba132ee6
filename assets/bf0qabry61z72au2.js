const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/3j20em1lilnrpdcm.js","assets/i8clt0mfz495j7ii.js"])))=>i.map(i=>d[i]);
import{r as E,e as W,j as o,f as $,_ as q}from"./i8clt0mfz495j7ii.js";import{u as B,E as Q,b1 as X,gU as D,gX as J,jm as K,gS as Y,d as w,b0 as Z,o as ee,L as se,fz as A}from"./ghewn7l2ynbm32fm.js";import{gj as P,gk as ae,gl as te,S as ne,cQ as oe,ch as re,gm as ie,gn as le,go as de}from"./j0yo6uv6652vva62.js";const ce=ee(()=>q(()=>import("./3j20em1lilnrpdcm.js").then(e=>e._),__vite__mapDeps([0,1])),{loading:e=>se(e)});function ge({asset:e,contextConnectorSourceUrl:r,disableExpandable:d=!1,isSingle:c,isUserTurn:u,className:i}){var T,b;const n=B(),l=Q(n).flags,[f,s]=E.useState(!1),{isUnauthenticated:t}=X(),g=l==null?void 0:l.includes(D.NoAuthEnableFileUploads),h=J(e.asset_pointer),a=P.useState(V=>P.selectFile(V,h)),M=ae((T=a==null?void 0:a.file)!=null?T:null,a==null?void 0:a.file.name,(b=a==null?void 0:a.fileId)!=null?b:void 0,a==null?void 0:a.gizmoId,a==null?void 0:a.contextConnectorInfo,!0),_=t&&a&&g,{gizmoEditorData:x}=K(),v=te(),y=E.useContext(ne),z=(y==null?void 0:y.serverSharedThreadId)&&u,O=Y(),{isOpen:G}=oe(),j=W(),{data:F,isLoading:k,error:H}=re({asset:e,gizmoId:x==null?void 0:x.id,getServerUrl:!_}),{url:S,width:I,height:C}=M&&g?{width:e.width,height:e.height,url:M}:F!=null?F:{},N=k||!f,p=I&&C?{Landscape:I>C,Portrait:I<C}:void 0,m=["overflow-hidden rounded-lg"];if(c&&(m.push("w-full h-full"),p!=null&&p.Landscape?m.push("max-w-96 max-h-64"):p!=null&&p.Portrait?m.push("max-h-96 max-w-64"):m.push("max-w-64 max-h-64")),i&&m.unshift(i),z&&O())return null;let L;return S!=null&&(L=o.jsx(ie,{alt:j.formatMessage(U.imageAltText),className:w(G?"max-w-[88px]":"max-w-full",!c&&"aspect-square","object-cover object-center",m),src:S,width:I,height:C,onLoad:()=>s(!0)}),!v&&!d&&(L=o.jsx(le,{src:S,alt:j.formatMessage(U.imageAltText),contextConnectorSourceUrl:r,className:w(m),children:L}))),o.jsx("div",{className:w(m),children:o.jsx("div",{className:w("bg-token-main-surface-secondary text-token-text-tertiary relative flex h-auto w-full max-w-lg items-center justify-center overflow-hidden",!c&&"aspect-square"),children:S!=null?L:o.jsx("div",{className:"flex items-center justify-center",style:{aspectRatio:"".concat(I," / ").concat(C),width:I},title:N?j.formatMessage(U.loadingImage):j.formatMessage(U.errorLoadingImage),children:N?o.jsx(Z,{}):H?o.jsx(ce,{className:"icon-sm"}):null})})})}const U=$({loadingImage:{id:"textMessage.loadingImage",defaultMessage:"Loading..."},errorLoadingImage:{id:"textMessage.errorLoadingImage",defaultMessage:"Could not load image"},imageAltText:{id:"textMessage.imageAltText",defaultMessage:"Uploaded image"},targetedReply:{id:"textMessage.targetedReply",defaultMessage:"Replying to:"}});function R({assets:e,attachments:r,isUserTurn:d=!0,clientThreadId:c}){const u=e.length===1,{containerClassname:i,imageClassnames:n}=R.computeClassnames(e.length);let l=A.ATTACHMENT;return e&&!(r&&r.length>0)&&(l=A.IMAGE),o.jsxs("div",{className:"flex w-[var(--user-chat-width,70%)] flex-col items-end",children:[o.jsx("div",{className:w("flex flex-row items-center justify-end gap-1",i),children:e.map((f,s)=>{var g;const t=r==null?void 0:r.find(h=>h.id&&f.asset_pointer.includes(h.id));return o.jsx(ge,{asset:f,isSingle:u,isUserTurn:d,contextConnectorSourceUrl:(g=t==null?void 0:t.context_connector_info)==null?void 0:g.source_url,className:n[s]},s)})}),o.jsx(de,{featureType:l,isUserTurn:d,clientThreadId:c})]})}R.computeClassnames=e=>{if(e<2)return{containerClassname:null,imageClassnames:[]};let r=e>=4?"flex-wrap":"";const d=Array(e),c=s=>{d.fill(s)},u=s=>{r+=" ".concat(s)},i=(s,t)=>{d[s]=w(d[s],t)},n=e<=4&&e%2===0?2:3,l=Math.ceil(e/n),f=e%n!==0;n===2?(c("h-32 w-32"),u("max-w-72")):l<=2?(c("h-24 w-24 sm:h-32 sm:w-32"),u("max-w-80 sm:max-w-100")):(c("h-16 w-16"),u("max-w-52"));for(let s=0;s<e;s++){const t=Math.floor(s/n),g=s%n,h=Math.min(e-t*n,n),a=t===0,M=t===l-1,_=t===l-2,x=g===0,v=g===h-1;a&&x&&i(s,"rounded-ss-2xl"),a&&v&&i(s,"rounded-se-2xl"),M&&x&&i(s,"rounded-es-2xl"),M&&v&&i(s,"rounded-ee-sm"),f&&x&&_&&i(s,"rounded-es-2xl")}return{containerClassname:r,imageClassnames:d}};export{R as TextMessageImageGroup};
//# sourceMappingURL=bf0qabry61z72au2.js.map
