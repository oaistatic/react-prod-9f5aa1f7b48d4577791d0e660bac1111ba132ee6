const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/gsas8pb1acnf7jnd.js","assets/i8clt0mfz495j7ii.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/j2k7r2f0maz0c5g5.js","assets/88dcy8w0nw3pooi2.js","assets/mtsfsh7z74bmo6ig.js","assets/f2itj05whsmn3kgs.js","assets/mbhfxri3syrb9rbq.js","assets/fwyctp3zfyh6emd2.js"])))=>i.map(i=>d[i]);
var ce=Object.freeze,ue=Object.defineProperty,De=Object.defineProperties;var Oe=Object.getOwnPropertyDescriptors;var ge=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var me=(e,t,n)=>t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Y=(e,t)=>{for(var n in t||(t={}))Te.call(t,n)&&me(e,n,t[n]);if(ge)for(var n of ge(t))Ae.call(t,n)&&me(e,n,t[n]);return e},Z=(e,t)=>De(e,Oe(t));var ie=(e,t)=>ce(ue(e,"raw",{value:ce(t||e.slice())}));import{_ as S,e as ne,r as _,j as a,f as je,M as fe}from"./i8clt0mfz495j7ii.js";import{o as V,L as P,lf as Le,ar as Re,a7 as Fe,ai as Ge,a8 as Be,a9 as ze,ad as We,d as O,ah as $e,$ as K,aW as He,aV as se,cm as xe,ff as ye,u as Ue,as as Qe,cn as qe,F as Me,f as Je,W as Ke,cH as Xe,cJ as Ye,S as ee,P as ae,gX as te,e as Ze}from"./ghewn7l2ynbm32fm.js";import{ig as ea,ih as aa,bR as ta,ii as sa,bO as T,gr as na,ij as ia,ik as X,cZ as oa,c_ as ke,cQ as la,gl as ra,il as da,gm as ca,im as ga,io as ma,ae as ua}from"./j0yo6uv6652vva62.js";import{D as Ce,u as fa,I as oe}from"./emrxz4v8n4klxny6.js";import{D as xa}from"./lktqd4c5dfo8cx5l.js";import"./pbvsc3do5o365cxq.js";const ha=V(()=>S(()=>import("./gsas8pb1acnf7jnd.js").then(e=>e._),__vite__mapDeps([0,1])),{loading:e=>P(e)}),pa=V(()=>S(()=>import("./ghewn7l2ynbm32fm.js").then(e=>e.vJ),__vite__mapDeps([2,1,3])),{loading:e=>P(e)}),Ia=V(()=>S(()=>import("./j2k7r2f0maz0c5g5.js").then(e=>e._),__vite__mapDeps([4,1])),{loading:e=>P(e)}),_a=V(()=>S(()=>import("./88dcy8w0nw3pooi2.js").then(e=>e._),__vite__mapDeps([5,1])),{loading:e=>P(e)}),va={enter:e=>({zIndex:0,x:e===-1?"10%":"-10%",opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:e=>({zIndex:0,x:e===1?"10%":"-10%",opacity:0})},wa={enter:{opacity:0,y:"10%"},visible:{opacity:1,y:0},exit:{opacity:0,y:"10%"}},he=1e3,pe=1e3,Ie=(e,t)=>Math.abs(e)*t;function ba(e){var v,M;const t=ne(),n=Le(),l=Re(),[u,b]=_.useState({width:0,height:0}),[m,c]=_.useState(!1),[r,f]=_.useState(e.image),[I,C]=_.useState(!1),E=u.width>0&&u.height>0,y=_.useRef(null),[N,w]=_.useState(0);_.useEffect(()=>{if(!r.url)throw new Error("ExpandableImage requires a src");const s=new Image;s.onload=()=>{b({width:s.naturalWidth,height:s.naturalHeight})},s.onerror=()=>{},s.src=r.url},[r.url]),_.useEffect(()=>{const s=y.current;if(I)return s==null||s.addEventListener("keydown",d),()=>{s==null||s.removeEventListener("keydown",d)};f(e.image)},[I]);function o(){f(s=>{const h=(e.images.findIndex(p=>p.url===s.url)+1)%e.images.length;return e.images[h]}),w(-1)}function x(){f(s=>{const g=e.images.findIndex(p=>p.url===s.url),h=g>0?(g-1)%e.images.length:e.images.length-1;return e.images[h]}),w(1)}function i(s){var g;C(s),s&&((g=e.onOpen)==null||g.call(e,r))}function d(s){s.key==="ArrowLeft"?x():s.key==="ArrowRight"&&o()}const j=e.images.findIndex(s=>s.url===r.url);return a.jsxs(Fe,{onOpenChange:i,children:[a.jsx(Ge,{disabled:!E,className:e.className,"aria-label":t.formatMessage(D.showImage),children:e.children}),a.jsx(Be,{container:n==null?void 0:n.document.body,children:a.jsx(ze,{className:"radix-state-open:animate-show fixed inset-0 z-20 flex items-center justify-center bg-black/90 backdrop-blur-xl",children:a.jsxs(We,{className:O("radix-state-open:animate-contentShow relative flex h-[100dvh] w-screen justify-stretch divide-x divide-white/10 focus:outline-hidden"),ref:y,children:[a.jsx("div",{className:O("flex flex-1 transition-[flex-basis]",!m&&"md:basis-[75vw]"),children:a.jsxs("div",{className:"flex flex-1 flex-col md:p-6",children:[a.jsxs("div",{className:"flex justify-between px-6 py-2 pt-6 text-white sm:mb-4 md:mt-2 md:px-0 md:py-2",children:[a.jsx($e,{asChild:!0,children:a.jsx("button",{"aria-label":t.formatMessage(D.closeModal),children:a.jsx(pa,{})})}),a.jsx("div",{children:l&&a.jsxs(a.Fragment,{children:[(M=(v=e.getActions)==null?void 0:v.call(e,r))==null?void 0:M.map((s,g)=>a.jsx(K,{color:"ghost",size:"small",onClick:s.onClick,"aria-label":s.ariaLabel,disabled:s.disabled,icon:s.icon},g)),a.jsx(K,{color:"ghost",size:"small",onClick:()=>c(s=>!s),"aria-label":t.formatMessage(D.toggleSidebar),className:"md:inline-flex",icon:ha})]})})]}),a.jsx("div",{className:"relative flex flex-1 flex-col items-center justify-center overflow-hidden",children:a.jsx(He,{initial:!1,custom:N,children:a.jsxs(se.div,{className:"absolute grid h-full w-full grid-rows-2",custom:N,variants:va,drag:"x",dragConstraints:{left:0,right:0},dragElastic:1,onDragEnd:(s,{offset:g,velocity:h})=>{const p=Ie(g.x,h.x);p<-he?o():p>he&&x()},children:[a.jsx(se.img,{src:r.url,alt:r.alt,className:"row-span-4 mx-auto h-full object-scale-down",onPanEnd:(s,{offset:g,velocity:h})=>{const p=Ie(g.y,h.y);p<-pe?c(!0):p>pe&&c(!1)}},r.url),!l&&m&&a.jsx(se.div,{className:"flex text-white",variants:wa,initial:"enter",animate:"visible",exit:"exit",transition:{y:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2}},children:e.metadataRenderer(r)})]},r.url)})}),e.images.length>1?a.jsxs("div",{className:"flex items-center justify-center gap-4 p-8 text-white",children:[a.jsx(K,{color:"ghost",size:"small",onClick:x,"aria-label":t.formatMessage(D.previousImage),icon:_a}),e.images.map((s,g)=>{var h;return a.jsx("img",{src:s.url,alt:(h=s.alt)!=null?h:"",className:O("h-12 w-12 cursor-pointer rounded-sm object-cover transition duration-300 hover:opacity-100",s.url===r.url?"ring-2 ring-white ring-offset-4 ring-offset-black":"opacity-25"),onClick:()=>{f(s),w(g<j?1:-1)},"aria-label":t.formatMessage(D.showImage),role:"button"},s.url)}),a.jsx(K,{color:"ghost",size:"small",onClick:o,"aria-label":t.formatMessage(D.nextImage),icon:Ia})]}):null]})}),a.jsx("div",{className:O("hidden items-center justify-start overflow-hidden bg-gray-900 text-white transition-[flex-basis] duration-500 md:flex",m?"md:basis-[25vw]":"md:basis-0"),children:a.jsx("div",{className:"w-[25vw] min-w-[25vw]",children:e.metadataRenderer(r)})})]})})})]})}const D=je({showImage:{id:"imageViewer.showImage",defaultMessage:"Show Image"},closeModal:{id:"imageViewer.closeModal",defaultMessage:"Close Modal"},toggleSidebar:{id:"imageViewer.toggleSidebar",defaultMessage:"Toggle Sidebar"},nextImage:{id:"imageViewer.nextImage",defaultMessage:"Next Image"},previousImage:{id:"imageViewer.previousImage",defaultMessage:"Previous Image"}});function ja({withLottie:e}){return a.jsxs("div",{className:"absolute start-0 top-0 flex h-full w-full items-center justify-center rounded-full",children:[a.jsx(xa,{animate:e,matchTextColor:!0,className:"h-6 w-6"}),a.jsx(ya,{})]})}function ya(){const[t,n]=_.useState(new Date);_.useEffect(()=>{n(new Date)},[]);const l=ea(+t,25e3);return a.jsx(aa,{percentage:l,thickness:1.25/23,className:"absolute start-1/2 top-1/2 h-10 w-10 -translate-x-1/2 -translate-y-1/2",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:"".concat((100-l)/100*.2,"s"),transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"})}const Ee=V(()=>S(()=>import("./mtsfsh7z74bmo6ig.js").then(e=>e._),__vite__mapDeps([6,1])),{loading:e=>P(e)}),Ne=V(()=>S(()=>import("./f2itj05whsmn3kgs.js").then(e=>e._),__vite__mapDeps([7,1])),{loading:e=>P(e)}),Se=V(()=>S(()=>import("./mbhfxri3syrb9rbq.js").then(e=>e._),__vite__mapDeps([8,1])),{loading:e=>P(e)}),Ma=V(()=>S(()=>import("./fwyctp3zfyh6emd2.js").then(e=>e._),__vite__mapDeps([9,1])),{loading:e=>P(e)});function Fa({messages:e,clientThreadId:t,disableClickThru:n=!1}){const[l,u]=e,b=ta(l),m=sa(),c=e.some(I=>m.has(I.id));let r=null;u!=null&&xe.isMultimodalTextMessage(u)&&(r=xe.getImageAssetPointers(u));let f=T.Running;return r!=null?f=T.Finished:u!=null?f=T.Error:b&&(f=T.Stopped),a.jsx(Ce.Provider,{value:n,children:!c&&a.jsx(Ca,{imageAssets:r!=null?r:[],clientThreadId:t,toolStatus:f,toolMessage:u,messageId:l.id})})}const ka="https://help.openai.com/en/articles/8932459",Ca=({imageAssets:e,clientThreadId:t,toolMessage:n,toolStatus:l,messageId:u})=>{const b=ne(),m=ye(t),c=na(e,void 0,m),r=Ue(),f=Qe(r),I=ia(t),C=_.useMemo(()=>l===T.Finished&&c.every(o=>!!o.data),[l,c]);if((n==null?void 0:n.content.content_type)===qe.SystemError)return null;const E=Ve(e[0]),y=c.map(o=>o.data).filter(o=>o!=null),N=y.map(o=>Z(Y({},o),{alt:X(o)})),w=(o=0)=>"".concat(u,"-image-").concat(o);return a.jsxs("div",{children:[a.jsxs(Va,{$numItems:c.length,className:"my-1 transition-opacity duration-300",children:[c.length===0&&l===T.Running&&a.jsx(_e,{layoutId:"loading:placeholder",shape:E,isToolRunning:!0},"loading"),c.map((o,x)=>{const{isLoading:i,data:d,error:j}=o;if(i)return a.jsx(_e,{shape:E,layoutId:w(x)},x);if(j!=null||(d==null?void 0:d.url)==null)return a.jsx(le,{layoutId:w(x),className:"text-token-text-tertiary text-sm",shape:E,children:a.jsx("div",{className:"flex min-h-full flex-col items-center justify-center gap-3 px-4 pb-5",children:b.formatMessage(k.imageLoadError)})},x);if(n&&d){const v=Z(Y({},d),{alt:X(d)});return a.jsx(Ea,{image:v,allImages:N,clientThreadId:t,toolMessage:n,index:x,onOpenImageEditor:()=>{oa.setFocusedObject({type:ke.Image,image:v,allImages:y,messageId:n.id})}},x)}})]}),f&&C&&a.jsx("div",{className:"text-md text-token-text-tertiary flex flex-row items-center py-2",children:a.jsx("span",{className:"me-2",children:I?a.jsx(fe,{id:"xQcNUs",defaultMessage:"Made with the old version of image generation. <link>Learn more</link>",values:{link:o=>a.jsx("a",{className:"text-token-text-tertiary underline underline-offset-4",href:ka,target:"_blank",rel:"noopener noreferrer",children:o})}}):a.jsx(fe,{id:"hyynYz",defaultMessage:"Made with the old version of image generation. New version <link>available now</link>.",values:{link:o=>a.jsx("a",{className:"text-token-text-tertiary underline underline-offset-4",href:"https://openai.com/index/introducing-4o-image-generation/",target:"_blank",rel:"noopener noreferrer",children:o})}})})})]})};function Ea({toolMessage:e,clientThreadId:t,allImages:n,image:l,index:u,onOpenImageEditor:b}){const m=ne(),c=ye(t),r=Ve(l),f=_.useContext(Ce),[I,C]=_.useState({}),E=fa({clientThreadId:t});async function y(i){ma(i,c,e.id,f)}function N(i){var d,j,v,M,s,g,h,p,A,L,R,F,G,B,z,W,$,H,U,Q,q,J;ee.logEvent("chatgpt_dalle_image_view_full",null,{sourceOperation:(v=(j=(d=i.metadata)==null?void 0:d.dalle)==null?void 0:j.edit_op)!=null?v:"none",hasParent:(s=(M=i.metadata)==null?void 0:M.dalle)!=null&&s.parent_gen_id?"true":"false",model:"dalle"}),ae.logEvent("chatgpt_dalle_image_view_full",{conversationId:c,messageId:e.id,generationId:(h=(g=i.metadata)==null?void 0:g.dalle)==null?void 0:h.gen_id,parentGenerationId:(A=(p=i.metadata)==null?void 0:p.dalle)==null?void 0:A.parent_gen_id,fileId:te(i.asset_pointer),sourceOperation:(R=(L=i.metadata)==null?void 0:L.dalle)==null?void 0:R.edit_op,model:"dalle"}),ee.logEvent("chatgpt_image_view_full",null,{sourceOperation:(B=(G=(F=i.metadata)==null?void 0:F.dalle)==null?void 0:G.edit_op)!=null?B:"none",hasParent:(W=(z=i.metadata)==null?void 0:z.dalle)!=null&&W.parent_gen_id?"true":"false",model:"dalle"}),ae.logEvent("chatgpt_image_view_full",{conversationId:c,messageId:e.id,generationId:(H=($=i.metadata)==null?void 0:$.dalle)==null?void 0:H.gen_id,parentGenerationId:(Q=(U=i.metadata)==null?void 0:U.dalle)==null?void 0:Q.parent_gen_id,fileId:te(i.asset_pointer),sourceOperation:(J=(q=i.metadata)==null?void 0:q.dalle)==null?void 0:J.edit_op,model:"dalle"})}function w(i,d){var v,M,s,g,h,p,A,L,R,F,G,B,z,W,$,H,U,Q,q,J,re,de;C(Pe=>Z(Y({},Pe),{[i.asset_pointer]:d}));const j=f?"chatgpt_dalle_image_captioning_rating":"chatgpt_dalle_image_rating";ee.logEvent(j,d?"like":"dislike",{liked:d?"true":"false",sourceOperation:(s=(M=(v=i.metadata)==null?void 0:v.dalle)==null?void 0:M.edit_op)!=null?s:"none",hasParent:(h=(g=i.metadata)==null?void 0:g.dalle)!=null&&h.parent_gen_id?"true":"false",model:"dalle"}),ae.logEvent(j,{liked:d,conversationId:c,messageId:e.id,generationId:(A=(p=i.metadata)==null?void 0:p.dalle)==null?void 0:A.gen_id,parentGenerationId:(R=(L=i.metadata)==null?void 0:L.dalle)==null?void 0:R.parent_gen_id,fileId:te(i.asset_pointer),sourceOperation:(G=(F=i.metadata)==null?void 0:F.dalle)==null?void 0:G.edit_op,model:"dalle"}),ee.logEvent("chatgpt_image_rating",d?"like":"dislike",{liked:d?"true":"false",sourceOperation:(W=(z=(B=i.metadata)==null?void 0:B.dalle)==null?void 0:z.edit_op)!=null?W:"none",hasParent:(H=($=i.metadata)==null?void 0:$.dalle)!=null&&H.parent_gen_id?"true":"false",model:"dalle"}),ae.logEvent("chatgpt_image_rating",{liked:d,conversationId:c,messageId:e.id,generationId:(Q=(U=i.metadata)==null?void 0:U.dalle)==null?void 0:Q.gen_id,parentGenerationId:(J=(q=i.metadata)==null?void 0:q.dalle)==null?void 0:J.parent_gen_id,fileId:te(i.asset_pointer),sourceOperation:(de=(re=i.metadata)==null?void 0:re.dalle)==null?void 0:de.edit_op,model:"dalle"})}function o(i){const d=I[i.asset_pointer],j={label:m.formatMessage(k.likeImage),onClick:()=>w(i,!0),disabled:d===!0,ariaLabel:m.formatMessage(k.likeImage),icon:Ee},v={label:m.formatMessage(k.dislikeImage),onClick:()=>w(i,!1),disabled:d===!1,ariaLabel:m.formatMessage(k.dislikeImage),icon:Ne},M={label:m.formatMessage(k.downloadImage),onClick:()=>y(i),ariaLabel:m.formatMessage(k.downloadImage),icon:Se};return[d!==!1&&j,d!==!0&&v,M].filter(Boolean)}let x=a.jsx(Sa,{image:l,shape:r,rating:I[l.asset_pointer],onDownload:()=>y(l),onRate:(i,d)=>w(i,d),clientThreadId:t,layoutId:void 0});return E?x=a.jsx("div",{role:"button",onClick:b,children:x}):f||(x=a.jsx(ba,{image:l,images:n,metadataRenderer:i=>a.jsx(Na,{image:i}),onOpen:N,getActions:o,children:x})),a.jsx("div",{className:"flex",children:x},u)}function _e({shape:e,layoutId:t,isToolRunning:n=!1}){const{isOpen:l}=la();return a.jsx(le,{shape:e,layoutId:l?void 0:t,children:a.jsx("div",{className:"flex min-h-full items-center justify-center",children:a.jsx(ja,{withLottie:n})})},"loading")}function Na({image:e}){const t=ne(),[n,l]=_.useState(!1),u=Ze();function b(m){const c=X(e);l(!0),ua(c,u,m),setTimeout(()=>{l(!1)},2e3)}return a.jsxs("div",{className:"flex flex-col items-start gap-3 p-6",children:[a.jsx("div",{className:"text-sm text-gray-300 sm:text-base",children:t.formatMessage(k.imageViewerMetadataTitle)}),a.jsx("div",{className:"max-h-32 overflow-y-auto text-sm md:max-h-[80vh] md:text-lg",children:X(e)}),a.jsx(K,{color:"primary",onClick:b,disabled:n,className:"hidden sm:block",icon:Ma,children:n?t.formatMessage(k.imageViewerMetadataCopyButtonCopied):t.formatMessage(k.imageViewerMetadataCopyButton)})]})}function le({children:e,shape:t,className:n,layoutId:l}){return a.jsxs(se.div,{layoutId:l,className:O("relative",n,t==="1792x1024"&&"aspect-7/4",t==="1024x1024"&&"aspect-square max-w-[400px]",t==="1024x1792"&&"aspect-4/7 max-w-xs","overflow-hidden rounded-2xl"),children:[a.jsx("div",{className:"bg-token-main-surface-secondary pointer-events-none absolute inset-0"}),a.jsx("div",{className:"relative h-full",children:e})]})}function Sa({image:e,shape:t,rating:n,onDownload:l,onRate:u,clientThreadId:b,layoutId:m}){const c=Je(Ke.isBusinessWorkspace),r=Xe(b,o=>o==null?void 0:o.mode),f=ra(),I=da(),C=(I==null?void 0:I.type)===ke.Image&&I.image.asset_pointer===e.asset_pointer,{url:E,width:y,height:N}=e,w=!c&&(r==null?void 0:r.kind)!==Ye.GizmoMagicCreate;return a.jsxs(le,{shape:t,className:"group/dalle-image",layoutId:C?void 0:m,children:[a.jsx(ca,{alt:X(e),src:E,width:y,height:N}),a.jsx("div",{className:O("pointer-events-none absolute inset-0 rounded-2xl shadow-[inset_0_0_0_1px_rgba(0,0,0,0.1)] dark:shadow-[inset_0_0_0_1px_rgba(255,255,255,0.1)]",C?"bg-black/50 group-hover/dalle-image:bg-black/70":"group-hover/dalle-image:bg-transparent")}),f?!C&&a.jsx("div",{className:"pointer-events-none invisible absolute end-3 top-3 text-white group-hover/dalle-image:visible",children:a.jsx(ga,{})}):a.jsxs(a.Fragment,{children:[w&&a.jsxs(ve,{children:[n!==!1&&a.jsx(oe,{icon:Ee,selected:n===!0,onClick:o=>{o.stopPropagation(),u(e,!0)}}),n!==!0&&a.jsx(oe,{icon:Ne,selected:n===!1,onClick:o=>{o.stopPropagation(),u(e,!1)}})]}),a.jsx(ve,{$rightAlign:!0,children:a.jsx(oe,{icon:Se,onClick:o=>{o.stopPropagation(),l()}})})]})]})}var we;const ve=Me.div(we||(we=ie(["invisible absolute top-3 flex gap-1 group-hover/dalle-image:visible z-2\n",""])),({$rightAlign:e})=>e?"end-3":"start-3");var be;const Va=Me.div(be||(be=ie(["grid gap-2\n",""])),({$numItems:e})=>e<=1?"grid-cols-1":"grid-cols-2");function Ve(e){if(!e)return"1024x1024";const{width:t,height:n}=e;return t>n?"1792x1024":t<n?"1024x1792":"1024x1024"}const k=je({creatingImages:{id:"dalleMessage.creatingImagesV2",defaultMessage:"Creating image"},stopped:{id:"dalleMessage.stoppedV3",defaultMessage:"Stopped creating image"},errorCreating:{id:"dalleMessage.errorCreatingV2",defaultMessage:"Error creating image"},imageLoadError:{id:"dalleMessage.imageLoadError",defaultMessage:"Error loading image"},imageViewerMetadataTitle:{id:"dalleMessage.imageViewerMetadataTitle",defaultMessage:"Prompt"},imageViewerMetadataCopyButton:{id:"dalleMessage.imageViewerMetadataCopyButton",defaultMessage:"Copy"},imageViewerMetadataCopyButtonCopied:{id:"dalleMessage.imageViewerMetadataCopyButtonCopied",defaultMessage:"Copied!"},imageEditButton:{id:"dalleMessage.imageEditButton",defaultMessage:"Edit"},downloadImage:{id:"imageViewer.downloadImage",defaultMessage:"Download Image"},likeImage:{id:"imageViewer.likeImage",defaultMessage:"Like Image"},dislikeImage:{id:"imageViewer.dislikeImage",defaultMessage:"Dislike Image"}});export{Fa as default};
//# sourceMappingURL=j39tdkic03ejpi9l.js.map
