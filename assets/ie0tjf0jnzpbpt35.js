import{r as L,j as l}from"./i8clt0mfz495j7ii.js";import{C as k}from"./k6dbkwjaexelrlgh.js";import{D as X}from"./f5qlxxpahyz6p72m.js";import{u as Y,i as Z,C as $,g as y}from"./kticz4kb6d3g30cz.js";import{C as z,T as tt}from"./dxyrjy681bkwlnj8.js";import{C as F}from"./lo4w8zafp8iqjpvk.js";import{a as et,b as ot,c as rt,d as M}from"./6ji8ehbh56ghw0zw.js";import{C as nt}from"./ce3hgmw4iyyhicud.js";import{T as it,a as st,A as P}from"./go502v54gisfd23y.js";import{b as lt,f8 as ct,aF as R,kp as mt}from"./j0yo6uv6652vva62.js";import{dd as at,u as ut}from"./ghewn7l2ynbm32fm.js";import{u as dt}from"./mqebxepg7t6q2tie.js";import{C as pt}from"./inhyojyded8f1i4q.js";import"./gdq1l97elemowxcc.js";import"./kiv50zw1ij6k8vyj.js";import"./cb0ba83bmi83mjz2.js";import"./o564tkn3ln8nzryq.js";import"./ns51nblw8ziscsgd.js";import"./f76gy0b8ieo4s693.js";import"./k1t8elp5z7nmkg2d.js";import"./kau2ug0899cbkpxh.js";import"./o9vew0btr2k0i59c.js";import"./jdfzk1zd468oela3.js";import"./mstl8wgfzorpgdoe.js";import"./pc7u7c6vz2ia5xux.js";import"./kfdkis1zwf4ccfgg.js";import"./ol9d5wxhynx9q2is.js";import"./mbmcx8v24u1ao1ke.js";import"./jh95iaetowvobxaf.js";import"./deakbbf27g8e7ba0.js";import"./omoqxnq6po1pmb00.js";import"./kl7c6054usfnqmd4.js";import"./k97n0y6ba9c9h39c.js";import"./hu1kfuw35sk0pi95.js";import"./l2r1du6tfxyv7jaj.js";import"./ln88gzx578175chd.js";function ft(t,e){const s=t.doc.lineAt(e.from);return e.from===s.from&&e.to-1===s.to}function Ct(t){const e=t.dom.querySelector(".cm-gutters");return e?e.offsetWidth:0}const gt=({onAddComment:t,isSendDisabled:e=!1,isWaitingForCommentResponse:s=!1})=>{const n=et(),p=ot(),o=rt(),O=L.useCallback(r=>{const{height:i,width:u}=r,c=n();if(!p||!c)return null;const m=p.selection.asSingle();if(m.ranges.length===0)return null;const a=m.ranges[0],{empty:H,to:v}=a;let{head:C}=a;const{platform:I}=lt();C=I==="web"?C:v;const g=C===v;let w=C;if(g&&ft(p,a)&&(w-=1),H)return null;const{left:h,top:A,bottom:N}=c.contentDOM.getBoundingClientRect(),{left:W,top:_,bottom:b}=at(c.coordsAtPos(w,g?-1:1)),E=Ct(c);function G(){if(g)return Math.max(W-h+E-u,E);let f=W-h+E;return f+u>o&&(f=-(u-o)),f}function j(f){const S=i*2,B=f.contentHeight-(b-N)>S&&window.innerHeight-b>S,V=b-A+8,x=_-A-i-8;return g&&B||x<0?{top:V,aboveOrBelow:P.BELOW}:{top:x,aboveOrBelow:P.ABOVE}}const T=j(c);return{left:G(),top:T.top,aboveOrBelow:T.aboveOrBelow,toolbarSize:r}},[p,n,o]),D=L.useCallback(()=>{var r,i;return(i=(r=n())==null?void 0:r.dom)!=null?i:null},[n]);return l.jsx(it,{onAddComment:t,isWaitingForCommentResponse:s,isSendDisabled:e,toolbarType:st.CODE,getToolbarPosition:O,getEditorDom:D,getSelectionRange:()=>{const r=n();if(!r)return null;const{state:i}=r,u=i.selection.asSingle();if(u.ranges.length===0)return null;const c=u.ranges[0],{from:m,to:a}=c;return m==null||a==null?null:{from:m,to:a,sourceFrom:m,sourceTo:a}}})};function ht({diff:t}){var e;return Y((e=t==null?void 0:t.edits)!=null?e:[]),null}function Et(t,e,s){const n=s?y():0;return t<=1e3-n?t-(e?z:0):t-(e?tt:0)}const ee=({comments:t,currentlyStreamingLineIndex:e,isPreview:s=!1,isWaitingForCommentResponse:n=!1,isSendDisabled:p=!1,readonlyReason:o,isRequestActive:O=!1,language:D,value:r,textdocDiff:i,maxLength:u,onAcceleratorsExpandedChange:c,onAddComment:m,onAcceptComment:a,onDismissComment:H,onBlur:v,onSave:C,onChange:I,onCancelRequest:g,getStableCommentId:w=mt,commentsMode:h=F.ENABLED,hideToolbar:A,hideAccelerators:N=!1,onSubmitAccelerator:W,modelCursor:_,codemirrorRef:b})=>{var U;const E=L.useRef(null),G=ut(),j=ct(G),[{width:T},f]=dt(),S=L.useRef(null),B=t.length>0,V=S.current,x=Et(T,B,(U=Z(V))!=null?U:!1),q=M(({commentingOn:d})=>d),J=M(({hoveredCommentId:d})=>d),K=M(({focusedCommentId:d})=>d);L.useEffect(()=>{var d;(d=E.current)==null||d.UNSAFE_setValue(r||"")},[r]);const Q=T-x;return l.jsx("div",{className:nt.code,ref:R(f,S),style:j&&s?{margin:"0 16px"}:{},children:l.jsxs(k,{id:"codemirror",comments:h===F.ALL_HIDDEN?void 0:t,commentingOn:q,currentlyStreamingLineIndex:e,hoveredCommentId:J,focusedCommentId:K,language:D,readonlyReason:o,onChange:I,maxLength:u,value:r,textdocDiff:i,editorRef:R(E,b),width:x,modelCursor:_,isPreview:s,hideLineNumbers:j&&s,onBlur:v,onSave:C,children:[l.jsxs(k.EditorChildren,{children:[!A&&l.jsx(gt,{onAddComment:m,isSendDisabled:p,isWaitingForCommentResponse:n}),h!==F.ALL_HIDDEN&&l.jsx("div",{className:B?"me-4":"",children:l.jsx($,{getStableCommentId:w,availableWidth:Q,comments:t,commentsMode:h,onAddComment:m,onAcceptComment:a,onDismissComment:H,isWaitingForCommentResponse:n,isRequestActive:O,disableBlockComments:!0})})]}),l.jsxs(k.ContextChildren,{children:[i&&l.jsx(ht,{diff:i}),!N&&l.jsx(X,{isRequestActive:O,isVisuallyHidden:p||!!(o!=null&&o.isStreamingFromNative)||(o==null?void 0:o.isReadonly)&&!o.isStreaming,onSubmit:W,onCancel:g,actions:pt,onExpandedChange:c})]})]})})};export{ee as CodeComposer};
//# sourceMappingURL=ie0tjf0jnzpbpt35.js.map
