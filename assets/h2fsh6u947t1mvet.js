const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/o84nb2862ibyoi1c.js","assets/i8clt0mfz495j7ii.js","assets/otyqbgm5k20lfbwp.js"])))=>i.map(i=>d[i]);
import{j as s,c as We,e as Jt,r as R,f as Zt,_ as Pt,M as He}from"./i8clt0mfz495j7ii.js";import{aW as es,u as ts,cH as Ae,cI as ss,dp as is,cE as At,hv as ns,ht as Bt,cn as wt,a$ as as,e as ls,a as os,d as Ot,o as zt,L as Vt,bO as X,bT as Ke,ns as q,$ as It,ll as rs}from"./ghewn7l2ynbm32fm.js";import{ip as Z,b$ as kt,iq as Rt,ir as cs,is as ds,it as Et,iu as Gt,iv as us,iw as ms,ix as fs,iy as xs,iz as gs,iA as hs,cb as Ft,cc as ps}from"./j0yo6uv6652vva62.js";import{C as vs,a as Ss}from"./owvt7s3ln6qx5fou.js";import{p as js}from"./o2ch1u40q6bs5ljp.js";import{u as Ts,S as Lt}from"./fy1n36to2eb0czaf.js";function Ps({children:l}){return s.jsx("div",{className:"bg-token-main-surface-primary h-full w-full px-[22px] py-4",children:l})}function bs(){return s.jsxs("div",{className:"flex w-full gap-2",children:[s.jsx("div",{className:"h-6 w-6",children:s.jsx(Z,{className:"h-full w-full rounded-full!"})}),s.jsxs("div",{className:"flex w-full flex-col gap-2",children:[s.jsx(Z,{}),s.jsx(Z,{}),s.jsx(Z,{}),s.jsx(Z,{})]})]})}function qt({chunks:l,isFinishedThinking:e,taskInfo:n}){var r,x,o;const C=l.some(b=>b.type===kt.Glaux),T=l.length===0||l.length===1&&((r=l[0])==null?void 0:r.type)===kt.Thought&&!((o=(x=l[0])==null?void 0:x.thought)!=null&&o.content),h=!n||n.status===Rt.CREATED||n.status===Rt.RUNNING;return T&&h?s.jsx(bs,{}):s.jsx("div",{className:"relative isolate my-3 flex flex-col",children:s.jsx(es,{children:l.map((b,d)=>s.jsx(vs,{index:d,chunk:b,gap:Ss,isLast:d===l.length-1,isExpanded:!0,isAnimationComplete:e,showBullet:!0,onClick:()=>{},isKAUR1BR5:!1,hasGlauxMessages:C,onAnimationComplete:()=>{},onMeasure:()=>{}},"cot-sidebar-".concat(d)))})})}const ys=zt(()=>Pt(()=>import("./o84nb2862ibyoi1c.js").then(l=>l._),__vite__mapDeps([0,1])),{loading:l=>Vt(l)}),Cs=zt(()=>Pt(()=>import("./otyqbgm5k20lfbwp.js").then(l=>l._),__vite__mapDeps([2,1])),{loading:l=>Vt(l)}),$t=" Â· ",Dt=l=>{"use forget";const e=We.c(8),{title:n,children:C,className:T}=l;let h;e[0]!==T?(h=Ot("pt-2 pb-4",T),e[0]=T,e[1]=h):h=e[1];let r;e[2]!==n?(r=s.jsx("div",{className:"text-token-text-secondary text-md mb-2 font-medium",children:n}),e[2]=n,e[3]=r):r=e[3];let x;return e[4]!==C||e[5]!==h||e[6]!==r?(x=s.jsxs("div",{className:h,children:[r,C]}),e[4]=C,e[5]=h,e[6]=r,e[7]=x):x=e[7],x};function _s(l){"use forget";var at,lt,ot,rt,ct,dt,ut,mt,ft,xt,gt,ht,pt,vt,St,jt,Tt,bt,yt,Ct,_t,Nt;const e=We.c(147),{conversation:n,sidebar:C}=l,{reasoningGroupIndex:T,turnIndex:h,scrollTo:r}=C,x=T===void 0?-1:T,o=h===void 0?-1:h,b=ts(),d=Jt(),Me=R.useRef(null),Qe=R.useRef(null),_=Ae(n.id,Es);let ee;e[0]!==_.length?(ee=i=>X.getConversationTurnAtIndex(i,Math.max(0,_.length-1)),e[0]=_.length,e[1]=ee):ee=e[1];const w=Ae(n.id,ee);let te;e[2]!==(w==null?void 0:w.messageGroups)?(te=(at=w==null?void 0:w.messageGroups)==null?void 0:at.findIndex(Rs),e[2]=w==null?void 0:w.messageGroups,e[3]=te):te=e[3];const E=te,Xe=R.useRef(Math.max(0,_.length-1));let se;e[4]!==n||e[5]!==E||e[6]!==_.length||e[7]!==o?(se=()=>{const i=Math.max(0,_.length-1);o!==i&&E>=0&&Xe.current!==i&&(hs(n,{type:"cot",turnIndex:i,reasoningGroupIndex:E}),Xe.current=i)},e[4]=n,e[5]=E,e[6]=_.length,e[7]=o,e[8]=se):se=e[8];let ie;e[9]!==n||e[10]!==E||e[11]!==_||e[12]!==o?(ie=[n,_,o,E],e[9]=n,e[10]=E,e[11]=_,e[12]=o,e[13]=ie):ie=e[13],R.useEffect(se,ie);let ne;e[14]!==o?(ne=i=>{var L;const u=X.getConversationTurns(i);if(o<0||o>=u.length)return[void 0,void 0,!0];const m=X.getConversationTurnAtIndex(i,o),S=(L=m==null?void 0:m.messages)!=null?L:[],g=S[S.length-1],k=(g==null?void 0:g.id)!=null?X.getRequestId(i,g.id):void 0;return[m,k,!!(g!=null&&g.end_turn)]},e[14]=o,e[15]=ne):ne=e[15];const[a,Ye,Ht]=Ae(n.id,ne),Kt=ss(Ye),N=!!(Ye&&Kt&&!Ht);let ae;e[16]!==(a==null?void 0:a.messages)?(ae=a==null?void 0:a.messages.find(ks),e[16]=a==null?void 0:a.messages,e[17]=ae):ae=e[17];const A=ae;let le;e[18]!==b||e[19]!==(a==null?void 0:a.messages)?(le=a==null?void 0:a.messages.some(i=>{var u,m,S;return((u=i==null?void 0:i.metadata)==null?void 0:u.api_tool_type)==="glaux"||is({id:(S=(m=i==null?void 0:i.metadata)==null?void 0:m.model_slug)!=null?S:""},b)}),e[18]=b,e[19]=a==null?void 0:a.messages,e[20]=le):le=e[20];const we=le;let p=x>=0?(lt=a==null?void 0:a.messageGroups)==null?void 0:lt[x]:void 0;const G=(ot=At((p==null?void 0:p.type)===ns.a8km123?p.messages:[]))!=null?ot:A,I=(rt=G==null?void 0:G.metadata)==null?void 0:rt.async_task_id;cs(I,G,n.id),ds(I);const Ie=Et(i=>Gt.getTask(I!=null?I:"",i)),c=Ie==null?void 0:Ie.finalMessage;let oe;e[21]!==(c==null?void 0:c.id)?(oe=i=>{var u;return X.getConversationTurnIndex(i,(u=c==null?void 0:c.id)!=null?u:"")},e[21]=c==null?void 0:c.id,e[22]=oe):oe=e[22];const y=Ae(n.id,oe);let re;e[23]!==c||e[24]!==(a==null?void 0:a.messages)?(re=c!=null?c:At(a==null?void 0:a.messages),e[23]=c,e[24]=a==null?void 0:a.messages,e[25]=re):re=e[25];const f=re,t=Et(i=>Gt.getTask(I!=null?I:"",i));let ce;e[26]!==(t==null?void 0:t.taskId)?(ce=(ct=t==null?void 0:t.taskId)==null?void 0:ct.startsWith("thinking"),e[26]=t==null?void 0:t.taskId,e[27]=ce):ce=e[27];const ke=!ce;if(t){let i;e[28]!==t.rows?(i=(dt=t.rows)!=null?dt:[],e[28]=t.rows,e[29]=i):i=e[29],p=us(i)}let Re;e:{if(!p||p.type!==Bt){let u;e[30]===Symbol.for("react.memo_cache_sentinel")?(u={chunks:[]},e[30]=u):u=e[30],Re=u;break e}let i;e[31]!==we||e[32]!==p.groups?(i=js(p.groups,we),e[31]=we,e[32]=p.groups,e[33]=i):i=e[33],Re=i}const{chunks:de}=Re;let ue;e[34]!==de?(ue=de===void 0?[]:de,e[34]=de,e[35]=ue):ue=e[35];const j=ue;let Y;if(e[36]!==p){e:{const i={startReasoningMessage:void 0,endReasoningMessage:void 0};if(!p||!Array.isArray(p.groups)){Y=i;break e}for(const u of p.groups)for(const m of u.messages)((ut=m.content)==null?void 0:ut.content_type)===wt.StructuredThoughts&&!i.startReasoningMessage&&(i.startReasoningMessage=m),((mt=m.content)==null?void 0:mt.content_type)===wt.ReasoningRecap&&(i.endReasoningMessage=m);Y=i}e[36]=p,e[37]=Y}else Y=e[37];const{startReasoningMessage:Ee,endReasoningMessage:me}=Y,v=!!me;let fe;e[38]!==t?(fe=t&&ms(t),e[38]=t,e[39]=fe):fe=e[39];const Ge=fe,Je=R.useRef(null),Ze=R.useRef(j.length);let xe;e[40]!==j.length||e[41]!==v||e[42]!==N||e[43]!==r?(xe=()=>{const i=Je.current===!0;Je.current=N;let u=0,m=0;return u=requestAnimationFrame(()=>{m=requestAnimationFrame(()=>{var S,g;v?(r==="sources"||i&&!N)&&((g=Qe.current)==null||g.scrollIntoView({block:"start"})):(S=Me.current)==null||S.scrollIntoView({behavior:Ze.current!==j.length?"smooth":void 0,block:"end"}),Ze.current=j.length})}),()=>{u&&cancelAnimationFrame(u),m&&cancelAnimationFrame(m)}},e[40]=j.length,e[41]=v,e[42]=N,e[43]=r,e[44]=xe):xe=e[44];let ge;e[45]!==j.length||e[46]!==n.id||e[47]!==N||e[48]!==r?(ge=[n.id,j.length,r,N],e[45]=j.length,e[46]=n.id,e[47]=N,e[48]=r,e[49]=ge):ge=e[49],as(xe,ge);const[Wt,Mt]=R.useState(Is);let he,pe;e[50]!==v?(he=()=>{if(v)return;const i=window.setInterval(()=>Mt(Date.now()),1e3);return()=>clearInterval(i)},pe=[v],e[50]=v,e[51]=he,e[52]=pe):(he=e[51],pe=e[52]),R.useEffect(he,pe);const Fe=ls(),Le=t==null?void 0:t.taskId;let ve;e[53]!==d||e[54]!==Le||e[55]!==Fe?(ve={taskId:Le,intl:d,toaster:Fe},e[53]=d,e[54]=Le,e[55]=Fe,e[56]=ve):ve=e[56];const qe=fs(ve),et=t!=null&&t.createdAt?Date.parse(t.createdAt)/1e3:Ee==null?void 0:Ee.create_time,tt=v?me==null?void 0:me.create_time:Wt/1e3,Qt=et!=null&&tt!=null?Math.max(0,tt-et):0,st=Math.floor(Qt),it=Math.floor(st/60),$e=st%60;let Se;e[57]!==$e?(Se=$e.toString(),e[57]=$e,e[58]=Se):Se=e[58];const nt=Se,De=it>0?"".concat(it,"m ").concat(nt,"s"):"".concat(nt,"s");let je;e[59]!==ke||e[60]!==(t==null?void 0:t.originalConversationId)||e[61]!==(t==null?void 0:t.taskId)?(je=ke?()=>{Ke(t==null?void 0:t.originalConversationId,i=>{i.steeringAsyncTaskId=t==null?void 0:t.taskId})}:void 0,e[59]=ke,e[60]=t==null?void 0:t.originalConversationId,e[61]=t==null?void 0:t.taskId,e[62]=je):je=e[62];const Pe=je;let Te;e[63]!==qe?(Te=()=>{qe.mutate()},e[63]=qe,e[64]=Te):Te=e[64];const Be=Te;let be;e[65]!==((ft=A==null?void 0:A.metadata)==null?void 0:ft.async_task_title)||e[66]!==d||e[67]!==(t==null?void 0:t.title)||e[68]!==(a==null?void 0:a.messages)?(be=(jt=(St=(gt=t==null?void 0:t.title)!=null?gt:(xt=A==null?void 0:A.metadata)==null?void 0:xt.async_task_title)!=null?St:(vt=(pt=(ht=a==null?void 0:a.messages)==null?void 0:ht.find(ws))==null?void 0:pt.metadata)==null?void 0:vt.async_task_title)!=null?jt:d.formatMessage(Q.activity),e[65]=(Tt=A==null?void 0:A.metadata)==null?void 0:Tt.async_task_title,e[66]=d,e[67]=t==null?void 0:t.title,e[68]=a==null?void 0:a.messages,e[69]=be):be=e[69];const F=be;let ye;e[70]!==d||e[71]!==(t==null?void 0:t.taskId)?(ye=(bt=t==null?void 0:t.taskId)!=null&&bt.startsWith("promode")?d.formatMessage(Q.proThinkingTitle):d.formatMessage(Q.placeholderTitle),e[70]=d,e[71]=t==null?void 0:t.taskId,e[72]=ye):ye=e[72];const Oe=ye,Xt=os(As),{hasSources:ze}=xs(n.id,y>=0?y:o,f),{sourcesCount:Ve}=Ts(n.id,y>=0?y:o,(yt=f==null?void 0:f.id)!=null?yt:"");let Ce;e[73]!==t?(Ce=t&&gs(t),e[73]=t,e[74]=Ce):Ce=e[74];const _e=Ce;if(Xt){let i;e[75]!==n?(i=()=>{Ft(n)},e[75]=n,e[76]=i):i=e[76];let u;e[77]===Symbol.for("react.memo_cache_sentinel")?(u=s.jsx(q.Backdrop,{}),e[77]=u):u=e[77];let m;e[78]!==d||e[79]!==r||e[80]!==F?(m=r==="sources"?d.formatMessage(Q.sourcesTitle):F,e[78]=d,e[79]=r,e[80]=F,e[81]=m):m=e[81];let S;e[82]!==m?(S=s.jsx("div",{className:"text-token-text-secondary text-md mb-2 truncate font-medium",children:m}),e[82]=m,e[83]=S):S=e[83];let g;e[84]!==j||e[85]!==n.id||e[86]!==y||e[87]!==v||e[88]!==(f==null?void 0:f.id)||e[89]!==r||e[90]!==o?(g=r==="sources"?s.jsx(Lt,{clientThreadId:n.id,turnIndex:y>=0?y:o,messageId:(Ct=f==null?void 0:f.id)!=null?Ct:"",isInSidebar:!0,combineSections:!0}):s.jsx(qt,{chunks:j,isFinishedThinking:v}),e[84]=j,e[85]=n.id,e[86]=y,e[87]=v,e[88]=f==null?void 0:f.id,e[89]=r,e[90]=o,e[91]=g):g=e[91];let k;e[92]!==S||e[93]!==g?(k=s.jsx(q.Content,{size:"fit",children:s.jsx(q.ScrollRoot,{className:"h-[80vh]",children:s.jsx(q.ContentSection,{"data-content-sheet-content-section":!0,children:s.jsxs("div",{className:"bg-primary px-6 py-4",children:[S,g]})})})}),e[92]=S,e[93]=g,e[94]=k):k=e[94];let L;return e[95]!==i||e[96]!==k?(L=s.jsx(q.Root,{defaultPresented:!0,children:s.jsx(q.Portal,{children:s.jsxs(q.View,{onCloseComplete:i,children:[u,k]})})}),e[95]=i,e[96]=k,e[97]=L):L=e[97],L}const Yt=(_t=G==null?void 0:G.metadata)==null?void 0:_t.async_task_original_message_id,J=v?c==null?void 0:c.id:Yt;let $;e[98]!==d?($=d.formatMessage(Q.cotDetails),e[98]=d,e[99]=$):$=e[99];let D;e[100]!==n.id||e[101]!==(c==null?void 0:c.id)||e[102]!==F||e[103]!==J?(D=J?s.jsx("button",{className:"before:bg-token-surface-hover dark:before:bg-token-main-surface-tertiary relative min-h-9 rounded-md before:absolute before:inset-y-0 before:-right-2.5 before:-left-2.5 before:rounded-md before:opacity-0 before:transition-opacity before:content-[''] hover:before:opacity-100",onClick:()=>{J&&(Ke(n.id,i=>{i.scrollToMessageId=J,i.scrollToMessageIsAssistant=!!(c!=null&&c.id)}),requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{Ke(n.id,Ns)})})}))},children:s.jsx("div",{className:"relative z-10 max-w-[250px] truncate",children:F})}):s.jsx("div",{className:"max-w-[250px] truncate",children:F}),e[100]=n.id,e[101]=c==null?void 0:c.id,e[102]=F,e[103]=J,e[104]=D):D=e[104];let P;e[105]!==De||e[106]!==Ge?(P=!Ge&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-token-text-tertiary",children:$t}),s.jsx("span",{className:"text-token-text-tertiary",children:De})]}),e[105]=De,e[106]=Ge,e[107]=P):P=e[107];let B;e[108]!==D||e[109]!==P?(B=s.jsxs("div",{className:"flex w-full items-center gap-2.5 px-0.5 text-lg",children:[D,P]}),e[108]=D,e[109]=P,e[110]=B):B=e[110];let O;e[111]!==n?(O=()=>Ft(n),e[111]=n,e[112]=O):O=e[112];let z;e[113]!==_e||e[114]!==Pe||e[115]!==Be?(z=_e&&s.jsx(Ut,{onAddContext:Pe,onStopTask:Be}),e[113]=_e,e[114]=Pe,e[115]=Be,e[116]=z):z=e[116];let V;e[117]!==j||e[118]!==v||e[119]!==t?(V=s.jsx(qt,{chunks:j,isFinishedThinking:v,taskInfo:t}),e[117]=j,e[118]=v,e[119]=t,e[120]=V):V=e[120];const Ue=_e&&"pb-12";let U;e[121]!==Ue?(U=Ot("scroll-mb-4",Ue),e[121]=Ue,e[122]=U):U=e[122];let H;e[123]!==U?(H=s.jsx("div",{ref:Me,className:U}),e[123]=U,e[124]=H):H=e[124];let K;e[125]!==V||e[126]!==H||e[127]!==Oe?(K=s.jsxs(Dt,{title:Oe,className:"px-3",children:[V,H]}),e[125]=V,e[126]=H,e[127]=Oe,e[128]=K):K=e[128];let W;e[129]!==n.id||e[130]!==y||e[131]!==ze||e[132]!==d||e[133]!==N||e[134]!==(f==null?void 0:f.id)||e[135]!==Ve||e[136]!==o?(W=!N&&ze&&s.jsxs(Dt,{title:s.jsxs("div",{className:"flex items-center gap-1 px-3",children:[s.jsx("span",{children:d.formatMessage(Q.sourcesTitle)}),s.jsx("span",{className:"text-token-text-tertiary",children:$t}),s.jsx("span",{className:"text-token-text-tertiary",children:Ve})]}),children:[s.jsx("div",{ref:Qe,className:"scroll-mt-24"}),s.jsx(Lt,{clientThreadId:n.id,turnIndex:y>=0?y:o,messageId:(Nt=f==null?void 0:f.id)!=null?Nt:"",isInSidebar:!0,combineSections:!0})]}),e[129]=n.id,e[130]=y,e[131]=ze,e[132]=d,e[133]=N,e[134]=f==null?void 0:f.id,e[135]=Ve,e[136]=o,e[137]=W):W=e[137];let M;e[138]!==K||e[139]!==W?(M=s.jsx("div",{className:"bg-primary flex h-full flex-col px-2",children:s.jsxs("div",{className:"flex-1 overflow-y-auto py-3",children:[K,W]})}),e[138]=K,e[139]=W,e[140]=M):M=e[140];let Ne;return e[141]!==$||e[142]!==B||e[143]!==O||e[144]!==z||e[145]!==M?(Ne=s.jsx(ps,{ariaLabel:$,leading:B,handleClose:O,trailing:z,children:M}),e[141]=$,e[142]=B,e[143]=O,e[144]=z,e[145]=M,e[146]=Ne):Ne=e[146],Ne}function Ns(l){l.scrollToMessageId=void 0,l.scrollToMessageIsAssistant=void 0}function As(){return!rs()}function ws(l){var e;return(e=l.metadata)==null?void 0:e.async_task_title}function Is(){return Date.now()}function ks(l){var e;return(e=l.metadata)==null?void 0:e.async_task_id}function Rs(l){return l.type===Bt}function Es(l){return X.getConversationTurnIds(l)}const Q=Zt({cotDetails:{id:"GKVpeP",defaultMessage:"Reasoning details"},placeholderTitle:{id:"w0RKFn",defaultMessage:"Thinking"},proThinkingTitle:{id:"wOEgCa",defaultMessage:"Pro thinking"},queries:{id:"8HonUQ",defaultMessage:"{count, plural, one {# query} other {# queries}}"},sources:{id:"YC7OAc",defaultMessage:"{count, plural, one {# source} other {# sources}}"},activity:{id:"1TpF7a",defaultMessage:"Activity"},sourcesTitle:{id:"XUf3jw",defaultMessage:"Sources"}});function Ut(l){"use forget";const e=We.c(10),{onAddContext:n,onStopTask:C,taskIsFinalizing:T}=l;let h,r;e[0]===Symbol.for("react.memo_cache_sentinel")?(h=s.jsx(ys,{}),r=s.jsx(He,{id:"hVKG6H",defaultMessage:"Stop"}),e[0]=h,e[1]=r):(h=e[0],r=e[1]);let x;e[2]!==C?(x=s.jsxs(It,{onClick:C,color:"secondary",className:"flex flex-1 items-center justify-center gap-2",children:[h,r]}),e[2]=C,e[3]=x):x=e[3];let o;e[4]!==n||e[5]!==T?(o=n&&s.jsxs(It,{onClick:n,className:"flex flex-1 items-center justify-center gap-2",disabled:T,children:[s.jsx(Cs,{className:"me-1"}),T?s.jsx(He,{id:"WhS0Hs",defaultMessage:"Finalizing"}):s.jsx(He,{id:"d3wD0e",defaultMessage:"Update"})]}),e[4]=n,e[5]=T,e[6]=o):o=e[6];let b;return e[7]!==x||e[8]!==o?(b=s.jsx("div",{className:"bg-token-bg-primary border-t p-4",children:s.jsxs("div",{className:"flex gap-2",children:[x,o]})}),e[7]=x,e[8]=o,e[9]=b):b=e[9],b}const Bs=Object.freeze(Object.defineProperty({__proto__:null,ChatScreenCoTFlyout:_s,SidebarButtons:Ut},Symbol.toStringTag,{value:"Module"}));export{bs as C,Ut as S,Ps as a,Bs as c};
//# sourceMappingURL=h2fsh6u947t1mvet.js.map
