var z=Object.defineProperty,U=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var B=(i,e,n)=>e in i?z(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n,C=(i,e)=>{for(var n in e||(e={}))H.call(e,n)&&B(i,n,e[n]);if(A)for(var n of A(e))W.call(e,n)&&B(i,n,e[n]);return i},_=(i,e)=>U(i,Y(e));import{e as Q,r as v,j as t,f as D,M as T,c as $,u as K,a as J}from"./i8clt0mfz495j7ii.js";import{C as X,d as R,$ as q,h7 as Z,e as ee,R as O}from"./ghewn7l2ynbm32fm.js";import{P as te,i as ae}from"./dyjp0wep007vxvkq.js";import{o as se,hk as L,V as ie}from"./j0yo6uv6652vva62.js";import"./ia54sddtrl9qa2wj.js";function ne({forceInviteeRole:i=null,initialInviteMethod:e="email",initialEmail:n="",initialPhone:p="",initialRole:j="",isOpen:E=!0,isSubmitting:I=!1,onClose:w,onSubmit:P,showCloseButton:S=!0}){const a=Q(),[r,f]=v.useState(e),[M,x]=v.useState(n),[y,g]=v.useState(p),[u,o]=v.useState(null),[l,d]=v.useState(null),[c,h]=v.useState(()=>{var m;return(m=i!=null?i:j)!=null?m:""}),k=M.trim(),N=y.trim(),b=r==="email"?k:N,G=!c||I||b.length===0||(r==="email"?u!=null:l!=null),F=t.jsx(Z,{href:"https://help.openai.com/en/articles/12315553-parental-controls-faq",className:"underline",children:t.jsx(T,{id:"0M5wS5",defaultMessage:"Learn more"})});return t.jsxs(X,{testId:"modal-invite-members-to-amphora",isOpen:E,onClose:w,size:"custom",showCloseButton:S,className:"max-w-md text-sm",title:i==null?a.formatMessage(s.inviteMemberModalTitle):a.formatMessage(s.inviteChildModalTitle),children:[t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[t.jsx("label",{htmlFor:r==="email"?"email":"amphora-invite-phone",className:"text-sm font-medium",children:a.formatMessage(r==="email"?s.invitesInputLabel:s.invitesPhoneInputLabel)}),t.jsx("button",{type:"button",className:"text-token-text-secondary text-sm underline underline-offset-[2px] [text-decoration-skip-ink:none]",onClick:()=>f(m=>{const V=m==="email"?"phone":"email";return o(null),d(null),V}),children:a.formatMessage(r==="email"?s.switchToPhoneLink:s.switchToEmailLink)})]}),r==="email"?t.jsxs(t.Fragment,{children:[t.jsx(se,{name:"email",ariaLabel:!1,type:"email",value:M,onChange:m=>{x(m.target.value),u&&o(null)},autoFocus:!0,placeholder:a.formatMessage(s.invitesInputPlaceholder),className:R(u&&"border-red-500 focus-within:border-red-500 focus-within:ring-red-500")}),u?t.jsx("p",{className:"mt-1 text-xs text-red-500",children:u}):null]}):t.jsx(te,{id:"amphora-invite-phone",name:"account_identifier",value:y,setValue:m=>{g(m),l&&d(null)},label:a.formatMessage(s.invitesPhoneInputLabel),error:l!=null?l:void 0,appearance:{layout:"inline",showDialCodePrefix:!1,rounded:"lg",densePadding:!0,triggerShowOnlyDialCode:!0,fullWidthJustifyDialCode:!1,placeholderTextSize:"sm",dropdownPanelWidthPx:320}}),t.jsx("p",{className:"text-token-text-tertiary mt-2 text-xs",children:a.formatMessage(s.invitesInputHelperText)})]}),i==null&&t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsx("p",{className:"text-sm font-medium",children:a.formatMessage(s.relationshipQuestion)}),t.jsx("div",{className:"flex flex-col gap-3",children:t.jsxs(L.Root,{className:"text-token-text-primary flex flex-col gap-2 text-sm",value:c,onValueChange:m=>h(m),children:[t.jsx(L.Item,{value:"owner",label:a.formatMessage(s.roleOwner),children:t.jsx(L.Indicator,{})}),t.jsx(L.Item,{value:"member_role",label:a.formatMessage(s.roleMember),children:t.jsx(L.Indicator,{})})]})})]}),t.jsx("div",{className:R("overflow-clip duration-300 [interpolate-size:allow-keywords] motion-safe:transition-[height]",c?"h-max":"h-0"),children:c==="owner"?t.jsx("p",{className:"text-token-text-secondary text-xs",children:t.jsx(T,_(C({},s.relationshipInfoForMember),{values:{LearnMoreLink:F}}))}):c==="member_role"?t.jsx("p",{className:"text-token-text-secondary text-xs",children:t.jsx(T,_(C({},s.relationshipInfoForOwner),{values:{LearnMoreLink:F}}))}):null})]}),t.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[t.jsx(q,{color:"secondary",onClick:w,children:a.formatMessage(s.cancelButton)}),t.jsx(q,{onClick:()=>{const m=c==="owner"?"owner":"member_role";if(b){if(o(null),d(null),r==="email"){if(!ie.test(k)){o(a.formatMessage(s.invalidEmailError));return}}else if(!ae(N)){d(a.formatMessage(s.invalidPhoneError));return}P({accountIdentifier:b,inviteMethod:r,role:m})}},disabled:G,children:t.jsx(T,C({},s.modalInviteButton))})]})]})}const s=D({inviteMemberModalTitle:{id:"amphora.inviteMemberModalTitle",defaultMessage:"Invite family member"},inviteChildModalTitle:{id:"amphora.inviteChildModalTitle",defaultMessage:"Add a child"},invitesInputPlaceholder:{id:"amphora.members.invitesInputPlaceholder2",defaultMessage:"name@email.com"},invitesInputLabel:{id:"amphora.members.invitesInputLabel",defaultMessage:"Email address"},invitesPhoneInputLabel:{id:"amphora.members.invitesPhoneInputLabel",defaultMessage:"Phone number"},invitesInputHelperText:{id:"amphora.members.invitesInputHelperText2",defaultMessage:"If your family member is new to ChatGPT, they'll be asked to create an account."},switchToPhoneLink:{id:"amphora.members.usePhoneLink",defaultMessage:"Use phone"},switchToEmailLink:{id:"amphora.members.useEmailLink",defaultMessage:"Use email"},invalidEmailError:{id:"amphora.members.invalidEmailError",defaultMessage:"Enter a valid email address."},invalidPhoneError:{id:"amphora.members.invalidPhoneError",defaultMessage:"Enter a valid phone number."},cancelButton:{id:"amphora.members.cancelButton",defaultMessage:"Cancel"},modalInviteButton:{id:"amphora.members.modalInviteButton",defaultMessage:"Send"},relationshipQuestion:{id:"amphora.members.relationshipQuestion",defaultMessage:"This person is:"},relationshipInfoForOwner:{id:"amphora.members.relationshipInfoForOwner2",defaultMessage:"If your child accepts, you'll be able to manage some of their settings, set time limits, and add safeguards that work for your family. You won't have access to details about your teen's conversations with ChatGPT, except in certain rare safety circumstances. You can unlink accounts anytime. {LearnMoreLink}"},relationshipInfoForMember:{id:"amphora.members.relationshipInfoForMember2",defaultMessage:"Your parent or guardian will be able to adjust certain features, set time limits, and add safeguards to help guide your experience. We won't share details of your conversations with ChatGPT, except in certain rare safety circumstances. You can unlink accounts anytime. {LearnMoreLink}"},roleMember:{id:"amphora.members.inviteModalRoleMember",defaultMessage:"My child"},roleOwner:{id:"amphora.members.inviteModalRoleOwner",defaultMessage:"My parent or guardian"}});function he(i){"use forget";const e=$.c(19),{amphora_id:n,onClose:p,forceInviteeRole:j}=i,E=Q(),I=K(),w=ee(),[P,S]=v.useState(n!=null?n:null);let a;e[0]!==P?(a=async o=>{var k;const{accountIdentifier:l,role:d}=o;let c=!1,h=P;if(!h){const N=d==="owner"?"member_role":"owner",b=await O.safePost("/amphora",{requestBody:{role:N}});if(h=(k=b==null?void 0:b.id)!=null?k:null,!h)throw window.location.reload(),new Error("Failed to create amphora group");c=!0,S(h)}if(!h)throw new Error("Failed to determine amphora id");return await O.safePost("/amphora/{amphora_id}/members",{parameters:{path:{amphora_id:h}},requestBody:{members:[{account_identifier:l,role:d}]}}),{amphoraId:h,createdNewAmphora:c}},e[0]=P,e[1]=a):a=e[1];let r;e[2]!==p||e[3]!==I?(r=o=>{const{amphoraId:l,createdNewAmphora:d}=o;d&&I.invalidateQueries({queryKey:["amphora"],exact:!0}),l&&I.invalidateQueries({queryKey:["amphora",l]}),p()},e[2]=p,e[3]=I,e[4]=r):r=e[4];let f;e[5]!==E||e[6]!==w?(f=o=>{const l=o instanceof Error?o.message:String(o);w.danger(E.formatMessage(re.inviteError,{error:l}),{toastId:"amphora_invite_error"})},e[5]=E,e[6]=w,e[7]=f):f=e[7];let M;e[8]!==a||e[9]!==r||e[10]!==f?(M={mutationFn:a,onSuccess:r,onError:f},e[8]=a,e[9]=r,e[10]=f,e[11]=M):M=e[11];const x=J(M),y=j!=null?j:null;let g;e[12]!==x?(g=o=>{const{accountIdentifier:l,role:d}=o;return x.mutate({accountIdentifier:l,role:d})},e[12]=x,e[13]=g):g=e[13];let u;return e[14]!==x.isPending||e[15]!==p||e[16]!==y||e[17]!==g?(u=t.jsx(ne,{forceInviteeRole:y,onClose:p,onSubmit:g,isSubmitting:x.isPending}),e[14]=x.isPending,e[15]=p,e[16]=y,e[17]=g,e[18]=u):u=e[18],u}const re=D({inviteError:{id:"amphora.members.inviteError",defaultMessage:"Unable to send invite: {error}"}});export{he as AmphoraInviteModal};
//# sourceMappingURL=fy4hmnn2rznj0pfd.js.map
