const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/3j20em1lilnrpdcm.js","assets/i8clt0mfz495j7ii.js","assets/dkkcsrii3168szu2.js","assets/ceivmd4pm4umbvdn.js","assets/nju52ppu7cxhyzrm.js","assets/eqmr3ssx7mhy67lm.js","assets/eoe1k1cgpspr6c5f.js","assets/j0yo6uv6652vva62.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css","assets/bwwtp434e5t8plq3.js","assets/bgxcag65uz54fc39.js"])))=>i.map(i=>d[i]);
var Ke=Object.freeze,Je=Object.defineProperty,Ts=Object.defineProperties;var Ds=Object.getOwnPropertyDescriptors;var Ye=Object.getOwnPropertySymbols;var Es=Object.prototype.hasOwnProperty,Hs=Object.prototype.propertyIsEnumerable;var Xe=(s,t,r)=>t in s?Je(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,R=(s,t)=>{for(var r in t||(t={}))Es.call(t,r)&&Xe(s,r,t[r]);if(Ye)for(var r of Ye(t))Hs.call(t,r)&&Xe(s,r,t[r]);return s},oe=(s,t)=>Ts(s,Ds(t));var Ce=(s,t)=>Ke(Je(s,"raw",{value:Ke(t||s.slice())}));import{j as e,M as i,_ as B,l as Os,e as le,u as ye,a as Me,f as ve,r as f,h as ms,b as us,c as Gs,d as As}from"./i8clt0mfz495j7ii.js";import{d as se,$ as ae,o as V,L as W,aV as Is,T as Ae,bf as Ls,bg as Ps,cw as Fs,t5 as Us,t6 as zs,t7 as qs,cC as Bs,h6 as Vs,li as Ws,e as Le,R as te,t8 as pe,jE as Qs,t4 as $s,e4 as x,P as Y,h7 as xe,b7 as Ie,u as Pe,z as fs,C as be,ba as Ks,h as Ys,b6 as Xs,bd as Js,F as hs,M as Ze}from"./ghewn7l2ynbm32fm.js";import{kW as gs,tY as xs,tZ as Zs,t_ as et,t$ as Ms,bh as ue,bi as he,bj as fe,u0 as ps,u1 as st,bf as ys,gW as vs,bg as bs,bc as tt,u2 as rt,aR as js,m as ot,bk as at}from"./j0yo6uv6652vva62.js";import{T as ee}from"./zm1ki9l766pgg0bx.js";const nt=V(()=>B(()=>import("./3j20em1lilnrpdcm.js").then(s=>s._),__vite__mapDeps([0,1])),{loading:s=>W(s)}),it=V(()=>B(()=>import("./dkkcsrii3168szu2.js").then(s=>s._),__vite__mapDeps([2,1])),{loading:s=>W(s)}),lt=80,je=100;function _s(s){return s<je?"bg-token-bg-status-warning text-token-text-status-warning":"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default"}function ws(s){return gs()&&s!=null&&s>lt}function $t({memoryFullPct:s,className:t,children:r,showInfoLabel:o,onManageMemories:a}){return ws(s)?e.jsx("div",{className:se("border-token-border-default rounded-lg border p-1 text-sm",t),children:e.jsxs(Is.div,{className:se("flex h-7 items-center gap-1 overflow-hidden rounded-sm px-1.5 font-medium whitespace-nowrap",_s(s)),initial:{width:0},animate:{width:"".concat(s,"%")},transition:{duration:.5},children:[e.jsx(it,{className:"icon-sm ms-1"}),e.jsx(i,{id:"6D2etG",defaultMessage:"{memoryFullPct}% full",values:{memoryFullPct:s}}),r,o&&e.jsx(Ae,{interactive:!0,label:s<je?e.jsx("div",{className:"whitespace-normal",children:e.jsx(i,{id:"gxY4wi",defaultMessage:"ChatGPT's almost out of space for new saved memories. <memoryModalLink>Manage saved memories</memoryModalLink> to create more space.",values:{memoryModalLink:g=>e.jsx("a",{href:"#",className:"cursor-pointer underline",onClick:_=>{_.preventDefault(),a==null||a()},children:g})}})}):e.jsx("div",{className:"whitespace-normal",children:e.jsx(i,{id:"1JxMf3",defaultMessage:"ChatGPT's out of space for saved memories. <memoryModalLink>Manage saved memories</memoryModalLink> to create more space.",values:{memoryModalLink:g=>e.jsx("a",{href:"#",className:"cursor-pointer underline",onClick:_=>{_.preventDefault(),a==null||a()},children:g})}})}),children:e.jsx(nt,{className:"icon-sm ms-1"})})]})}):null}function dt({memoryFullPct:s,className:t,showUpgradeCTA:r=!1,isPaid:o=!1,onUpgrade:a}){return ws(s)?e.jsxs("div",{className:se("border-token-border-default bg-token-main-surface-primary flex items-center justify-between gap-4 rounded-lg border p-[14px]",t),children:[e.jsxs("div",{className:"inline-block gap-1",children:[e.jsx("div",{className:se("mb-1 inline-block rounded-[6px] px-[6px] py-[2px] text-sm font-semibold",_s(s!=null?s:0)),children:e.jsx(i,{id:"56hzv4",defaultMessage:"{memoryFullPct}% full",values:{memoryFullPct:s}})}),e.jsx("div",{className:"text-token-text-secondary text-sm",children:(s!=null?s:0)>=je?o?e.jsx(i,{id:"HaCKNx",defaultMessage:"New memories can't be saved, so responses may feel less personalized. Delete existing memories to free up space."}):e.jsx(i,{id:"MXPinw",defaultMessage:"New memories can't be saved, so responses may feel less personalized. Upgrade to expand memory, or delete existing memories."}):o?e.jsx(i,{id:"obgK9b",defaultMessage:"Once memory is full, responses may feel less personalized. Delete existing memories to free up space."}):e.jsx(i,{id:"PDLzFM",defaultMessage:"Once memory is full, responses may feel less personalized. Upgrade to expand memory, or delete existing memories."})})]}),r&&!o&&e.jsx(ae,{color:"primary",size:"medium",onClick:a,children:e.jsx(i,{id:"1rRvWt",defaultMessage:"Upgrade"})})]}):null}function ct({memoryFullPct:s,className:t,onUpgrade:r}){const o=(s!=null?s:0)>=je,a=o?"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default":"bg-token-bg-status-warning text-token-text-status-warning";return e.jsxs("div",{className:se("border-token-border-default bg-token-main-surface-primary flex items-center justify-between gap-4 rounded-2xl border p-[14px]",t),children:[e.jsxs("div",{className:"inline-block gap-1",children:[e.jsx("div",{className:se("mb-1 inline-block rounded-[6px] px-[6px] py-[2px] text-sm font-semibold",a),children:e.jsx(i,{id:"56hzv4",defaultMessage:"{memoryFullPct}% full",values:{memoryFullPct:s}})}),e.jsx("div",{className:"text-token-text-secondary text-xs",children:o?e.jsx(i,{id:"MXPinw",defaultMessage:"New memories can't be saved, so responses may feel less personalized. Upgrade to expand memory, or delete existing memories."}):e.jsx(i,{id:"PDLzFM",defaultMessage:"Once memory is full, responses may feel less personalized. Upgrade to expand memory, or delete existing memories."})})]}),e.jsx(ae,{color:"primary",size:"medium",onClick:r,children:e.jsx(i,{id:"1rRvWt",defaultMessage:"Upgrade"})})]})}var Ne,es;function mt(){if(es)return Ne;es=1;var s=Ls(),t=Ps(),r="[object RegExp]";function o(a){return t(a)&&s(a)==r}return Ne=o,Ne}var Se,ss;function ut(){if(ss)return Se;ss=1;var s=mt(),t=Fs(),r=Us(),o=r&&r.isRegExp,a=o?t(o):s;return Se=a,Se}var Re,ts;function ft(){if(ts)return Re;ts=1;var s=zs(),t=s("length");return Re=t,Re}var Te,rs;function ht(){if(rs)return Te;rs=1;var s="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",o="\\u20d0-\\u20ff",a=t+r+o,n="\\ufe0e\\ufe0f",g="["+s+"]",_="["+a+"]",m="\\ud83c[\\udffb-\\udfff]",v="(?:"+_+"|"+m+")",T="[^"+s+"]",y="(?:\\ud83c[\\udde6-\\uddff]){2}",D="[\\ud800-\\udbff][\\udc00-\\udfff]",C="\\u200d",M=v+"?",b="["+n+"]?",w="(?:"+C+"(?:"+[T,y,D].join("|")+")"+b+M+")*",j=b+M+w,l="(?:"+[T+_+"?",_,y,D,g].join("|")+")",p=RegExp(m+"(?="+m+")|"+l+j,"g");function E(N){for(var S=p.lastIndex=0;p.test(N);)++S;return S}return Te=E,Te}var De,os;function gt(){if(os)return De;os=1;var s=ft(),t=xs(),r=ht();function o(a){return t(a)?r(a):s(a)}return De=o,De}var Ee,as;function xt(){if(as)return Ee;as=1;var s=qs(),t=Zs(),r=xs(),o=Bs(),a=ut(),n=gt(),g=et(),_=Vs(),m=Ws(),v=30,T="...",y=/\w*$/;function D(C,M){var b=v,w=T;if(o(M)){var j="separator"in M?M.separator:j;b="length"in M?_(M.length):b,w="omission"in M?s(M.omission):w}C=m(C);var l=C.length;if(r(C)){var p=g(C);l=p.length}if(b>=l)return C;var E=b-n(w);if(E<1)return w;var N=p?t(p,0,E).join(""):C.slice(0,E);if(j===void 0)return N+w;if(p&&(E+=N.length-E),a(j)){if(C.slice(E).search(j)){var S,L=N;for(j.global||(j=RegExp(j.source,m(y.exec(j))+"g")),j.lastIndex=0;S=j.exec(L);)var u=S.index;N=N.slice(0,u===void 0?E:u)}}else if(C.indexOf(s(j),E)!=E){var P=N.lastIndexOf(j);P>-1&&(N=N.slice(0,P))}return N+w}return Ee=D,Ee}var Mt=xt();const ks=Os(Mt),pt=V(()=>B(()=>import("./ceivmd4pm4umbvdn.js").then(s=>s._),__vite__mapDeps([3,1])),{loading:s=>W(s)}),yt=V(()=>B(()=>import("./nju52ppu7cxhyzrm.js").then(s=>s._),__vite__mapDeps([4,1])),{loading:s=>W(s)}),vt=V(()=>B(()=>import("./eqmr3ssx7mhy67lm.js").then(s=>s._),__vite__mapDeps([5,1])),{loading:s=>W(s)}),bt="https://help.openai.com/en/articles/8590148-memory-faq";function Cs({memory:s,gizmo:t,className:r,readOnly:o,showDivider:a}){var J,ce;const n=le(),g=Le(),_=ye(),m=Ms(),{mutate:v,isPending:T}=Me({mutationFn:async({memoryId:G,status:$})=>{const{success:K}=await te.safePatch("/memories/{memory_id}/status",{parameters:{path:{memory_id:G}},requestBody:{status:$}});if(!K)throw new Error("An error occurred while updating the memory status")},onSettled:()=>{_.invalidateQueries({queryKey:ue(t==null?void 0:t.id)}),_.invalidateQueries({queryKey:he()})},onError:()=>{g.danger(U.somethingWentWrong,{id:"memoryUpdateStatusFailed",toastId:"memory_update_status_failed"})}}),{mutate:y,isPending:D}=Me({mutationFn:async G=>{const{success:$}=await te.safeDelete("/memories/{memory_id}",{parameters:{path:{memory_id:G}},requestBody:{gizmo_id:t==null?void 0:t.id}});if(!$)throw new Error("An error occurred while deleting the memory")},onSettled:()=>{_.invalidateQueries({queryKey:ue(t==null?void 0:t.id)}),_.invalidateQueries({queryKey:he()})},onError:()=>{g.danger(U.deleteFailed,{id:"memoryDeleteFailed",toastId:"memory_delete_failed"})}}),[C,M]=f.useState(!1);function b(G){const $=new Date,K=G.getFullYear()===$.getFullYear();try{return n.formatDate(G,R({month:"long",day:"numeric"},K?{}:{year:"numeric"}))}catch(ne){const re={month:"long",day:"numeric"};return K||(re.year="numeric"),G.toLocaleDateString(void 0,re)}}const w=n.formatMessage(U.moreOptions),l=((J=s.status)!=null?J:pe)==="cold",p=l?()=>{Y.logEvent("Memory Manage Modal Memory Unarchive Clicked"),v({memoryId:s.id,status:"warm"},{onSuccess:()=>{g.successNeutral(n.formatMessage(U.memoryPrioritized),{duration:4,hasCloseButton:!1})}})}:void 0,E=()=>{Y.logEvent("Memory Manage Modal Memory Delete Clicked"),M(!0)},N=l&&s.last_updated?U.deprioritizedOnNoReason:null,S=l&&s.last_updated?{actor:s.last_updated.actor==="user"?n.formatMessage(U.you):"ChatGPT",date:s.last_updated.timestamp!=null?(()=>{const G=Qs(s.last_updated.timestamp);return b(G)})():n.formatMessage(U.unknownDate)}:void 0,L=s.conversation_id,u=L?"/c/".concat(L):void 0,P=s.updated_at?(()=>{const G=$s(s.updated_at);return b(G)})():void 0,Z=l?null:u?P?U.savedOnFromChat:U.savedFromChat:P?U.savedOnNoChat:null,O=l?void 0:u?{date:P,link:G=>e.jsx("a",{href:u,className:"underline",target:"_blank",rel:"noreferrer",children:G})}:P?{date:P}:void 0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:se("group border-token-border-default flex w-full flex-row items-center gap-3 border-b px-3",a===!1&&"border-b-0",(D||T)&&"pointer-events-none opacity-50",r),children:[e.jsx("div",{className:se("min-w-0 flex-1 py-3 whitespace-pre-wrap",l&&"text-token-text-tertiary"),children:s.content}),e.jsx("div",{className:"flex shrink-0 justify-end",children:e.jsx(ee.Actions,{children:!o&&e.jsxs(x.Root,{children:[e.jsx(x.Trigger,{asChild:!0,children:e.jsx("button",{"aria-label":w,className:"text-token-text-tertiary hover:text-token-text-secondary pointer-events-none size-8! opacity-0 group-hover:pointer-events-auto group-hover:opacity-100",children:e.jsx(yt,{className:"icon"})})}),e.jsx(x.Portal,{children:e.jsxs(x.Content,{align:"start",size:"small",className:"max-w-[280px] min-w-0",children:[p&&m&&e.jsx(x.Item,{icon:vt,onClick:p,children:n.formatMessage(U.prioritizeThisMemory)}),e.jsx(x.Item,{icon:pt,color:"danger",onClick:E,children:n.formatMessage(U.delete)}),N&&S&&e.jsx(x.Group,{children:e.jsx("div",{className:"text-token-text-tertiary px-4 py-2 text-[13px] leading-4",children:e.jsx(i,oe(R({},N),{values:S}))})}),Z&&O&&e.jsx(x.Group,{children:e.jsx("div",{className:"text-token-text-tertiary px-4 py-2 text-[13px] leading-4",children:e.jsx(i,oe(R({},Z),{values:O}))})})]})})]})})})]}),!o&&C&&e.jsx(fe,{isOpen:!0,primaryButtonColor:"danger",title:n.formatMessage(U.deleteConfirmTitle),confirmText:n.formatMessage(U.delete),onConfirm:()=>{Y.logEvent("Memory Manage Modal Memory Delete Confirmed"),y(s.id,{onSuccess:()=>{g.successNeutral(n.formatMessage(U.memoryDeleted),{duration:4,hasCloseButton:!1})}}),M(!1)},onClose:()=>{M(!1)},children:e.jsx("div",{className:"mb-2 text-sm",children:n.formatMessage(U.deleteConfirmDescription,{name:(ce=t==null?void 0:t.name)!=null?ce:"ChatGPT",title:e.jsx("strong",{children:ks(s.content,{length:130,omission:"..."})}),link:G=>e.jsx("a",{href:bt,target:"_blank",rel:"noreferrer",className:"underline",children:G})})})})]})}const U=ve({deprioritizedOnNoReason:{id:"MemoryRow.deprioritizedOnNoReason",defaultMessage:"Deprioritized by {actor} on {date}."},deprioritizedOnWithReason:{id:"MemoryRow.deprioritizedOnWithReason",defaultMessage:"Deprioritized by {actor} on {date} because {reason}."},delete:{id:"MemoryRow.delete",defaultMessage:"Delete"},deleteConfirmTitle:{id:"MemoryRow.deleteConfirmTitle",defaultMessage:"Delete this memory?"},deleteConfirmDescription:{id:"MemoryRow.deleteConfirmDescription",defaultMessage:'"{title}" will be deleted. {name} may not remember this information going forward. <link>Learn more</link>'},deleteFailed:{id:"MemoryRow.deleteFailed",defaultMessage:"Failed to forget memory"},moreOptions:{id:"MemoryRow.moreOptions",defaultMessage:"More options"},savedFromChat:{id:"MemoryRow.savedFromChat",defaultMessage:"Saved from a <link>chat</link>."},savedOnFromChat:{id:"MemoryRow.savedOnFromChat",defaultMessage:"Saved on {date} from a <link>chat</link>."},savedOnNoChat:{id:"MemoryRow.savedOnNoChat",defaultMessage:"Saved on {date}."},somethingWentWrong:{id:"MemoryRow.somethingWentWrong",defaultMessage:"Something went wrong..."},memoryPrioritized:{id:"MemoryRow.memoryPrioritized",defaultMessage:"Memory prioritized"},memoryDeleted:{id:"MemoryRow.memoryDeleted",defaultMessage:"Memory deleted"},prioritizeThisMemory:{id:"MemoryRow.prioritizeThisMemory",defaultMessage:"Prioritize this memory"},unknownDate:{id:"MemoryRow.unknownDate",defaultMessage:"Unknown date"},you:{id:"MemoryRow.you",defaultMessage:"You"}}),jt=80,_t=100;function wt(s){const t=gs(),r=ps();return t&&!r&&s!=null&&s>jt}function kt({memoryFullPct:s,className:t}){if(!wt(s))return null;const o=s;return e.jsx("div",{className:se("flex items-center justify-center",t),children:e.jsx("div",{className:se("flex items-center justify-center gap-0.5 rounded-[8px] p-1 text-sm leading-4 font-semibold whitespace-nowrap",o>=_t?"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default":"bg-token-bg-status-warning text-token-text-status-warning"),children:e.jsx(i,{id:"R17Ykc",defaultMessage:"{memoryFullPct}% full",values:{memoryFullPct:o}})})})}const He=ve({disableOptimizeTitle:{id:"personalizationSettings.disableOptimizeTitle",defaultMessage:"Turn off automatic memory management?"},turnOff:{id:"common.turnOff",defaultMessage:"Turn off"},disableOptimizeDescription:{id:"personalizationSettings.disableOptimizeDescription",defaultMessage:"Once memory is full, ChatGPT won't save new memories, and responses may feel less personal. {link}"}}),Ct=({isOpen:s=!1,setShowDisableOMConfirm:t,goldenHourMutation:r})=>{const o=le();return e.jsx(fe,{isOpen:s,title:o.formatMessage(He.disableOptimizeTitle),confirmText:o.formatMessage(He.turnOff),primaryButtonColor:"danger",onConfirm:()=>{r.mutate({setting:Ie.GoldenHour,value:!1}),t(!1)},onClose:()=>{t(!1)},children:e.jsx("div",{className:"mb-2 text-sm",children:e.jsx(i,oe(R({},He.disableOptimizeDescription),{values:{link:a=>e.jsx(xe,{href:"https://help.openai.com/en/articles/8590148-memory-faq",className:"underline",children:a})}}))})})},Nt=V(()=>B(()=>import("./ceivmd4pm4umbvdn.js").then(s=>s._),__vite__mapDeps([3,1])),{loading:s=>W(s)}),St=V(()=>B(()=>import("./nju52ppu7cxhyzrm.js").then(s=>s._),__vite__mapDeps([4,1])),{loading:s=>W(s)});function Rt({label:s,active:t,onClick:r}){return e.jsx("button",{onClick:r,className:"rounded-lg px-3 py-2.5 text-start text-sm "+(t?"dark:bg-token-interactive-bg-secondary-press dark:hover:bg-token-interactive-bg-secondary-hover bg-[#0000000f] hover:bg-[#0000000a]":"dark:hover:bg-token-interactive-bg-secondary-hover hover:bg-[#0000000a]"),children:e.jsx("div",{className:"font-semibold text-wrap",children:s})})}function Tt({isOpen:s,onClose:t}){const r=le(),o=Pe();fs(o);const a=ye(),{data:n,isLoading:g,isFetching:_,refetch:m}=st(50,s),v=f.useMemo(()=>Array.isArray(n==null?void 0:n.history)?n.history:[],[n]),T=g||_&&!n,[y,D]=f.useState(null),[C,M]=f.useState(!1),[b,w]=f.useState(!1),[j,l]=f.useState(!1),[p,E]=f.useState(!1),N=f.useCallback(async()=>{await m()},[m]),S=f.useCallback(h=>{const d=new Date((h||0)*1e3),k=d.getFullYear()===new Date().getFullYear();try{const A=r.formatDate(d,R({month:"long",day:"numeric"},k?{}:{year:"numeric"})),I=r.formatTime(d,{hour:"numeric",minute:"2-digit"});return"".concat(A,", ").concat(I)}catch(A){const I={month:"long",day:"numeric"};k||(I.year="numeric");const F=d.toLocaleDateString(void 0,I),z=d.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"});return"".concat(F,", ").concat(z)}},[r]),L=f.useMemo(()=>v.map(h=>{var d;return{id:(d=h.id)!=null?d:"__current__",label:S(h.snapshot_time)}}),[v,S]),u=f.useMemo(()=>{var d,k,A;if(v.length===0)return null;if(y==null)return(k=(d=v.find(I=>I.id==null))!=null?d:v[0])!=null?k:null;const h=y==="__current__"?null:y;return(A=v.find(I=>{var F;return((F=I.id)!=null?F:"__current__")===(h!=null?h:"__current__")}))!=null?A:null},[v,y]),P=f.useMemo(()=>u?S(u.snapshot_time):"",[u,S]),Z=f.useCallback(()=>{!u||u.id==null||l(!0)},[u]),O=f.useCallback(async()=>{if(!(!u||u.id==null)){E(!0);try{const{success:h}=await te.safeDelete("/memories/history/{memory_history_id}",{parameters:{path:{memory_history_id:u.id}}});if(!h)throw new Error("failed");await N(),D(null)}catch(h){}finally{E(!1),l(!1)}}},[u,N]),J=(y!=null?y:"__current__")==="__current__",ce=(u==null?void 0:u.id)!=null&&!J;f.useEffect(()=>{if(!s||T)return;if(v.length===0){D(k=>k===null?k:null);return}const h=new Set(v.map(k=>{var A;return(A=k.id)!=null?A:"__current__"})),d=h.has("__current__");D(k=>{var I,F;const A=k!=null?k:"__current__";return h.has(A)?k:d?null:(F=(I=v[0])==null?void 0:I.id)!=null?F:null})},[s,T,v]);function G(h){var F,z;const d=h.updated_at!=null?Date.parse(h.updated_at):NaN;let k=(F=h.last_updated)==null?void 0:F.timestamp;k=k!=null?k:(z=h.created_timestamp)!=null?z:void 0;const A=k!=null?k*1e3:NaN,I=Math.max(Number.isFinite(d)?d:-1/0,Number.isFinite(A)?A:-1/0);return Number.isFinite(I)?I:0}const{currentMemories:$,deprioritizedMemories:K}=f.useMemo(()=>{var I,F;const h=(I=u==null?void 0:u.memories)!=null?I:[],d=[],k=[];for(const z of h)((F=z.status)!=null?F:pe)==="cold"?k.push(z):d.push(z);const A=(z,de)=>G(de)-G(z);return{currentMemories:d.sort(A),deprioritizedMemories:k.sort(A)}},[u]),ne=f.useMemo(()=>[...$,...K],[$,K]);let re=null;return T?re=e.jsxs("div",{className:"border-token-border-default flex w-full flex-col rounded-lg border",children:[e.jsxs("div",{className:"border-token-border-default relative flex flex-row items-center justify-between gap-3 px-4 py-5",children:[e.jsxs("div",{className:"flex w-48 flex-col gap-2 px-3",children:[e.jsx("div",{className:"bg-token-bg-tertiary h-5 w-48 animate-pulse rounded"}),e.jsx("div",{className:"bg-token-bg-tertiary h-3 w-28 animate-pulse rounded"})]}),e.jsx("div",{className:"bg-token-bg-tertiary h-8 w-36 animate-pulse rounded-full"}),e.jsx("span",{className:"sr-only",children:e.jsx(i,R({},q.loading))})]}),e.jsx("div",{className:"flex flex-1 overflow-y-auto px-4",children:e.jsx("div",{className:"w-full",children:Array.from({length:6}).map((h,d)=>{const k=Math.floor(Math.random()*193)+128;return e.jsx("div",{className:"border-token-border-default flex items-start gap-3 border-b py-4",children:e.jsx("div",{className:"bg-token-bg-tertiary h-6 animate-pulse rounded",style:{width:"".concat(k,"px")}})},d)})})})]}):u?re=e.jsxs("div",{className:"border-token-border-default flex w-full flex-col rounded-lg border",children:[e.jsxs("div",{className:"border-token-border-default group relative flex flex-row items-center justify-between gap-2 px-4 py-5",children:[e.jsx("div",{className:"min-w-0 flex-1 px-3",children:e.jsx("div",{className:"text-lg font-semibold",children:P})}),e.jsxs("div",{className:"flex h-full shrink-0 items-start gap-2 pe-1",children:[ce?e.jsxs(x.Root,{children:[e.jsx(x.Trigger,{asChild:!0,children:e.jsx("button",{"aria-label":r.formatMessage(q.moreOptions),className:"text-token-text-tertiary hover:text-token-text-secondary size-8!",children:e.jsx(St,{className:"icon"})})}),e.jsx(x.Portal,{children:e.jsx(x.Content,{align:"start",size:"small",className:"max-w-[200px] min-w-0",children:e.jsx(x.Item,{icon:Nt,color:"danger",onClick:Z,className:"gap-2.5! pe-3!",children:r.formatMessage(q.deleteSnapshot)})})})]}):null,e.jsx(ae,{color:"secondary",onClick:()=>M(!0),disabled:J,style:{pointerEvents:J?"none":void 0},children:u.id==null?e.jsx(i,R({},q.currentVersion)):e.jsx(i,R({},q.restoreThisVersion))})]})]}),$.length+K.length===0?e.jsx("div",{className:"text-token-text-tertiary flex flex-1 items-center justify-center p-4 text-sm",children:e.jsx(i,R({},q.noMemories))}):e.jsx("div",{className:"flex flex-1 overflow-y-auto px-4",children:e.jsx("div",{className:"w-full text-sm",children:ne.map((h,d)=>e.jsx(Cs,{memory:h,gizmo:void 0,readOnly:!0,showDivider:d!==ne.length-1},h.id))})})]}):re=e.jsx("div",{className:"border-token-border-default text-token-text-tertiary flex h-full w-full items-center justify-center rounded-lg border p-4 text-sm",children:e.jsx(i,R({},q.noMemories))}),e.jsxs(e.Fragment,{children:[e.jsx(be,{testId:"modal-saved-memories-history",isOpen:s,onClose:t,size:"custom",className:"max-h-[85vh] max-md:min-h-[60vh] md:h-[740px] md:max-w-[960px]",type:"success",title:r.formatMessage(q.title),showCloseButton:!0,children:e.jsxs("div",{className:"flex h-full min-h-0 gap-4",children:[e.jsx("div",{className:"w-60 shrink-0 overflow-y-auto",children:e.jsx("div",{className:"flex flex-col pb-2",children:T?Array.from({length:6}).map((h,d)=>e.jsx("div",{className:"rounded px-3 py-2.5",children:e.jsx("div",{className:"bg-token-bg-tertiary h-4 w-40 animate-pulse rounded"})},d)):e.jsxs(e.Fragment,{children:[L.map(h=>{const d=(y!=null?y:"__current__")===h.id;return e.jsx(Rt,{label:h.label,active:d,onClick:()=>D(h.id)},h.id)}),L.length===0?e.jsx("div",{className:"text-sm",children:e.jsx(i,R({},q.noHistory))}):null]})})}),e.jsx("div",{className:"flex min-w-0 flex-1 overflow-hidden",children:re})]})}),j&&(u==null?void 0:u.id)!=null&&e.jsx(fe,{isOpen:!0,title:r.formatMessage(q.confirmDeleteTitle),confirmText:r.formatMessage(q.confirmDeleteCta),primaryButtonColor:"danger",loading:p,onConfirm:O,onClose:()=>{p||l(!1)},children:e.jsx("div",{className:"text-token-text-secondary mb-2 text-sm",children:e.jsx(i,R({},q.confirmDeleteBody))})}),C&&e.jsx(fe,{isOpen:!0,title:r.formatMessage(q.confirmRestoreTitle),confirmText:r.formatMessage(q.confirmRestoreCta),primaryButtonColor:"danger",loading:b,onConfirm:async()=>{if(!(!u||u.id==null)){w(!0);try{const{success:h}=await te.safePost("/memories/history/{memory_history_id}/revert",{parameters:{path:{memory_history_id:u.id}}});if(!h)throw new Error("failed");await N(),D(null),a.invalidateQueries({queryKey:["memories"]})}catch(h){}finally{M(!1),w(!1)}}},onClose:()=>M(!1),children:e.jsx("div",{className:"mb-2 text-sm",children:e.jsx(i,R({},q.confirmRestoreBody))})})]})}const q=ve({title:{id:"SavedMemoriesHistoryModal.title",defaultMessage:"Saved memories history"},loading:{id:"SavedMemoriesHistoryModal.loading",defaultMessage:"Loading..."},noHistory:{id:"SavedMemoriesHistoryModal.noHistory",defaultMessage:"No checkpoints"},noMemories:{id:"SavedMemoriesHistoryModal.noMemories",defaultMessage:"No memories"},currentVersion:{id:"SavedMemoriesHistoryModal.currentVersion",defaultMessage:"Current version"},restoreThisVersion:{id:"SavedMemoriesHistoryModal.restoreThisVersion",defaultMessage:"Restore this version"},confirmRestoreTitle:{id:"SavedMemoriesHistoryModal.confirmRestoreTitle",defaultMessage:"Restore this version?"},confirmRestoreBody:{id:"SavedMemoriesHistoryModal.confirmRestoreBody",defaultMessage:"This will replace your current saved memories."},confirmRestoreCta:{id:"SavedMemoriesHistoryModal.confirmRestoreCta",defaultMessage:"Restore"},cancel:{id:"common.cancel",defaultMessage:"Cancel"},moreOptions:{id:"SavedMemoriesHistoryModal.moreOptions",defaultMessage:"More options"},deleteSnapshot:{id:"SavedMemoriesHistoryModal.deleteSnapshot",defaultMessage:"Delete this version"},confirmDeleteTitle:{id:"SavedMemoriesHistoryModal.confirmDeleteTitle",defaultMessage:"Delete this version?"},confirmDeleteBody:{id:"SavedMemoriesHistoryModal.confirmDeleteBody",defaultMessage:"This cannot be undone."},confirmDeleteCta:{id:"SavedMemoriesHistoryModal.confirmDeleteCta",defaultMessage:"Delete"}}),Dt=V(()=>B(()=>import("./eoe1k1cgpspr6c5f.js").then(s=>s._),__vite__mapDeps([6,1])),{loading:s=>W(s)}),ns=V(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yo),__vite__mapDeps([7,1,8,9,10])),{loading:s=>W(s)}),Et=V(()=>B(()=>import("./bwwtp434e5t8plq3.js").then(s=>s._),__vite__mapDeps([11,1])),{loading:s=>W(s)}),Ht=V(()=>B(()=>import("./nju52ppu7cxhyzrm.js").then(s=>s._),__vite__mapDeps([4,1])),{loading:s=>W(s)});V(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yA),__vite__mapDeps([7,1,8,9,10])),{loading:s=>W(s)});var ds;const ge=hs.div(ds||(ds=Ce(["flex h-full items-center justify-center pb-8 text-sm text-token-text-tertiary rounded-lg border border-token-border-default"])));function is(s){var n,g;const t=s.updated_at!=null?Date.parse(s.updated_at):NaN;let r=(n=s.last_updated)==null?void 0:n.timestamp;r=r!=null?r:(g=s.created_timestamp)!=null?g:void 0;const o=r!=null?r*1e3:NaN,a=Math.max(Number.isFinite(t)?t:-1/0,Number.isFinite(o)?o:-1/0);return Number.isFinite(a)?a:0}function Kt({isOpen:s,onClose:t,initialGizmoId:r,contextScopes:o,memoryEntriesFilter:a,requiredContextScopes:n}){var qe,Be,Ve,We,Qe,$e;const g=Pe(),_=ms(),m=le(),v=Ks(),T=ys(),[y,D]=f.useState(r),[C,M]=f.useState(!1),[b,w]=f.useState(""),[j,l]=f.useState(!1),[p,E]=f.useState(!1),[N,S]=f.useState(!1),[L,u]=f.useState(!1),[P,Z]=f.useState(!1),O=vs();Ys(g,"1900515849");const J=Ms(),{data:ce,isLoading:G}=Xs(Ie.GoldenHour),$=ce!==void 0&&J,K=ps(),ne=Js(!0),re=f.useCallback(c=>{if(!c&&K){Z(!0);return}ne.mutate({setting:Ie.GoldenHour,value:c}),Y.logEventWithStatsig("Personalization Settings Automatic Memory Management ".concat(c?"Enabled":"Disabled"),"chatgpt_personalization_settings_automatic_memory_management_".concat(c?"enabled":"disabled"))},[ne,K]),h=G||ne.isPending,{data:d,isLoading:k,isError:A,refetch:I}=bs(y,!0,T,o,a,n),F=(qe=d==null?void 0:d.memories)!=null?qe:[],z=F.length,de=[...F].sort((c,Q)=>(C?1:-1)*(is(c)-is(Q))),_e=(()=>{const c=b.trim();if(c==="")return de;const Q=new Set(tt(de,c,ie=>({targets:[ie.content]}),{locale:m.locale,maxResults:de.length}).map(ie=>ie.id));return de.filter(ie=>Q.has(ie.id))})(),Fe=_e.filter(c=>{var Q;return((Q=c.status)!=null?Q:pe)!=="cold"}),Ue=_e.filter(c=>{var Q;return((Q=c.status)!=null?Q:pe)==="cold"}),ze=f.useMemo(()=>[...Fe,...Ue],[Fe,Ue]),{data:we,refetch:Ut}=us({queryKey:["memory_gizmos"],queryFn:()=>te.safeGet("/memories/gizmos"),refetchOnMount:"always"}),ke=rt(g,(Be=d==null?void 0:d.memoryFullPct)!=null?Be:0)!=="control",X=[{id:void 0,name:"ChatGPT",iconUrl:null},...(Ve=we==null?void 0:we.items.map(({gizmo:c})=>{var Q;return{id:c.id,name:c.display.name,iconUrl:(Q=c.display.profile_picture_url)!=null?Q:null}}))!=null?Ve:[]].find(c=>c.id===y);f.useEffect(()=>{!k&&!A&&y!==void 0&&z===0&&D(void 0)},[k,A,y,z]);const Ns=O&&K?H.descriptionOptimizeOn:O&&$?H.descriptionPaid:O?H.descriptionFreeMoonshine:H.descriptionFree,Ss=c=>e.jsx(xe,{href:Oe,className:"underline",children:c});let me;return k?me=e.jsx(ge,{className:"border-none",children:e.jsx(i,R({},H.loading))}):A?me=e.jsx(ge,{className:"border-none",children:e.jsxs("div",{className:"max-w-sm text-center",children:[e.jsx("div",{className:"mb-4 text-red-500",children:e.jsx(i,{id:"MemoriesModal.somethingWentWrong",defaultMessage:"Something went wrong..."})}),e.jsx("div",{children:e.jsx(ae,{color:"secondary",size:"small",onClick:()=>{I()},children:e.jsx(i,{id:"MemoriesModal.retry",defaultMessage:"Retry"})})})]})}):z===0?me=e.jsx(ge,{className:"text-token-text-primary border-none",children:T?e.jsxs("div",{className:"flex h-full max-w-sm flex-col items-center justify-center gap-0.5 text-center text-base",children:[e.jsx(Et,{className:"icon-xl"}),e.jsx(i,oe(R({},H.noMemories),{values:{name:(We=X==null?void 0:X.name)!=null?We:"ChatGPT"}}))]}):e.jsx("div",{className:"flex h-full max-w-sm items-center justify-center text-center",children:e.jsx(i,R({},H.noMemoriesAndDisabled))})}):b.trim()!==""&&_e.length===0?me=e.jsx(ge,{className:"text-token-text-tertiary border-none",children:e.jsxs("div",{className:"flex h-full max-w-sm flex-col items-center justify-center gap-2 text-center text-base",children:[e.jsx(ns,{className:"icon-lg"}),e.jsx("div",{children:e.jsx(i,oe(R({},H.searchNoResults),{values:{query:b.trim()}}))}),e.jsx("div",{children:e.jsx(ae,{color:"secondary",size:"small",onClick:()=>{S(!0)},children:e.jsx(i,R({},H.viewHistory))})})]})}):me=e.jsx(ee.Root,{size:"compact",children:e.jsx(ee.Body,{children:ze.map((c,Q)=>{const ie=X?{id:X.id,name:X.name}:void 0,Rs={memory:c,gizmo:ie,showDivider:Q!==ze.length-1};return e.jsx(Cs,R({},Rs),c.id)})})}),e.jsxs(e.Fragment,{children:[e.jsxs(be,{testId:"modal-golden-hour-memories",isOpen:s,size:"custom",className:"max-h-[85vh] px-2 py-2 max-md:min-h-[60vh] md:h-[740px] md:max-w-[680px]",headerClassName:"shrink-0",contentClassName:"h-full flex flex-col",type:"success",onClose:t,title:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:m.formatMessage(H.title)}),!ke&&e.jsx(kt,{memoryFullPct:d==null?void 0:d.memoryFullPct})]}),description:!ke&&e.jsx("div",{className:"text-token-text-secondary",children:m.formatMessage(Ns,{link:Ss})}),showCloseButton:!0,isScrollable:!1,children:[e.jsxs("div",{className:"border-token-border-default w-full border-b pb-4",children:[ke&&e.jsx(ct,{memoryFullPct:d==null?void 0:d.memoryFullPct,onUpgrade:()=>{var c;Y.logEventWithStatsig("Memories Upgrade Button Clicked","chatgpt_memories_upgrade_button_clicked_settings",{memory_full_pct:(c=d==null?void 0:d.memoryFullPct)!=null?c:0}),js(_,"chatgpt_memories_upgrade_button")},className:"mb-6"}),e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"relative min-w-0 flex-1",children:[e.jsx("div",{className:"pointer-events-none absolute start-3 top-1/2 flex h-5 w-5 -translate-y-1/2 items-center justify-center",children:e.jsx(ns,{className:"icon text-token-text-tertiary"})}),e.jsx("input",{type:"text",id:"memories-search",name:"memories-search",placeholder:m.formatMessage(H.searchPlaceholder),className:"border-token-border-default placeholder:text-token-text-tertiary/70 h-9.5 w-full max-w-[320px] rounded-full border bg-transparent ps-10 pe-3 text-sm outline-none focus:shadow-none focus:ring-0 focus:outline-none",value:b,onChange:c=>w(c.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsxs(x.Root,{children:[e.jsx(x.Trigger,{asChild:!0,children:e.jsx("button",{"aria-label":m.formatMessage(H.sortAria),className:"text-token-text-tertiary hover:text-token-text-secondary hover:bg-token-interactive-bg-tertiary-hover inline-flex size-8! items-center justify-center rounded-md",children:e.jsx(Dt,{className:"icon"})})}),e.jsx(x.Portal,{children:e.jsxs(x.Content,{align:"start",size:"auto",className:"max-w-[280px] min-w-[165px]",children:[e.jsx(x.Group,{children:e.jsx("div",{className:"text-token-text-tertiary px-4 pt-2.5 pb-2 text-[13px] leading-4",children:e.jsx(i,R({},H.sortHeader))})}),e.jsxs(x.RadioGroup,{value:C?"oldest":"newest",onValueChange:c=>M(c==="oldest"),children:[e.jsx(x.RadioItem,{value:"newest",children:e.jsx(i,R({},H.newestFirst))}),e.jsx(x.RadioItem,{value:"oldest",children:e.jsx(i,R({},H.oldestFirst))})]})]})})]}),e.jsxs(x.Root,{children:[e.jsx(x.Trigger,{asChild:!0,children:e.jsx("button",{"aria-label":m.formatMessage(H.moreOptionsAria),className:"text-token-text-tertiary hover:text-token-text-secondary hover:bg-token-interactive-bg-tertiary-hover inline-flex size-8! items-center justify-center rounded-md",children:e.jsx(Ht,{className:"icon"})})}),e.jsx(x.Portal,{children:e.jsxs(x.Content,{align:"start",size:"small",className:"max-w-[280px] min-w-0",children:[$&&e.jsx(x.Group,{children:e.jsx(x.CheckboxItem,{label:m.formatMessage(H.autoManageTitle),checked:K,disabled:h,onCheckedChange:c=>{re(c===!0)}})}),e.jsxs(x.Group,{children:[e.jsx(x.Item,{onClick:()=>{S(!0)},children:e.jsx(i,R({},H.viewHistory))}),e.jsx(x.Item,{color:"danger",onClick:()=>{E(!1),l(!0)},children:e.jsx(i,R({},H.deleteAllMemories))})]})]})})]})]})]})]}),e.jsx("div",{className:"h-full min-w-sm overflow-y-auto",children:me}),j&&e.jsx(fe,{isOpen:!0,primaryButtonColor:"danger",title:m.formatMessage(H.deleteAllConfirmTitle),confirmText:m.formatMessage(H.deleteAllConfirmCta),loading:L,onConfirm:async()=>{u(!0);try{const c={gizmo_id:y,context_scopes:o,required_context_scopes:n,memory_entries_filter:a,delete_history:p};y===void 0&&(c.delete_history=p),await te.safeDelete("/settings/clear_account_user_memory",{requestBody:c}),await I()}catch(c){}finally{u(!1),l(!1)}},onClose:()=>l(!1),children:e.jsxs("div",{className:"mb-2 flex flex-col gap-5 text-sm",children:[e.jsx("div",{className:"text-sm",children:O?e.jsx(i,oe(R({},H.deleteAllConfirmDescriptionUpdated),{values:{name:(Qe=X==null?void 0:X.name)!=null?Qe:"ChatGPT",link:c=>e.jsx(xe,{href:Oe,className:"underline",children:c})}})):e.jsx(i,oe(R({},H.deleteAllConfirmDescription),{values:{name:($e=X==null?void 0:X.name)!=null?$e:"ChatGPT",link:c=>e.jsx(xe,{href:Oe,className:"underline",children:c})}}))}),e.jsxs("div",{className:"border-token-border-default flex flex-row gap-3 rounded-2xl border px-4 py-4 text-sm",children:[e.jsx(ot,{id:"delete-past-versions",checked:p,onChange:c=>E(c.target.checked),className:"border-token-border-default! h-5 w-5 shrink-0 rounded-full! border ring-0 ring-offset-0 focus:ring-0 focus:ring-offset-0 focus:outline-none",style:{backgroundColor:p?v?"transparent":"black":"transparent"}}),e.jsx("span",{children:m.formatMessage(H.alsoDeletePastVersions)})]})]})})]}),e.jsx(Tt,{isOpen:N,onClose:()=>S(!1)}),$&&P&&e.jsx(Ct,{isOpen:P,setShowDisableOMConfirm:Z,goldenHourMutation:ne})]})}const Oe="https://help.openai.com/en/articles/8983136-what-is-memory",H=ve({descriptionFree:{id:"GoldenHourMemoriesModalFree.description",defaultMessage:"ChatGPT remembers useful details about you and your preferences so it can be more helpful. <link>Learn more</link>"},descriptionFreeMoonshine:{id:"GoldenHourMemoriesModal.description.freeMoonshine",defaultMessage:"ChatGPT tries to remember your recent chats, but it may forget things over time. Saved memories are never forgotten. <link>Learn more</link>"},descriptionPaid:{id:"GoldenHourMemoriesModal.description",defaultMessage:"ChatGPT automatically remembers useful information from chats, making responses more relevant and personal. <link>Learn more</link>"},descriptionOptimizeOn:{id:"GoldenHourMemoriesModal.description.optimizeOn",defaultMessage:"ChatGPT remembers and automatically manages useful information from chats, making responses more relevant and personal. <link>Learn more</link>"},delete:{id:"GoldenHourMemoriesModal.delete",defaultMessage:"Delete"},deleteDescription:{id:"GoldenHourMemoriesModal.deleteDescription",defaultMessage:'"{title}" will be deleted. {name} may not remember this information going forward. <link>Learn more</link>'},history:{id:"GoldenHourMemoriesModal.history",defaultMessage:"History"},historyIntro:{id:"GoldenHourMemoriesModal.historyIntro",defaultMessage:"Revert to a previous version of your saved memories."},historyModalTitle:{id:"GoldenHourMemoriesModal.historyModalTitle",defaultMessage:"Saved memories history"},loading:{id:"GoldenHourMemoriesModal.loading",defaultMessage:"Loading..."},noHistory:{id:"GoldenHourMemoriesModal.noHistory",defaultMessage:"No checkpoints"},noMemories:{id:"GoldenHourMemoriesModal.noMemories",defaultMessage:"No saved memories"},noMemoriesAndDisabled:{id:"GoldenHourMemoriesModal.noMemoriesAndDisabled",defaultMessage:"Memory is disabled. ChatGPT won't use or save memories."},autoManageTitle:{id:"GoldenHourMemoriesModal.autoManageTitle",defaultMessage:"Automatically manage"},remove:{id:"GoldenHourMemoriesModal.remove",defaultMessage:"Remove"},retry:{id:"GoldenHourMemoriesModal.retry",defaultMessage:"Retry"},somethingWentWrong:{id:"GoldenHourMemoriesModal.somethingWentWrong",defaultMessage:"Something went wrong..."},title:{id:"GoldenHourMemoriesModal.title",defaultMessage:"Saved memories"},unknownGizmo:{id:"GoldenHourMemoriesModal.unknownGizmo",defaultMessage:"Unknown GPT"},viewHistoryTooltip:{id:"GoldenHourMemoriesModal.viewHistoryTooltip",defaultMessage:"View saved memories history"},viewingSnapshot:{id:"GoldenHourMemoriesModal.viewingSnapshot",defaultMessage:"Viewing snapshot from {date}"},searchPlaceholder:{id:"GoldenHourMemoriesModal.searchPlaceholder",defaultMessage:"Search memories"},searchNoResults:{id:"GoldenHourMemoriesModal.searchNoResults",defaultMessage:'No results found for "{query}"'},sortAria:{id:"GoldenHourMemoriesModal.sortAria",defaultMessage:"Sort"},sortHeader:{id:"GoldenHourMemoriesModal.sortHeader",defaultMessage:"Sort"},newestFirst:{id:"GoldenHourMemoriesModal.newestFirst",defaultMessage:"Newest first"},oldestFirst:{id:"GoldenHourMemoriesModal.oldestFirst",defaultMessage:"Oldest first"},moreOptionsAria:{id:"GoldenHourMemoriesModal.moreOptionsAria",defaultMessage:"More options"},viewHistory:{id:"GoldenHourMemoriesModal.viewHistory",defaultMessage:"View history"},deleteAllMemories:{id:"GoldenHourMemoriesModal.deleteAllMemories",defaultMessage:"Delete all memories"},deleteAllConfirmTitle:{id:"GoldenHourMemoriesModal.deleteAllConfirmTitle",defaultMessage:"Delete all memories?"},deleteAllConfirmCta:{id:"GoldenHourMemoriesModal.deleteAllConfirmCta",defaultMessage:"Delete all"},deleteAllConfirmDescription:{id:"GoldenHourMemoriesModal.deleteAllConfirmDescription",defaultMessage:"{name} may not remember this information going forward. To fully remove this information from memory, also delete any related chats. <link>Learn more</link>"},deleteAllConfirmDescriptionUpdated:{id:"GoldenHourMemoriesModal.deleteAllConfirmDescriptionUpdated",defaultMessage:"{name} may not remember this information going forward. To fully remove this information from memory, also delete any related chats. <link>Learn more</link>"},alsoDeletePastVersions:{id:"GoldenHourMemoriesModal.alsoDeletePastVersions",defaultMessage:"Also delete all past versions of saved memories. This cannot be undone."}});function ls({description:s,onClose:t,onConfirm:r}){const o=le();return e.jsx(be,{testId:"modal-confirm-reset-memory",isOpen:!0,onClose:t,type:"success",title:o.formatMessage({id:"MemoriesModal.resetModalTitle",defaultMessage:"Are you sure?"}),description:s,primaryButton:e.jsx(Ze.Button,{title:o.formatMessage({id:"MemoriesModal.resetModalConfirm",defaultMessage:"Clear memory"}),color:"danger",onClick:r,"data-testid":"confirm-reset-memories-button"}),secondaryButton:e.jsx(Ze.Button,{title:o.formatMessage({id:"MemoriesModal.resetModalCancel",defaultMessage:"Cancel"}),color:"secondary",onClick:t})})}function Ot(s){"use forget";const t=Gs.c(20),{onReset:r,gizmoId:o,memoryName:a,contextScopes:n,requiredContextScopes:g,memoryEntriesFilter:_}=s,[m,v]=f.useState(!1),T=le(),y=Le(),D=vs();let C;t[0]!==n||t[1]!==o||t[2]!==T||t[3]!==_||t[4]!==r||t[5]!==g||t[6]!==y?(C=async()=>{Y.logEvent("Memory Manage Reset Button Confirmed");try{const p={context_scopes:n,required_context_scopes:g,memory_entries_filter:_};o&&(p.gizmo_id=o),await te.safeDelete("/settings/clear_account_user_memory",{requestBody:p}),y.success(T.formatMessage({id:"ResetMemoriesButton.resetSuccess",defaultMessage:"Memory cleared."})),r&&r(),v(!1)}catch(p){y.danger(As({id:"ResetMemoriesButton.resetFailed",defaultMessage:"Failed to clear memory."}),{toastId:"reset_memories_button_reset_failed"})}},t[0]=n,t[1]=o,t[2]=T,t[3]=_,t[4]=r,t[5]=g,t[6]=y,t[7]=C):C=t[7];const M=C;let b;t[8]===Symbol.for("react.memo_cache_sentinel")?(b=()=>{Y.logEvent("Memory Manage Reset Button Clicked"),v(!0)},t[8]=b):b=t[8];let w;t[9]!==o?(w=e.jsx(ae,{color:"danger-outline",onClick:b,"data-testid":"reset-memories-button",children:o?e.jsx(i,{id:"ResetMemoriesButton.resetGizmo",defaultMessage:"Clear this GPT's memory"}):e.jsx(i,{id:"ResetMemoriesButton.resetChatGPT",defaultMessage:"Delete all"})}),t[9]=o,t[10]=w):w=t[10];let j;t[11]!==M||t[12]!==D||t[13]!==T||t[14]!==a||t[15]!==m?(j=m&&(D?e.jsx(ls,{description:T.formatMessage({id:"MemoriesModal.resetGizmoModalDescriptionUpdated",defaultMessage:"Deleting your saved memories means {name} may not remember this information going forward. To fully remove this information from {name}'s memory, please delete any related chats. <link>Learn more</link>"},{name:a,link:Gt}),onClose:()=>v(!1),onConfirm:M}):e.jsx(ls,{description:T.formatMessage({id:"MemoriesModal.resetGizmoModalDescription",defaultMessage:"{name} will forget everything it has remembered from your chats. This cannot be undone."},{name:a}),onClose:()=>v(!1),onConfirm:M})),t[11]=M,t[12]=D,t[13]=T,t[14]=a,t[15]=m,t[16]=j):j=t[16];let l;return t[17]!==w||t[18]!==j?(l=e.jsxs(e.Fragment,{children:[w,j]}),t[17]=w,t[18]=j,t[19]=l):l=t[19],l}function Gt(s){return e.jsx("a",{className:"underline",href:"https://help.openai.com/en/articles/8983136-what-is-memory",children:s})}const At=V(()=>B(()=>import("./ceivmd4pm4umbvdn.js").then(s=>s._),__vite__mapDeps([3,1])),{loading:s=>W(s)}),It=V(()=>B(()=>import("./bgxcag65uz54fc39.js").then(s=>s._),__vite__mapDeps([12,1])),{loading:s=>W(s)}),Lt=V(()=>B(()=>import("./j0yo6uv6652vva62.js").then(s=>s.yA),__vite__mapDeps([7,1,8,9,10])),{loading:s=>W(s)});function Pt({gizmo:s,memory:t}){var j;const r=le(),o=Le(),a=ye(),[n,g]=f.useState(!1),[_,m]=f.useState(t.content),v=f.useRef(null);f.useEffect(()=>{if(n&&v.current){const l=v.current,p=l.value.length;l.focus(),l.setSelectionRange(p,p)}},[n]);const{mutate:T,isPending:y}=Me({mutationFn:async l=>{const{success:p}=await te.safeDelete("/memories/{memory_id}",{parameters:{path:{memory_id:l}},requestBody:{gizmo_id:s==null?void 0:s.id}});if(!p)throw new Error("An error occurred while deleting the memory")},onSettled:()=>{a.invalidateQueries({queryKey:ue(s==null?void 0:s.id)}),a.invalidateQueries({queryKey:he()})},onError:()=>{o.danger({id:"MemoriesModal.deleteFailed",defaultMessage:"Failed to forget memory",description:"Toast message when deleting memory fails"},{id:"memoryDeleteFailed",toastId:"memory_delete_failed"})}}),{mutate:D,isPending:C}=Me({mutationFn:async()=>await te.safePatch("/memories/{memory_id}",{parameters:{path:{memory_id:t.id}},requestBody:{gizmo_id:s==null?void 0:s.id,content:_}}),onSuccess:l=>{const{memory_max_tokens:p,memory_num_tokens:E}=l;a.setQueryData(ue(s==null?void 0:s.id),N=>{if(!N||typeof N!="object")return N;const S=N,L=Math.min(Math.floor(100*E/p),100);return oe(R({},S),{memory_max_tokens:p,memory_num_tokens:E,memoryFullPct:L})}),a.invalidateQueries({queryKey:ue(s==null?void 0:s.id)}),a.invalidateQueries({queryKey:he()}),g(!1)},onError:()=>{o.danger({id:"MemoriesModal.editFailed",defaultMessage:"Failed to update memory",description:"Toast message when editing memory fails"},{id:"memoryEditFailed",toastId:"memory_edit_failed"})}}),[M,b]=f.useState(!1),w=r.formatMessage({id:"N0czuB",defaultMessage:"Remove"});return e.jsxs(e.Fragment,{children:[e.jsx(ee.Row,{disabled:y||C,children:n?e.jsxs(ee.Cell,{colSpan:2,className:"relative pe-0",children:[e.jsx("input",{ref:v,autoFocus:!0,value:_,onChange:l=>m(l.target.value),className:"w-full rounded border-2 border-transparent py-2 pe-36 focus:outline-none",maxLength:500,onKeyDown:l=>{if(!l.nativeEvent.isComposing&&l.key==="Enter"){if(_.trim()===""){Y.logEvent("Memory Manage Modal Memory Delete Clicked"),b(!0);return}D()}}}),e.jsxs("div",{className:"absolute end-1 top-1/2 flex -translate-y-1/2 gap-1",children:[e.jsx(ae,{color:"secondary",size:"small",onClick:()=>{m(t.content),g(!1)},children:e.jsx(i,{id:"TTo8Tw",defaultMessage:"Cancel"})}),e.jsx(ae,{size:"small",onClick:()=>{if(_.trim()===""){Y.logEvent("Memory Manage Modal Memory Delete Clicked"),b(!0);return}D()},disabled:C,children:e.jsx(i,{id:"mDcKbU",defaultMessage:"Save"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(ee.Cell,{className:"pe-0",divClassName:"min-h-[40px] items-center w-full",children:e.jsx("div",{className:"border-2 border-transparent py-2 whitespace-pre-wrap",children:t.content})}),e.jsx(ee.Cell,{textAlign:"right",children:e.jsxs(ee.Actions,{children:[(()=>{const l=r.formatMessage({id:"EditableMemoriesModal.edit",defaultMessage:"Edit"});return e.jsx("button",{onClick:()=>g(!0),"aria-label":l,className:"text-token-text-tertiary hover:text-token-text-secondary",children:e.jsx(Ae,{label:l,side:"top",className:"leading-none",children:e.jsx(It,{className:"icon-sm"})})})})(),e.jsx("button",{onClick:()=>{Y.logEvent("Memory Manage Modal Memory Delete Clicked"),b(!0)},"aria-label":w,className:"text-token-text-tertiary hover:text-token-text-secondary",children:e.jsx(Ae,{className:"leading-none",label:w,side:"top",children:e.jsx(At,{className:"icon-sm"})})})]})})]})}),M&&e.jsx(fe,{isOpen:!0,primaryButtonColor:"danger",title:w,confirmText:r.formatMessage({id:"fCn0ar",defaultMessage:"Forget"}),onConfirm:()=>{Y.logEvent("Memory Manage Modal Memory Delete Confirmed"),T(t.id),b(!1)},onClose:()=>{b(!1),m(t.content),g(!1)},children:e.jsx(i,{id:"j2cZHW",defaultMessage:'Remove "{title}" from {name}’s saved memories. This can’t be undone. <link>Learn more</link>',values:{name:(j=s==null?void 0:s.name)!=null?j:"ChatGPT",title:e.jsx("strong",{children:ks(t.content,{length:130,omission:"..."})}),link:l=>e.jsx("a",{href:"https://help.openai.com/en/articles/8590148-memory-faq",target:"_blank",className:"underline",rel:"noreferrer",children:l})}})})]})}function Ft({selectedGizmoId:s,onSelect:t,items:r}){const o=r.find(n=>n.id===s);function a(n){var g;return e.jsx(at,{isFirstParty:n.id===void 0,src:(g=n.iconUrl)!=null?g:null,className:"icon"})}return e.jsx("div",{className:"border-token-border-medium mb-2 inline-flex rounded-md border",children:e.jsxs(x.Root,{children:[e.jsx(x.Trigger,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[o?e.jsxs(e.Fragment,{children:[a(o),e.jsx("span",{className:"text-token-text-primary",children:o.name})]}):e.jsx(i,{id:"MemoriesModal.unknownGizmo",defaultMessage:"Unknown GPT"}),e.jsx(Lt,{className:"icon-sm text-token-text-tertiary"})]})}),e.jsx(x.Portal,{children:e.jsx(x.Content,{children:r.map(n=>e.jsxs(x.Item,{className:"flex items-center gap-3",onClick:()=>{t(n.id)},children:[a(n),n.name]},n.id))})})]})})}var cs;const Ge=hs.div(cs||(cs=Ce(["flex h-full items-center justify-center pb-8 text-sm text-token-text-tertiary rounded-lg border border-token-border-default"])));function Yt({onClose:s,initialGizmoId:t,contextScopes:r,memoryEntriesFilter:o,requiredContextScopes:a}){var u,P,Z;const n=le(),g=ye(),_=ys(),[m,v]=f.useState(t),T=Pe(),y=ms(),D=fs(T),C=D==null?void 0:D.hasPlusFeatures();f.useEffect(()=>{Y.logEvent("Memory Modal Shown")},[]);const{data:M,isLoading:b,isError:w,refetch:j}=bs(m,!0,_,r,o,a),l=M==null?void 0:M.memories,{data:p,refetch:E}=us({queryKey:["memory_gizmos"],queryFn:()=>te.safeGet("/memories/gizmos"),refetchOnMount:"always"}),N=[{id:void 0,name:"ChatGPT",iconUrl:null},...(u=p==null?void 0:p.items.map(({gizmo:O})=>{var J;return{id:O.id,name:O.display.name,iconUrl:(J=O.display.profile_picture_url)!=null?J:null}}))!=null?u:[]],S=N.find(O=>O.id===m);f.useEffect(()=>{!b&&!w&&m!==void 0&&(!l||l.length===0)&&v(void 0)},[b,w,l,m]);let L;return b?L=e.jsx(Ge,{children:e.jsx(i,{id:"MemoriesModal.loading",defaultMessage:"Loading..."})}):w?L=e.jsx(Ge,{children:e.jsxs("div",{className:"max-w-sm text-center",children:[e.jsx("div",{className:"mb-4 text-red-500",children:e.jsx(i,{id:"MemoriesModal.somethingWentWrong",defaultMessage:"Something went wrong..."})}),e.jsx("div",{children:e.jsx(ae,{color:"secondary",onClick:()=>{j()},children:e.jsx(i,{id:"MemoriesModal.retry",defaultMessage:"Retry"})})})]})}):!l||l.length===0?L=e.jsx(Ge,{children:e.jsx("div",{className:"max-w-sm text-center",children:_?e.jsx(i,{id:"MemoriesModal.noMemories.1",defaultMessage:"As you chat with {name}, the details and preferences it saves will be shown here.",values:{name:(P=S==null?void 0:S.name)!=null?P:"ChatGPT"}}):e.jsx(i,{id:"MemoriesModal.noMemoriesAndDisabled",defaultMessage:"Memory is disabled. ChatGPT won't use or save memories."})})}):L=e.jsx(ee.Root,{className:"border-token-border-default h-full",size:"compact",bordered:!0,children:e.jsx(ee.Body,{children:l.map(O=>e.jsx(Pt,{gizmo:S?{id:S.id,name:S.name}:void 0,memory:O},O.id))})}),e.jsxs(be,{testId:"modal-memories",isOpen:!0,onClose:s,size:"custom",className:"max-w-5xl",type:"success",title:n.formatMessage({id:"MemoriesModal.title",defaultMessage:"Saved memories"}),showCloseButton:!0,children:[C&&N.length>1&&e.jsx("div",{className:"mb-4",children:e.jsx(Ft,{selectedGizmoId:m,items:N,onSelect:O=>{g.invalidateQueries({queryKey:ue(O)}),g.invalidateQueries({queryKey:he()}),v(O)}})}),e.jsx(dt,{memoryFullPct:M==null?void 0:M.memoryFullPct,className:"mb-5",showUpgradeCTA:!1,isPaid:C,onUpgrade:()=>{Y.logEventWithStatsig("Memories Upgrade Button Clicked","chatgpt_memories_upgrade_button_clicked_settings"),js(y,"chatgpt_memories_upgrade_button")}}),e.jsx("div",{className:"h-[24rem]",children:L}),e.jsx("div",{className:"mt-5 flex justify-end",children:e.jsx(Ot,{onReset:()=>{j(),E(),m&&v(void 0)},gizmoId:m,memoryName:(Z=S==null?void 0:S.name)!=null?Z:"ChatGPT",contextScopes:r,requiredContextScopes:a,memoryEntriesFilter:o})})]})}export{Yt as E,Kt as G,dt as M,Ot as R,$t as a,kt as b,ks as t};
//# sourceMappingURL=gk19dtvu6bikdyrw.js.map
