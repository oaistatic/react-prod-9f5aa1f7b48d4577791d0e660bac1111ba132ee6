const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/3j20em1lilnrpdcm.js","assets/i8clt0mfz495j7ii.js","assets/d5usxzmea5cxgha2.js","assets/nrby27vmpob112wj.js","assets/pdp94tw1ktf1pj0a.js","assets/d3awu4bo9vouiss6.js"])))=>i.map(i=>d[i]);
import{R as E,r as m,j as s,M as k,_ as j,e as O}from"./i8clt0mfz495j7ii.js";import{u as G,aK as V,mO as B,cN as y,cJ as L,bN as q,bQ as D,bO as z,oW as R,mU as H,o as b,aV as g,d as u,aW as P,L as v,ba as U}from"./ghewn7l2ynbm32fm.js";import{T as W}from"./g67jqqe3hqj7p3s8.js";import{C as F}from"./hlon4mihnqp86jji.js";import{c as K}from"./agji492j2wlm3ws1.js";import"./ixwp0fvcs3jhuh48.js";import"./j0yo6uv6652vva62.js";import"./mqebxepg7t6q2tie.js";import"./o564tkn3ln8nzryq.js";import"./ns51nblw8ziscsgd.js";import"./ce3hgmw4iyyhicud.js";import"./drmwaklva7v056il.js";import"./6ji8ehbh56ghw0zw.js";import"./cb0ba83bmi83mjz2.js";import"./dxyrjy681bkwlnj8.js";import"./f76gy0b8ieo4s693.js";import"./icuos2x1zai4tnyd.js";import"./iakvhqfu6nmvphq6.js";import"./k6dbkwjaexelrlgh.js";import"./gdq1l97elemowxcc.js";import"./kiv50zw1ij6k8vyj.js";import"./k1t8elp5z7nmkg2d.js";import"./kau2ug0899cbkpxh.js";import"./o9vew0btr2k0i59c.js";import"./nrnf80lbyqanffwr.js";import"./kz85ppopzltkr0hm.js";import"./ozby1o16tp40naiq.js";import"./gy1lpvuoewmzh42c.js";import"./hxdh3tr5l8kut4ed.js";import"./hu1bt0oauegdhua6.js";import"./lb3e2s17svct1mam.js";import"./nnzgss862gapaux3.js";import"./nfccle6oyncifphl.js";import"./h1em0bjkpkjv8ykw.js";import"./mjbhy8c4bs0n8qw2.js";import"./mjq17q47489shd3e.js";import"./jyyjaseddjwyjwou.js";import"./l0icc3zt92jpknxy.js";import"./i03gut32e8jn5ajq.js";import"./lep2wptoy14cfe2w.js";import"./cxbsld3botts7bfn.js";import"./da0eqg5j39u1e96s.js";import"./bbipyj9bituayr8q.js";import"./gru2v64zamj4frog.js";import"./ib30xv8geh252fv7.js";import"./ol9d5wxhynx9q2is.js";import"./b6hyii2315xk7j19.js";import"./olrcssu7duieo6m7.js";function J({turn:e,turnIndex:t,conversation:o,hasActiveRequest:r,isFinalTurn:n}){return s.jsx(F,{turnIndex:t,conversation:o,groupedMessagesToRender:e.messageGroups,allGroupedMessages:e.messageGroups,allMessages:e.messages,isUserTurn:e.role==="user",isFinalUserTurn:!1,isFinalAssistantTurn:!1,isFinalTurn:n,isCompletionRequestInProgress:!1,isFeedbackEnabled:!1,hasActiveRequest:r,onRequestCompletion:()=>{},renderingView:"share-modal"})}function Q({messages:e,hasActiveRequest:t,clientThreadId:o,allowOrphanMessages:r}){const n=G(),{session:a}=V(n),h=m.useMemo(()=>{var x,p;if(o)return null;const l=B();return y.initThread({clientThreadId:l,conversationMode:{kind:L.PrimaryAssistant},userId:(x=a==null?void 0:a.user)==null?void 0:x.id,accountId:(p=a==null?void 0:a.account)==null?void 0:p.id}),l},[]),i=o!=null?o:h,c=q(n,i),d=m.useMemo(()=>{const l=D(i);if(l&&i===o){let f=[];for(const N of e){let C=N;const w=z.findNode(l,({message:S})=>N.id===S.id);!w&&!r||(w&&(C=w.message),f=R(f,C))}return f}const{allConversationMessages:x,threadResponse:p}=K(e);y.updateThreadFromServer(i,p);let _=[];for(const f of x)_=R(_,f.message);return _.filter(f=>f.role!=="root")},[e,i,o,r]);return s.jsx("div",{className:"space-y-2",children:d.map((l,x)=>s.jsx(J,{turn:l,turnIndex:x,conversation:c,hasActiveRequest:t,isFinalTurn:x===d.length-1},l.messages[0].id))})}const $=E.memo(Q),X=b(()=>j(()=>import("./3j20em1lilnrpdcm.js").then(e=>e._),__vite__mapDeps([0,1])),{loading:e=>v(e)}),Y=b(()=>j(()=>import("./d5usxzmea5cxgha2.js").then(e=>e._),__vite__mapDeps([2,1])),{loading:e=>v(e)}),Z=b(()=>j(()=>import("./nrby27vmpob112wj.js").then(e=>e._),__vite__mapDeps([3,1])),{loading:e=>v(e)}),ee=b(()=>j(()=>import("./pdp94tw1ktf1pj0a.js").then(e=>e._),__vite__mapDeps([4,1])),{loading:e=>v(e)}),se=b(()=>j(()=>import("./d3awu4bo9vouiss6.js").then(e=>e._),__vite__mapDeps([5,1])),{loading:e=>v(e)}),te=m.memo(W,(e,t)=>e.sharedTextdoc.sharedTextdocId===t.sharedTextdoc.sharedTextdocId&&e.showHeader===t.showHeader&&e.disableNetworkRequests===t.disableNetworkRequests&&e.unsafeAllowAllNetworkRequests===t.unsafeAllowAllNetworkRequests&&e.disablePermissions===t.disablePermissions);function I({children:e,className:t,fullscreen:o}){const r=m.useRef(null),[n,a]=m.useState(!1),i=U()?"#353535":"#fff";return m.useEffect(()=>{const c=r.current;if(!c)return;const d=()=>a(c.scrollHeight>c.clientHeight);d();const l=new ResizeObserver(d);return l.observe(c),()=>{l.disconnect()}},[e]),s.jsxs("div",{ref:r,className:u(!o&&"relative",t,!n&&"pb-2"),children:[e,!o&&n&&s.jsx("div",{className:"pointer-events-none absolute start-0 end-0 bottom-0 h-40",style:{background:"linear-gradient(to top, ".concat(i,", transparent)")}})]})}function cs(){return s.jsx("div",{className:"w-full",children:s.jsx("div",{className:"bg-token-main-surface-secondary mx-auto block h-[120px] rounded-3xl",children:s.jsx(H,{})})})}const A={deep_research:s.jsx(Z,{title:"Deep Research",className:"h-[16px] w-[16px]"}),canvas:s.jsx(ee,{title:"Canvas",className:"h-[16px] w-[16px]"}),image:s.jsx(se,{title:"Image",className:"h-[16px] w-[16px]"}),sora:s.jsx(Y,{title:"Sora",className:"h-[16px] w-[16px]"})},oe={deep_research:"Deep Research",canvas:"Canvas",image:"ImageGen",sora:"Sora"},re=({icon:e,label:t})=>s.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-white/80 px-2 py-1 text-xs text-black backdrop-blur-xs dark:bg-black/50 dark:text-white",children:[e,s.jsx("span",{className:"font-semibold",children:t})]}),ds=({tags:e,badgeLabels:t})=>{const o=e.filter(r=>!!A[r]);return o.length===0?null:s.jsx("div",{className:"absolute end-3 top-3 z-10 flex gap-2",children:o.map(r=>{var n;return s.jsx(re,{icon:A[r],label:(n=t==null?void 0:t[r])!=null?n:oe[r]||r},r)})})};function ne({url:e,attachment_width:t,attachment_height:o,isFullscreen:r}){return s.jsx("video",{className:u(r?"mx-auto block max-h-screen max-w-full rounded-none object-contain":"mx-auto block w-full rounded-3xl object-cover object-center"),style:{aspectRatio:t/o},src:e,playsInline:!0,autoPlay:!0,muted:!0,loop:!0})}const ae=m.memo(ne);function ie({attachment:e,isFullscreen:t,isInline:o,isComposer:r}){return s.jsx("div",{className:u(t&&"flex h-screen items-center justify-center",t&&"rounded-none",o&&"rounded-3xl",r&&"mx-24 rounded-3xl"),children:e.generation_type==="video_gen"?s.jsx(ae,{url:e.url,attachment_width:e.width,attachment_height:e.height,isFullscreen:t,isInline:o}):s.jsxs("div",{className:"relative",children:[s.jsx("img",{className:u(t?"mx-auto block max-h-screen max-w-full rounded-none object-contain":"mx-auto block rounded-3xl object-cover object-center"),style:{aspectRatio:e.width/e.height},src:e.url,alt:e.kind}),e.output_blocked&&s.jsxs("div",{className:"text-token-text-error absolute start-0 bottom-0 flex h-1/4 w-full items-center justify-center gap-1 bg-transparent text-xs font-medium",children:[s.jsx(X,{className:"text-red-500"}),s.jsx(k,{id:"post-tree-attachment-output-blocked",defaultMessage:"Blocked by moderation"})]})]})})}const le=m.memo(ie);function ce({url:e,isFullscreen:t,isInline:o,isComposer:r,isUnfurl:n}){const a=O();return s.jsx("div",{className:u(t&&"flex h-screen items-center justify-center",t&&"rounded-none",o&&"rounded-3xl",r&&"mx-24 rounded-3xl",n&&"h-full w-full"),children:s.jsx("img",{src:e,className:u(t?"mx-auto block max-h-screen max-w-full":"mx-auto block aspect-square",t?"rounded-none object-contain":n?"h-full w-full rounded-none object-cover object-top":"rounded-3xl object-center"),alt:a.formatMessage({id:"image-share-renderer-alt",defaultMessage:"User Shared Image"})})})}const T=m.memo(ce);function de({attachment:e,isFullscreen:t,isInline:o}){const r=m.useRef(null);return s.jsx("div",{ref:r,className:u("bg-token-main-surface-primary w-full",t?"h-[100vh] rounded-none":"",o?"h-[300px] cursor-zoom-in overflow-hidden rounded-3xl":"flex-1"),children:s.jsx(te,{disablePermissions:!t,sharedTextdoc:{sharedTextdocId:e.shared_textdoc_id,title:e.shared_textdoc.name,type:e.shared_textdoc.textdoc_type,content:e.shared_textdoc.content},showHeader:!1,unsafeAllowAllNetworkRequests:!0})})}const me=m.memo(de);function ue({attachment:e,caption:t,variant:o,coverPhotoUrl:r,hasActiveRequest:n,clientThreadId:a}){var x;const h=(x=e.tags)==null?void 0:x.includes("deep_research"),i=o==="fullscreen",c=o==="inline",d=o==="composer",l=o==="unfurl";switch(e.kind){case"message_slice":return e.messages.length===0?null:s.jsx(M,{caption:t,variant:o,coverPhotoUrl:r,messages:e.messages,hasActiveRequest:n,hasCaption:!h,clientThreadId:a});case"conversation_share":{const p=e.share.linear_conversation.map(_=>_.message).filter(_=>_!=null);return p.length===0?null:s.jsx(M,{hasCaption:!1,caption:t,variant:o,coverPhotoUrl:r,messages:p,hasActiveRequest:n,clientThreadId:a})}case"image_share":return s.jsx(T,{url:e.file_public_url,isFullscreen:i,isInline:c,isComposer:d,isUnfurl:l});case"media_generation":return s.jsx(T,{url:e.url,isFullscreen:i,isInline:c,isComposer:d,isUnfurl:l});case"canvas":return s.jsx(me,{attachment:e,isFullscreen:i,isInline:c});case"sora":return s.jsx(le,{attachment:e,isFullscreen:i,isInline:c,isComposer:d});case"link":return s.jsx(pe,{url:e.url,ogData:e.og_data,isFullscreen:i,isInline:c,isComposer:d});case"error":return s.jsx("div",{children:s.jsx(k,{id:"post-tree-attachment-error",defaultMessage:"Error loading attachment"})});default:return null}}function xe({url:e,ogData:t,isFullscreen:o,isInline:r,isComposer:n}){var a;return s.jsx(g.div,{layout:"position",className:u("bg-token-main-surface-primary inline-block w-full rounded-3xl dark:bg-[#353535]",o&&"h-screen overflow-auto rounded-none",n&&"shadow-[0_12px_24px_-6px_rgb(0_0_0_/_0.1),0_0_1px_rgb(0_0_0_/_0.2)] dark:shadow-[0_10px_20px_-6px_rgb(20_20_20_/_0.5),inset_0_0_1px_rgb(255_255_255_/_0.3)]"),children:s.jsx(I,{fullscreen:!r,className:u("rounded-b-3xl",o&&"relative p-4 lg:px-24 lg:py-24"),children:s.jsx("div",{className:"flex flex-col gap-2 p-4",children:s.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-token-main-surface-secondary break-words hover:underline",children:s.jsxs("div",{className:"items-top flex flex-row gap-4",children:[t.og_image&&s.jsx("img",{className:"h-40 w-40 object-cover",src:t.og_image,alt:(a=t.og_title)!=null?a:void 0}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("div",{className:"text-token-text-primary font-medium",children:t.og_title||e}),t.og_site_name&&s.jsx("div",{className:"text-token-text-tertiary",children:t.og_site_name}),t.og_description&&s.jsx("div",{className:"text-token-text-secondary",children:t.og_description})]})]})})})})})}const pe=m.memo(xe);function M({caption:e,variant:t,coverPhotoUrl:o,messages:r,hasActiveRequest:n,hasCaption:a,clientThreadId:h}){const i=t==="fullscreen",c=t==="inline",d=t==="composer",l=t==="unfurl";return s.jsxs(g.div,{layout:"position",className:u("bg-token-main-surface-primary inline-block w-full rounded-3xl dark:bg-[#353535]",i&&"h-screen overflow-auto rounded-none",d&&"shadow-[0_12px_24px_-6px_rgb(0_0_0_/_0.1),0_0_1px_rgb(0_0_0_/_0.2)] dark:shadow-[0_10px_20px_-6px_rgb(20_20_20_/_0.5),inset_0_0_1px_rgb(255_255_255_/_0.3)]",l&&"h-full"),children:[o&&s.jsx("img",{className:u("max-h-[300px] w-full object-cover object-center",{"rounded-t-3xl":t!=="fullscreen","rounded-none":i}),src:o,alt:e!=null?e:""}),s.jsx(I,{fullscreen:!c,className:u("rounded-b-3xl",i&&"relative p-4 lg:px-24 lg:py-24",c&&"max-h-[300px] overflow-hidden p-6",d&&"max-h-[300px] overflow-auto p-6",l&&"h-full overflow-hidden p-5"),children:s.jsxs(g.div,{layout:"position",transition:{type:"spring",duration:.45,bounce:.15},children:[s.jsx(P,{mode:"wait",children:a?e==null&&t==="composer"?s.jsx(g.div,{layout:"position",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:s.jsx("div",{className:"text-token-text-primary max-w-[460px] pb-8 text-2xl leading-[1.4] font-medium",children:s.jsx("span",{className:"animate-pulse opacity-30",children:s.jsx(k,{id:"placeholder.generatingTitle",defaultMessage:"Generating title..."})})})},"loading-caption"):e!==""?s.jsx(g.div,{layout:"position",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:s.jsx("div",{className:"text-token-text-primary max-w-[460px] pb-8 text-2xl leading-[1.4] font-medium",children:e})},"caption"):null:null}),s.jsx($,{messages:r,hasActiveRequest:n,clientThreadId:h,allowOrphanMessages:!0})]})})]})}const ms=m.memo(ue);export{ms as AttachmentContent,oe as BADGE_LABELS,re as Badge,ds as BadgeContainer,cs as LoadingAttachmentContent,ue as _AttachmentContent};
//# sourceMappingURL=i62z0czv9p8e8lku.js.map
