const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fg1cwp14kl8llosr.js","assets/i8clt0mfz495j7ii.js","assets/3j20em1lilnrpdcm.js","assets/nw44vms3p4cc1mrm.js","assets/jyroje0qaxw6h3z1.js","assets/frf0wu8ouyfyu06j.js"])))=>i.map(i=>d[i]);
var I=Object.defineProperty,R=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var k=(s,e,a)=>e in s?I(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a,p=(s,e)=>{for(var a in e||(e={}))S.call(e,a)&&k(s,a,e[a]);if(j)for(var a of j(e))O.call(e,a)&&k(s,a,e[a]);return s},_=(s,e)=>R(s,F(e));var P=(s,e)=>{var a={};for(var r in s)S.call(s,r)&&e.indexOf(r)<0&&(a[r]=s[r]);if(s!=null&&j)for(var r of j(s))e.indexOf(r)<0&&O.call(s,r)&&(a[r]=s[r]);return a};import{j as t,M as g,b as L,h as E,r as H,_ as v}from"./i8clt0mfz495j7ii.js";import{R as m,A as x,J as z,oF as A,P as b,gj as N,$ as w,o as f,cj as G,d as W,aL as U,L as y,oG as q}from"./ghewn7l2ynbm32fm.js";import{bU as $}from"./j0yo6uv6652vva62.js";import{M as B}from"./mzyl3pd4zxnxoe9i.js";import{r as V}from"./mjbhy8c4bs0n8qw2.js";const de=async s=>await m.safePost("/shopping/customer",{requestBody:{items:s.map(e=>({id:e.id,value:e.value,quantity:e.quantity}))},authOption:x.SendIfAvailable}),me=async c=>{var n=c,{conversationId:s,sharedConversationUrl:e,existing_customer_session_client_secret:a}=n,r=P(n,["conversationId","sharedConversationUrl","existing_customer_session_client_secret"]);const l=async()=>await m.safePost("/shopping/checkout",{requestBody:{items:r.items.map(d=>({id:d.id,value:d.value,quantity:d.quantity})),conversation_id:s,shared_conversation_url:e,existing_customer_session_client_secret:a},authOption:x.SendIfAvailable});try{return await l()}catch(d){return await l()}},xe=async(s,{shippingMethodId:e,shippingAddress:a,items:r})=>{var d,h,o;const c=performance.now(),n={items:r.map(i=>({id:i.id,value:i.value,quantity:i.quantity}))};e!=null&&(n.shipping_option_id=e),a!=null&&(n.shipping_address={name:(d=a.name)!=null?d:void 0,line_one:(h=a.addressLine1)!=null?h:void 0,line_two:a.addressLine2,city:a.city,state:a.state,postal_code:a.postalCode,country:a.country,phone_number:(o=a.phoneNumber)!=null?o:void 0}),n.items=r.map(i=>({id:i.id,value:i.value,quantity:i.quantity}));const l=await m.safePatch("/shopping/checkout/{checkout_session_id}/update",{parameters:{path:{checkout_session_id:s}},requestBody:n,authOption:x.SendIfAvailable});return z.addAction("shopping_checkout.update",{durationMs:performance.now()-c}),l},he=async(s,e,a,r,c)=>await m.safePost("/shopping/checkout/{checkout_session_id}/complete",{parameters:{path:{checkout_session_id:s}},requestBody:{items:e.map(n=>({id:n.id,value:n.value,quantity:n.quantity})),payment_method:a,attempt_id:r,shipping_address:c},authOption:x.SendIfAvailable}),Q=async()=>(await m.safeGet("/shopping/orders",{authOption:x.SendIfAvailable})).orders,K=async s=>await m.safeGet("/shopping/order/{order_id}",{parameters:{path:{order_id:s}},authOption:x.SendIfAvailable}),J=f(()=>v(()=>import("./fg1cwp14kl8llosr.js"),__vite__mapDeps([0,1])),{loading:s=>y(s)}),X=f(()=>v(()=>import("./3j20em1lilnrpdcm.js").then(s=>s._),__vite__mapDeps([2,1])),{loading:s=>y(s)}),Y=f(()=>v(()=>import("./nw44vms3p4cc1mrm.js").then(s=>s._),__vite__mapDeps([3,1])),{loading:s=>y(s)}),Z=f(()=>v(()=>import("./jyroje0qaxw6h3z1.js").then(s=>s._),__vite__mapDeps([4,1])),{loading:s=>y(s)}),D=f(()=>v(()=>import("./frf0wu8ouyfyu06j.js").then(s=>s._),__vite__mapDeps([5,1])),{loading:s=>y(s)}),C=1e3*5*60;function ue(){const s=ae();return s?t.jsx(te,{orderId:s}):t.jsx(A,{title:t.jsx(g,{id:"xdSD9Q",defaultMessage:"Orders"}),children:t.jsx(ee,{})})}const M=()=>t.jsxs("div",{className:"flex w-full gap-3 py-2",children:[t.jsx("div",{className:"bg-token-bg-tertiary h-20 w-20 rounded-xl"}),t.jsxs("div",{className:"flex flex-1 flex-col items-start justify-start gap-1",children:[t.jsx(q,{index:0,width:50,heightSize:"sm"}),t.jsx(q,{index:0,width:70,heightSize:"sm"})]})]});function ee(){const s=E(),{data:e,isLoading:a,isError:r,error:c}=L({queryKey:["orders"],queryFn:Q,staleTime:C,refetchOnMount:"always",refetchOnWindowFocus:"always"});return a?t.jsx(M,{}):r?t.jsxs("div",{className:"flex min-h-[400px] w-full flex-col items-center justify-center py-6 text-sm",children:[t.jsx(X,{className:"icon-xl"}),t.jsx("div",{className:"text-base font-medium",children:t.jsx(g,{id:"/GqhEc",defaultMessage:"Error loading orders"})}),!1]}):e&&(e!=null&&e.length)?t.jsx("div",{className:"flex flex-col",children:e==null?void 0:e.map((n,l)=>t.jsxs(t.Fragment,{children:[t.jsx(se,{order:n,onClick:()=>{T(s,n.order.id)}},n.order.id),l!==e.length-1&&t.jsx("div",{className:"bg-token-border-light h-px"})]}))}):t.jsxs("div",{className:"flex min-h-[400px] w-full flex-col items-center justify-center py-6 text-sm",children:[t.jsx(Y,{className:"icon-xl"}),t.jsx("div",{className:"text-base font-medium",children:t.jsx(g,{id:"2XILkl",defaultMessage:"No orders yet"})}),t.jsx("div",{className:"text-token-text-secondary text-xs",children:t.jsx(g,{id:"LwFNFv",defaultMessage:"Products you buy with ChatGPT will show here."})})]})}const se=({order:s,onClick:e})=>{var a;return t.jsxs("button",{className:"my-3",onClick:e,children:[t.jsxs("div",{className:"flex gap-3",children:[t.jsx("div",{children:t.jsx("img",{className:"border-token-border-default bg-token-bg-primary shadow-xxs relative h-14 w-14 rounded-[10px] border border-[.5px]",src:(a=s.image_url)!=null?a:"",alt:s.title})}),t.jsxs("div",{className:"flex flex-1 flex-col items-start justify-start gap-0.5",children:[t.jsx("div",{className:"-mt-1 line-clamp-2 text-start text-base",children:s.title}),t.jsx("div",{className:"text-token-text-secondary text-xs",children:s.subtitle})]}),t.jsx("div",{className:"me-2 flex items-center justify-center",children:t.jsx(Z,{className:"icon"})})]}),s.error_message&&t.jsx("div",{className:"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default mt-3 flex items-center rounded-lg px-3 py-1 text-sm",children:s.error_message})]})},te=({orderId:s})=>{var c,n,l,d,h;const{data:e,isLoading:a}=L({queryKey:["order",s],queryFn:()=>K(s),staleTime:C,refetchOnMount:"always",refetchOnWindowFocus:"always"}),r=E();return H.useEffect(()=>{(e!=null&&e.order.conversation_id||e!=null&&e.order.shared_conversation_url)&&s&&b.logEventWithStatsig("product_order_history","product_order_history",_(p({},N({clientThreadId:e==null?void 0:e.order.conversation_id})),{action:"shown",order_id:s,shared_conversation_url:e.order.shared_conversation_url}))},[e==null?void 0:e.order.conversation_id,e==null?void 0:e.order.shared_conversation_url,s]),t.jsxs("div",{children:[t.jsxs("div",{className:"h-header-height my-1 -ms-1 flex flex-shrink-0 items-center gap-2",children:[t.jsx(w,{color:"ghost",size:"medium",onClick:()=>T(r,void 0),contentWrapperClassName:"gap-[6px]",className:"w-9 rounded-lg",children:t.jsx(D,{className:"icon icon-sm"})}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx($,{className:"icon h-[18px] w-[18px] rounded-full",url:(c=e==null?void 0:e.merchant_logo_url)!=null?c:"",size:128,minSize:16,fallback:t.jsx(J,{className:"text-token-text-tertiary"})}),t.jsx("div",{className:"text-sm font-normal",children:e==null?void 0:e.merchant_title})]}),t.jsx("div",{className:"text-token-text-secondary text-xs",children:e==null?void 0:e.merchant_subtitle})]})]}),a?t.jsx(M,{}):e?t.jsxs("div",{className:"flex flex-col pt-1 pb-4",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsx("div",{className:"bg-token-bg-tertiary dark:bg-token-main-surface-primary-inverse overflow-clip rounded-lg",children:t.jsx("img",{className:"m-0 aspect-square h-32 w-32 object-cover mix-blend-darken",src:(n=e==null?void 0:e.image_url)!=null?n:"",alt:(l=e==null?void 0:e.title)!=null?l:""})}),t.jsxs("div",{className:"flex flex-1 flex-col gap-0.5",children:[t.jsx("div",{className:"text-normal line-clamp-2 text-[17px] font-medium",children:e.title}),t.jsx("div",{className:"text-token-text-secondary text-sm",children:e==null?void 0:e.subtitle}),t.jsxs("div",{className:"mt-2 flex w-full flex-1 items-end gap-2",children:[((d=e.order.conversation_id)!=null?d:e.order.shared_conversation_url)&&t.jsx(w,{as:"a",to:e.order.shared_conversation_url||G(e.order.conversation_id),onClick:o=>{o.stopPropagation(),b.logEventWithStatsig("product_order_history","product_order_history",_(p({},N({clientThreadId:e==null?void 0:e.order.conversation_id})),{action:"open_conversation_button_clicked",order_id:s,shared_conversation_url:e.order.shared_conversation_url}))},color:"ghost",className:"border-token-border-light rounded-2xl border px-4",children:t.jsx(g,{id:"bLLnUh",defaultMessage:"Open in ChatGPT"})}),e.external_buttons.map((o,i)=>t.jsx(t.Fragment,{children:t.jsx(w,{as:"a",to:o.url,openNewTab:!0,onClick:u=>{u.stopPropagation(),b.logEventWithStatsig("product_order_history","product_order_history",_(p({},N({clientThreadId:e==null?void 0:e.order.conversation_id})),{action:"external_link_button_clicked",url:o.url,order_id:s}))},color:"ghost",className:"border-token-border-light rounded-2xl border px-4",children:o.title},"".concat(o.title,"-").concat(i))}))]})]})]}),e.error_message&&t.jsx("div",{className:"bg-token-bg-status-error text-token-interactive-label-danger-secondary-default mt-4 flex items-center rounded-lg px-3 py-1 text-sm",children:e.error_message}),t.jsx("div",{className:"mt-8 flex flex-col gap-8",children:(h=e==null?void 0:e.sections)==null?void 0:h.map(o=>t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"border-token-border-light border-b pb-2.5 text-base font-medium",children:o.title}),t.jsx("dl",{className:"divide-token-border-light divide-y",children:o.items.map(i=>t.jsxs("div",{className:"text-token-text-primary flex items-start gap-2 py-2.5 text-sm",children:[t.jsx("dt",{className:"flex-grow text-sm",children:i.label}),t.jsx("dd",{className:"text-end text-sm font-medium whitespace-pre",children:t.jsx(B,{remarkPlugins:[[V,{singleTilde:!1}]],components:{a:u=>t.jsx("a",_(p({},u),{className:W(u.className,"underline"),target:"_blank",children:u.children}))},children:i.value})})]},i.label))})]},o.title))})]}):null]})},T=(s,e)=>{const a=window.location.hash,[r,c]=a.split("?"),n=new URLSearchParams(c);e?n.set("order",e):n.delete("order");const l="#settings/".concat(U.Orders).concat(n.toString()?"?".concat(n.toString()):"");s(l,{replace:!0})},ae=()=>{const s=window.location.hash,[e,a]=s.split("?");return new URLSearchParams(a).get("order")};export{ue as O,de as a,he as c,me as g,T as s,xe as u};
//# sourceMappingURL=kmo5unuf793khl43.js.map
