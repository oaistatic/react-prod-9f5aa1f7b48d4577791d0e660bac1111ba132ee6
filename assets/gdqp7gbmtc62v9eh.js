var j=Object.defineProperty;var C=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var A=(e,t,a)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,T=(e,t)=>{for(var a in t||(t={}))L.call(t,a)&&A(e,a,t[a]);if(C)for(var a of C(t))M.call(t,a)&&A(e,a,t[a]);return e};var b=(e,t,a)=>A(e,typeof t!="symbol"?t+"":t,a);import{l as B}from"./i8clt0mfz495j7ii.js";var y={},E;function S(){if(E)return y;E=1,y.byteLength=x,y.toByteArray=k,y.fromByteArray=F;for(var e=[],t=[],a=typeof Uint8Array<"u"?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,g=o.length;s<g;++s)e[s]=o[s],t[o.charCodeAt(s)]=s;t[45]=62,t[95]=63;function p(r){var c=r.length;if(c%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=r.indexOf("=");n===-1&&(n=c);var l=n===c?0:4-n%4;return[n,l]}function x(r){var c=p(r),n=c[0],l=c[1];return(n+l)*3/4-l}function f(r,c,n){return(c+n)*3/4-n}function k(r){var c,n=p(r),l=n[0],u=n[1],d=new a(f(r,l,u)),h=0,w=u>0?l-4:l,v;for(v=0;v<w;v+=4)c=t[r.charCodeAt(v)]<<18|t[r.charCodeAt(v+1)]<<12|t[r.charCodeAt(v+2)]<<6|t[r.charCodeAt(v+3)],d[h++]=c>>16&255,d[h++]=c>>8&255,d[h++]=c&255;return u===2&&(c=t[r.charCodeAt(v)]<<2|t[r.charCodeAt(v+1)]>>4,d[h++]=c&255),u===1&&(c=t[r.charCodeAt(v)]<<10|t[r.charCodeAt(v+1)]<<4|t[r.charCodeAt(v+2)]>>2,d[h++]=c>>8&255,d[h++]=c&255),d}function i(r){return e[r>>18&63]+e[r>>12&63]+e[r>>6&63]+e[r&63]}function m(r,c,n){for(var l,u=[],d=c;d<n;d+=3)l=(r[d]<<16&16711680)+(r[d+1]<<8&65280)+(r[d+2]&255),u.push(i(l));return u.join("")}function F(r){for(var c,n=r.length,l=n%3,u=[],d=16383,h=0,w=n-l;h<w;h+=d)u.push(m(r,h,h+d>w?w:h+d));return l===1?(c=r[n-1],u.push(e[c>>2]+e[c<<4&63]+"==")):l===2&&(c=(r[n-2]<<8)+r[n-1],u.push(e[c>>10]+e[c>>4&63]+e[c<<2&63]+"=")),u.join("")}return y}var R=S();const O=B(R);var P=Object.defineProperty,D=(e,t,a)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,J=(e,t,a)=>(D(e,t+"",a),a);function U(e,t){let a=Array.from({length:e.length},(o,s)=>({start:s,end:s+1}));for(;a.length>1;){let o=null;for(let s=0;s<a.length-1;s++){const g=e.slice(a[s].start,a[s+1].end),p=t.get(g.join(","));p!=null&&(o==null||p<o[0])&&(o=[p,s])}if(o!=null){const s=o[1];a[s]={start:a[s].start,end:a[s+1].end},a.splice(s+1,1)}else break}return a}function I(e,t){return e.length===1?[t.get(e.join(","))]:U(e,t).map(a=>t.get(e.slice(a.start,a.end).join(","))).filter(a=>a!=null)}function N(e){return e.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var _=class{constructor(e,t){b(this,"specialTokens");b(this,"inverseSpecialTokens");b(this,"patStr");b(this,"textEncoder",new TextEncoder);b(this,"textDecoder",new TextDecoder("utf-8"));b(this,"rankMap",new Map);b(this,"textMap",new Map);this.patStr=e.pat_str;const a=e.bpe_ranks.split("\n").filter(Boolean).reduce((o,s)=>{const[g,p,...x]=s.split(" "),f=Number.parseInt(p,10);return x.forEach((k,i)=>o[k]=f+i),o},{});for(const[o,s]of Object.entries(a)){const g=O.toByteArray(o);this.rankMap.set(g.join(","),s),this.textMap.set(s,g)}this.specialTokens=T(T({},e.special_tokens),t),this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((o,[s,g])=>(o[g]=this.textEncoder.encode(s),o),{})}encode(e,t=[],a="all"){var k;const o=new RegExp(this.patStr,"ug"),s=_.specialTokenRegex(Object.keys(this.specialTokens)),g=[],p=new Set(t==="all"?Object.keys(this.specialTokens):t),x=new Set(a==="all"?Object.keys(this.specialTokens).filter(i=>!p.has(i)):a);if(x.size>0){const i=_.specialTokenRegex([...x]),m=e.match(i);if(m!=null)throw new Error("The text contains a special token that is not allowed: ".concat(m[0]))}let f=0;for(;;){let i=null,m=f;for(;s.lastIndex=m,i=s.exec(e),!(i==null||p.has(i[0]));)m=i.index+1;const F=(k=i==null?void 0:i.index)!=null?k:e.length;for(const c of e.substring(f,F).matchAll(o)){const n=this.textEncoder.encode(c[0]),l=this.rankMap.get(n.join(","));if(l!=null){g.push(l);continue}g.push(...I(n,this.rankMap))}if(i==null)break;let r=this.specialTokens[i[0]];g.push(r),f=i.index+i[0].length}return g}decode(e){var g;const t=[];let a=0;for(let p=0;p<e.length;++p){const x=e[p],f=(g=this.textMap.get(x))!=null?g:this.inverseSpecialTokens[x];f!=null&&(t.push(f),a+=f.length)}const o=new Uint8Array(a);let s=0;for(const p of t)o.set(p,s),s+=p.length;return this.textDecoder.decode(o)}},q=_;J(q,"specialTokenRegex",e=>new RegExp(e.map(t=>N(t)).join("|"),"g"));function z(e){switch(e){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"gpt-4o-search-preview":case"gpt-4o-search-preview-2025-03-11":case"gpt-4o-mini-search-preview":case"gpt-4o-mini-search-preview-2025-03-11":case"gpt-4o-audio-preview":case"gpt-4o-audio-preview-2024-12-17":case"gpt-4o-audio-preview-2024-10-01":case"gpt-4o-mini-audio-preview":case"gpt-4o-mini-audio-preview-2024-12-17":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-mini-2024-09-12":case"o1-preview":case"o1-preview-2024-09-12":case"o1-pro":case"o1-pro-2025-03-19":case"o3":case"o3-2025-04-16":case"o3-mini":case"o3-mini-2025-01-31":case"o4-mini":case"o4-mini-2025-04-16":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":case"gpt-4o-realtime-preview-2024-12-17":case"gpt-4o-mini-realtime-preview":case"gpt-4o-mini-realtime-preview-2024-12-17":case"gpt-4.1":case"gpt-4.1-2025-04-14":case"gpt-4.1-mini":case"gpt-4.1-mini-2025-04-14":case"gpt-4.1-nano":case"gpt-4.1-nano-2025-04-14":case"gpt-4.5-preview":case"gpt-4.5-preview-2025-02-27":case"gpt-5":case"gpt-5-2025-08-07":case"gpt-5-nano":case"gpt-5-nano-2025-08-07":case"gpt-5-mini":case"gpt-5-mini-2025-08-07":case"gpt-5-chat-latest":return"o200k_base";default:throw new Error("Unknown model")}}export{q as Tiktoken,z as getEncodingNameForModel};
//# sourceMappingURL=gdqp7gbmtc62v9eh.js.map
