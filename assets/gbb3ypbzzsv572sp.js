var ue=Object.defineProperty,ie=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var G=(e,r,a)=>r in e?ue(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,p=(e,r)=>{for(var a in r||(r={}))de.call(r,a)&&G(e,a,r[a]);if(Z)for(var a of Z(r))pe.call(r,a)&&G(e,a,r[a]);return e},w=(e,r)=>ie(e,fe(r));import{e as L,r as S,j as l,h as te,k as B,M as W,P as Se}from"./i8clt0mfz495j7ii.js";import{R as ye,u as he,a0 as ge,$ as be,e as Pe,B as se,P as re,aY as _e,J as Q,eb as Te}from"./ghewn7l2ynbm32fm.js";import{c as m,S as q,F as Y,a as oe,C as D,L as we}from"./n8tfpmgkqe98i7yl.js";import{cN as Me,cP as Ee,bK as xe,gP as Ce,dB as Ne,aI as ve,ew as Le,dH as Ae,dI as je,dC as F,mF as Re,bH as Oe,dF as Ie,k5 as Ue,bI as Fe,bJ as qe}from"./j0yo6uv6652vva62.js";import{P as ne,u as ze,B as ke}from"./kplnfohfof8ely0n.js";import{S as Qe}from"./mq11hu99eist2abq.js";const ee="country_code",k="step",V=e=>ye.safePost("/accounts/pending_team_workspace",{requestBody:e}),Ve=({formData:e,onNext:r})=>{var y,P;const a=L(),[t,d]=S.useState({role:(y=e.role)!=null?y:"",department:(P=e.department)!=null?P:""}),[n,f]=S.useState({}),g=(s,o)=>{d(h=>w(p({},h),{[s]:o})),f(h=>w(p({},h),{[s]:""}))},b=S.useMemo(()=>{const s=Me.map(o=>({label:a.formatMessage(o.displayValue),value:o.id}));return s.sort((o,h)=>o.label.localeCompare(h.label)),s},[a]),c=S.useMemo(()=>{const s=Ee.map(o=>({label:a.formatMessage(o.displayValue),value:o.id}));return s.sort((o,h)=>o.label.localeCompare(h.label)),s},[a]),u=S.useMemo(()=>[{formType:"select",label:a.formatMessage(m.roleLabel),name:"role",placeholder:a.formatMessage(m.rolePlaceholder),value:t.role,onChange:s=>g("role",s),error:n.role,required:!0,options:c},{formType:"select",label:a.formatMessage(m.workspaceDepartmentLabel),name:"department",placeholder:a.formatMessage(m.workspaceDepartmentPlaceholder),value:t.department,onChange:s=>g("department",s),error:n.department,required:!0,options:b}],[b,n.department,n.role,t.department,t.role,a,c]),i=()=>{const s={};return u.forEach(o=>{o.required&&!t[o.name]&&(s[o.name]=a.formatMessage(m.fieldRequired,{fieldName:o.label}))}),f(s),Object.values(s).every(o=>!o)};return l.jsx(q,{content:l.jsxs(Y,{title:a.formatMessage(m.tellUsAboutWorkStepTitle),subTitle:a.formatMessage(m.tellUsAboutWorkStepSubtitle),children:[l.jsx("div",{className:"flex flex-col gap-6",children:u.map(s=>S.createElement(oe,w(p({},s),{key:s.name})))}),l.jsx(D,{onClick:async()=>{i()&&await r(t)}})]})})},Be=e=>e==="sales_marketing",Ye={input:"rounded-full!",button:"rounded-full! h-8! w-8! border-none!",buttons:"absolute end-2! gap-0!"};function De({isOneDollarPromoEligible:e,isFreeTrialPromoEligible:r,salesMarketingCopyEnabled:a}){return!e&&!r?{titleMessage:m.purchaseStepTitle,subTitleMessage:void 0}:e?{titleMessage:m.oneDollarPromoTitle,subTitleMessage:a?m.salesMarketingPromoSubtitleOneDollar:m.oneDollarPromoSubtitle}:{titleMessage:m.freeTrialPromoTitle,subTitleMessage:a?m.salesMarketingPromoSubtitleFree:m.freeTrialPromoSubtitle}}const Xe=({onNext:e,onPrevious:r,pendingWorkspace:a,initialBillingDetails:t,formData:d})=>{var $,H;const n=L(),f=he(),g=Le(),{data:b,isLoading:c,error:u}=xe({ctx:f,countryCode:t==null?void 0:t.country,currency:t==null?void 0:t.currency,enabled:t!=null}),i=te(),y=B(),s=S.useMemo(()=>{const K=new URLSearchParams(y.search).get("segment");return Be(K)?K:null},[y.search])!=null&&ge(f,"3300867660").get("enable_sales_marketing_copy",!1),o=(H=new URLSearchParams(($=a==null?void 0:a.query_params)!=null?$:"").get(ne))!=null?H:void 0,{selectedPlan:h,setSelectedPlan:A,numSeats:E,setNumSeats:j,promoData:x,TEAM1DOLLAR_COUPON_IsEligible:C,TEAM_FREE_TRIAL_COUPON_IsEligible:N}=ze({initialSeats:d==null?void 0:d.numSeats,initialPromoCoupon:o}),{eligible:R,campaignId:O}=Ce(),I=!o&&R,T=x!=null?x:I?{coupon:O,state:"eligible",redemption:null}:void 0;if(!t||c||u!=null||!b)return l.jsx(q,{forceLightTheme:!0,content:null});const{annualBillingPlan:_}=Ne(t.currency,b),z=Math.floor(100-_.discountedMonthlyCost/_.monthlyCost*100),v={priceInterval:h,billingDetails:t,numSeats:E,promoData:T},U=C||N,{titleMessage:ce,subTitleMessage:X}=De({isOneDollarPromoEligible:!!C,isFreeTrialPromoEligible:!!N,salesMarketingCopyEnabled:s}),me=ve(isNaN(E)?0:E,g,Ae);return l.jsx(q,{forceLightTheme:!0,onPrevious:r?()=>r(p({},v)):void 0,content:l.jsxs(Y,{title:n.formatMessage(ce),subTitle:X&&n.formatMessage(X),children:[l.jsxs("div",{className:"flex flex-col gap-6",children:[l.jsx(je,{numSeats:E,minSeats:g,setNumSeats:j,classNames:Ye,label:l.jsx(W,p({},m.seatsCountLabel))}),l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsx(we,{required:!0,children:n.formatMessage(m.planSummaryTitle)}),l.jsxs("div",{className:"border-token-border-default flex flex-col gap-6 rounded-3xl border p-5",children:[!(U&&h===F.FLEXIBLE)&&l.jsx(Qe,{ariaLabel:n.formatMessage(m.planTypeLabel),leftItem:{label:l.jsx("div",{className:"flex flex-wrap justify-center gap-1 text-center",children:n.formatMessage(m.annualPlanLabel,{percent:z,span:J=>l.jsx("span",{className:"text-[#10A37F]",children:J})})}),value:F.ANNUAL},rightItem:{label:n.formatMessage(m.monthlyPlanLabel),value:F.FLEXIBLE},value:h,onChange:A}),l.jsx(ke,{numSeats:me,selectedPlan:h,billingDetails:t,totalLabel:m.allPlansTodayTotal,billDate:n.formatMessage(m.today),promoData:T})]})]})]}),l.jsx(D,{onClick:()=>e(p({},v))}),l.jsx(be,{color:"ghost",onClick:()=>i("/"),children:l.jsx(W,{id:"TjfExQ",defaultMessage:"Cancel"})})]})})},$e=({formData:e,onNext:r,onPrevious:a})=>{var y,P;const t=L(),[d,n]=S.useState({workspaceName:(y=e.workspaceName)!=null?y:"",companySize:(P=e.companySize)!=null?P:""}),[f,g]=S.useState({}),b=(s,o)=>{n(h=>w(p({},h),{[s]:o})),g(h=>w(p({},h),{[s]:""}))},c=Re.map(s=>({label:typeof s.displayValue=="string"?s.displayValue:t.formatMessage(s.displayValue),value:s.id})),u=S.useMemo(()=>[{formType:"input",label:t.formatMessage(m.workspaceNameLabel),name:"workspaceName",placeholder:t.formatMessage(m.workspaceNamePlaceholder),value:d.workspaceName,onChange:s=>b("workspaceName",s),error:f.workspaceName,required:!0,autoFocus:!0},{formType:"select",label:t.formatMessage(m.workspaceCompanySizeLabel),name:"companySize",placeholder:t.formatMessage(m.workspaceCompanySizePlaceholder),value:d.companySize,onChange:s=>b("companySize",s),error:f.companySize,required:!1,options:c}],[f.companySize,f.workspaceName,d.companySize,d.workspaceName,t,c]),i=()=>{const s={};return u.forEach(o=>{o.required&&!d[o.name]&&(s[o.name]=t.formatMessage(m.fieldRequired,{fieldName:o.label}))}),g(s),Object.values(s).every(o=>!o)};return l.jsx(q,{onPrevious:a?()=>a(p({},d)):void 0,content:l.jsxs(Y,{title:t.formatMessage(m.workspaceNameStepTitle),subTitle:t.formatMessage(m.workspaceNameStepSubtitle),children:[l.jsx("div",{className:"flex flex-col gap-6",children:u.map(s=>S.createElement(oe,w(p({},s),{key:s.name})))}),l.jsx(D,{disabled:!d.workspaceName,onClick:async()=>{i()&&await r(p({},d))}})]})})};var le=(e=>(e.AboutWork="about-work",e.WorkspaceInfo="workspace-info",e.ConfigurePlan="configure-plan",e))(le||{});const He=Te(Object.values(le),void 0),ra=({pendingWorkspace:e})=>{var h,A,E,j,x,C,N,R,O,I;const r=L(),[a,t]=S.useState({workspaceName:(h=e==null?void 0:e.workspace_name)!=null?h:void 0,role:(A=e==null?void 0:e.role)!=null?A:void 0,department:(E=e==null?void 0:e.department)!=null?E:void 0,companySize:(j=e==null?void 0:e.company_size)!=null?j:void 0,numSeats:(x=e==null?void 0:e.seat_quantity)!=null?x:void 0});Ue((N=new URLSearchParams((C=e==null?void 0:e.query_params)!=null?C:"").get(ne))!=null?N:"");const d=Je({data:a}),n=se(),f=B(),g=(I=(O=new URLSearchParams(f.search).get(ee))!=null?O:new URLSearchParams((R=e==null?void 0:e.query_params)!=null?R:"").get(ee))!=null?I:void 0,b=Se(),{country:c,userCountry:u}=Fe({initialCountryCode:g}),i=qe({country:c,currentAccount:n,location:"TeamDirectSignUpFlow"}),y=He(e==null?void 0:e.step_name),{step:P,nextStep:s}=Ke({initialStep:y&&M.includes(y)?y:void 0});S.useEffect(()=>{e||(()=>{var _;V({step_name:(_=e==null?void 0:e.step_name)!=null?_:M[0],query_params:f.search,user_segment:"v1"})})()},[]),S.useEffect(()=>{var v,U;const T=f.key,z=new URLSearchParams(window.location.search).get("referrer")||document.referrer;re.logEventWithStatsig("Account Pay: Team Direct Sign Up Flow","chatgpt_account_payment_team_direct_sign_up_flow",w(p({},n==null?void 0:n.subscriptionAnalyticsParams),{referrer:z,initialTab:e==null?void 0:e.step_name,currentTab:P,locationKey:T,navigationType:b,initialCountrySelectorCountry:g!=null?g:c,selectedCountry:(v=i==null?void 0:i.country)!=null?v:"",selectedCurrency:(U=i==null?void 0:i.currency)!=null?U:"",userCountry:u!=null?u:""}))},[P]);const o=()=>{switch(P){case"about-work":return l.jsx(Ve,{formData:a,onNext:async T=>{const _=p(p({},a),T);t(_),await s(_)}});case"workspace-info":return l.jsx($e,{formData:a,onNext:async T=>{const _=p(p({},a),T);t(_),await s(_)}});case"configure-plan":return l.jsx(Xe,{formData:a,initialBillingDetails:i!=null?i:void 0,onNext:async T=>{await d(p(p({},a),T))},pendingWorkspace:e});default:return null}};return l.jsxs(l.Fragment,{children:[l.jsx("title",{children:r.formatMessage(m.teamSignUpPageTitle)}),o()]})},Je=({data:e,isCustomCheckout:r=!1})=>{const{prepareCheckoutSession:a,navigateToCheckout:t}=Oe(),d=Pe(),n=L(),f=se();return S.useCallback(async({priceInterval:b,billingDetails:c,numSeats:u,promoData:i})=>{var y;try{re.logEvent("Account Pay: Payment Checkout Clicked",w(p({planType:_e.SELF_SERVE_BUSINESS},f==null?void 0:f.subscriptionAnalyticsParams),{referrer:document.referrer}));const P=await a(w(p({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:(y=e.workspaceName)!=null?y:"",price_interval:b,seat_quantity:u},billing_details:c},r?{}:{checkout_ui_mode:"redirect"}),{promo_campaign:b===F.FLEXIBLE?i==null?void 0:i.coupon:null,cancel_url:window.location.href}));await t(P)}catch(P){Q.addError(P),d.warning(n.formatMessage(Ie.paymentErrorWarning),{hasCloseButton:!0})}},[r,f==null?void 0:f.subscriptionAnalyticsParams,e.workspaceName,n,t,a,d])},ae=(e,r)=>{const a=new URLSearchParams(window.location.search);Object.entries(e).forEach(([d,n])=>{a.set(d,n)});const t="".concat(window.location.pathname,"?").concat(a.toString());r?r(t,{replace:!1}):window.history.replaceState(null,"",t)},M=["configure-plan"],Ke=({initialStep:e})=>{const r=te(),a=B(),[t,d]=S.useState(()=>{const c=e!=null?e:M[0];return ae({[k]:c}),c}),n=S.useCallback(c=>{d(c),ae({[k]:c},r)},[r]),f=S.useRef(null);S.useEffect(()=>{const u=new URLSearchParams(a.search).get(k);u!==f.current&&u&&M.includes(u)&&u!==t&&n(u),f.current=u},[a.search,n,t]);const g=async c=>{let u=t;const i=M.indexOf(t);i>=0&&i<M.length-1&&(u=M[i+1],n(u));try{await V({workspace_name:c.workspaceName,company_size:c.companySize,department:c.department,role:c.role,step_name:u,query_params:a.search,user_segment:"v1"})}catch(y){Q.addError(y)}},b=S.useCallback(async c=>{let u=t;const i=M.indexOf(t);i>0&&(u=M[i-1],n(u));try{await V({workspace_name:c.workspaceName,company_size:c.companySize,department:c.department,role:c.role,step_name:u,query_params:a.search,user_segment:"v1"})}catch(y){Q.addError(y)}},[a.search,n,t]);return{step:t,nextStep:g,previousStep:b}};export{ra as C,k as S,Be as i,Je as u};
//# sourceMappingURL=gbb3ypbzzsv572sp.js.map
