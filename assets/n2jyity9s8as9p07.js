const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/j0yo6uv6652vva62.js","assets/i8clt0mfz495j7ii.js","assets/ghewn7l2ynbm32fm.js","assets/root-c4psboex.css","assets/conversation-small-lq38g8zw.css"])))=>i.map(i=>d[i]);
import{_ as P,A as N,r as m,a4 as v,a as M,j as e,e as S,M as o}from"./i8clt0mfz495j7ii.js";import{o as b,L as W,u as T,aK as R,nb as U,R as I,A as O,P as i,v as B,nc as $,$ as L}from"./ghewn7l2ynbm32fm.js";import{N as p,U as h,W as H,a as D,C as K}from"./bhddj8o0r8yu170k.js";const j=b(()=>P(()=>import("./j0yo6uv6652vva62.js").then(t=>t.yE),__vite__mapDeps([0,1,2,3,4])),{loading:t=>W(t)});function q(t,n){setTimeout(()=>{window.location.href=n},t*1e3)}const Y=N(function(){const n=T(),[l,c]=m.useState(!1),{session:r,isLoading:f}=R(n),{phoneNumber:s,proof:C,nextAction:x,entityId:g}=v(),A=x===p.Authenticate,y=x===p.LinkAccount&&!l,E=x===p.LinkAccount&&l,{mutate:_,isPending:w}=M({mutationFn:async a=>{try{if(a===h.Cancel)return{success:!1};if(!r||f)return{success:!1,errorCode:U.SessionExpired};const{success:u,error_code:d}=await I.safePost("/moodeng/account_linking",{requestBody:{proof:C,identifier:s},authOption:O.Required});return{success:u,errorCode:d}}catch(u){return{success:!1}}},onSuccess:(a,u)=>{var d;if(!a.success&&u===h.Cancel){window.location.href=H;return}else if(!a.success){const k=new URLSearchParams;k.set("reason",(d=a.errorCode)!=null?d:""),k.set("wid",g!=null?g:""),window.location.href="/account-link/error?".concat(k.toString());return}return c(!0),q(2,D)}});return m.useEffect(()=>{if(A){if(!s)return;i.logEventWithStatsig("Account Link: Redirect to Authenticate","chatgpt_account_link_redirect_authenticate"),B(n,{fallbackScreenHint:"signup",callbackUrl:"".concat(location.pathname).concat(location.search).concat(location.hash),additionalAuthParams:{[$]:"true"}})}},[A,s,n]),e.jsxs("div",{className:"mx-auto w-full max-w-sm sm:max-w-md",children:[y&&e.jsx(F,{phoneNumber:s,onAllowClick:()=>_(h.Allow),onCancelClick:()=>_(h.Cancel),isOnAllowClickPending:w,isOnCancelClickPending:w}),E&&e.jsx(G,{})]})});function F({phoneNumber:t,onAllowClick:n,onCancelClick:l,isOnAllowClickPending:c,isOnCancelClickPending:r}){const f=S();return m.useEffect(()=>{i.logEventWithStatsig("Account Link: Confirm UI Shown","chatgpt_account_link_confirm_ui_shown")},[]),e.jsxs("div",{className:"flex w-full flex-col items-center justify-center px-4 py-10",children:[e.jsx("header",{className:"oai-header",children:e.jsx(j,{alt:f.formatMessage({id:"login.openAiLogo",defaultMessage:"OpenAI Logo"}),className:"h-10 w-10"})}),e.jsx("h1",{className:"mt-10 text-center text-3xl font-semibold",children:e.jsx(o,{id:"account-link.confirm.title",defaultMessage:"Confirm account linking"})}),e.jsx("p",{className:"text-token-text-secondary mt-6 text-center",children:e.jsx(o,{id:"account-link.confirm-link.description",defaultMessage:'By clicking "Allow", your WhatsApp number {phoneValue} and conversations will be linked to your ChatGPT account and subject to data cotrols in your account settings. <learnMoreLink>Learn more.</learnMoreLink>',values:{phoneValue:t,learnMoreLink:s=>e.jsx("a",{href:K,target:"_blank",rel:"noopener noreferrer",className:"text-token-link hover:text-token-link-hover",children:s})}})}),e.jsxs("div",{className:"mt-6 flex w-full flex-col gap-3",children:[e.jsx(L,{className:"w-full rounded-md",color:"green",type:"submit",onClick:()=>{i.logEventWithStatsig('Account Link: "Allow WhatsApp Linking" Button Clicked',"chatgpt_account_link_allow_clicked"),n()},disabled:c||r,loading:c,children:e.jsx(o,{id:"account-link.confirm.button",defaultMessage:"Allow"})}),e.jsx(L,{className:"w-full rounded-md",color:"secondary",onClick:()=>{i.logEventWithStatsig('Account Link: "Cancel WhatsApp Linking" Button Clicked',"chatgpt_account_link_cancel_clicked"),l()},disabled:r||c,children:e.jsx(o,{id:"account-link.confirm.cancel",defaultMessage:"Cancel"})})]})]})}function G(){const t=S();return m.useEffect(()=>{i.logEventWithStatsig("Account Link: Success","chatgpt_account_link_success")},[]),e.jsxs("div",{className:"flex w-full flex-col items-center justify-center px-4 py-10",children:[e.jsx("header",{className:"oai-header",children:e.jsx(j,{alt:t.formatMessage({id:"login.openAiLogo",defaultMessage:"OpenAI Logo"}),className:"h-10 w-10"})}),e.jsx("h1",{className:"mt-10 text-center text-3xl font-semibold",children:e.jsx(o,{id:"account-link.success.title",defaultMessage:"Successfully linked your ChatGPT account"})}),e.jsx("p",{className:"text-token-text-secondary mt-6 text-center",children:e.jsx(o,{id:"account-link.success.description",defaultMessage:"You can now close this window and return to WhatsApp, or you will be automatically redirected momentarily."})})]})}export{Y as default};
//# sourceMappingURL=n2jyity9s8as9p07.js.map
